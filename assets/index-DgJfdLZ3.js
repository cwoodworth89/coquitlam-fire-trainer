(function(){const A=document.createElement("link").relList;if(A&&A.supports&&A.supports("modulepreload"))return;for(const V of document.querySelectorAll('link[rel="modulepreload"]'))k(V);new MutationObserver(V=>{for(const it of V)if(it.type==="childList")for(const O of it.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&k(O)}).observe(document,{childList:!0,subtree:!0});function C(V){const it={};return V.integrity&&(it.integrity=V.integrity),V.referrerPolicy&&(it.referrerPolicy=V.referrerPolicy),V.crossOrigin==="use-credentials"?it.credentials="include":V.crossOrigin==="anonymous"?it.credentials="omit":it.credentials="same-origin",it}function k(V){if(V.ep)return;V.ep=!0;const it=C(V);fetch(V.href,it)}})();function um(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var Wp={exports:{}},dd={};var Cm;function P_(){if(Cm)return dd;Cm=1;var x=Symbol.for("react.transitional.element"),A=Symbol.for("react.fragment");function C(k,V,it){var O=null;if(it!==void 0&&(O=""+it),V.key!==void 0&&(O=""+V.key),"key"in V){it={};for(var g in V)g!=="key"&&(it[g]=V[g])}else it=V;return V=it.ref,{$$typeof:x,type:k,key:O,ref:V!==void 0?V:null,props:it}}return dd.Fragment=A,dd.jsx=C,dd.jsxs=C,dd}var Lm;function D_(){return Lm||(Lm=1,Wp.exports=P_()),Wp.exports}var Ae=D_(),Jp={exports:{}},vi={};var Im;function k_(){if(Im)return vi;Im=1;var x=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),it=Symbol.for("react.consumer"),O=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),bt=Symbol.for("react.suspense"),Et=Symbol.for("react.memo"),Wt=Symbol.for("react.lazy"),It=Symbol.for("react.activity"),Mt=Symbol.iterator;function Ui(dt){return dt===null||typeof dt!="object"?null:(dt=Mt&&dt[Mt]||dt["@@iterator"],typeof dt=="function"?dt:null)}var Bi={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},je=Object.assign,gi={};function on(dt,St,Ht){this.props=dt,this.context=St,this.refs=gi,this.updater=Ht||Bi}on.prototype.isReactComponent={},on.prototype.setState=function(dt,St){if(typeof dt!="object"&&typeof dt!="function"&&dt!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,dt,St,"setState")},on.prototype.forceUpdate=function(dt){this.updater.enqueueForceUpdate(this,dt,"forceUpdate")};function ea(){}ea.prototype=on.prototype;function We(dt,St,Ht){this.props=dt,this.context=St,this.refs=gi,this.updater=Ht||Bi}var Qi=We.prototype=new ea;Qi.constructor=We,je(Qi,on.prototype),Qi.isPureReactComponent=!0;var Ni=Array.isArray;function Xi(){}var Xe={H:null,A:null,T:null,S:null},Un=Object.prototype.hasOwnProperty;function wn(dt,St,Ht){var ae=Ht.ref;return{$$typeof:x,type:dt,key:St,ref:ae!==void 0?ae:null,props:Ht}}function ca(dt,St){return wn(dt.type,St,dt.props)}function Fe(dt){return typeof dt=="object"&&dt!==null&&dt.$$typeof===x}function Ei(dt){var St={"=":"=0",":":"=2"};return"$"+dt.replace(/[=:]/g,function(Ht){return St[Ht]})}var Sn=/\/+/g;function Pi(dt,St){return typeof dt=="object"&&dt!==null&&dt.key!=null?Ei(""+dt.key):St.toString(36)}function $i(dt){switch(dt.status){case"fulfilled":return dt.value;case"rejected":throw dt.reason;default:switch(typeof dt.status=="string"?dt.then(Xi,Xi):(dt.status="pending",dt.then(function(St){dt.status==="pending"&&(dt.status="fulfilled",dt.value=St)},function(St){dt.status==="pending"&&(dt.status="rejected",dt.reason=St)})),dt.status){case"fulfilled":return dt.value;case"rejected":throw dt.reason}}throw dt}function Vt(dt,St,Ht,ae,me){var xe=typeof dt;(xe==="undefined"||xe==="boolean")&&(dt=null);var Ve=!1;if(dt===null)Ve=!0;else switch(xe){case"bigint":case"string":case"number":Ve=!0;break;case"object":switch(dt.$$typeof){case x:case A:Ve=!0;break;case Wt:return Ve=dt._init,Vt(Ve(dt._payload),St,Ht,ae,me)}}if(Ve)return me=me(dt),Ve=ae===""?"."+Pi(dt,0):ae,Ni(me)?(Ht="",Ve!=null&&(Ht=Ve.replace(Sn,"$&/")+"/"),Vt(me,St,Ht,"",function(Qa){return Qa})):me!=null&&(Fe(me)&&(me=ca(me,Ht+(me.key==null||dt&&dt.key===me.key?"":(""+me.key).replace(Sn,"$&/")+"/")+Ve)),St.push(me)),1;Ve=0;var Mi=ae===""?".":ae+":";if(Ni(dt))for(var Vi=0;Vi<dt.length;Vi++)ae=dt[Vi],xe=Mi+Pi(ae,Vi),Ve+=Vt(ae,St,Ht,xe,me);else if(Vi=Ui(dt),typeof Vi=="function")for(dt=Vi.call(dt),Vi=0;!(ae=dt.next()).done;)ae=ae.value,xe=Mi+Pi(ae,Vi++),Ve+=Vt(ae,St,Ht,xe,me);else if(xe==="object"){if(typeof dt.then=="function")return Vt($i(dt),St,Ht,ae,me);throw St=String(dt),Error("Objects are not valid as a React child (found: "+(St==="[object Object]"?"object with keys {"+Object.keys(dt).join(", ")+"}":St)+"). If you meant to render a collection of children, use an array instead.")}return Ve}function ce(dt,St,Ht){if(dt==null)return dt;var ae=[],me=0;return Vt(dt,ae,"","",function(xe){return St.call(Ht,xe,me++)}),ae}function re(dt){if(dt._status===-1){var St=dt._result;St=St(),St.then(function(Ht){(dt._status===0||dt._status===-1)&&(dt._status=1,dt._result=Ht)},function(Ht){(dt._status===0||dt._status===-1)&&(dt._status=2,dt._result=Ht)}),dt._status===-1&&(dt._status=0,dt._result=St)}if(dt._status===1)return dt._result.default;throw dt._result}var xi=typeof reportError=="function"?reportError:function(dt){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var St=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof dt=="object"&&dt!==null&&typeof dt.message=="string"?String(dt.message):String(dt),error:dt});if(!window.dispatchEvent(St))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",dt);return}console.error(dt)},ge={map:ce,forEach:function(dt,St,Ht){ce(dt,function(){St.apply(this,arguments)},Ht)},count:function(dt){var St=0;return ce(dt,function(){St++}),St},toArray:function(dt){return ce(dt,function(St){return St})||[]},only:function(dt){if(!Fe(dt))throw Error("React.Children.only expected to receive a single React element child.");return dt}};return vi.Activity=It,vi.Children=ge,vi.Component=on,vi.Fragment=C,vi.Profiler=V,vi.PureComponent=We,vi.StrictMode=k,vi.Suspense=bt,vi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Xe,vi.__COMPILER_RUNTIME={__proto__:null,c:function(dt){return Xe.H.useMemoCache(dt)}},vi.cache=function(dt){return function(){return dt.apply(null,arguments)}},vi.cacheSignal=function(){return null},vi.cloneElement=function(dt,St,Ht){if(dt==null)throw Error("The argument must be a React element, but you passed "+dt+".");var ae=je({},dt.props),me=dt.key;if(St!=null)for(xe in St.key!==void 0&&(me=""+St.key),St)!Un.call(St,xe)||xe==="key"||xe==="__self"||xe==="__source"||xe==="ref"&&St.ref===void 0||(ae[xe]=St[xe]);var xe=arguments.length-2;if(xe===1)ae.children=Ht;else if(1<xe){for(var Ve=Array(xe),Mi=0;Mi<xe;Mi++)Ve[Mi]=arguments[Mi+2];ae.children=Ve}return wn(dt.type,me,ae)},vi.createContext=function(dt){return dt={$$typeof:O,_currentValue:dt,_currentValue2:dt,_threadCount:0,Provider:null,Consumer:null},dt.Provider=dt,dt.Consumer={$$typeof:it,_context:dt},dt},vi.createElement=function(dt,St,Ht){var ae,me={},xe=null;if(St!=null)for(ae in St.key!==void 0&&(xe=""+St.key),St)Un.call(St,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&(me[ae]=St[ae]);var Ve=arguments.length-2;if(Ve===1)me.children=Ht;else if(1<Ve){for(var Mi=Array(Ve),Vi=0;Vi<Ve;Vi++)Mi[Vi]=arguments[Vi+2];me.children=Mi}if(dt&&dt.defaultProps)for(ae in Ve=dt.defaultProps,Ve)me[ae]===void 0&&(me[ae]=Ve[ae]);return wn(dt,xe,me)},vi.createRef=function(){return{current:null}},vi.forwardRef=function(dt){return{$$typeof:g,render:dt}},vi.isValidElement=Fe,vi.lazy=function(dt){return{$$typeof:Wt,_payload:{_status:-1,_result:dt},_init:re}},vi.memo=function(dt,St){return{$$typeof:Et,type:dt,compare:St===void 0?null:St}},vi.startTransition=function(dt){var St=Xe.T,Ht={};Xe.T=Ht;try{var ae=dt(),me=Xe.S;me!==null&&me(Ht,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(Xi,xi)}catch(xe){xi(xe)}finally{St!==null&&Ht.types!==null&&(St.types=Ht.types),Xe.T=St}},vi.unstable_useCacheRefresh=function(){return Xe.H.useCacheRefresh()},vi.use=function(dt){return Xe.H.use(dt)},vi.useActionState=function(dt,St,Ht){return Xe.H.useActionState(dt,St,Ht)},vi.useCallback=function(dt,St){return Xe.H.useCallback(dt,St)},vi.useContext=function(dt){return Xe.H.useContext(dt)},vi.useDebugValue=function(){},vi.useDeferredValue=function(dt,St){return Xe.H.useDeferredValue(dt,St)},vi.useEffect=function(dt,St){return Xe.H.useEffect(dt,St)},vi.useEffectEvent=function(dt){return Xe.H.useEffectEvent(dt)},vi.useId=function(){return Xe.H.useId()},vi.useImperativeHandle=function(dt,St,Ht){return Xe.H.useImperativeHandle(dt,St,Ht)},vi.useInsertionEffect=function(dt,St){return Xe.H.useInsertionEffect(dt,St)},vi.useLayoutEffect=function(dt,St){return Xe.H.useLayoutEffect(dt,St)},vi.useMemo=function(dt,St){return Xe.H.useMemo(dt,St)},vi.useOptimistic=function(dt,St){return Xe.H.useOptimistic(dt,St)},vi.useReducer=function(dt,St,Ht){return Xe.H.useReducer(dt,St,Ht)},vi.useRef=function(dt){return Xe.H.useRef(dt)},vi.useState=function(dt){return Xe.H.useState(dt)},vi.useSyncExternalStore=function(dt,St,Ht){return Xe.H.useSyncExternalStore(dt,St,Ht)},vi.useTransition=function(){return Xe.H.useTransition()},vi.version="19.2.0",vi}var Pm;function cm(){return Pm||(Pm=1,Jp.exports=k_()),Jp.exports}var He=cm();const Lp=um(He);var Qp={exports:{}},pd={},tm={exports:{}},em={};var Dm;function R_(){return Dm||(Dm=1,(function(x){function A(Vt,ce){var re=Vt.length;Vt.push(ce);t:for(;0<re;){var xi=re-1>>>1,ge=Vt[xi];if(0<V(ge,ce))Vt[xi]=ce,Vt[re]=ge,re=xi;else break t}}function C(Vt){return Vt.length===0?null:Vt[0]}function k(Vt){if(Vt.length===0)return null;var ce=Vt[0],re=Vt.pop();if(re!==ce){Vt[0]=re;t:for(var xi=0,ge=Vt.length,dt=ge>>>1;xi<dt;){var St=2*(xi+1)-1,Ht=Vt[St],ae=St+1,me=Vt[ae];if(0>V(Ht,re))ae<ge&&0>V(me,Ht)?(Vt[xi]=me,Vt[ae]=re,xi=ae):(Vt[xi]=Ht,Vt[St]=re,xi=St);else if(ae<ge&&0>V(me,re))Vt[xi]=me,Vt[ae]=re,xi=ae;else break t}}return ce}function V(Vt,ce){var re=Vt.sortIndex-ce.sortIndex;return re!==0?re:Vt.id-ce.id}if(x.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var it=performance;x.unstable_now=function(){return it.now()}}else{var O=Date,g=O.now();x.unstable_now=function(){return O.now()-g}}var bt=[],Et=[],Wt=1,It=null,Mt=3,Ui=!1,Bi=!1,je=!1,gi=!1,on=typeof setTimeout=="function"?setTimeout:null,ea=typeof clearTimeout=="function"?clearTimeout:null,We=typeof setImmediate<"u"?setImmediate:null;function Qi(Vt){for(var ce=C(Et);ce!==null;){if(ce.callback===null)k(Et);else if(ce.startTime<=Vt)k(Et),ce.sortIndex=ce.expirationTime,A(bt,ce);else break;ce=C(Et)}}function Ni(Vt){if(je=!1,Qi(Vt),!Bi)if(C(bt)!==null)Bi=!0,Xi||(Xi=!0,Ei());else{var ce=C(Et);ce!==null&&$i(Ni,ce.startTime-Vt)}}var Xi=!1,Xe=-1,Un=5,wn=-1;function ca(){return gi?!0:!(x.unstable_now()-wn<Un)}function Fe(){if(gi=!1,Xi){var Vt=x.unstable_now();wn=Vt;var ce=!0;try{t:{Bi=!1,je&&(je=!1,ea(Xe),Xe=-1),Ui=!0;var re=Mt;try{e:{for(Qi(Vt),It=C(bt);It!==null&&!(It.expirationTime>Vt&&ca());){var xi=It.callback;if(typeof xi=="function"){It.callback=null,Mt=It.priorityLevel;var ge=xi(It.expirationTime<=Vt);if(Vt=x.unstable_now(),typeof ge=="function"){It.callback=ge,Qi(Vt),ce=!0;break e}It===C(bt)&&k(bt),Qi(Vt)}else k(bt);It=C(bt)}if(It!==null)ce=!0;else{var dt=C(Et);dt!==null&&$i(Ni,dt.startTime-Vt),ce=!1}}break t}finally{It=null,Mt=re,Ui=!1}ce=void 0}}finally{ce?Ei():Xi=!1}}}var Ei;if(typeof We=="function")Ei=function(){We(Fe)};else if(typeof MessageChannel<"u"){var Sn=new MessageChannel,Pi=Sn.port2;Sn.port1.onmessage=Fe,Ei=function(){Pi.postMessage(null)}}else Ei=function(){on(Fe,0)};function $i(Vt,ce){Xe=on(function(){Vt(x.unstable_now())},ce)}x.unstable_IdlePriority=5,x.unstable_ImmediatePriority=1,x.unstable_LowPriority=4,x.unstable_NormalPriority=3,x.unstable_Profiling=null,x.unstable_UserBlockingPriority=2,x.unstable_cancelCallback=function(Vt){Vt.callback=null},x.unstable_forceFrameRate=function(Vt){0>Vt||125<Vt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Un=0<Vt?Math.floor(1e3/Vt):5},x.unstable_getCurrentPriorityLevel=function(){return Mt},x.unstable_next=function(Vt){switch(Mt){case 1:case 2:case 3:var ce=3;break;default:ce=Mt}var re=Mt;Mt=ce;try{return Vt()}finally{Mt=re}},x.unstable_requestPaint=function(){gi=!0},x.unstable_runWithPriority=function(Vt,ce){switch(Vt){case 1:case 2:case 3:case 4:case 5:break;default:Vt=3}var re=Mt;Mt=Vt;try{return ce()}finally{Mt=re}},x.unstable_scheduleCallback=function(Vt,ce,re){var xi=x.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?xi+re:xi):re=xi,Vt){case 1:var ge=-1;break;case 2:ge=250;break;case 5:ge=1073741823;break;case 4:ge=1e4;break;default:ge=5e3}return ge=re+ge,Vt={id:Wt++,callback:ce,priorityLevel:Vt,startTime:re,expirationTime:ge,sortIndex:-1},re>xi?(Vt.sortIndex=re,A(Et,Vt),C(bt)===null&&Vt===C(Et)&&(je?(ea(Xe),Xe=-1):je=!0,$i(Ni,re-xi))):(Vt.sortIndex=ge,A(bt,Vt),Bi||Ui||(Bi=!0,Xi||(Xi=!0,Ei()))),Vt},x.unstable_shouldYield=ca,x.unstable_wrapCallback=function(Vt){var ce=Mt;return function(){var re=Mt;Mt=ce;try{return Vt.apply(this,arguments)}finally{Mt=re}}}})(em)),em}var km;function O_(){return km||(km=1,tm.exports=R_()),tm.exports}var im={exports:{}},xr={};var Rm;function B_(){if(Rm)return xr;Rm=1;var x=cm();function A(bt){var Et="https://react.dev/errors/"+bt;if(1<arguments.length){Et+="?args[]="+encodeURIComponent(arguments[1]);for(var Wt=2;Wt<arguments.length;Wt++)Et+="&args[]="+encodeURIComponent(arguments[Wt])}return"Minified React error #"+bt+"; visit "+Et+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function C(){}var k={d:{f:C,r:function(){throw Error(A(522))},D:C,C,L:C,m:C,X:C,S:C,M:C},p:0,findDOMNode:null},V=Symbol.for("react.portal");function it(bt,Et,Wt){var It=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:V,key:It==null?null:""+It,children:bt,containerInfo:Et,implementation:Wt}}var O=x.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function g(bt,Et){if(bt==="font")return"";if(typeof Et=="string")return Et==="use-credentials"?Et:""}return xr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,xr.createPortal=function(bt,Et){var Wt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Et||Et.nodeType!==1&&Et.nodeType!==9&&Et.nodeType!==11)throw Error(A(299));return it(bt,Et,null,Wt)},xr.flushSync=function(bt){var Et=O.T,Wt=k.p;try{if(O.T=null,k.p=2,bt)return bt()}finally{O.T=Et,k.p=Wt,k.d.f()}},xr.preconnect=function(bt,Et){typeof bt=="string"&&(Et?(Et=Et.crossOrigin,Et=typeof Et=="string"?Et==="use-credentials"?Et:"":void 0):Et=null,k.d.C(bt,Et))},xr.prefetchDNS=function(bt){typeof bt=="string"&&k.d.D(bt)},xr.preinit=function(bt,Et){if(typeof bt=="string"&&Et&&typeof Et.as=="string"){var Wt=Et.as,It=g(Wt,Et.crossOrigin),Mt=typeof Et.integrity=="string"?Et.integrity:void 0,Ui=typeof Et.fetchPriority=="string"?Et.fetchPriority:void 0;Wt==="style"?k.d.S(bt,typeof Et.precedence=="string"?Et.precedence:void 0,{crossOrigin:It,integrity:Mt,fetchPriority:Ui}):Wt==="script"&&k.d.X(bt,{crossOrigin:It,integrity:Mt,fetchPriority:Ui,nonce:typeof Et.nonce=="string"?Et.nonce:void 0})}},xr.preinitModule=function(bt,Et){if(typeof bt=="string")if(typeof Et=="object"&&Et!==null){if(Et.as==null||Et.as==="script"){var Wt=g(Et.as,Et.crossOrigin);k.d.M(bt,{crossOrigin:Wt,integrity:typeof Et.integrity=="string"?Et.integrity:void 0,nonce:typeof Et.nonce=="string"?Et.nonce:void 0})}}else Et==null&&k.d.M(bt)},xr.preload=function(bt,Et){if(typeof bt=="string"&&typeof Et=="object"&&Et!==null&&typeof Et.as=="string"){var Wt=Et.as,It=g(Wt,Et.crossOrigin);k.d.L(bt,Wt,{crossOrigin:It,integrity:typeof Et.integrity=="string"?Et.integrity:void 0,nonce:typeof Et.nonce=="string"?Et.nonce:void 0,type:typeof Et.type=="string"?Et.type:void 0,fetchPriority:typeof Et.fetchPriority=="string"?Et.fetchPriority:void 0,referrerPolicy:typeof Et.referrerPolicy=="string"?Et.referrerPolicy:void 0,imageSrcSet:typeof Et.imageSrcSet=="string"?Et.imageSrcSet:void 0,imageSizes:typeof Et.imageSizes=="string"?Et.imageSizes:void 0,media:typeof Et.media=="string"?Et.media:void 0})}},xr.preloadModule=function(bt,Et){if(typeof bt=="string")if(Et){var Wt=g(Et.as,Et.crossOrigin);k.d.m(bt,{as:typeof Et.as=="string"&&Et.as!=="script"?Et.as:void 0,crossOrigin:Wt,integrity:typeof Et.integrity=="string"?Et.integrity:void 0})}else k.d.m(bt)},xr.requestFormReset=function(bt){k.d.r(bt)},xr.unstable_batchedUpdates=function(bt,Et){return bt(Et)},xr.useFormState=function(bt,Et,Wt){return O.H.useFormState(bt,Et,Wt)},xr.useFormStatus=function(){return O.H.useHostTransitionStatus()},xr.version="19.2.0",xr}var Om;function i_(){if(Om)return im.exports;Om=1;function x(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x)}catch(A){console.error(A)}}return x(),im.exports=B_(),im.exports}var Bm;function N_(){if(Bm)return pd;Bm=1;var x=O_(),A=cm(),C=i_();function k(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function V(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function it(i){var a=i,l=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(l=a.return),i=a.return;while(i)}return a.tag===3?l:null}function O(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function g(i){if(i.tag===31){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function bt(i){if(it(i)!==i)throw Error(k(188))}function Et(i){var a=i.alternate;if(!a){if(a=it(i),a===null)throw Error(k(188));return a!==i?null:i}for(var l=i,p=a;;){var w=l.return;if(w===null)break;var M=w.alternate;if(M===null){if(p=w.return,p!==null){l=p;continue}break}if(w.child===M.child){for(M=w.child;M;){if(M===l)return bt(w),i;if(M===p)return bt(w),a;M=M.sibling}throw Error(k(188))}if(l.return!==p.return)l=w,p=M;else{for(var U=!1,Q=w.child;Q;){if(Q===l){U=!0,l=w,p=M;break}if(Q===p){U=!0,p=w,l=M;break}Q=Q.sibling}if(!U){for(Q=M.child;Q;){if(Q===l){U=!0,l=M,p=w;break}if(Q===p){U=!0,p=M,l=w;break}Q=Q.sibling}if(!U)throw Error(k(189))}}if(l.alternate!==p)throw Error(k(190))}if(l.tag!==3)throw Error(k(188));return l.stateNode.current===l?i:a}function Wt(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=Wt(i),a!==null)return a;i=i.sibling}return null}var It=Object.assign,Mt=Symbol.for("react.element"),Ui=Symbol.for("react.transitional.element"),Bi=Symbol.for("react.portal"),je=Symbol.for("react.fragment"),gi=Symbol.for("react.strict_mode"),on=Symbol.for("react.profiler"),ea=Symbol.for("react.consumer"),We=Symbol.for("react.context"),Qi=Symbol.for("react.forward_ref"),Ni=Symbol.for("react.suspense"),Xi=Symbol.for("react.suspense_list"),Xe=Symbol.for("react.memo"),Un=Symbol.for("react.lazy"),wn=Symbol.for("react.activity"),ca=Symbol.for("react.memo_cache_sentinel"),Fe=Symbol.iterator;function Ei(i){return i===null||typeof i!="object"?null:(i=Fe&&i[Fe]||i["@@iterator"],typeof i=="function"?i:null)}var Sn=Symbol.for("react.client.reference");function Pi(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===Sn?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case je:return"Fragment";case on:return"Profiler";case gi:return"StrictMode";case Ni:return"Suspense";case Xi:return"SuspenseList";case wn:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case Bi:return"Portal";case We:return i.displayName||"Context";case ea:return(i._context.displayName||"Context")+".Consumer";case Qi:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Xe:return a=i.displayName||null,a!==null?a:Pi(i.type)||"Memo";case Un:a=i._payload,i=i._init;try{return Pi(i(a))}catch{}}return null}var $i=Array.isArray,Vt=A.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=C.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},xi=[],ge=-1;function dt(i){return{current:i}}function St(i){0>ge||(i.current=xi[ge],xi[ge]=null,ge--)}function Ht(i,a){ge++,xi[ge]=i.current,i.current=a}var ae=dt(null),me=dt(null),xe=dt(null),Ve=dt(null);function Mi(i,a){switch(Ht(xe,a),Ht(me,i),Ht(ae,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?y(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=y(a),i=v(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}St(ae),Ht(ae,i)}function Vi(){St(ae),St(me),St(xe)}function Qa(i){i.memoizedState!==null&&Ht(Ve,i);var a=ae.current,l=v(a,i.type);a!==l&&(Ht(me,i),Ht(ae,l))}function Ys(i){me.current===i&&(St(ae),St(me)),Ve.current===i&&(St(Ve),Ic._currentValue=re)}var za,ks;function Ua(i){if(za===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);za=a&&a[1]||"",ks=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+za+i+ks}var br=!1;function Nt(i,a){if(!i||br)return"";br=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(a){var te=function(){throw Error()};if(Object.defineProperty(te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(te,[])}catch(qt){var Ut=qt}Reflect.construct(i,[],te)}else{try{te.call()}catch(qt){Ut=qt}i.call(te.prototype)}}else{try{throw Error()}catch(qt){Ut=qt}(te=i())&&typeof te.catch=="function"&&te.catch(function(){})}}catch(qt){if(qt&&Ut&&typeof qt.stack=="string")return[qt.stack,Ut.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var M=p.DetermineComponentFrameRoot(),U=M[0],Q=M[1];if(U&&Q){var mt=U.split(`
`),Bt=Q.split(`
`);for(w=p=0;p<mt.length&&!mt[p].includes("DetermineComponentFrameRoot");)p++;for(;w<Bt.length&&!Bt[w].includes("DetermineComponentFrameRoot");)w++;if(p===mt.length||w===Bt.length)for(p=mt.length-1,w=Bt.length-1;1<=p&&0<=w&&mt[p]!==Bt[w];)w--;for(;1<=p&&0<=w;p--,w--)if(mt[p]!==Bt[w]){if(p!==1||w!==1)do if(p--,w--,0>w||mt[p]!==Bt[w]){var Yt=`
`+mt[p].replace(" at new "," at ");return i.displayName&&Yt.includes("<anonymous>")&&(Yt=Yt.replace("<anonymous>",i.displayName)),Yt}while(1<=p&&0<=w);break}}}finally{br=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?Ua(l):""}function wr(i,a){switch(i.tag){case 26:case 27:case 5:return Ua(i.type);case 16:return Ua("Lazy");case 13:return i.child!==a&&a!==null?Ua("Suspense Fallback"):Ua("Suspense");case 19:return Ua("SuspenseList");case 0:case 15:return Nt(i.type,!1);case 11:return Nt(i.type.render,!1);case 1:return Nt(i.type,!0);case 31:return Ua("Activity");default:return""}}function Sr(i){try{var a="",l=null;do a+=wr(i,l),l=i,i=i.return;while(i);return a}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var zi=Object.prototype.hasOwnProperty,ln=x.unstable_scheduleCallback,Tr=x.unstable_cancelCallback,Ar=x.unstable_shouldYield,Ks=x.unstable_requestPaint,ia=x.unstable_now,gs=x.unstable_getCurrentPriorityLevel,qr=x.unstable_ImmediatePriority,co=x.unstable_UserBlockingPriority,ie=x.unstable_NormalPriority,Ws=x.unstable_LowPriority,ha=x.unstable_IdlePriority,Rs=x.log,Gr=x.unstable_setDisableYieldValue,oe=null,ke=null;function Ie(i){if(typeof Rs=="function"&&Gr(i),ke&&typeof ke.setStrictMode=="function")try{ke.setStrictMode(oe,i)}catch{}}var un=Math.clz32?Math.clz32:Js,Ca=Math.log,Qe=Math.LN2;function Js(i){return i>>>=0,i===0?32:31-(Ca(i)/Qe|0)|0}var ts=256,ys=262144,Za=4194304;function ot(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function H(i,a,l){var p=i.pendingLanes;if(p===0)return 0;var w=0,M=i.suspendedLanes,U=i.pingedLanes;i=i.warmLanes;var Q=p&134217727;return Q!==0?(p=Q&~M,p!==0?w=ot(p):(U&=Q,U!==0?w=ot(U):l||(l=Q&~i,l!==0&&(w=ot(l))))):(Q=p&~M,Q!==0?w=ot(Q):U!==0?w=ot(U):l||(l=p&~i,l!==0&&(w=ot(l)))),w===0?0:a!==0&&a!==w&&(a&M)===0&&(M=w&-w,l=a&-a,M>=l||M===32&&(l&4194048)!==0)?a:w}function G(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function tt(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function at(){var i=Za;return Za<<=1,(Za&62914560)===0&&(Za=4194304),i}function _t(i){for(var a=[],l=0;31>l;l++)a.push(i);return a}function yt(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function zt(i,a,l,p,w,M){var U=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var Q=i.entanglements,mt=i.expirationTimes,Bt=i.hiddenUpdates;for(l=U&~l;0<l;){var Yt=31-un(l),te=1<<Yt;Q[Yt]=0,mt[Yt]=-1;var Ut=Bt[Yt];if(Ut!==null)for(Bt[Yt]=null,Yt=0;Yt<Ut.length;Yt++){var qt=Ut[Yt];qt!==null&&(qt.lane&=-536870913)}l&=~te}p!==0&&ft(i,p,0),M!==0&&w===0&&i.tag!==0&&(i.suspendedLanes|=M&~(U&~a))}function ft(i,a,l){i.pendingLanes|=a,i.suspendedLanes&=~a;var p=31-un(a);i.entangledLanes|=a,i.entanglements[p]=i.entanglements[p]|1073741824|l&261930}function jt(i,a){var l=i.entangledLanes|=a;for(i=i.entanglements;l;){var p=31-un(l),w=1<<p;w&a|i[p]&a&&(i[p]|=a),l&=~w}}function Kt(i,a){var l=a&-a;return l=(l&42)!==0?1:Dt(l),(l&(i.suspendedLanes|a))!==0?0:l}function Dt(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Ft(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ze(){var i=ce.p;return i!==0?i:(i=window.event,i===void 0?32:Ka(i.type))}function Pe(i,a){var l=ce.p;try{return ce.p=i,a()}finally{ce.p=l}}var ri=Math.random().toString(36).slice(2),Le="__reactFiber$"+ri,Ye="__reactProps$"+ri,ii="__reactContainer$"+ri,nn="__reactEvents$"+ri,Tn="__reactListeners$"+ri,ui="__reactHandles$"+ri,Zi="__reactResources$"+ri,Yi="__reactMarker$"+ri;function Zn(i){delete i[Le],delete i[Ye],delete i[nn],delete i[Tn],delete i[ui]}function Mn(i){var a=i[Le];if(a)return a;for(var l=i.parentNode;l;){if(a=l[ii]||l[Le]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(i=Te(i);i!==null;){if(l=i[Le])return l;i=Te(i)}return a}i=l,l=i.parentNode}return null}function jn(i){if(i=i[Le]||i[ii]){var a=i.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return i}return null}function es(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(k(33))}function Ci(i){var a=i[Zi];return a||(a=i[Zi]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Vn(i){i[Yi]=!0}var Ol=new Set,ja={};function Kn(i,a){Hr(i,a),Hr(i+"Capture",a)}function Hr(i,a){for(ja[i]=a,i=0;i<a.length;i++)Ol.add(a[i])}var ga=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),La={},Xr={};function Os(i){return zi.call(Xr,i)?!0:zi.call(La,i)?!1:ga.test(i)?Xr[i]=!0:(La[i]=!0,!1)}function Ue(i,a,l){if(Os(a))if(l===null)i.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var p=a.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+l)}}function qi(i,a,l){if(l===null)i.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+l)}}function In(i,a,l,p){if(p===null)i.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(a,l,""+p)}}function bi(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Qs(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function is(i,a,l){var p=Object.getOwnPropertyDescriptor(i.constructor.prototype,a);if(!i.hasOwnProperty(a)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var w=p.get,M=p.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return w.call(this)},set:function(U){l=""+U,M.call(this,U)}}),Object.defineProperty(i,a,{enumerable:p.enumerable}),{getValue:function(){return l},setValue:function(U){l=""+U},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function ai(i){if(!i._valueTracker){var a=Qs(i)?"checked":"value";i._valueTracker=is(i,a,""+i[a])}}function Fi(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var l=a.getValue(),p="";return i&&(p=Qs(i)?i.checked?"true":"false":i.value),i=p,i!==l?(a.setValue(i),!0):!1}function Go(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var ho=/[\n"\\]/g;function Ki(i){return i.replace(ho,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function tr(i,a,l,p,w,M,U,Q){i.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?i.type=U:i.removeAttribute("type"),a!=null?U==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+bi(a)):i.value!==""+bi(a)&&(i.value=""+bi(a)):U!=="submit"&&U!=="reset"||i.removeAttribute("value"),a!=null?Bs(i,U,bi(a)):l!=null?Bs(i,U,bi(l)):p!=null&&i.removeAttribute("value"),w==null&&M!=null&&(i.defaultChecked=!!M),w!=null&&(i.checked=w&&typeof w!="function"&&typeof w!="symbol"),Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?i.name=""+bi(Q):i.removeAttribute("name")}function wi(i,a,l,p,w,M,U,Q){if(M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(i.type=M),a!=null||l!=null){if(!(M!=="submit"&&M!=="reset"||a!=null)){ai(i);return}l=l!=null?""+bi(l):"",a=a!=null?""+bi(a):l,Q||a===i.value||(i.value=a),i.defaultValue=a}p=p??w,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=Q?i.checked:!!p,i.defaultChecked=!!p,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(i.name=U),ai(i)}function Bs(i,a,l){a==="number"&&Go(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function an(i,a,l,p){if(i=i.options,a){a={};for(var w=0;w<l.length;w++)a["$"+l[w]]=!0;for(l=0;l<i.length;l++)w=a.hasOwnProperty("$"+i[l].value),i[l].selected!==w&&(i[l].selected=w),w&&p&&(i[l].defaultSelected=!0)}else{for(l=""+bi(l),a=null,w=0;w<i.length;w++){if(i[w].value===l){i[w].selected=!0,p&&(i[w].defaultSelected=!0);return}a!==null||i[w].disabled||(a=i[w])}a!==null&&(a.selected=!0)}}function ns(i,a,l){if(a!=null&&(a=""+bi(a),a!==i.value&&(i.value=a),l==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=l!=null?""+bi(l):""}function $r(i,a,l,p){if(a==null){if(p!=null){if(l!=null)throw Error(k(92));if($i(p)){if(1<p.length)throw Error(k(93));p=p[0]}l=p}l==null&&(l=""),a=l}l=bi(a),i.defaultValue=l,p=i.textContent,p===l&&p!==""&&p!==null&&(i.value=p),ai(i)}function as(i,a){if(a){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=a;return}}i.textContent=a}var fo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Er(i,a,l){var p=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?p?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":p?i.setProperty(a,l):typeof l!="number"||l===0||fo.has(a)?a==="float"?i.cssFloat=l:i[a]=(""+l).trim():i[a]=l+"px"}function Mr(i,a,l){if(a!=null&&typeof a!="object")throw Error(k(62));if(i=i.style,l!=null){for(var p in l)!l.hasOwnProperty(p)||a!=null&&a.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var w in a)p=a[w],a.hasOwnProperty(w)&&l[w]!==p&&Er(i,w,p)}else for(var M in a)a.hasOwnProperty(M)&&Er(i,M,a[M])}function Ho(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xo(i){return Nl.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function na(){}var Yr=null;function aa(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Wn=null,Ke=null;function Va(i){var a=jn(i);if(a&&(i=a.stateNode)){var l=i[Ye]||null;t:switch(i=a.stateNode,a.type){case"input":if(tr(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Ki(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var p=l[a];if(p!==i&&p.form===i.form){var w=p[Ye]||null;if(!w)throw Error(k(90));tr(p,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(a=0;a<l.length;a++)p=l[a],p.form===i.form&&Fi(p)}break t;case"textarea":ns(i,l.value,l.defaultValue);break t;case"select":a=l.value,a!=null&&an(i,!!l.multiple,a,!1)}}}var ji=!1;function Fl(i,a,l){if(ji)return i(a,l);ji=!0;try{var p=i(a);return p}finally{if(ji=!1,(Wn!==null||Ke!==null)&&(hh(),Wn&&(a=Wn,i=Ke,Ke=Wn=null,Va(a),i)))for(a=0;a<i.length;a++)Va(i[a])}}function vs(i,a){var l=i.stateNode;if(l===null)return null;var p=l[Ye]||null;if(p===null)return null;l=p[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break t;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(k(231,a,typeof l));return l}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$o=!1;if(Ns)try{var xs={};Object.defineProperty(xs,"passive",{get:function(){$o=!0}}),window.addEventListener("test",xs,xs),window.removeEventListener("test",xs,xs)}catch{$o=!1}var er=null,po=null,kn=null;function bs(){if(kn)return kn;var i,a=po,l=a.length,p,w="value"in er?er.value:er.textContent,M=w.length;for(i=0;i<l&&a[i]===w[i];i++);var U=l-i;for(p=1;p<=U&&a[l-p]===w[M-p];p++);return kn=w.slice(i,1<p?1-p:void 0)}function mo(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function Kr(){return!0}function Ul(){return!1}function fa(i){function a(l,p,w,M,U){this._reactName=l,this._targetInst=w,this.type=p,this.nativeEvent=M,this.target=U,this.currentTarget=null;for(var Q in i)i.hasOwnProperty(Q)&&(l=i[Q],this[Q]=l?l(M):M[Q]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Kr:Ul,this.isPropagationStopped=Ul,this}return It(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Kr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Kr)},persist:function(){},isPersistent:Kr}),a}var sa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zl=fa(sa),Wr=It({},sa,{view:0,detail:0}),hi=fa(Wr),ir,si,ws,fl=It({},Wr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bu,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ws&&(ws&&i.type==="mousemove"?(ir=i.screenX-ws.screenX,si=i.screenY-ws.screenY):si=ir=0,ws=i),ir)},movementY:function(i){return"movementY"in i?i.movementY:si}}),_o=fa(fl),yu=It({},fl,{dataTransfer:0}),Hu=fa(yu),Xu=It({},Wr,{relatedTarget:0}),jl=fa(Xu),vu=It({},sa,{animationName:0,elapsedTime:0,pseudoElement:0}),Vl=fa(vu),$u=It({},sa,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Fs=fa($u),Yu=It({},sa,{data:0}),zr=fa(Yu),Cr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ku={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function go(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=xu[i])?!!a[i]:!1}function bu(){return go}var dl=It({},Wr,{key:function(i){if(i.key){var a=Cr[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=mo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Ku[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bu,charCode:function(i){return i.type==="keypress"?mo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?mo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Wu=fa(dl),Oc=It({},fl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wu=fa(Oc),ql=It({},Wr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bu}),Ju=fa(ql),Gl=It({},sa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Su=fa(Gl),yo=It({},fl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ia=fa(yo),Tu=It({},sa,{newState:0,oldState:0}),vo=fa(Tu),qa=[9,13,27,32],xo=Ns&&"CompositionEvent"in window,Jr=null;Ns&&"documentMode"in document&&(Jr=document.documentMode);var bo=Ns&&"TextEvent"in window&&!Jr,Yo=Ns&&(!xo||Jr&&8<Jr&&11>=Jr),Hl=" ",zn=!1;function Qu(i,a){switch(i){case"keyup":return qa.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oi(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Lr=!1;function Si(i,a){switch(i){case"compositionend":return oi(a);case"keypress":return a.which!==32?null:(zn=!0,Hl);case"textInput":return i=a.data,i===Hl&&zn?null:i;default:return null}}function Di(i,a){if(Lr)return i==="compositionend"||!xo&&Qu(i,a)?(i=bs(),kn=po=er=null,Lr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Yo&&a.locale!=="ko"?null:a.data;default:return null}}var wo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ga(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!wo[i.type]:a==="textarea"}function Ko(i,a,l,p){Wn?Ke?Ke.push(p):Ke=[p]:Wn=p,a=yh(a,"onChange"),0<a.length&&(l=new Zl("onChange","change",null,l,p),i.push({event:l,listeners:a}))}var Ss=null,Us=null;function nr(i){Qh(i,0)}function ya(i){var a=es(i);if(Fi(a))return i}function So(i,a){if(i==="change")return a}var Xl=!1;if(Ns){var Ts;if(Ns){var As="oninput"in document;if(!As){var Wo=document.createElement("div");Wo.setAttribute("oninput","return;"),As=typeof Wo.oninput=="function"}Ts=As}else Ts=!1;Xl=Ts&&(!document.documentMode||9<document.documentMode)}function Qr(){Ss&&(Ss.detachEvent("onpropertychange",To),Us=Ss=null)}function To(i){if(i.propertyName==="value"&&ya(Us)){var a=[];Ko(a,Us,i,aa(i)),Fl(nr,a)}}function ss(i,a,l){i==="focusin"?(Qr(),Ss=a,Us=l,Ss.attachEvent("onpropertychange",To)):i==="focusout"&&Qr()}function $l(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ya(Us)}function Zs(i,a){if(i==="click")return ya(a)}function Jo(i,a){if(i==="input"||i==="change")return ya(a)}function ar(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var ra=typeof Object.is=="function"?Object.is:ar;function mi(i,a){if(ra(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var l=Object.keys(i),p=Object.keys(a);if(l.length!==p.length)return!1;for(p=0;p<l.length;p++){var w=l[p];if(!zi.call(a,w)||!ra(i[w],a[w]))return!1}return!0}function Ao(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function pl(i,a){var l=Ao(i);i=0;for(var p;l;){if(l.nodeType===3){if(p=i+l.textContent.length,i<=a&&p>=a)return{node:l,offset:a-i};i=p}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=Ao(l)}}function ml(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?ml(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function sr(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=Go(i.document);a instanceof i.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)i=a.contentWindow;else break;a=Go(i.document)}return a}function Ir(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var Eo=Ns&&"documentMode"in document&&11>=document.documentMode,Pr=null,_l=null,to=null,Dr=!1;function Mo(i,a,l){var p=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Dr||Pr==null||Pr!==Go(p)||(p=Pr,"selectionStart"in p&&Ir(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),to&&mi(to,p)||(to=p,p=yh(_l,"onSelect"),0<p.length&&(a=new Zl("onSelect","select",null,a,l),i.push({event:a,listeners:p}),a.target=Pr)))}function rs(i,a){var l={};return l[i.toLowerCase()]=a.toLowerCase(),l["Webkit"+i]="webkit"+a,l["Moz"+i]="moz"+a,l}var js={animationend:rs("Animation","AnimationEnd"),animationiteration:rs("Animation","AnimationIteration"),animationstart:rs("Animation","AnimationStart"),transitionrun:rs("Transition","TransitionRun"),transitionstart:rs("Transition","TransitionStart"),transitioncancel:rs("Transition","TransitionCancel"),transitionend:rs("Transition","TransitionEnd")},Qo={},zo={};Ns&&(zo=document.createElement("div").style,"AnimationEvent"in window||(delete js.animationend.animation,delete js.animationiteration.animation,delete js.animationstart.animation),"TransitionEvent"in window||delete js.transitionend.transition);function qn(i){if(Qo[i])return Qo[i];if(!js[i])return i;var a=js[i],l;for(l in a)if(a.hasOwnProperty(l)&&l in zo)return Qo[i]=a[l];return i}var eo=qn("animationend"),gl=qn("animationiteration"),Co=qn("animationstart"),Bc=qn("transitionrun"),Au=qn("transitionstart"),Yl=qn("transitioncancel"),io=qn("transitionend"),tl=new Map,Es="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Es.push("scrollEnd");function sn(i,a){tl.set(i,a),Kn(a,[i])}var Vs=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},os=[],Pa=0,_n=0;function Da(){for(var i=Pa,a=_n=Pa=0;a<i;){var l=os[a];os[a++]=null;var p=os[a];os[a++]=null;var w=os[a];os[a++]=null;var M=os[a];if(os[a++]=null,p!==null&&w!==null){var U=p.pending;U===null?w.next=w:(w.next=U.next,U.next=w),p.pending=w}M!==0&&kr(l,w,M)}}function Gn(i,a,l,p){os[Pa++]=i,os[Pa++]=a,os[Pa++]=l,os[Pa++]=p,_n|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Lo(i,a,l,p){return Gn(i,a,l,p),rr(i)}function Ms(i,a){return Gn(i,null,null,a),rr(i)}function kr(i,a,l){i.lanes|=l;var p=i.alternate;p!==null&&(p.lanes|=l);for(var w=!1,M=i.return;M!==null;)M.childLanes|=l,p=M.alternate,p!==null&&(p.childLanes|=l),M.tag===22&&(i=M.stateNode,i===null||i._visibility&1||(w=!0)),i=M,M=M.return;return i.tag===3?(M=i.stateNode,w&&a!==null&&(w=31-un(l),i=M.hiddenUpdates,p=i[w],p===null?i[w]=[a]:p.push(a),a.lane=l|536870912),M):null}function rr(i){if(50<fu)throw fu=0,ch=null,Error(k(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var ka={};function Eu(i,a,l,p){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function da(i,a,l,p){return new Eu(i,a,l,p)}function el(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ls(i,a){var l=i.alternate;return l===null?(l=da(i.tag,a,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=a,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,a=i.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function yl(i,a){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,a=l.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function Io(i,a,l,p,w,M){var U=0;if(p=i,typeof i=="function")el(i)&&(U=1);else if(typeof i=="string")U=Vr(i,l,ae.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case wn:return i=da(31,l,a,w),i.elementType=wn,i.lanes=M,i;case je:return us(l.children,w,M,a);case gi:U=8,w|=24;break;case on:return i=da(12,l,a,w|2),i.elementType=on,i.lanes=M,i;case Ni:return i=da(13,l,a,w),i.elementType=Ni,i.lanes=M,i;case Xi:return i=da(19,l,a,w),i.elementType=Xi,i.lanes=M,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case We:U=10;break t;case ea:U=9;break t;case Qi:U=11;break t;case Xe:U=14;break t;case Un:U=16,p=null;break t}U=29,l=Error(k(130,i===null?"null":typeof i,"")),p=null}return a=da(U,l,a,w),a.elementType=i,a.type=p,a.lanes=M,a}function us(i,a,l,p){return i=da(7,i,p,a),i.lanes=l,i}function Po(i,a,l){return i=da(6,i,null,a),i.lanes=l,i}function Do(i){var a=da(18,null,null,0);return a.stateNode=i,a}function vl(i,a,l){return a=da(4,i.children!==null?i.children:[],i.key,a),a.lanes=l,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var r=new WeakMap;function d(i,a){if(typeof i=="object"&&i!==null){var l=r.get(i);return l!==void 0?l:(a={value:i,source:a,stack:Sr(a)},r.set(i,a),a)}return{value:i,source:a,stack:Sr(a)}}var b=[],I=0,N=null,Y=0,lt=[],At=0,Ot=null,$t=1,pe="";function Re(i,a){b[I++]=Y,b[I++]=N,N=i,Y=a}function _i(i,a,l){lt[At++]=$t,lt[At++]=pe,lt[At++]=Ot,Ot=i;var p=$t;i=pe;var w=32-un(p)-1;p&=~(1<<w),l+=1;var M=32-un(a)+w;if(30<M){var U=w-w%5;M=(p&(1<<U)-1).toString(32),p>>=U,w-=U,$t=1<<32-un(a)+w|l<<w|p,pe=M+i}else $t=1<<M|l<<w|p,pe=i}function oa(i){i.return!==null&&(Re(i,1),_i(i,1,0))}function Rn(i){for(;i===N;)N=b[--I],b[I]=null,Y=b[--I],b[I]=null;for(;i===Ot;)Ot=lt[--At],lt[At]=null,pe=lt[--At],lt[At]=null,$t=lt[--At],lt[At]=null}function Ra(i,a){lt[At++]=$t,lt[At++]=pe,lt[At++]=Ot,$t=a.id,pe=a.overflow,Ot=i}var Li=null,ci=null,Qt=!1,qs=null,Ha=!1,xl=Error(k(519));function cs(i){var a=Error(k(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ko(d(a,i)),xl}function no(i){var a=i.stateNode,l=i.type,p=i.memoizedProps;switch(a[Le]=i,a[Ye]=p,l){case"dialog":Oi("cancel",a),Oi("close",a);break;case"iframe":case"object":case"embed":Oi("load",a);break;case"video":case"audio":for(l=0;l<Mc.length;l++)Oi(Mc[l],a);break;case"source":Oi("error",a);break;case"img":case"image":case"link":Oi("error",a),Oi("load",a);break;case"details":Oi("toggle",a);break;case"input":Oi("invalid",a),wi(a,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Oi("invalid",a);break;case"textarea":Oi("invalid",a),$r(a,p.value,p.defaultValue,p.children)}l=p.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||p.suppressHydrationWarning===!0||zc(a.textContent,l)?(p.popover!=null&&(Oi("beforetoggle",a),Oi("toggle",a)),p.onScroll!=null&&Oi("scroll",a),p.onScrollEnd!=null&&Oi("scrollend",a),p.onClick!=null&&(a.onclick=na),a=!0):a=!1,a||cs(i,!0)}function Cn(i){for(Li=i.return;Li;)switch(Li.tag){case 5:case 31:case 13:Ha=!1;return;case 27:case 3:Ha=!0;return;default:Li=Li.return}}function ei(i){if(i!==Li)return!1;if(!Qt)return Cn(i),Qt=!0,!1;var a=i.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||S(i.type,i.memoizedProps)),l=!l),l&&ci&&cs(i),Cn(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(k(317));ci=Ce(i)}else if(a===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(k(317));ci=Ce(i)}else a===27?(a=ci,W(i.type)?(i=de,de=null,ci=i):ci=a):ci=Li?le(i.stateNode.nextSibling):null;return!0}function Rr(){ci=Li=null,Qt=!1}function Mu(){var i=qs;return i!==null&&(Hs===null?Hs=i:Hs.push.apply(Hs,i),qs=null),i}function ko(i){qs===null?qs=[i]:qs.push(i)}var bl=dt(null),hs=null,or=null;function ao(i,a,l){Ht(bl,a._currentValue),a._currentValue=l}function so(i){i._currentValue=bl.current,St(bl)}function Nc(i,a,l){for(;i!==null;){var p=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,p!==null&&(p.childLanes|=a)):p!==null&&(p.childLanes&a)!==a&&(p.childLanes|=a),i===l)break;i=i.return}}function zu(i,a,l,p){var w=i.child;for(w!==null&&(w.return=i);w!==null;){var M=w.dependencies;if(M!==null){var U=w.child;M=M.firstContext;t:for(;M!==null;){var Q=M;M=w;for(var mt=0;mt<a.length;mt++)if(Q.context===a[mt]){M.lanes|=l,Q=M.alternate,Q!==null&&(Q.lanes|=l),Nc(M.return,l,i),p||(U=null);break t}M=Q.next}}else if(w.tag===18){if(U=w.return,U===null)throw Error(k(341));U.lanes|=l,M=U.alternate,M!==null&&(M.lanes|=l),Nc(U,l,i),U=null}else U=w.child;if(U!==null)U.return=w;else for(U=w;U!==null;){if(U===i){U=null;break}if(w=U.sibling,w!==null){w.return=U.return,U=w;break}U=U.return}w=U}}function Kl(i,a,l,p){i=null;for(var w=a,M=!1;w!==null;){if(!M){if((w.flags&524288)!==0)M=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var U=w.alternate;if(U===null)throw Error(k(387));if(U=U.memoizedProps,U!==null){var Q=w.type;ra(w.pendingProps.value,U.value)||(i!==null?i.push(Q):i=[Q])}}else if(w===Ve.current){if(U=w.alternate,U===null)throw Error(k(387));U.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(i!==null?i.push(Ic):i=[Ic])}w=w.return}i!==null&&zu(a,i,l,p),a.flags|=262144}function tc(i){for(i=i.firstContext;i!==null;){if(!ra(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function pa(i){hs=i,or=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function fi(i){return Cu(hs,i)}function Ro(i,a){return hs===null&&pa(i),Cu(i,a)}function Cu(i,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},or===null){if(i===null)throw Error(k(308));or=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else or=or.next=a;return l}var ec=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(l,p){i.push(p)}};this.abort=function(){a.aborted=!0,i.forEach(function(l){return l()})}},Ah=x.unstable_scheduleCallback,Lu=x.unstable_NormalPriority,Pn={$$typeof:We,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lr(){return{controller:new ec,data:new Map,refCount:0}}function Oo(i){i.refCount--,i.refCount===0&&Ah(Lu,function(){i.controller.abort()})}var Ee=null,Oe=0,Bo=0,No=null;function Fc(i,a){if(Ee===null){var l=Ee=[];Oe=0,Bo=Ec(),No={status:"pending",value:void 0,then:function(p){l.push(p)}}}return Oe++,a.then(_,_),a}function _(){if(--Oe===0&&Ee!==null){No!==null&&(No.status="fulfilled");var i=Ee;Ee=null,Bo=0,No=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function t(i,a){var l=[],p={status:"pending",value:null,reason:null,then:function(w){l.push(w)}};return i.then(function(){p.status="fulfilled",p.value=a;for(var w=0;w<l.length;w++)(0,l[w])(a)},function(w){for(p.status="rejected",p.reason=w,w=0;w<l.length;w++)(0,l[w])(void 0)}),p}var o=Vt.S;Vt.S=function(i,a){ep=ia(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Fc(i,a),o!==null&&o(i,a)};var c=dt(null);function h(){var i=c.current;return i!==null?i:En.pooledCache}function m(i,a){a===null?Ht(c,c.current):Ht(c,a.pool)}function T(){var i=h();return i===null?null:{parent:Pn._currentValue,pool:i}}var z=Error(k(460)),P=Error(k(474)),B=Error(k(542)),Z={then:function(){}};function j(i){return i=i.status,i==="fulfilled"||i==="rejected"}function $(i,a,l){switch(l=i[l],l===void 0?i.push(a):l!==a&&(a.then(na,na),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,ct(i),i;default:if(typeof a.status=="string")a.then(na,na);else{if(i=En,i!==null&&100<i.shellSuspendCounter)throw Error(k(482));i=a,i.status="pending",i.then(function(p){if(a.status==="pending"){var w=a;w.status="fulfilled",w.value=p}},function(p){if(a.status==="pending"){var w=a;w.status="rejected",w.reason=p}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,ct(i),i}throw et=a,z}}function J(i){try{var a=i._init;return a(i._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(et=l,z):l}}var et=null;function rt(){if(et===null)throw Error(k(459));var i=et;return et=null,i}function ct(i){if(i===z||i===B)throw Error(k(483))}var ht=null,pt=0;function nt(i){var a=pt;return pt+=1,ht===null&&(ht=[]),$(ht,i,a)}function vt(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function wt(i,a){throw a.$$typeof===Mt?Error(k(525)):(i=Object.prototype.toString.call(a),Error(k(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function Pt(i){function a(Lt,xt){if(i){var kt=Lt.deletions;kt===null?(Lt.deletions=[xt],Lt.flags|=16):kt.push(xt)}}function l(Lt,xt){if(!i)return null;for(;xt!==null;)a(Lt,xt),xt=xt.sibling;return null}function p(Lt){for(var xt=new Map;Lt!==null;)Lt.key!==null?xt.set(Lt.key,Lt):xt.set(Lt.index,Lt),Lt=Lt.sibling;return xt}function w(Lt,xt){return Lt=ls(Lt,xt),Lt.index=0,Lt.sibling=null,Lt}function M(Lt,xt,kt){return Lt.index=kt,i?(kt=Lt.alternate,kt!==null?(kt=kt.index,kt<xt?(Lt.flags|=67108866,xt):kt):(Lt.flags|=67108866,xt)):(Lt.flags|=1048576,xt)}function U(Lt){return i&&Lt.alternate===null&&(Lt.flags|=67108866),Lt}function Q(Lt,xt,kt,Jt){return xt===null||xt.tag!==6?(xt=Po(kt,Lt.mode,Jt),xt.return=Lt,xt):(xt=w(xt,kt),xt.return=Lt,xt)}function mt(Lt,xt,kt,Jt){var Je=kt.type;return Je===je?Yt(Lt,xt,kt.props.children,Jt,kt.key):xt!==null&&(xt.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===Un&&J(Je)===xt.type)?(xt=w(xt,kt.props),vt(xt,kt),xt.return=Lt,xt):(xt=Io(kt.type,kt.key,kt.props,null,Lt.mode,Jt),vt(xt,kt),xt.return=Lt,xt)}function Bt(Lt,xt,kt,Jt){return xt===null||xt.tag!==4||xt.stateNode.containerInfo!==kt.containerInfo||xt.stateNode.implementation!==kt.implementation?(xt=vl(kt,Lt.mode,Jt),xt.return=Lt,xt):(xt=w(xt,kt.children||[]),xt.return=Lt,xt)}function Yt(Lt,xt,kt,Jt,Je){return xt===null||xt.tag!==7?(xt=us(kt,Lt.mode,Jt,Je),xt.return=Lt,xt):(xt=w(xt,kt),xt.return=Lt,xt)}function te(Lt,xt,kt){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return xt=Po(""+xt,Lt.mode,kt),xt.return=Lt,xt;if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case Ui:return kt=Io(xt.type,xt.key,xt.props,null,Lt.mode,kt),vt(kt,xt),kt.return=Lt,kt;case Bi:return xt=vl(xt,Lt.mode,kt),xt.return=Lt,xt;case Un:return xt=J(xt),te(Lt,xt,kt)}if($i(xt)||Ei(xt))return xt=us(xt,Lt.mode,kt,null),xt.return=Lt,xt;if(typeof xt.then=="function")return te(Lt,nt(xt),kt);if(xt.$$typeof===We)return te(Lt,Ro(Lt,xt),kt);wt(Lt,xt)}return null}function Ut(Lt,xt,kt,Jt){var Je=xt!==null?xt.key:null;if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return Je!==null?null:Q(Lt,xt,""+kt,Jt);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case Ui:return kt.key===Je?mt(Lt,xt,kt,Jt):null;case Bi:return kt.key===Je?Bt(Lt,xt,kt,Jt):null;case Un:return kt=J(kt),Ut(Lt,xt,kt,Jt)}if($i(kt)||Ei(kt))return Je!==null?null:Yt(Lt,xt,kt,Jt,null);if(typeof kt.then=="function")return Ut(Lt,xt,nt(kt),Jt);if(kt.$$typeof===We)return Ut(Lt,xt,Ro(Lt,kt),Jt);wt(Lt,kt)}return null}function qt(Lt,xt,kt,Jt,Je){if(typeof Jt=="string"&&Jt!==""||typeof Jt=="number"||typeof Jt=="bigint")return Lt=Lt.get(kt)||null,Q(xt,Lt,""+Jt,Je);if(typeof Jt=="object"&&Jt!==null){switch(Jt.$$typeof){case Ui:return Lt=Lt.get(Jt.key===null?kt:Jt.key)||null,mt(xt,Lt,Jt,Je);case Bi:return Lt=Lt.get(Jt.key===null?kt:Jt.key)||null,Bt(xt,Lt,Jt,Je);case Un:return Jt=J(Jt),qt(Lt,xt,kt,Jt,Je)}if($i(Jt)||Ei(Jt))return Lt=Lt.get(kt)||null,Yt(xt,Lt,Jt,Je,null);if(typeof Jt.then=="function")return qt(Lt,xt,kt,nt(Jt),Je);if(Jt.$$typeof===We)return qt(Lt,xt,kt,Ro(xt,Jt),Je);wt(xt,Jt)}return null}function De(Lt,xt,kt,Jt){for(var Je=null,pn=null,Ne=xt,Ii=xt=0,Hi=null;Ne!==null&&Ii<kt.length;Ii++){Ne.index>Ii?(Hi=Ne,Ne=null):Hi=Ne.sibling;var mn=Ut(Lt,Ne,kt[Ii],Jt);if(mn===null){Ne===null&&(Ne=Hi);break}i&&Ne&&mn.alternate===null&&a(Lt,Ne),xt=M(mn,xt,Ii),pn===null?Je=mn:pn.sibling=mn,pn=mn,Ne=Hi}if(Ii===kt.length)return l(Lt,Ne),Qt&&Re(Lt,Ii),Je;if(Ne===null){for(;Ii<kt.length;Ii++)Ne=te(Lt,kt[Ii],Jt),Ne!==null&&(xt=M(Ne,xt,Ii),pn===null?Je=Ne:pn.sibling=Ne,pn=Ne);return Qt&&Re(Lt,Ii),Je}for(Ne=p(Ne);Ii<kt.length;Ii++)Hi=qt(Ne,Lt,Ii,kt[Ii],Jt),Hi!==null&&(i&&Hi.alternate!==null&&Ne.delete(Hi.key===null?Ii:Hi.key),xt=M(Hi,xt,Ii),pn===null?Je=Hi:pn.sibling=Hi,pn=Hi);return i&&Ne.forEach(function(Dc){return a(Lt,Dc)}),Qt&&Re(Lt,Ii),Je}function ni(Lt,xt,kt,Jt){if(kt==null)throw Error(k(151));for(var Je=null,pn=null,Ne=xt,Ii=xt=0,Hi=null,mn=kt.next();Ne!==null&&!mn.done;Ii++,mn=kt.next()){Ne.index>Ii?(Hi=Ne,Ne=null):Hi=Ne.sibling;var Dc=Ut(Lt,Ne,mn.value,Jt);if(Dc===null){Ne===null&&(Ne=Hi);break}i&&Ne&&Dc.alternate===null&&a(Lt,Ne),xt=M(Dc,xt,Ii),pn===null?Je=Dc:pn.sibling=Dc,pn=Dc,Ne=Hi}if(mn.done)return l(Lt,Ne),Qt&&Re(Lt,Ii),Je;if(Ne===null){for(;!mn.done;Ii++,mn=kt.next())mn=te(Lt,mn.value,Jt),mn!==null&&(xt=M(mn,xt,Ii),pn===null?Je=mn:pn.sibling=mn,pn=mn);return Qt&&Re(Lt,Ii),Je}for(Ne=p(Ne);!mn.done;Ii++,mn=kt.next())mn=qt(Ne,Lt,Ii,mn.value,Jt),mn!==null&&(i&&mn.alternate!==null&&Ne.delete(mn.key===null?Ii:mn.key),xt=M(mn,xt,Ii),pn===null?Je=mn:pn.sibling=mn,pn=mn);return i&&Ne.forEach(function(I_){return a(Lt,I_)}),Qt&&Re(Lt,Ii),Je}function Dn(Lt,xt,kt,Jt){if(typeof kt=="object"&&kt!==null&&kt.type===je&&kt.key===null&&(kt=kt.props.children),typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case Ui:t:{for(var Je=kt.key;xt!==null;){if(xt.key===Je){if(Je=kt.type,Je===je){if(xt.tag===7){l(Lt,xt.sibling),Jt=w(xt,kt.props.children),Jt.return=Lt,Lt=Jt;break t}}else if(xt.elementType===Je||typeof Je=="object"&&Je!==null&&Je.$$typeof===Un&&J(Je)===xt.type){l(Lt,xt.sibling),Jt=w(xt,kt.props),vt(Jt,kt),Jt.return=Lt,Lt=Jt;break t}l(Lt,xt);break}else a(Lt,xt);xt=xt.sibling}kt.type===je?(Jt=us(kt.props.children,Lt.mode,Jt,kt.key),Jt.return=Lt,Lt=Jt):(Jt=Io(kt.type,kt.key,kt.props,null,Lt.mode,Jt),vt(Jt,kt),Jt.return=Lt,Lt=Jt)}return U(Lt);case Bi:t:{for(Je=kt.key;xt!==null;){if(xt.key===Je)if(xt.tag===4&&xt.stateNode.containerInfo===kt.containerInfo&&xt.stateNode.implementation===kt.implementation){l(Lt,xt.sibling),Jt=w(xt,kt.children||[]),Jt.return=Lt,Lt=Jt;break t}else{l(Lt,xt);break}else a(Lt,xt);xt=xt.sibling}Jt=vl(kt,Lt.mode,Jt),Jt.return=Lt,Lt=Jt}return U(Lt);case Un:return kt=J(kt),Dn(Lt,xt,kt,Jt)}if($i(kt))return De(Lt,xt,kt,Jt);if(Ei(kt)){if(Je=Ei(kt),typeof Je!="function")throw Error(k(150));return kt=Je.call(kt),ni(Lt,xt,kt,Jt)}if(typeof kt.then=="function")return Dn(Lt,xt,nt(kt),Jt);if(kt.$$typeof===We)return Dn(Lt,xt,Ro(Lt,kt),Jt);wt(Lt,kt)}return typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint"?(kt=""+kt,xt!==null&&xt.tag===6?(l(Lt,xt.sibling),Jt=w(xt,kt),Jt.return=Lt,Lt=Jt):(l(Lt,xt),Jt=Po(kt,Lt.mode,Jt),Jt.return=Lt,Lt=Jt),U(Lt)):l(Lt,xt)}return function(Lt,xt,kt,Jt){try{pt=0;var Je=Dn(Lt,xt,kt,Jt);return ht=null,Je}catch(Ne){if(Ne===z||Ne===B)throw Ne;var pn=da(29,Ne,null,Lt.mode);return pn.lanes=Jt,pn.return=Lt,pn}finally{}}}var Xt=Pt(!0),ne=Pt(!1),ue=!1;function ve(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function he(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function se(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function we(i,a,l){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(en&2)!==0){var w=p.pending;return w===null?a.next=a:(a.next=w.next,w.next=a),p.pending=a,a=rr(i),kr(i,null,l),a}return Gn(i,p,a,l),rr(i)}function qe(i,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var p=a.lanes;p&=i.pendingLanes,l|=p,a.lanes=l,jt(i,l)}}function fe(i,a){var l=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,l===p)){var w=null,M=null;if(l=l.firstBaseUpdate,l!==null){do{var U={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};M===null?w=M=U:M=M.next=U,l=l.next}while(l!==null);M===null?w=M=a:M=M.next=a}else w=M=a;l={baseState:p.baseState,firstBaseUpdate:w,lastBaseUpdate:M,shared:p.shared,callbacks:p.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=a:i.next=a,l.lastBaseUpdate=a}var _e=!1;function Ze(){if(_e){var i=No;if(i!==null)throw i}}function tn(i,a,l,p){_e=!1;var w=i.updateQueue;ue=!1;var M=w.firstBaseUpdate,U=w.lastBaseUpdate,Q=w.shared.pending;if(Q!==null){w.shared.pending=null;var mt=Q,Bt=mt.next;mt.next=null,U===null?M=Bt:U.next=Bt,U=mt;var Yt=i.alternate;Yt!==null&&(Yt=Yt.updateQueue,Q=Yt.lastBaseUpdate,Q!==U&&(Q===null?Yt.firstBaseUpdate=Bt:Q.next=Bt,Yt.lastBaseUpdate=mt))}if(M!==null){var te=w.baseState;U=0,Yt=Bt=mt=null,Q=M;do{var Ut=Q.lane&-536870913,qt=Ut!==Q.lane;if(qt?(ki&Ut)===Ut:(p&Ut)===Ut){Ut!==0&&Ut===Bo&&(_e=!0),Yt!==null&&(Yt=Yt.next={lane:0,tag:Q.tag,payload:Q.payload,callback:null,next:null});t:{var De=i,ni=Q;Ut=a;var Dn=l;switch(ni.tag){case 1:if(De=ni.payload,typeof De=="function"){te=De.call(Dn,te,Ut);break t}te=De;break t;case 3:De.flags=De.flags&-65537|128;case 0:if(De=ni.payload,Ut=typeof De=="function"?De.call(Dn,te,Ut):De,Ut==null)break t;te=It({},te,Ut);break t;case 2:ue=!0}}Ut=Q.callback,Ut!==null&&(i.flags|=64,qt&&(i.flags|=8192),qt=w.callbacks,qt===null?w.callbacks=[Ut]:qt.push(Ut))}else qt={lane:Ut,tag:Q.tag,payload:Q.payload,callback:Q.callback,next:null},Yt===null?(Bt=Yt=qt,mt=te):Yt=Yt.next=qt,U|=Ut;if(Q=Q.next,Q===null){if(Q=w.shared.pending,Q===null)break;qt=Q,Q=qt.next,qt.next=null,w.lastBaseUpdate=qt,w.shared.pending=null}}while(!0);Yt===null&&(mt=te),w.baseState=mt,w.firstBaseUpdate=Bt,w.lastBaseUpdate=Yt,M===null&&(w.shared.lanes=0),hu|=U,i.lanes=U,i.memoizedState=te}}function li(i,a){if(typeof i!="function")throw Error(k(191,i));i.call(a)}function yi(i,a){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)li(l[i],a)}var Wi=dt(null),ma=dt(0);function ur(i,a){i=uo,Ht(ma,i),Ht(Wi,a),uo=i|a.baseLanes}function cn(){Ht(ma,uo),Ht(Wi,Wi.current)}function Xa(){uo=ma.current,St(Wi),St(ma)}var gn=dt(null),yn=null;function Hn(i){var a=i.alternate;Ht(Gi,Gi.current&1),Ht(gn,i),yn===null&&(a===null||Wi.current!==null||a.memoizedState!==null)&&(yn=i)}function cr(i){Ht(Gi,Gi.current),Ht(gn,i),yn===null&&(yn=i)}function wl(i){i.tag===22?(Ht(Gi,Gi.current),Ht(gn,i),yn===null&&(yn=i)):Or()}function Or(){Ht(Gi,Gi.current),Ht(gn,gn.current)}function va(i){St(gn),yn===i&&(yn=null),St(Gi)}var Gi=dt(0);function Sl(i){for(var a=i;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||ee(l)||ye(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Br=0,$e=null,Ti=null,vn=null,zs=!1,Xn=!1,$n=!1,$a=0,di=0,hr=null,Wl=0;function xn(){throw Error(k(321))}function ic(i,a){if(a===null)return!1;for(var l=0;l<a.length&&l<i.length;l++)if(!ra(i[l],a[l]))return!1;return!0}function Uc(i,a,l,p,w,M){return Br=M,$e=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Vt.H=i===null||i.memoizedState===null?Pd:Ef,$n=!1,M=l(p,w),$n=!1,Xn&&(M=Fo(a,l,p,w)),Zc(i),M}function Zc(i){Vt.H=$c;var a=Ti!==null&&Ti.next!==null;if(Br=0,vn=Ti=$e=null,zs=!1,di=0,hr=null,a)throw Error(k(300));i===null||Qn||(i=i.dependencies,i!==null&&tc(i)&&(Qn=!0))}function Fo(i,a,l,p){$e=i;var w=0;do{if(Xn&&(hr=null),di=0,Xn=!1,25<=w)throw Error(k(301));if(w+=1,vn=Ti=null,i.updateQueue!=null){var M=i.updateQueue;M.lastEffect=null,M.events=null,M.stores=null,M.memoCache!=null&&(M.memoCache.index=0)}Vt.H=Mf,M=a(l,p)}while(Xn);return M}function Eh(){var i=Vt.H,a=i.useState()[0];return a=typeof a.then=="function"?tu(a):a,i=i.useState()[0],(Ti!==null?Ti.memoizedState:null)!==i&&($e.flags|=1024),a}function Jl(){var i=$a!==0;return $a=0,i}function Tl(i,a,l){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~l}function Ql(i){if(zs){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}zs=!1}Br=0,vn=Ti=$e=null,Xn=!1,di=$a=0,hr=null}function xa(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?$e.memoizedState=vn=i:vn=vn.next=i,vn}function An(){if(Ti===null){var i=$e.alternate;i=i!==null?i.memoizedState:null}else i=Ti.next;var a=vn===null?$e.memoizedState:vn.next;if(a!==null)vn=a,Ti=i;else{if(i===null)throw $e.alternate===null?Error(k(467)):Error(k(310));Ti=i,i={memoizedState:Ti.memoizedState,baseState:Ti.baseState,baseQueue:Ti.baseQueue,queue:Ti.queue,next:null},vn===null?$e.memoizedState=vn=i:vn=vn.next=i}return vn}function il(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tu(i){var a=di;return di+=1,hr===null&&(hr=[]),i=$(hr,i,a),a=$e,(vn===null?a.memoizedState:vn.next)===null&&(a=a.alternate,Vt.H=a===null||a.memoizedState===null?Pd:Ef),i}function jc(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return tu(i);if(i.$$typeof===We)return fi(i)}throw Error(k(438,String(i)))}function Mh(i){var a=null,l=$e.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var p=$e.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(a={data:p.data.map(function(w){return w.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=il(),$e.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(i),p=0;p<i;p++)l[p]=ca;return a.index++,l}function Al(i,a){return typeof a=="function"?a(i):a}function nc(i){var a=An();return Iu(a,Ti,i)}function Iu(i,a,l){var p=i.queue;if(p===null)throw Error(k(311));p.lastRenderedReducer=l;var w=i.baseQueue,M=p.pending;if(M!==null){if(w!==null){var U=w.next;w.next=M.next,M.next=U}a.baseQueue=w=M,p.pending=null}if(M=i.baseState,w===null)i.memoizedState=M;else{a=w.next;var Q=U=null,mt=null,Bt=a,Yt=!1;do{var te=Bt.lane&-536870913;if(te!==Bt.lane?(ki&te)===te:(Br&te)===te){var Ut=Bt.revertLane;if(Ut===0)mt!==null&&(mt=mt.next={lane:0,revertLane:0,gesture:null,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null}),te===Bo&&(Yt=!0);else if((Br&Ut)===Ut){Bt=Bt.next,Ut===Bo&&(Yt=!0);continue}else te={lane:0,revertLane:Bt.revertLane,gesture:null,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null},mt===null?(Q=mt=te,U=M):mt=mt.next=te,$e.lanes|=Ut,hu|=Ut;te=Bt.action,$n&&l(M,te),M=Bt.hasEagerState?Bt.eagerState:l(M,te)}else Ut={lane:te,revertLane:Bt.revertLane,gesture:Bt.gesture,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null},mt===null?(Q=mt=Ut,U=M):mt=mt.next=Ut,$e.lanes|=te,hu|=te;Bt=Bt.next}while(Bt!==null&&Bt!==a);if(mt===null?U=M:mt.next=Q,!ra(M,i.memoizedState)&&(Qn=!0,Yt&&(l=No,l!==null)))throw l;i.memoizedState=M,i.baseState=U,i.baseQueue=mt,p.lastRenderedState=M}return w===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function eu(i){var a=An(),l=a.queue;if(l===null)throw Error(k(311));l.lastRenderedReducer=i;var p=l.dispatch,w=l.pending,M=a.memoizedState;if(w!==null){l.pending=null;var U=w=w.next;do M=i(M,U.action),U=U.next;while(U!==w);ra(M,a.memoizedState)||(Qn=!0),a.memoizedState=M,a.baseQueue===null&&(a.baseState=M),l.lastRenderedState=M}return[M,p]}function nl(i,a,l){var p=$e,w=An(),M=Qt;if(M){if(l===void 0)throw Error(k(407));l=l()}else l=a();var U=!ra((Ti||w).memoizedState,l);if(U&&(w.memoizedState=l,Qn=!0),w=w.queue,Pu(cf.bind(null,p,w,i),[i]),w.getSnapshot!==a||U||vn!==null&&vn.memoizedState.tag&1){if(p.flags|=2048,su(9,{destroy:void 0},El.bind(null,p,w,l,a),null),En===null)throw Error(k(349));M||(Br&127)!==0||ro(p,a,l)}return l}function ro(i,a,l){i.flags|=16384,i={getSnapshot:a,value:l},a=$e.updateQueue,a===null?(a=il(),$e.updateQueue=a,a.stores=[i]):(l=a.stores,l===null?a.stores=[i]:l.push(i))}function El(i,a,l,p){a.value=l,a.getSnapshot=p,iu(a)&&Td(i)}function cf(i,a,l){return l(function(){iu(a)&&Td(i)})}function iu(i){var a=i.getSnapshot;i=i.value;try{var l=a();return!ra(i,l)}catch{return!0}}function Td(i){var a=Ms(i,2);a!==null&&Cs(a,i,2)}function zh(i){var a=xa();if(typeof i=="function"){var l=i;if(i=l(),$n){Ie(!0);try{l()}finally{Ie(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Al,lastRenderedState:i},a}function Jn(i,a,l,p){return i.baseState=l,Iu(i,Ti,typeof p=="function"?p:Al)}function hf(i,a,l,p,w){if(kh(i))throw Error(k(485));if(i=a.action,i!==null){var M={payload:w,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){M.listeners.push(U)}};Vt.T!==null?l(!0):M.isTransition=!1,p(M),l=a.pending,l===null?(M.next=a.pending=M,ff(a,M)):(M.next=l.next,a.pending=l.next=M)}}function ff(i,a){var l=a.action,p=a.payload,w=i.state;if(a.isTransition){var M=Vt.T,U={};Vt.T=U;try{var Q=l(w,p),mt=Vt.S;mt!==null&&mt(U,Q),nu(i,a,Q)}catch(Bt){ac(i,a,Bt)}finally{M!==null&&U.types!==null&&(M.types=U.types),Vt.T=M}}else try{M=l(w,p),nu(i,a,M)}catch(Bt){ac(i,a,Bt)}}function nu(i,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(p){au(i,a,p)},function(p){return ac(i,a,p)}):au(i,a,l)}function au(i,a,l){a.status="fulfilled",a.value=l,Ch(a),i.state=l,a=i.pending,a!==null&&(l=a.next,l===a?i.pending=null:(l=l.next,a.next=l,ff(i,l)))}function ac(i,a,l){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do a.status="rejected",a.reason=l,Ch(a),a=a.next;while(a!==p)}i.action=null}function Ch(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function df(i,a){return a}function Ad(i,a){if(Qt){var l=En.formState;if(l!==null){t:{var p=$e;if(Qt){if(ci){e:{for(var w=ci,M=Ha;w.nodeType!==8;){if(!M){w=null;break e}if(w=le(w.nextSibling),w===null){w=null;break e}}M=w.data,w=M==="F!"||M==="F"?w:null}if(w){ci=le(w.nextSibling),p=w.data==="F!";break t}}cs(p)}p=!1}p&&(a=l[0])}}return l=xa(),l.memoizedState=l.baseState=a,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:df,lastRenderedState:a},l.queue=p,l=fr.bind(null,$e,p),p.dispatch=l,p=zh(!1),M=Xc.bind(null,$e,!1,p.queue),p=xa(),w={state:a,dispatch:null,action:i,pending:null},p.queue=w,l=hf.bind(null,$e,w,M,l),w.dispatch=l,p.memoizedState=i,[a,l,!1]}function pf(i){var a=An();return Ed(a,Ti,i)}function Ed(i,a,l){if(a=Iu(i,a,df)[0],i=nc(Al)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var p=tu(a)}catch(U){throw U===z?B:U}else p=a;a=An();var w=a.queue,M=w.dispatch;return l!==a.memoizedState&&($e.flags|=2048,su(9,{destroy:void 0},mf.bind(null,w,l),null)),[p,M,i]}function mf(i,a){i.action=a}function Md(i){var a=An(),l=Ti;if(l!==null)return Ed(a,l,i);An(),a=a.memoizedState,l=An();var p=l.queue.dispatch;return l.memoizedState=i,[a,p,!1]}function su(i,a,l,p){return i={tag:i,create:l,deps:p,inst:a,next:null},a=$e.updateQueue,a===null&&(a=il(),$e.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=i.next=i:(p=l.next,l.next=i,i.next=p,a.lastEffect=i),i}function _f(){return An().memoizedState}function Vc(i,a,l,p){var w=xa();$e.flags|=i,w.memoizedState=su(1|a,{destroy:void 0},l,p===void 0?null:p)}function Ml(i,a,l,p){var w=An();p=p===void 0?null:p;var M=w.memoizedState.inst;Ti!==null&&p!==null&&ic(p,Ti.memoizedState.deps)?w.memoizedState=su(a,M,l,p):($e.flags|=i,w.memoizedState=su(1|a,M,l,p))}function zd(i,a){Vc(8390656,8,i,a)}function Pu(i,a){Ml(2048,8,i,a)}function Lh(i){$e.flags|=4;var a=$e.updateQueue;if(a===null)a=il(),$e.updateQueue=a,a.events=[i];else{var l=a.events;l===null?a.events=[i]:l.push(i)}}function qc(i){var a=An().memoizedState;return Lh({ref:a,nextImpl:i}),function(){if((en&2)!==0)throw Error(k(440));return a.impl.apply(void 0,arguments)}}function gf(i,a){return Ml(4,2,i,a)}function yf(i,a){return Ml(4,4,i,a)}function Cd(i,a){if(typeof a=="function"){i=i();var l=a(i);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function fs(i,a,l){l=l!=null?l.concat([i]):null,Ml(4,4,Cd.bind(null,a,i),l)}function ru(){}function Ih(i,a){var l=An();a=a===void 0?null:a;var p=l.memoizedState;return a!==null&&ic(a,p[1])?p[0]:(l.memoizedState=[i,a],i)}function vf(i,a){var l=An();a=a===void 0?null:a;var p=l.memoizedState;if(a!==null&&ic(a,p[1]))return p[0];if(p=i(),$n){Ie(!0);try{i()}finally{Ie(!1)}}return l.memoizedState=[p,a],p}function Du(i,a,l){return l===void 0||(Br&1073741824)!==0&&(ki&261930)===0?i.memoizedState=a:(i.memoizedState=l,i=Gh(),$e.lanes|=i,hu|=i,l)}function Ld(i,a,l,p){return ra(l,a)?l:Wi.current!==null?(i=Du(i,l,p),ra(i,a)||(Qn=!0),i):(Br&42)===0||(Br&1073741824)!==0&&(ki&261930)===0?(Qn=!0,i.memoizedState=l):(i=Gh(),$e.lanes|=i,hu|=i,a)}function Gc(i,a,l,p,w){var M=ce.p;ce.p=M!==0&&8>M?M:8;var U=Vt.T,Q={};Vt.T=Q,Xc(i,!1,a,l);try{var mt=w(),Bt=Vt.S;if(Bt!==null&&Bt(Q,mt),mt!==null&&typeof mt=="object"&&typeof mt.then=="function"){var Yt=t(mt,p);sc(i,a,Yt,Ur(i))}else sc(i,a,p,Ur(i))}catch(te){sc(i,a,{then:function(){},status:"rejected",reason:te},Ur())}finally{ce.p=M,U!==null&&Q.types!==null&&(U.types=Q.types),Vt.T=U}}function Fp(){}function Ph(i,a,l,p){if(i.tag!==5)throw Error(k(476));var w=xf(i).queue;Gc(i,w,a,re,l===null?Fp:function(){return bf(i),l(p)})}function xf(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Al,lastRenderedState:re},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Al,lastRenderedState:l},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function bf(i){var a=xf(i);a.next===null&&(a=i.alternate.memoizedState),sc(i,a.next.queue,{},Ur())}function wf(){return fi(Ic)}function Dh(){return An().memoizedState}function Sf(){return An().memoizedState}function Tf(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var l=Ur();i=se(l);var p=we(a,i,l);p!==null&&(Cs(p,a,l),qe(p,a,l)),a={cache:lr()},i.payload=a;return}a=a.return}}function Hc(i,a,l){var p=Ur();l={lane:p,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},kh(i)?Af(a,l):(l=Lo(i,a,l,p),l!==null&&(Cs(l,i,p),Id(l,a,p)))}function fr(i,a,l){var p=Ur();sc(i,a,l,p)}function sc(i,a,l,p){var w={lane:p,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(kh(i))Af(a,w);else{var M=i.alternate;if(i.lanes===0&&(M===null||M.lanes===0)&&(M=a.lastRenderedReducer,M!==null))try{var U=a.lastRenderedState,Q=M(U,l);if(w.hasEagerState=!0,w.eagerState=Q,ra(Q,U))return Gn(i,a,w,0),En===null&&Da(),!1}catch{}finally{}if(l=Lo(i,a,w,p),l!==null)return Cs(l,i,p),Id(l,a,p),!0}return!1}function Xc(i,a,l,p){if(p={lane:2,revertLane:Ec(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},kh(i)){if(a)throw Error(k(479))}else a=Lo(i,l,p,2),a!==null&&Cs(a,i,2)}function kh(i){var a=i.alternate;return i===$e||a!==null&&a===$e}function Af(i,a){Xn=zs=!0;var l=i.pending;l===null?a.next=a:(a.next=l.next,l.next=a),i.pending=a}function Id(i,a,l){if((l&4194048)!==0){var p=a.lanes;p&=i.pendingLanes,l|=p,a.lanes=l,jt(i,l)}}var $c={readContext:fi,use:jc,useCallback:xn,useContext:xn,useEffect:xn,useImperativeHandle:xn,useLayoutEffect:xn,useInsertionEffect:xn,useMemo:xn,useReducer:xn,useRef:xn,useState:xn,useDebugValue:xn,useDeferredValue:xn,useTransition:xn,useSyncExternalStore:xn,useId:xn,useHostTransitionStatus:xn,useFormState:xn,useActionState:xn,useOptimistic:xn,useMemoCache:xn,useCacheRefresh:xn};$c.useEffectEvent=xn;var Pd={readContext:fi,use:jc,useCallback:function(i,a){return xa().memoizedState=[i,a===void 0?null:a],i},useContext:fi,useEffect:zd,useImperativeHandle:function(i,a,l){l=l!=null?l.concat([i]):null,Vc(4194308,4,Cd.bind(null,a,i),l)},useLayoutEffect:function(i,a){return Vc(4194308,4,i,a)},useInsertionEffect:function(i,a){Vc(4,2,i,a)},useMemo:function(i,a){var l=xa();a=a===void 0?null:a;var p=i();if($n){Ie(!0);try{i()}finally{Ie(!1)}}return l.memoizedState=[p,a],p},useReducer:function(i,a,l){var p=xa();if(l!==void 0){var w=l(a);if($n){Ie(!0);try{l(a)}finally{Ie(!1)}}}else w=a;return p.memoizedState=p.baseState=w,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:w},p.queue=i,i=i.dispatch=Hc.bind(null,$e,i),[p.memoizedState,i]},useRef:function(i){var a=xa();return i={current:i},a.memoizedState=i},useState:function(i){i=zh(i);var a=i.queue,l=fr.bind(null,$e,a);return a.dispatch=l,[i.memoizedState,l]},useDebugValue:ru,useDeferredValue:function(i,a){var l=xa();return Du(l,i,a)},useTransition:function(){var i=zh(!1);return i=Gc.bind(null,$e,i.queue,!0,!1),xa().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,l){var p=$e,w=xa();if(Qt){if(l===void 0)throw Error(k(407));l=l()}else{if(l=a(),En===null)throw Error(k(349));(ki&127)!==0||ro(p,a,l)}w.memoizedState=l;var M={value:l,getSnapshot:a};return w.queue=M,zd(cf.bind(null,p,M,i),[i]),p.flags|=2048,su(9,{destroy:void 0},El.bind(null,p,M,l,a),null),l},useId:function(){var i=xa(),a=En.identifierPrefix;if(Qt){var l=pe,p=$t;l=(p&~(1<<32-un(p)-1)).toString(32)+l,a="_"+a+"R_"+l,l=$a++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=Wl++,a="_"+a+"r_"+l.toString(32)+"_";return i.memoizedState=a},useHostTransitionStatus:wf,useFormState:Ad,useActionState:Ad,useOptimistic:function(i){var a=xa();a.memoizedState=a.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Xc.bind(null,$e,!0,l),l.dispatch=a,[i,a]},useMemoCache:Mh,useCacheRefresh:function(){return xa().memoizedState=Tf.bind(null,$e)},useEffectEvent:function(i){var a=xa(),l={impl:i};return a.memoizedState=l,function(){if((en&2)!==0)throw Error(k(440));return l.impl.apply(void 0,arguments)}}},Ef={readContext:fi,use:jc,useCallback:Ih,useContext:fi,useEffect:Pu,useImperativeHandle:fs,useInsertionEffect:gf,useLayoutEffect:yf,useMemo:vf,useReducer:nc,useRef:_f,useState:function(){return nc(Al)},useDebugValue:ru,useDeferredValue:function(i,a){var l=An();return Ld(l,Ti.memoizedState,i,a)},useTransition:function(){var i=nc(Al)[0],a=An().memoizedState;return[typeof i=="boolean"?i:tu(i),a]},useSyncExternalStore:nl,useId:Dh,useHostTransitionStatus:wf,useFormState:pf,useActionState:pf,useOptimistic:function(i,a){var l=An();return Jn(l,Ti,i,a)},useMemoCache:Mh,useCacheRefresh:Sf};Ef.useEffectEvent=qc;var Mf={readContext:fi,use:jc,useCallback:Ih,useContext:fi,useEffect:Pu,useImperativeHandle:fs,useInsertionEffect:gf,useLayoutEffect:yf,useMemo:vf,useReducer:eu,useRef:_f,useState:function(){return eu(Al)},useDebugValue:ru,useDeferredValue:function(i,a){var l=An();return Ti===null?Du(l,i,a):Ld(l,Ti.memoizedState,i,a)},useTransition:function(){var i=eu(Al)[0],a=An().memoizedState;return[typeof i=="boolean"?i:tu(i),a]},useSyncExternalStore:nl,useId:Dh,useHostTransitionStatus:wf,useFormState:Md,useActionState:Md,useOptimistic:function(i,a){var l=An();return Ti!==null?Jn(l,Ti,i,a):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:Mh,useCacheRefresh:Sf};Mf.useEffectEvent=qc;function Rh(i,a,l,p){a=i.memoizedState,l=l(p,a),l=l==null?a:It({},a,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var zl={enqueueSetState:function(i,a,l){i=i._reactInternals;var p=Ur(),w=se(p);w.payload=a,l!=null&&(w.callback=l),a=we(i,w,p),a!==null&&(Cs(a,i,p),qe(a,i,p))},enqueueReplaceState:function(i,a,l){i=i._reactInternals;var p=Ur(),w=se(p);w.tag=1,w.payload=a,l!=null&&(w.callback=l),a=we(i,w,p),a!==null&&(Cs(a,i,p),qe(a,i,p))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var l=Ur(),p=se(l);p.tag=2,a!=null&&(p.callback=a),a=we(i,p,l),a!==null&&(Cs(a,i,l),qe(a,i,l))}};function rc(i,a,l,p,w,M,U){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,M,U):a.prototype&&a.prototype.isPureReactComponent?!mi(l,p)||!mi(w,M):!0}function Dd(i,a,l,p){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,p),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,p),a.state!==i&&zl.enqueueReplaceState(a,a.state,null)}function ku(i,a){var l=a;if("ref"in a){l={};for(var p in a)p!=="ref"&&(l[p]=a[p])}if(i=i.defaultProps){l===a&&(l=It({},l));for(var w in i)l[w]===void 0&&(l[w]=i[w])}return l}function kd(i){Vs(i)}function Rd(i){console.error(i)}function Od(i){Vs(i)}function Oh(i,a){try{var l=i.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(p){setTimeout(function(){throw p})}}function Bd(i,a,l){try{var p=i.onCaughtError;p(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function Yc(i,a,l){return l=se(l),l.tag=3,l.payload={element:null},l.callback=function(){Oh(i,a)},l}function Nd(i){return i=se(i),i.tag=3,i}function Ru(i,a,l,p){var w=l.type.getDerivedStateFromError;if(typeof w=="function"){var M=p.value;i.payload=function(){return w(M)},i.callback=function(){Bd(a,l,p)}}var U=l.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(i.callback=function(){Bd(a,l,p),typeof w!="function"&&(Dl===null?Dl=new Set([this]):Dl.add(this));var Q=p.stack;this.componentDidCatch(p.value,{componentStack:Q!==null?Q:""})})}function Up(i,a,l,p,w){if(l.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(a=l.alternate,a!==null&&Kl(a,l,w,!0),l=gn.current,l!==null){switch(l.tag){case 31:case 13:return yn===null?Hh():l.alternate===null&&Fn===0&&(Fn=3),l.flags&=-257,l.flags|=65536,l.lanes=w,p===Z?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([p]):a.add(p),Yh(i,p,w)),!1;case 22:return l.flags|=65536,p===Z?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([p])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([p]):l.add(p)),Yh(i,p,w)),!1}throw Error(k(435,l.tag))}return Yh(i,p,w),Hh(),!1}if(Qt)return a=gn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=w,p!==xl&&(i=Error(k(422),{cause:p}),ko(d(i,l)))):(p!==xl&&(a=Error(k(423),{cause:p}),ko(d(a,l))),i=i.current.alternate,i.flags|=65536,w&=-w,i.lanes|=w,p=d(p,l),w=Yc(i.stateNode,p,w),fe(i,w),Fn!==4&&(Fn=2)),!1;var M=Error(k(520),{cause:p});if(M=d(M,l),vc===null?vc=[M]:vc.push(M),Fn!==4&&(Fn=2),a===null)return!0;p=d(p,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,i=w&-w,l.lanes|=i,i=Yc(l.stateNode,p,i),fe(l,i),!1;case 1:if(a=l.type,M=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Dl===null||!Dl.has(M))))return l.flags|=65536,w&=-w,l.lanes|=w,w=Nd(w),Ru(w,i,l,p),fe(l,w),!1}l=l.return}while(l!==null);return!1}var On=Error(k(461)),Qn=!1;function Ya(i,a,l,p){a.child=i===null?ne(a,null,l,p):Xt(a,i.child,l,p)}function Kc(i,a,l,p,w){l=l.render;var M=a.ref;if("ref"in p){var U={};for(var Q in p)Q!=="ref"&&(U[Q]=p[Q])}else U=p;return pa(a),p=Uc(i,a,l,U,M,w),Q=Jl(),i!==null&&!Qn?(Tl(i,a,w),al(i,a,w)):(Qt&&Q&&oa(a),a.flags|=1,Ya(i,a,p,w),a.child)}function Wc(i,a,l,p,w){if(i===null){var M=l.type;return typeof M=="function"&&!el(M)&&M.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=M,oc(i,a,M,p,w)):(i=Io(l.type,null,p,a,a.mode,w),i.ref=a.ref,i.return=a,a.child=i)}if(M=i.child,!Fh(i,w)){var U=M.memoizedProps;if(l=l.compare,l=l!==null?l:mi,l(U,p)&&i.ref===a.ref)return al(i,a,w)}return a.flags|=1,i=ls(M,p),i.ref=a.ref,i.return=a,a.child=i}function oc(i,a,l,p,w){if(i!==null){var M=i.memoizedProps;if(mi(M,p)&&i.ref===a.ref)if(Qn=!1,a.pendingProps=p=M,Fh(i,w))(i.flags&131072)!==0&&(Qn=!0);else return a.lanes=i.lanes,al(i,a,w)}return Nh(i,a,l,p,w)}function zf(i,a,l,p){var w=p.children,M=i!==null?i.memoizedState:null;if(i===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((a.flags&128)!==0){if(M=M!==null?M.baseLanes|l:l,i!==null){for(p=a.child=i.child,w=0;p!==null;)w=w|p.lanes|p.childLanes,p=p.sibling;p=w&~M}else p=0,a.child=null;return uc(i,a,M,l,p)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&m(a,M!==null?M.cachePool:null),M!==null?ur(a,M):cn(),wl(a);else return p=a.lanes=536870912,uc(i,a,M!==null?M.baseLanes|l:l,l,p)}else M!==null?(m(a,M.cachePool),ur(a,M),Or(),a.memoizedState=null):(i!==null&&m(a,null),cn(),Or());return Ya(i,a,w,l),a.child}function lc(i,a){return i!==null&&i.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function uc(i,a,l,p,w){var M=h();return M=M===null?null:{parent:Pn._currentValue,pool:M},a.memoizedState={baseLanes:l,cachePool:M},i!==null&&m(a,null),cn(),wl(a),i!==null&&Kl(i,a,p,!0),a.childLanes=w,null}function cc(i,a){return a=Jc({mode:a.mode,children:a.children},i.mode),a.ref=i.ref,i.child=a,a.return=i,a}function Bh(i,a,l){return Xt(a,i.child,null,l),i=cc(a,a.pendingProps),i.flags|=2,va(a),a.memoizedState=null,i}function Cf(i,a,l){var p=a.pendingProps,w=(a.flags&128)!==0;if(a.flags&=-129,i===null){if(Qt){if(p.mode==="hidden")return i=cc(a,p),a.lanes=536870912,lc(null,i);if(cr(a),(i=ci)?(i=Zt(i,Ha),i=i!==null&&i.data==="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:Ot!==null?{id:$t,overflow:pe}:null,retryLane:536870912,hydrationErrors:null},l=Do(i),l.return=a,a.child=l,Li=a,ci=null)):i=null,i===null)throw cs(a);return a.lanes=536870912,null}return cc(a,p)}var M=i.memoizedState;if(M!==null){var U=M.dehydrated;if(cr(a),w)if(a.flags&256)a.flags&=-257,a=Bh(i,a,l);else if(a.memoizedState!==null)a.child=i.child,a.flags|=128,a=null;else throw Error(k(558));else if(Qn||Kl(i,a,l,!1),w=(l&i.childLanes)!==0,Qn||w){if(p=En,p!==null&&(U=Kt(p,l),U!==0&&U!==M.retryLane))throw M.retryLane=U,Ms(i,U),Cs(p,i,U),On;Hh(),a=Bh(i,a,l)}else i=M.treeContext,ci=le(U.nextSibling),Li=a,Qt=!0,qs=null,Ha=!1,i!==null&&Ra(a,i),a=cc(a,p),a.flags|=4096;return a}return i=ls(i.child,{mode:p.mode,children:p.children}),i.ref=a.ref,a.child=i,i.return=a,i}function hc(i,a){var l=a.ref;if(l===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(k(284));(i===null||i.ref!==l)&&(a.flags|=4194816)}}function Nh(i,a,l,p,w){return pa(a),l=Uc(i,a,l,p,void 0,w),p=Jl(),i!==null&&!Qn?(Tl(i,a,w),al(i,a,w)):(Qt&&p&&oa(a),a.flags|=1,Ya(i,a,l,w),a.child)}function Lf(i,a,l,p,w,M){return pa(a),a.updateQueue=null,l=Fo(a,p,l,w),Zc(i),p=Jl(),i!==null&&!Qn?(Tl(i,a,M),al(i,a,M)):(Qt&&p&&oa(a),a.flags|=1,Ya(i,a,l,M),a.child)}function Fd(i,a,l,p,w){if(pa(a),a.stateNode===null){var M=ka,U=l.contextType;typeof U=="object"&&U!==null&&(M=fi(U)),M=new l(p,M),a.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=zl,a.stateNode=M,M._reactInternals=a,M=a.stateNode,M.props=p,M.state=a.memoizedState,M.refs={},ve(a),U=l.contextType,M.context=typeof U=="object"&&U!==null?fi(U):ka,M.state=a.memoizedState,U=l.getDerivedStateFromProps,typeof U=="function"&&(Rh(a,l,U,p),M.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(U=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),U!==M.state&&zl.enqueueReplaceState(M,M.state,null),tn(a,p,M,w),Ze(),M.state=a.memoizedState),typeof M.componentDidMount=="function"&&(a.flags|=4194308),p=!0}else if(i===null){M=a.stateNode;var Q=a.memoizedProps,mt=ku(l,Q);M.props=mt;var Bt=M.context,Yt=l.contextType;U=ka,typeof Yt=="object"&&Yt!==null&&(U=fi(Yt));var te=l.getDerivedStateFromProps;Yt=typeof te=="function"||typeof M.getSnapshotBeforeUpdate=="function",Q=a.pendingProps!==Q,Yt||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(Q||Bt!==U)&&Dd(a,M,p,U),ue=!1;var Ut=a.memoizedState;M.state=Ut,tn(a,p,M,w),Ze(),Bt=a.memoizedState,Q||Ut!==Bt||ue?(typeof te=="function"&&(Rh(a,l,te,p),Bt=a.memoizedState),(mt=ue||rc(a,l,mt,p,Ut,Bt,U))?(Yt||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(a.flags|=4194308)):(typeof M.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=p,a.memoizedState=Bt),M.props=p,M.state=Bt,M.context=U,p=mt):(typeof M.componentDidMount=="function"&&(a.flags|=4194308),p=!1)}else{M=a.stateNode,he(i,a),U=a.memoizedProps,Yt=ku(l,U),M.props=Yt,te=a.pendingProps,Ut=M.context,Bt=l.contextType,mt=ka,typeof Bt=="object"&&Bt!==null&&(mt=fi(Bt)),Q=l.getDerivedStateFromProps,(Bt=typeof Q=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(U!==te||Ut!==mt)&&Dd(a,M,p,mt),ue=!1,Ut=a.memoizedState,M.state=Ut,tn(a,p,M,w),Ze();var qt=a.memoizedState;U!==te||Ut!==qt||ue||i!==null&&i.dependencies!==null&&tc(i.dependencies)?(typeof Q=="function"&&(Rh(a,l,Q,p),qt=a.memoizedState),(Yt=ue||rc(a,l,Yt,p,Ut,qt,mt)||i!==null&&i.dependencies!==null&&tc(i.dependencies))?(Bt||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(p,qt,mt),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(p,qt,mt)),typeof M.componentDidUpdate=="function"&&(a.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof M.componentDidUpdate!="function"||U===i.memoizedProps&&Ut===i.memoizedState||(a.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&Ut===i.memoizedState||(a.flags|=1024),a.memoizedProps=p,a.memoizedState=qt),M.props=p,M.state=qt,M.context=mt,p=Yt):(typeof M.componentDidUpdate!="function"||U===i.memoizedProps&&Ut===i.memoizedState||(a.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||U===i.memoizedProps&&Ut===i.memoizedState||(a.flags|=1024),p=!1)}return M=p,hc(i,a),p=(a.flags&128)!==0,M||p?(M=a.stateNode,l=p&&typeof l.getDerivedStateFromError!="function"?null:M.render(),a.flags|=1,i!==null&&p?(a.child=Xt(a,i.child,null,w),a.child=Xt(a,null,l,w)):Ya(i,a,l,w),a.memoizedState=M.state,i=a.child):i=al(i,a,w),i}function Ud(i,a,l,p){return Rr(),a.flags|=256,Ya(i,a,l,p),a.child}var If={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pf(i){return{baseLanes:i,cachePool:T()}}function Df(i,a,l){return i=i!==null?i.childLanes&~l:0,a&&(i|=mr),i}function Cl(i,a,l){var p=a.pendingProps,w=!1,M=(a.flags&128)!==0,U;if((U=M)||(U=i!==null&&i.memoizedState===null?!1:(Gi.current&2)!==0),U&&(w=!0,a.flags&=-129),U=(a.flags&32)!==0,a.flags&=-33,i===null){if(Qt){if(w?Hn(a):Or(),(i=ci)?(i=Zt(i,Ha),i=i!==null&&i.data!=="&"?i:null,i!==null&&(a.memoizedState={dehydrated:i,treeContext:Ot!==null?{id:$t,overflow:pe}:null,retryLane:536870912,hydrationErrors:null},l=Do(i),l.return=a,a.child=l,Li=a,ci=null)):i=null,i===null)throw cs(a);return ye(i)?a.lanes=32:a.lanes=536870912,null}var Q=p.children;return p=p.fallback,w?(Or(),w=a.mode,Q=Jc({mode:"hidden",children:Q},w),p=us(p,w,l,null),Q.return=a,p.return=a,Q.sibling=p,a.child=Q,p=a.child,p.memoizedState=Pf(l),p.childLanes=Df(i,U,l),a.memoizedState=If,lc(null,p)):(Hn(a),kf(a,Q))}var mt=i.memoizedState;if(mt!==null&&(Q=mt.dehydrated,Q!==null)){if(M)a.flags&256?(Hn(a),a.flags&=-257,a=ou(i,a,l)):a.memoizedState!==null?(Or(),a.child=i.child,a.flags|=128,a=null):(Or(),Q=p.fallback,w=a.mode,p=Jc({mode:"visible",children:p.children},w),Q=us(Q,w,l,null),Q.flags|=2,p.return=a,Q.return=a,p.sibling=Q,a.child=p,Xt(a,i.child,null,l),p=a.child,p.memoizedState=Pf(l),p.childLanes=Df(i,U,l),a.memoizedState=If,a=lc(null,p));else if(Hn(a),ye(Q)){if(U=Q.nextSibling&&Q.nextSibling.dataset,U)var Bt=U.dgst;U=Bt,p=Error(k(419)),p.stack="",p.digest=U,ko({value:p,source:null,stack:null}),a=ou(i,a,l)}else if(Qn||Kl(i,a,l,!1),U=(l&i.childLanes)!==0,Qn||U){if(U=En,U!==null&&(p=Kt(U,l),p!==0&&p!==mt.retryLane))throw mt.retryLane=p,Ms(i,p),Cs(U,i,p),On;ee(Q)||Hh(),a=ou(i,a,l)}else ee(Q)?(a.flags|=192,a.child=i.child,a=null):(i=mt.treeContext,ci=le(Q.nextSibling),Li=a,Qt=!0,qs=null,Ha=!1,i!==null&&Ra(a,i),a=kf(a,p.children),a.flags|=4096);return a}return w?(Or(),Q=p.fallback,w=a.mode,mt=i.child,Bt=mt.sibling,p=ls(mt,{mode:"hidden",children:p.children}),p.subtreeFlags=mt.subtreeFlags&65011712,Bt!==null?Q=ls(Bt,Q):(Q=us(Q,w,l,null),Q.flags|=2),Q.return=a,p.return=a,p.sibling=Q,a.child=p,lc(null,p),p=a.child,Q=i.child.memoizedState,Q===null?Q=Pf(l):(w=Q.cachePool,w!==null?(mt=Pn._currentValue,w=w.parent!==mt?{parent:mt,pool:mt}:w):w=T(),Q={baseLanes:Q.baseLanes|l,cachePool:w}),p.memoizedState=Q,p.childLanes=Df(i,U,l),a.memoizedState=If,lc(i.child,p)):(Hn(a),l=i.child,i=l.sibling,l=ls(l,{mode:"visible",children:p.children}),l.return=a,l.sibling=null,i!==null&&(U=a.deletions,U===null?(a.deletions=[i],a.flags|=16):U.push(i)),a.child=l,a.memoizedState=null,l)}function kf(i,a){return a=Jc({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function Jc(i,a){return i=da(22,i,null,a),i.lanes=0,i}function ou(i,a,l){return Xt(a,i.child,null,l),i=kf(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function Zd(i,a,l){i.lanes|=a;var p=i.alternate;p!==null&&(p.lanes|=a),Nc(i.return,a,l)}function Rf(i,a,l,p,w,M){var U=i.memoizedState;U===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:p,tail:l,tailMode:w,treeForkCount:M}:(U.isBackwards=a,U.rendering=null,U.renderingStartTime=0,U.last=p,U.tail=l,U.tailMode=w,U.treeForkCount=M)}function jd(i,a,l){var p=a.pendingProps,w=p.revealOrder,M=p.tail;p=p.children;var U=Gi.current,Q=(U&2)!==0;if(Q?(U=U&1|2,a.flags|=128):U&=1,Ht(Gi,U),Ya(i,a,p,l),p=Qt?Y:0,!Q&&i!==null&&(i.flags&128)!==0)t:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Zd(i,l,a);else if(i.tag===19)Zd(i,l,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break t;for(;i.sibling===null;){if(i.return===null||i.return===a)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(w){case"forwards":for(l=a.child,w=null;l!==null;)i=l.alternate,i!==null&&Sl(i)===null&&(w=l),l=l.sibling;l=w,l===null?(w=a.child,a.child=null):(w=l.sibling,l.sibling=null),Rf(a,!1,w,l,M,p);break;case"backwards":case"unstable_legacy-backwards":for(l=null,w=a.child,a.child=null;w!==null;){if(i=w.alternate,i!==null&&Sl(i)===null){a.child=w;break}i=w.sibling,w.sibling=l,l=w,w=i}Rf(a,!0,l,null,M,p);break;case"together":Rf(a,!1,null,null,void 0,p);break;default:a.memoizedState=null}return a.child}function al(i,a,l){if(i!==null&&(a.dependencies=i.dependencies),hu|=a.lanes,(l&a.childLanes)===0)if(i!==null){if(Kl(i,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(k(153));if(a.child!==null){for(i=a.child,l=ls(i,i.pendingProps),a.child=l,l.return=a;i.sibling!==null;)i=i.sibling,l=l.sibling=ls(i,i.pendingProps),l.return=a;l.sibling=null}return a.child}function Fh(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&tc(i)))}function Zp(i,a,l){switch(a.tag){case 3:Mi(a,a.stateNode.containerInfo),ao(a,Pn,i.memoizedState.cache),Rr();break;case 27:case 5:Qa(a);break;case 4:Mi(a,a.stateNode.containerInfo);break;case 10:ao(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,cr(a),null;break;case 13:var p=a.memoizedState;if(p!==null)return p.dehydrated!==null?(Hn(a),a.flags|=128,null):(l&a.child.childLanes)!==0?Cl(i,a,l):(Hn(a),i=al(i,a,l),i!==null?i.sibling:null);Hn(a);break;case 19:var w=(i.flags&128)!==0;if(p=(l&a.childLanes)!==0,p||(Kl(i,a,l,!1),p=(l&a.childLanes)!==0),w){if(p)return jd(i,a,l);a.flags|=128}if(w=a.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Ht(Gi,Gi.current),p)break;return null;case 22:return a.lanes=0,zf(i,a,l,a.pendingProps);case 24:ao(a,Pn,i.memoizedState.cache)}return al(i,a,l)}function Vd(i,a,l){if(i!==null)if(i.memoizedProps!==a.pendingProps)Qn=!0;else{if(!Fh(i,l)&&(a.flags&128)===0)return Qn=!1,Zp(i,a,l);Qn=(i.flags&131072)!==0}else Qn=!1,Qt&&(a.flags&1048576)!==0&&_i(a,Y,a.index);switch(a.lanes=0,a.tag){case 16:t:{var p=a.pendingProps;if(i=J(a.elementType),a.type=i,typeof i=="function")el(i)?(p=ku(i,p),a.tag=1,a=Fd(null,a,i,p,l)):(a.tag=0,a=Nh(null,a,i,p,l));else{if(i!=null){var w=i.$$typeof;if(w===Qi){a.tag=11,a=Kc(null,a,i,p,l);break t}else if(w===Xe){a.tag=14,a=Wc(null,a,i,p,l);break t}}throw a=Pi(i)||i,Error(k(306,a,""))}}return a;case 0:return Nh(i,a,a.type,a.pendingProps,l);case 1:return p=a.type,w=ku(p,a.pendingProps),Fd(i,a,p,w,l);case 3:t:{if(Mi(a,a.stateNode.containerInfo),i===null)throw Error(k(387));p=a.pendingProps;var M=a.memoizedState;w=M.element,he(i,a),tn(a,p,null,l);var U=a.memoizedState;if(p=U.cache,ao(a,Pn,p),p!==M.cache&&zu(a,[Pn],l,!0),Ze(),p=U.element,M.isDehydrated)if(M={element:p,isDehydrated:!1,cache:U.cache},a.updateQueue.baseState=M,a.memoizedState=M,a.flags&256){a=Ud(i,a,p,l);break t}else if(p!==w){w=d(Error(k(424)),a),ko(w),a=Ud(i,a,p,l);break t}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(ci=le(i.firstChild),Li=a,Qt=!0,qs=null,Ha=!0,l=ne(a,null,p,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Rr(),p===w){a=al(i,a,l);break t}Ya(i,a,p,l)}a=a.child}return a;case 26:return hc(i,a),i===null?(l=Fa(a.type,null,a.pendingProps,null))?a.memoizedState=l:Qt||(l=a.type,i=a.pendingProps,p=f(xe.current).createElement(l),p[Le]=a,p[Ye]=i,Ba(p,l,i),Vn(p),a.stateNode=p):a.memoizedState=Fa(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return Qa(a),i===null&&Qt&&(p=a.stateNode=be(a.type,a.pendingProps,xe.current),Li=a,Ha=!0,w=ci,W(a.type)?(de=w,ci=le(p.firstChild)):ci=w),Ya(i,a,a.pendingProps.children,l),hc(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&Qt&&((w=p=ci)&&(p=gt(p,a.type,a.pendingProps,Ha),p!==null?(a.stateNode=p,Li=a,ci=le(p.firstChild),Ha=!1,w=!0):w=!1),w||cs(a)),Qa(a),w=a.type,M=a.pendingProps,U=i!==null?i.memoizedProps:null,p=M.children,S(w,M)?p=null:U!==null&&S(w,U)&&(a.flags|=32),a.memoizedState!==null&&(w=Uc(i,a,Eh,null,null,l),Ic._currentValue=w),hc(i,a),Ya(i,a,p,l),a.child;case 6:return i===null&&Qt&&((i=l=ci)&&(l=Tt(l,a.pendingProps,Ha),l!==null?(a.stateNode=l,Li=a,ci=null,i=!0):i=!1),i||cs(a)),null;case 13:return Cl(i,a,l);case 4:return Mi(a,a.stateNode.containerInfo),p=a.pendingProps,i===null?a.child=Xt(a,null,p,l):Ya(i,a,p,l),a.child;case 11:return Kc(i,a,a.type,a.pendingProps,l);case 7:return Ya(i,a,a.pendingProps,l),a.child;case 8:return Ya(i,a,a.pendingProps.children,l),a.child;case 12:return Ya(i,a,a.pendingProps.children,l),a.child;case 10:return p=a.pendingProps,ao(a,a.type,p.value),Ya(i,a,p.children,l),a.child;case 9:return w=a.type._context,p=a.pendingProps.children,pa(a),w=fi(w),p=p(w),a.flags|=1,Ya(i,a,p,l),a.child;case 14:return Wc(i,a,a.type,a.pendingProps,l);case 15:return oc(i,a,a.type,a.pendingProps,l);case 19:return jd(i,a,l);case 31:return Cf(i,a,l);case 22:return zf(i,a,l,a.pendingProps);case 24:return pa(a),p=fi(Pn),i===null?(w=h(),w===null&&(w=En,M=lr(),w.pooledCache=M,M.refCount++,M!==null&&(w.pooledCacheLanes|=l),w=M),a.memoizedState={parent:p,cache:w},ve(a),ao(a,Pn,w)):((i.lanes&l)!==0&&(he(i,a),tn(a,null,null,l),Ze()),w=i.memoizedState,M=a.memoizedState,w.parent!==p?(w={parent:p,cache:p},a.memoizedState=w,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=w),ao(a,Pn,p)):(p=M.cache,ao(a,Pn,p),p!==w.cache&&zu(a,[Pn],l,!0))),Ya(i,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(k(156,a.tag))}function Ll(i){i.flags|=4}function Of(i,a,l,p,w){if((a=(i.mode&32)!==0)&&(a=!1),a){if(i.flags|=16777216,(w&335544128)===w)if(i.stateNode.complete)i.flags|=8192;else if(sp())i.flags|=8192;else throw et=Z,P}else i.flags&=-16777217}function Uh(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Ma(a))if(sp())i.flags|=8192;else throw et=Z,P}function lu(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?at():536870912,i.lanes|=a,yc|=a)}function Ou(i,a){if(!Qt)switch(i.tailMode){case"hidden":a=i.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Bn(i){var a=i.alternate!==null&&i.alternate.child===i.child,l=0,p=0;if(a)for(var w=i.child;w!==null;)l|=w.lanes|w.childLanes,p|=w.subtreeFlags&65011712,p|=w.flags&65011712,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)l|=w.lanes|w.childLanes,p|=w.subtreeFlags,p|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=p,i.childLanes=l,a}function jp(i,a,l){var p=a.pendingProps;switch(Rn(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(a),null;case 1:return Bn(a),null;case 3:return l=a.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),a.memoizedState.cache!==p&&(a.flags|=2048),so(Pn),Vi(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(ei(a)?Ll(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Mu())),Bn(a),null;case 26:var w=a.type,M=a.memoizedState;return i===null?(Ll(a),M!==null?(Bn(a),Uh(a,M)):(Bn(a),Of(a,w,null,p,l))):M?M!==i.memoizedState?(Ll(a),Bn(a),Uh(a,M)):(Bn(a),a.flags&=-16777217):(i=i.memoizedProps,i!==p&&Ll(a),Bn(a),Of(a,w,i,p,l)),null;case 27:if(Ys(a),l=xe.current,w=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==p&&Ll(a);else{if(!p){if(a.stateNode===null)throw Error(k(166));return Bn(a),null}i=ae.current,ei(a)?no(a):(i=be(w,p,l),a.stateNode=i,Ll(a))}return Bn(a),null;case 5:if(Ys(a),w=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==p&&Ll(a);else{if(!p){if(a.stateNode===null)throw Error(k(166));return Bn(a),null}if(M=ae.current,ei(a))no(a);else{var U=f(xe.current);switch(M){case 1:M=U.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:M=U.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":M=U.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":M=U.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":M=U.createElement("div"),M.innerHTML="<script><\/script>",M=M.removeChild(M.firstChild);break;case"select":M=typeof p.is=="string"?U.createElement("select",{is:p.is}):U.createElement("select"),p.multiple?M.multiple=!0:p.size&&(M.size=p.size);break;default:M=typeof p.is=="string"?U.createElement(w,{is:p.is}):U.createElement(w)}}M[Le]=a,M[Ye]=p;t:for(U=a.child;U!==null;){if(U.tag===5||U.tag===6)M.appendChild(U.stateNode);else if(U.tag!==4&&U.tag!==27&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===a)break t;for(;U.sibling===null;){if(U.return===null||U.return===a)break t;U=U.return}U.sibling.return=U.return,U=U.sibling}a.stateNode=M;t:switch(Ba(M,w,p),w){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break t;case"img":p=!0;break t;default:p=!1}p&&Ll(a)}}return Bn(a),Of(a,a.type,i===null?null:i.memoizedProps,a.pendingProps,l),null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==p&&Ll(a);else{if(typeof p!="string"&&a.stateNode===null)throw Error(k(166));if(i=xe.current,ei(a)){if(i=a.stateNode,l=a.memoizedProps,p=null,w=Li,w!==null)switch(w.tag){case 27:case 5:p=w.memoizedProps}i[Le]=a,i=!!(i.nodeValue===l||p!==null&&p.suppressHydrationWarning===!0||zc(i.nodeValue,l)),i||cs(a,!0)}else i=f(i).createTextNode(p),i[Le]=a,a.stateNode=i}return Bn(a),null;case 31:if(l=a.memoizedState,i===null||i.memoizedState!==null){if(p=ei(a),l!==null){if(i===null){if(!p)throw Error(k(318));if(i=a.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(k(557));i[Le]=a}else Rr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Bn(a),i=!1}else l=Mu(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=l),i=!0;if(!i)return a.flags&256?(va(a),a):(va(a),null);if((a.flags&128)!==0)throw Error(k(558))}return Bn(a),null;case 13:if(p=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(w=ei(a),p!==null&&p.dehydrated!==null){if(i===null){if(!w)throw Error(k(318));if(w=a.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(k(317));w[Le]=a}else Rr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Bn(a),w=!1}else w=Mu(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=w),w=!0;if(!w)return a.flags&256?(va(a),a):(va(a),null)}return va(a),(a.flags&128)!==0?(a.lanes=l,a):(l=p!==null,i=i!==null&&i.memoizedState!==null,l&&(p=a.child,w=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(w=p.alternate.memoizedState.cachePool.pool),M=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(M=p.memoizedState.cachePool.pool),M!==w&&(p.flags|=2048)),l!==i&&l&&(a.child.flags|=8192),lu(a,a.updateQueue),Bn(a),null);case 4:return Vi(),i===null&&sd(a.stateNode.containerInfo),Bn(a),null;case 10:return so(a.type),Bn(a),null;case 19:if(St(Gi),p=a.memoizedState,p===null)return Bn(a),null;if(w=(a.flags&128)!==0,M=p.rendering,M===null)if(w)Ou(p,!1);else{if(Fn!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(M=Sl(i),M!==null){for(a.flags|=128,Ou(p,!1),i=M.updateQueue,a.updateQueue=i,lu(a,i),a.subtreeFlags=0,i=l,l=a.child;l!==null;)yl(l,i),l=l.sibling;return Ht(Gi,Gi.current&1|2),Qt&&Re(a,p.treeForkCount),a.child}i=i.sibling}p.tail!==null&&ia()>qh&&(a.flags|=128,w=!0,Ou(p,!1),a.lanes=4194304)}else{if(!w)if(i=Sl(M),i!==null){if(a.flags|=128,w=!0,i=i.updateQueue,a.updateQueue=i,lu(a,i),Ou(p,!0),p.tail===null&&p.tailMode==="hidden"&&!M.alternate&&!Qt)return Bn(a),null}else 2*ia()-p.renderingStartTime>qh&&l!==536870912&&(a.flags|=128,w=!0,Ou(p,!1),a.lanes=4194304);p.isBackwards?(M.sibling=a.child,a.child=M):(i=p.last,i!==null?i.sibling=M:a.child=M,p.last=M)}return p.tail!==null?(i=p.tail,p.rendering=i,p.tail=i.sibling,p.renderingStartTime=ia(),i.sibling=null,l=Gi.current,Ht(Gi,w?l&1|2:l&1),Qt&&Re(a,p.treeForkCount),i):(Bn(a),null);case 22:case 23:return va(a),Xa(),p=a.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(a.flags|=8192):p&&(a.flags|=8192),p?(l&536870912)!==0&&(a.flags&128)===0&&(Bn(a),a.subtreeFlags&6&&(a.flags|=8192)):Bn(a),l=a.updateQueue,l!==null&&lu(a,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),p=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(p=a.memoizedState.cachePool.pool),p!==l&&(a.flags|=2048),i!==null&&St(c),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),so(Pn),Bn(a),null;case 25:return null;case 30:return null}throw Error(k(156,a.tag))}function qd(i,a){switch(Rn(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return so(Pn),Vi(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return Ys(a),null;case 31:if(a.memoizedState!==null){if(va(a),a.alternate===null)throw Error(k(340));Rr()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 13:if(va(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(k(340));Rr()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return St(Gi),null;case 4:return Vi(),null;case 10:return so(a.type),null;case 22:case 23:return va(a),Xa(),i!==null&&St(c),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return so(Pn),null;case 25:return null;default:return null}}function Gd(i,a){switch(Rn(a),a.tag){case 3:so(Pn),Vi();break;case 26:case 27:case 5:Ys(a);break;case 4:Vi();break;case 31:a.memoizedState!==null&&va(a);break;case 13:va(a);break;case 19:St(Gi);break;case 10:so(a.type);break;case 22:case 23:va(a),Xa(),i!==null&&St(c);break;case 24:so(Pn)}}function Qc(i,a){try{var l=a.updateQueue,p=l!==null?l.lastEffect:null;if(p!==null){var w=p.next;l=w;do{if((l.tag&i)===i){p=void 0;var M=l.create,U=l.inst;p=M(),U.destroy=p}l=l.next}while(l!==w)}}catch(Q){fn(a,a.return,Q)}}function oo(i,a,l){try{var p=a.updateQueue,w=p!==null?p.lastEffect:null;if(w!==null){var M=w.next;p=M;do{if((p.tag&i)===i){var U=p.inst,Q=U.destroy;if(Q!==void 0){U.destroy=void 0,w=a;var mt=l,Bt=Q;try{Bt()}catch(Yt){fn(w,mt,Yt)}}}p=p.next}while(p!==M)}}catch(Yt){fn(a,a.return,Yt)}}function Bf(i){var a=i.updateQueue;if(a!==null){var l=i.stateNode;try{yi(a,l)}catch(p){fn(i,i.return,p)}}}function Hd(i,a,l){l.props=ku(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(p){fn(i,a,p)}}function th(i,a){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var p=i.stateNode;break;case 30:p=i.stateNode;break;default:p=i.stateNode}typeof l=="function"?i.refCleanup=l(p):l.current=p}}catch(w){fn(i,a,w)}}function sl(i,a){var l=i.ref,p=i.refCleanup;if(l!==null)if(typeof p=="function")try{p()}catch(w){fn(i,a,w)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(w){fn(i,a,w)}else l.current=null}function Xd(i){var a=i.type,l=i.memoizedProps,p=i.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&p.focus();break t;case"img":l.src?p.src=l.src:l.srcSet&&(p.srcset=l.srcSet)}}catch(w){fn(i,i.return,w)}}function Nf(i,a,l){try{var p=i.stateNode;Yp(p,i.type,l,a),p[Ye]=a}catch(w){fn(i,i.return,w)}}function $d(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&W(i.type)||i.tag===4}function Zh(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||$d(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&W(i.type)||i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function eh(i,a,l){var p=i.tag;if(p===5||p===6)i=i.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(i),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=na));else if(p!==4&&(p===27&&W(i.type)&&(l=i.stateNode,a=null),i=i.child,i!==null))for(eh(i,a,l),i=i.sibling;i!==null;)eh(i,a,l),i=i.sibling}function ih(i,a,l){var p=i.tag;if(p===5||p===6)i=i.stateNode,a?l.insertBefore(i,a):l.appendChild(i);else if(p!==4&&(p===27&&W(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(ih(i,a,l),i=i.sibling;i!==null;)ih(i,a,l),i=i.sibling}function Ff(i){var a=i.stateNode,l=i.memoizedProps;try{for(var p=i.type,w=a.attributes;w.length;)a.removeAttributeNode(w[0]);Ba(a,p,l),a[Le]=i,a[Ye]=l}catch(M){fn(i,i.return,M)}}var rl=!1,ba=!1,fc=!1,Yd=typeof WeakSet=="function"?WeakSet:Set,Oa=null;function Vp(i,a){if(i=i.containerInfo,s=nf,i=sr(i),Ir(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else t:{l=(l=i.ownerDocument)&&l.defaultView||window;var p=l.getSelection&&l.getSelection();if(p&&p.rangeCount!==0){l=p.anchorNode;var w=p.anchorOffset,M=p.focusNode;p=p.focusOffset;try{l.nodeType,M.nodeType}catch{l=null;break t}var U=0,Q=-1,mt=-1,Bt=0,Yt=0,te=i,Ut=null;e:for(;;){for(var qt;te!==l||w!==0&&te.nodeType!==3||(Q=U+w),te!==M||p!==0&&te.nodeType!==3||(mt=U+p),te.nodeType===3&&(U+=te.nodeValue.length),(qt=te.firstChild)!==null;)Ut=te,te=qt;for(;;){if(te===i)break e;if(Ut===l&&++Bt===w&&(Q=U),Ut===M&&++Yt===p&&(mt=U),(qt=te.nextSibling)!==null)break;te=Ut,Ut=te.parentNode}te=qt}l=Q===-1||mt===-1?null:{start:Q,end:mt}}else l=null}l=l||{start:0,end:0}}else l=null;for(u={focusedElem:i,selectionRange:l},nf=!1,Oa=a;Oa!==null;)if(a=Oa,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,Oa=i;else for(;Oa!==null;){switch(a=Oa,M=a.alternate,i=a.flags,a.tag){case 0:if((i&4)!==0&&(i=a.updateQueue,i=i!==null?i.events:null,i!==null))for(l=0;l<i.length;l++)w=i[l],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&M!==null){i=void 0,l=a,w=M.memoizedProps,M=M.memoizedState,p=l.stateNode;try{var De=ku(l.type,w);i=p.getSnapshotBeforeUpdate(De,M),p.__reactInternalSnapshotBeforeUpdate=i}catch(ni){fn(l,l.return,ni)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,l=i.nodeType,l===9)Ct(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Ct(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(k(163))}if(i=a.sibling,i!==null){i.return=a.return,Oa=i;break}Oa=a.return}}function Kd(i,a,l){var p=l.flags;switch(l.tag){case 0:case 11:case 15:pr(i,l),p&4&&Qc(5,l);break;case 1:if(pr(i,l),p&4)if(i=l.stateNode,a===null)try{i.componentDidMount()}catch(U){fn(l,l.return,U)}else{var w=ku(l.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(w,a,i.__reactInternalSnapshotBeforeUpdate)}catch(U){fn(l,l.return,U)}}p&64&&Bf(l),p&512&&th(l,l.return);break;case 3:if(pr(i,l),p&64&&(i=l.updateQueue,i!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{yi(i,a)}catch(U){fn(l,l.return,U)}}break;case 27:a===null&&p&4&&Ff(l);case 26:case 5:pr(i,l),a===null&&p&4&&Xd(l),p&512&&th(l,l.return);break;case 12:pr(i,l);break;case 31:pr(i,l),p&4&&la(i,l);break;case 13:pr(i,l),p&4&&Uf(i,l),p&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=lp.bind(null,l),Be(i,l))));break;case 22:if(p=l.memoizedState!==null||rl,!p){a=a!==null&&a.memoizedState!==null||ba,w=rl;var M=ba;rl=p,(ba=a)&&!M?Pl(i,l,(l.subtreeFlags&8772)!==0):pr(i,l),rl=w,ba=M}break;case 30:break;default:pr(i,l)}}function Wd(i){var a=i.alternate;a!==null&&(i.alternate=null,Wd(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&Zn(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Nn=null,dr=!1;function Il(i,a,l){for(l=l.child;l!==null;)dc(i,a,l),l=l.sibling}function dc(i,a,l){if(ke&&typeof ke.onCommitFiberUnmount=="function")try{ke.onCommitFiberUnmount(oe,l)}catch{}switch(l.tag){case 26:ba||sl(l,a),Il(i,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ba||sl(l,a);var p=Nn,w=dr;W(l.type)&&(Nn=l.stateNode,dr=!1),Il(i,a,l),Gt(l.stateNode),Nn=p,dr=w;break;case 5:ba||sl(l,a);case 6:if(p=Nn,w=dr,Nn=null,Il(i,a,l),Nn=p,dr=w,Nn!==null)if(dr)try{(Nn.nodeType===9?Nn.body:Nn.nodeName==="HTML"?Nn.ownerDocument.body:Nn).removeChild(l.stateNode)}catch(M){fn(l,a,M)}else try{Nn.removeChild(l.stateNode)}catch(M){fn(l,a,M)}break;case 18:Nn!==null&&(dr?(i=Nn,st(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),of(i)):st(Nn,l.stateNode));break;case 4:p=Nn,w=dr,Nn=l.stateNode.containerInfo,dr=!0,Il(i,a,l),Nn=p,dr=w;break;case 0:case 11:case 14:case 15:oo(2,l,a),ba||oo(4,l,a),Il(i,a,l);break;case 1:ba||(sl(l,a),p=l.stateNode,typeof p.componentWillUnmount=="function"&&Hd(l,a,p)),Il(i,a,l);break;case 21:Il(i,a,l);break;case 22:ba=(p=ba)||l.memoizedState!==null,Il(i,a,l),ba=p;break;default:Il(i,a,l)}}function la(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{of(i)}catch(l){fn(a,a.return,l)}}}function Uf(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{of(i)}catch(l){fn(a,a.return,l)}}function Jd(i){switch(i.tag){case 31:case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new Yd),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new Yd),a;default:throw Error(k(435,i.tag))}}function nh(i,a){var l=Jd(i);a.forEach(function(p){if(!l.has(p)){l.add(p);var w=Xp.bind(null,i,p);p.then(w,w)}})}function pi(i,a){var l=a.deletions;if(l!==null)for(var p=0;p<l.length;p++){var w=l[p],M=i,U=a,Q=U;t:for(;Q!==null;){switch(Q.tag){case 27:if(W(Q.type)){Nn=Q.stateNode,dr=!1;break t}break;case 5:Nn=Q.stateNode,dr=!1;break t;case 3:case 4:Nn=Q.stateNode.containerInfo,dr=!0;break t}Q=Q.return}if(Nn===null)throw Error(k(160));dc(M,U,w),Nn=null,dr=!1,M=w.alternate,M!==null&&(M.return=null),w.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Zf(a,i),a=a.sibling}var Nr=null;function Zf(i,a){var l=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:pi(a,i),Gs(i),p&4&&(oo(3,i,i.return),Qc(3,i),oo(5,i,i.return));break;case 1:pi(a,i),Gs(i),p&512&&(ba||l===null||sl(l,l.return)),p&64&&rl&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?p:l.concat(p))));break;case 26:var w=Nr;if(pi(a,i),Gs(i),p&512&&(ba||l===null||sl(l,l.return)),p&4){var M=l!==null?l.memoizedState:null;if(p=i.memoizedState,l===null)if(p===null)if(i.stateNode===null){t:{p=i.type,l=i.memoizedProps,w=w.ownerDocument||w;e:switch(p){case"title":M=w.getElementsByTagName("title")[0],(!M||M[Yi]||M[Le]||M.namespaceURI==="http://www.w3.org/2000/svg"||M.hasAttribute("itemprop"))&&(M=w.createElement(p),w.head.insertBefore(M,w.querySelector("head > title"))),Ba(M,p,l),M[Le]=i,Vn(M),p=M;break t;case"link":var U=jo("link","href",w).get(p+(l.href||""));if(U){for(var Q=0;Q<U.length;Q++)if(M=U[Q],M.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&M.getAttribute("rel")===(l.rel==null?null:l.rel)&&M.getAttribute("title")===(l.title==null?null:l.title)&&M.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){U.splice(Q,1);break e}}M=w.createElement(p),Ba(M,p,l),w.head.appendChild(M);break;case"meta":if(U=jo("meta","content",w).get(p+(l.content||""))){for(Q=0;Q<U.length;Q++)if(M=U[Q],M.getAttribute("content")===(l.content==null?null:""+l.content)&&M.getAttribute("name")===(l.name==null?null:l.name)&&M.getAttribute("property")===(l.property==null?null:l.property)&&M.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&M.getAttribute("charset")===(l.charSet==null?null:l.charSet)){U.splice(Q,1);break e}}M=w.createElement(p),Ba(M,p,l),w.head.appendChild(M);break;default:throw Error(k(468,p))}M[Le]=i,Vn(M),p=M}i.stateNode=p}else jr(w,i.type,i.stateNode);else i.stateNode=bn(w,p,i.memoizedProps);else M!==p?(M===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):M.count--,p===null?jr(w,i.type,i.stateNode):bn(w,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Nf(i,i.memoizedProps,l.memoizedProps)}break;case 27:pi(a,i),Gs(i),p&512&&(ba||l===null||sl(l,l.return)),l!==null&&p&4&&Nf(i,i.memoizedProps,l.memoizedProps);break;case 5:if(pi(a,i),Gs(i),p&512&&(ba||l===null||sl(l,l.return)),i.flags&32){w=i.stateNode;try{as(w,"")}catch(De){fn(i,i.return,De)}}p&4&&i.stateNode!=null&&(w=i.memoizedProps,Nf(i,w,l!==null?l.memoizedProps:w)),p&1024&&(fc=!0);break;case 6:if(pi(a,i),Gs(i),p&4){if(i.stateNode===null)throw Error(k(162));p=i.memoizedProps,l=i.stateNode;try{l.nodeValue=p}catch(De){fn(i,i.return,De)}}break;case 3:if(Zr=null,w=Nr,Nr=Ge(a.containerInfo),pi(a,i),Nr=w,Gs(i),p&4&&l!==null&&l.memoizedState.isDehydrated)try{of(a.containerInfo)}catch(De){fn(i,i.return,De)}fc&&(fc=!1,ol(i));break;case 4:p=Nr,Nr=Ge(i.stateNode.containerInfo),pi(a,i),Gs(i),Nr=p;break;case 12:pi(a,i),Gs(i);break;case 31:pi(a,i),Gs(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,nh(i,p)));break;case 13:pi(a,i),Gs(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(xc=ia()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,nh(i,p)));break;case 22:w=i.memoizedState!==null;var mt=l!==null&&l.memoizedState!==null,Bt=rl,Yt=ba;if(rl=Bt||w,ba=Yt||mt,pi(a,i),ba=Yt,rl=Bt,Gs(i),p&8192)t:for(a=i.stateNode,a._visibility=w?a._visibility&-2:a._visibility|1,w&&(l===null||mt||rl||ba||uu(i)),l=null,a=i;;){if(a.tag===5||a.tag===26){if(l===null){mt=l=a;try{if(M=mt.stateNode,w)U=M.style,typeof U.setProperty=="function"?U.setProperty("display","none","important"):U.display="none";else{Q=mt.stateNode;var te=mt.memoizedProps.style,Ut=te!=null&&te.hasOwnProperty("display")?te.display:null;Q.style.display=Ut==null||typeof Ut=="boolean"?"":(""+Ut).trim()}}catch(De){fn(mt,mt.return,De)}}}else if(a.tag===6){if(l===null){mt=a;try{mt.stateNode.nodeValue=w?"":mt.memoizedProps}catch(De){fn(mt,mt.return,De)}}}else if(a.tag===18){if(l===null){mt=a;try{var qt=mt.stateNode;w?ut(qt,!0):ut(mt.stateNode,!1)}catch(De){fn(mt,mt.return,De)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break t;for(;a.sibling===null;){if(a.return===null||a.return===i)break t;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}p&4&&(p=i.updateQueue,p!==null&&(l=p.retryQueue,l!==null&&(p.retryQueue=null,nh(i,l))));break;case 19:pi(a,i),Gs(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,nh(i,p)));break;case 30:break;case 21:break;default:pi(a,i),Gs(i)}}function Gs(i){var a=i.flags;if(a&2){try{for(var l,p=i.return;p!==null;){if($d(p)){l=p;break}p=p.return}if(l==null)throw Error(k(160));switch(l.tag){case 27:var w=l.stateNode,M=Zh(i);ih(i,M,w);break;case 5:var U=l.stateNode;l.flags&32&&(as(U,""),l.flags&=-33);var Q=Zh(i);ih(i,Q,U);break;case 3:case 4:var mt=l.stateNode.containerInfo,Bt=Zh(i);eh(i,Bt,mt);break;default:throw Error(k(161))}}catch(Yt){fn(i,i.return,Yt)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function ol(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;ol(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function pr(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Kd(i,a.alternate,a),a=a.sibling}function uu(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:oo(4,a,a.return),uu(a);break;case 1:sl(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&Hd(a,a.return,l),uu(a);break;case 27:Gt(a.stateNode);case 26:case 5:sl(a,a.return),uu(a);break;case 22:a.memoizedState===null&&uu(a);break;case 30:uu(a);break;default:uu(a)}i=i.sibling}}function Pl(i,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var p=a.alternate,w=i,M=a,U=M.flags;switch(M.tag){case 0:case 11:case 15:Pl(w,M,l),Qc(4,M);break;case 1:if(Pl(w,M,l),p=M,w=p.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(Bt){fn(p,p.return,Bt)}if(p=M,w=p.updateQueue,w!==null){var Q=p.stateNode;try{var mt=w.shared.hiddenCallbacks;if(mt!==null)for(w.shared.hiddenCallbacks=null,w=0;w<mt.length;w++)li(mt[w],Q)}catch(Bt){fn(p,p.return,Bt)}}l&&U&64&&Bf(M),th(M,M.return);break;case 27:Ff(M);case 26:case 5:Pl(w,M,l),l&&p===null&&U&4&&Xd(M),th(M,M.return);break;case 12:Pl(w,M,l);break;case 31:Pl(w,M,l),l&&U&4&&la(w,M);break;case 13:Pl(w,M,l),l&&U&4&&Uf(w,M);break;case 22:M.memoizedState===null&&Pl(w,M,l),th(M,M.return);break;case 30:break;default:Pl(w,M,l)}a=a.sibling}}function jf(i,a){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&Oo(l))}function Vf(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&Oo(i))}function Uo(i,a,l,p){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Qd(i,a,l,p),a=a.sibling}function Qd(i,a,l,p){var w=a.flags;switch(a.tag){case 0:case 11:case 15:Uo(i,a,l,p),w&2048&&Qc(9,a);break;case 1:Uo(i,a,l,p);break;case 3:Uo(i,a,l,p),w&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&Oo(i)));break;case 12:if(w&2048){Uo(i,a,l,p),i=a.stateNode;try{var M=a.memoizedProps,U=M.id,Q=M.onPostCommit;typeof Q=="function"&&Q(U,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(mt){fn(a,a.return,mt)}}else Uo(i,a,l,p);break;case 31:Uo(i,a,l,p);break;case 13:Uo(i,a,l,p);break;case 23:break;case 22:M=a.stateNode,U=a.alternate,a.memoizedState!==null?M._visibility&2?Uo(i,a,l,p):ah(i,a):M._visibility&2?Uo(i,a,l,p):(M._visibility|=2,pc(i,a,l,p,(a.subtreeFlags&10256)!==0||!1)),w&2048&&jf(U,a);break;case 24:Uo(i,a,l,p),w&2048&&Vf(a.alternate,a);break;default:Uo(i,a,l,p)}}function pc(i,a,l,p,w){for(w=w&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var M=i,U=a,Q=l,mt=p,Bt=U.flags;switch(U.tag){case 0:case 11:case 15:pc(M,U,Q,mt,w),Qc(8,U);break;case 23:break;case 22:var Yt=U.stateNode;U.memoizedState!==null?Yt._visibility&2?pc(M,U,Q,mt,w):ah(M,U):(Yt._visibility|=2,pc(M,U,Q,mt,w)),w&&Bt&2048&&jf(U.alternate,U);break;case 24:pc(M,U,Q,mt,w),w&&Bt&2048&&Vf(U.alternate,U);break;default:pc(M,U,Q,mt,w)}a=a.sibling}}function ah(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=i,p=a,w=p.flags;switch(p.tag){case 22:ah(l,p),w&2048&&jf(p.alternate,p);break;case 24:ah(l,p),w&2048&&Vf(p.alternate,p);break;default:ah(l,p)}a=a.sibling}}var sh=8192;function mc(i,a,l){if(i.subtreeFlags&sh)for(i=i.child;i!==null;)rh(i,a,l),i=i.sibling}function rh(i,a,l){switch(i.tag){case 26:mc(i,a,l),i.flags&sh&&i.memoizedState!==null&&kl(l,Nr,i.memoizedState,i.memoizedProps);break;case 5:mc(i,a,l);break;case 3:case 4:var p=Nr;Nr=Ge(i.stateNode.containerInfo),mc(i,a,l),Nr=p;break;case 22:i.memoizedState===null&&(p=i.alternate,p!==null&&p.memoizedState!==null?(p=sh,sh=16777216,mc(i,a,l),sh=p):mc(i,a,l));break;default:mc(i,a,l)}}function Bu(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function _c(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var p=a[l];Oa=p,tp(p,i)}Bu(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)jh(i),i=i.sibling}function jh(i){switch(i.tag){case 0:case 11:case 15:_c(i),i.flags&2048&&oo(9,i,i.return);break;case 3:_c(i);break;case 12:_c(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,gc(i)):_c(i);break;default:_c(i)}}function gc(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var p=a[l];Oa=p,tp(p,i)}Bu(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:oo(8,a,a.return),gc(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,gc(a));break;default:gc(a)}i=i.sibling}}function tp(i,a){for(;Oa!==null;){var l=Oa;switch(l.tag){case 0:case 11:case 15:oo(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var p=l.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Oo(l.memoizedState.cache)}if(p=l.child,p!==null)p.return=l,Oa=p;else t:for(l=i;Oa!==null;){p=Oa;var w=p.sibling,M=p.return;if(Wd(p),p===l){Oa=null;break t}if(w!==null){w.return=M,Oa=w;break t}Oa=M}}}var qp={getCacheForType:function(i){var a=fi(Pn),l=a.data.get(i);return l===void 0&&(l=i(),a.data.set(i,l)),l},cacheSignal:function(){return fi(Pn).controller.signal}},Gp=typeof WeakMap=="function"?WeakMap:Map,en=0,En=null,ti=null,ki=0,hn=0,wa=null,lo=!1,ll=!1,cu=!1,uo=0,Fn=0,hu=0,Nu=0,Vh=0,mr=0,yc=0,vc=null,Hs=null,oh=!1,xc=0,ep=0,qh=1/0,lh=null,Dl=null,ta=0,ds=null,Fr=null,ul=0,uh=0,qf=null,ip=null,fu=0,ch=null;function Ur(){return(en&2)!==0&&ki!==0?ki&-ki:Vt.T!==null?Ec():ze()}function Gh(){if(mr===0)if((ki&536870912)===0||Qt){var i=ys;ys<<=1,(ys&3932160)===0&&(ys=262144),mr=i}else mr=536870912;return i=gn.current,i!==null&&(i.flags|=32),mr}function Cs(i,a,l){(i===En&&(hn===2||hn===9)||i.cancelPendingCommit!==null)&&(Uu(i,0),cl(i,ki,mr,!1)),yt(i,l),((en&2)===0||i!==En)&&(i===En&&((en&2)===0&&(Nu|=l),Fn===4&&cl(i,ki,mr,!1)),hl(i))}function Fu(i,a,l){if((en&6)!==0)throw Error(k(327));var p=!l&&(a&127)===0&&(a&i.expiredLanes)===0||G(i,a),w=p?$f(i,a):Xf(i,a,!0),M=p;do{if(w===0){ll&&!p&&cl(i,a,0,!1);break}else{if(l=i.current.alternate,M&&!np(l)){w=Xf(i,a,!1),M=!1;continue}if(w===2){if(M=a,i.errorRecoveryDisabledLanes&M)var U=0;else U=i.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){a=U;t:{var Q=i;w=vc;var mt=Q.current.memoizedState.isDehydrated;if(mt&&(Uu(Q,U).flags|=256),U=Xf(Q,U,!1),U!==2){if(cu&&!mt){Q.errorRecoveryDisabledLanes|=M,Nu|=M,w=4;break t}M=Hs,Hs=w,M!==null&&(Hs===null?Hs=M:Hs.push.apply(Hs,M))}w=U}if(M=!1,w!==2)continue}}if(w===1){Uu(i,0),cl(i,a,0,!0);break}t:{switch(p=i,M=w,M){case 0:case 1:throw Error(k(345));case 4:if((a&4194048)!==a)break;case 6:cl(p,a,mr,!lo);break t;case 2:Hs=null;break;case 3:case 5:break;default:throw Error(k(329))}if((a&62914560)===a&&(w=xc+300-ia(),10<w)){if(cl(p,a,mr,!lo),H(p,0,!0)!==0)break t;ul=a,p.timeoutHandle=R(Gf.bind(null,p,l,Hs,lh,oh,a,mr,Nu,yc,lo,M,"Throttled",-0,0),w);break t}Gf(p,l,Hs,lh,oh,a,mr,Nu,yc,lo,M,null,-0,0)}}break}while(!0);hl(i)}function Gf(i,a,l,p,w,M,U,Q,mt,Bt,Yt,te,Ut,qt){if(i.timeoutHandle=-1,te=a.subtreeFlags,te&8192||(te&16785408)===16785408){te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:na},rh(a,M,te);var De=(M&62914560)===M?xc-ia():(M&4194048)===M?ep-ia():0;if(De=pp(te,De),De!==null){ul=M,i.cancelPendingCommit=De(Xh.bind(null,i,a,M,l,p,w,U,Q,mt,Yt,te,null,Ut,qt)),cl(i,M,U,!Bt);return}}Xh(i,a,M,l,p,w,U,Q,mt)}function np(i){for(var a=i;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var p=0;p<l.length;p++){var w=l[p],M=w.getSnapshot;w=w.value;try{if(!ra(M(),w))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function cl(i,a,l,p){a&=~Vh,a&=~Nu,i.suspendedLanes|=a,i.pingedLanes&=~a,p&&(i.warmLanes|=a),p=i.expirationTimes;for(var w=a;0<w;){var M=31-un(w),U=1<<M;p[M]=-1,w&=~U}l!==0&&ft(i,l,a)}function hh(){return(en&6)===0?(Tc(0),!1):!0}function bc(){if(ti!==null){if(hn===0)var i=ti.return;else i=ti,or=hs=null,Ql(i),ht=null,pt=0,i=ti;for(;i!==null;)Gd(i.alternate,i),i=i.return;ti=null}}function Uu(i,a){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,F(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),ul=0,bc(),En=i,ti=l=ls(i.current,null),ki=a,hn=0,wa=null,lo=!1,ll=G(i,a),cu=!1,yc=mr=Vh=Nu=hu=Fn=0,Hs=vc=null,oh=!1,(a&8)!==0&&(a|=a&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=a;0<p;){var w=31-un(p),M=1<<w;a|=i[w],p&=~M}return uo=a,Da(),l}function ap(i,a){$e=null,Vt.H=$c,a===z||a===B?(a=rt(),hn=3):a===P?(a=rt(),hn=4):hn=a===On?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,wa=a,ti===null&&(Fn=1,Oh(i,d(a,i.current)))}function sp(){var i=gn.current;return i===null?!0:(ki&4194048)===ki?yn===null:(ki&62914560)===ki||(ki&536870912)!==0?i===yn:!1}function Hf(){var i=Vt.H;return Vt.H=$c,i===null?$c:i}function rp(){var i=Vt.A;return Vt.A=qp,i}function Hh(){Fn=4,lo||(ki&4194048)!==ki&&gn.current!==null||(ll=!0),(hu&134217727)===0&&(Nu&134217727)===0||En===null||cl(En,ki,mr,!1)}function Xf(i,a,l){var p=en;en|=2;var w=Hf(),M=rp();(En!==i||ki!==a)&&(lh=null,Uu(i,a)),a=!1;var U=Fn;t:do try{if(hn!==0&&ti!==null){var Q=ti,mt=wa;switch(hn){case 8:bc(),U=6;break t;case 3:case 2:case 9:case 6:gn.current===null&&(a=!0);var Bt=hn;if(hn=0,wa=null,Zu(i,Q,mt,Bt),l&&ll){U=0;break t}break;default:Bt=hn,hn=0,wa=null,Zu(i,Q,mt,Bt)}}Hp(),U=Fn;break}catch(Yt){ap(i,Yt)}while(!0);return a&&i.shellSuspendCounter++,or=hs=null,en=p,Vt.H=w,Vt.A=M,ti===null&&(En=null,ki=0,Da()),U}function Hp(){for(;ti!==null;)Yf(ti)}function $f(i,a){var l=en;en|=2;var p=Hf(),w=rp();En!==i||ki!==a?(lh=null,qh=ia()+500,Uu(i,a)):ll=G(i,a);t:do try{if(hn!==0&&ti!==null){a=ti;var M=wa;e:switch(hn){case 1:hn=0,wa=null,Zu(i,a,M,1);break;case 2:case 9:if(j(M)){hn=0,wa=null,Kf(a);break}a=function(){hn!==2&&hn!==9||En!==i||(hn=7),hl(i)},M.then(a,a);break t;case 3:hn=7;break t;case 4:hn=5;break t;case 7:j(M)?(hn=0,wa=null,Kf(a)):(hn=0,wa=null,Zu(i,a,M,7));break;case 5:var U=null;switch(ti.tag){case 26:U=ti.memoizedState;case 5:case 27:var Q=ti;if(U?Ma(U):Q.stateNode.complete){hn=0,wa=null;var mt=Q.sibling;if(mt!==null)ti=mt;else{var Bt=Q.return;Bt!==null?(ti=Bt,fh(Bt)):ti=null}break e}}hn=0,wa=null,Zu(i,a,M,5);break;case 6:hn=0,wa=null,Zu(i,a,M,6);break;case 8:bc(),Fn=6;break t;default:throw Error(k(462))}}du();break}catch(Yt){ap(i,Yt)}while(!0);return or=hs=null,Vt.H=p,Vt.A=w,en=l,ti!==null?0:(En=null,ki=0,Da(),Fn)}function du(){for(;ti!==null&&!Ar();)Yf(ti)}function Yf(i){var a=Vd(i.alternate,i,uo);i.memoizedProps=i.pendingProps,a===null?fh(i):ti=a}function Kf(i){var a=i,l=a.alternate;switch(a.tag){case 15:case 0:a=Lf(l,a,a.pendingProps,a.type,void 0,ki);break;case 11:a=Lf(l,a,a.pendingProps,a.type.render,a.ref,ki);break;case 5:Ql(a);default:Gd(l,a),a=ti=yl(a,uo),a=Vd(l,a,uo)}i.memoizedProps=i.pendingProps,a===null?fh(i):ti=a}function Zu(i,a,l,p){or=hs=null,Ql(a),ht=null,pt=0;var w=a.return;try{if(Up(i,w,a,l,ki)){Fn=1,Oh(i,d(l,i.current)),ti=null;return}}catch(M){if(w!==null)throw ti=w,M;Fn=1,Oh(i,d(l,i.current)),ti=null;return}a.flags&32768?(Qt||p===1?i=!0:ll||(ki&536870912)!==0?i=!1:(lo=i=!0,(p===2||p===9||p===3||p===6)&&(p=gn.current,p!==null&&p.tag===13&&(p.flags|=16384))),Wf(a,i)):fh(a)}function fh(i){var a=i;do{if((a.flags&32768)!==0){Wf(a,lo);return}i=a.return;var l=jp(a.alternate,a,uo);if(l!==null){ti=l;return}if(a=a.sibling,a!==null){ti=a;return}ti=a=i}while(a!==null);Fn===0&&(Fn=5)}function Wf(i,a){do{var l=qd(i.alternate,i);if(l!==null){l.flags&=32767,ti=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(i=i.sibling,i!==null)){ti=i;return}ti=i=l}while(i!==null);Fn=6,ti=null}function Xh(i,a,l,p,w,M,U,Q,mt){i.cancelPendingCommit=null;do Ls();while(ta!==0);if((en&6)!==0)throw Error(k(327));if(a!==null){if(a===i.current)throw Error(k(177));if(M=a.lanes|a.childLanes,M|=_n,zt(i,l,M,U,Q,mt),i===En&&(ti=En=null,ki=0),Fr=a,ds=i,ul=l,uh=M,qf=w,ip=p,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,up(ie,function(){return Sc(),null})):(i.callbackNode=null,i.callbackPriority=0),p=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||p){p=Vt.T,Vt.T=null,w=ce.p,ce.p=2,U=en,en|=4;try{Vp(i,a,l)}finally{en=U,ce.p=w,Vt.T=p}}ta=1,wc(),Jf(),$h()}}function wc(){if(ta===1){ta=0;var i=ds,a=Fr,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=Vt.T,Vt.T=null;var p=ce.p;ce.p=2;var w=en;en|=4;try{Zf(a,i);var M=u,U=sr(i.containerInfo),Q=M.focusedElem,mt=M.selectionRange;if(U!==Q&&Q&&Q.ownerDocument&&ml(Q.ownerDocument.documentElement,Q)){if(mt!==null&&Ir(Q)){var Bt=mt.start,Yt=mt.end;if(Yt===void 0&&(Yt=Bt),"selectionStart"in Q)Q.selectionStart=Bt,Q.selectionEnd=Math.min(Yt,Q.value.length);else{var te=Q.ownerDocument||document,Ut=te&&te.defaultView||window;if(Ut.getSelection){var qt=Ut.getSelection(),De=Q.textContent.length,ni=Math.min(mt.start,De),Dn=mt.end===void 0?ni:Math.min(mt.end,De);!qt.extend&&ni>Dn&&(U=Dn,Dn=ni,ni=U);var Lt=pl(Q,ni),xt=pl(Q,Dn);if(Lt&&xt&&(qt.rangeCount!==1||qt.anchorNode!==Lt.node||qt.anchorOffset!==Lt.offset||qt.focusNode!==xt.node||qt.focusOffset!==xt.offset)){var kt=te.createRange();kt.setStart(Lt.node,Lt.offset),qt.removeAllRanges(),ni>Dn?(qt.addRange(kt),qt.extend(xt.node,xt.offset)):(kt.setEnd(xt.node,xt.offset),qt.addRange(kt))}}}}for(te=[],qt=Q;qt=qt.parentNode;)qt.nodeType===1&&te.push({element:qt,left:qt.scrollLeft,top:qt.scrollTop});for(typeof Q.focus=="function"&&Q.focus(),Q=0;Q<te.length;Q++){var Jt=te[Q];Jt.element.scrollLeft=Jt.left,Jt.element.scrollTop=Jt.top}}nf=!!s,u=s=null}finally{en=w,ce.p=p,Vt.T=l}}i.current=a,ta=2}}function Jf(){if(ta===2){ta=0;var i=ds,a=Fr,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=Vt.T,Vt.T=null;var p=ce.p;ce.p=2;var w=en;en|=4;try{Kd(i,a.alternate,a)}finally{en=w,ce.p=p,Vt.T=l}}ta=3}}function $h(){if(ta===4||ta===3){ta=0,Ks();var i=ds,a=Fr,l=ul,p=ip;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?ta=5:(ta=0,Fr=ds=null,Qf(i,i.pendingLanes));var w=i.pendingLanes;if(w===0&&(Dl=null),Ft(l),a=a.stateNode,ke&&typeof ke.onCommitFiberRoot=="function")try{ke.onCommitFiberRoot(oe,a,void 0,(a.current.flags&128)===128)}catch{}if(p!==null){a=Vt.T,w=ce.p,ce.p=2,Vt.T=null;try{for(var M=i.onRecoverableError,U=0;U<p.length;U++){var Q=p[U];M(Q.value,{componentStack:Q.stack})}}finally{Vt.T=a,ce.p=w}}(ul&3)!==0&&Ls(),hl(i),w=i.pendingLanes,(l&261930)!==0&&(w&42)!==0?i===ch?fu++:(fu=0,ch=i):fu=0,Tc(0)}}function Qf(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,Oo(a)))}function Ls(){return wc(),Jf(),$h(),Sc()}function Sc(){if(ta!==5)return!1;var i=ds,a=uh;uh=0;var l=Ft(ul),p=Vt.T,w=ce.p;try{ce.p=32>l?32:l,Vt.T=null,l=qf,qf=null;var M=ds,U=ul;if(ta=0,Fr=ds=null,ul=0,(en&6)!==0)throw Error(k(331));var Q=en;if(en|=4,jh(M.current),Qd(M,M.current,U,l),en=Q,Tc(0,!1),ke&&typeof ke.onPostCommitFiberRoot=="function")try{ke.onPostCommitFiberRoot(oe,M)}catch{}return!0}finally{ce.p=w,Vt.T=p,Qf(i,a)}}function td(i,a,l){a=d(l,a),a=Yc(i.stateNode,a,2),i=we(i,a,2),i!==null&&(yt(i,2),hl(i))}function fn(i,a,l){if(i.tag===3)td(i,i,l);else for(;a!==null;){if(a.tag===3){td(a,i,l);break}else if(a.tag===1){var p=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Dl===null||!Dl.has(p))){i=d(l,i),l=Nd(2),p=we(a,l,2),p!==null&&(Ru(l,p,a,i),yt(p,2),hl(p));break}}a=a.return}}function Yh(i,a,l){var p=i.pingCache;if(p===null){p=i.pingCache=new Gp;var w=new Set;p.set(a,w)}else w=p.get(a),w===void 0&&(w=new Set,p.set(a,w));w.has(l)||(cu=!0,w.add(l),i=op.bind(null,i,a,l),a.then(i,i))}function op(i,a,l){var p=i.pingCache;p!==null&&p.delete(a),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,En===i&&(ki&l)===l&&(Fn===4||Fn===3&&(ki&62914560)===ki&&300>ia()-xc?(en&2)===0&&Uu(i,0):Vh|=l,yc===ki&&(yc=0)),hl(i)}function ed(i,a){a===0&&(a=at()),i=Ms(i,a),i!==null&&(yt(i,a),hl(i))}function lp(i){var a=i.memoizedState,l=0;a!==null&&(l=a.retryLane),ed(i,l)}function Xp(i,a){var l=0;switch(i.tag){case 31:case 13:var p=i.stateNode,w=i.memoizedState;w!==null&&(l=w.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(k(314))}p!==null&&p.delete(a),ed(i,l)}function up(i,a){return ln(i,a)}var Zo=null,ju=null,Kh=!1,dh=!1,Wh=!1,pu=0;function hl(i){i!==ju&&i.next===null&&(ju===null?Zo=ju=i:ju=ju.next=i),dh=!0,Kh||(Kh=!0,Jh())}function Tc(i,a){if(!Wh&&dh){Wh=!0;do for(var l=!1,p=Zo;p!==null;){if(i!==0){var w=p.pendingLanes;if(w===0)var M=0;else{var U=p.suspendedLanes,Q=p.pingedLanes;M=(1<<31-un(42|i)+1)-1,M&=w&~(U&~Q),M=M&201326741?M&201326741|1:M?M|2:0}M!==0&&(l=!0,mh(p,M))}else M=ki,M=H(p,p===En?M:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(M&3)===0||G(p,M)||(l=!0,mh(p,M));p=p.next}while(l);Wh=!1}}function Ac(){id()}function id(){dh=Kh=!1;var i=0;pu!==0&&D()&&(i=pu);for(var a=ia(),l=null,p=Zo;p!==null;){var w=p.next,M=ph(p,a);M===0?(p.next=null,l===null?Zo=w:l.next=w,w===null&&(ju=l)):(l=p,(i!==0||(M&3)!==0)&&(dh=!0)),p=w}ta!==0&&ta!==5||Tc(i),pu!==0&&(pu=0)}function ph(i,a){for(var l=i.suspendedLanes,p=i.pingedLanes,w=i.expirationTimes,M=i.pendingLanes&-62914561;0<M;){var U=31-un(M),Q=1<<U,mt=w[U];mt===-1?((Q&l)===0||(Q&p)!==0)&&(w[U]=tt(Q,a)):mt<=a&&(i.expiredLanes|=Q),M&=~Q}if(a=En,l=ki,l=H(i,i===a?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p=i.callbackNode,l===0||i===a&&(hn===2||hn===9)||i.cancelPendingCommit!==null)return p!==null&&p!==null&&Tr(p),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||G(i,l)){if(a=l&-l,a===i.callbackPriority)return a;switch(p!==null&&Tr(p),Ft(l)){case 2:case 8:l=co;break;case 32:l=ie;break;case 268435456:l=ha;break;default:l=ie}return p=nd.bind(null,i),l=ln(l,p),i.callbackPriority=a,i.callbackNode=l,a}return p!==null&&p!==null&&Tr(p),i.callbackPriority=2,i.callbackNode=null,2}function nd(i,a){if(ta!==0&&ta!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(Ls()&&i.callbackNode!==l)return null;var p=ki;return p=H(i,i===En?p:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),p===0?null:(Fu(i,p,a),ph(i,ia()),i.callbackNode!=null&&i.callbackNode===l?nd.bind(null,i):null)}function mh(i,a){if(Ls())return null;Fu(i,a,!0)}function Jh(){X(function(){(en&6)!==0?ln(qr,Ac):id()})}function Ec(){if(pu===0){var i=Bo;i===0&&(i=ts,ts<<=1,(ts&261888)===0&&(ts=256)),pu=i}return pu}function cp(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Xo(""+i)}function hp(i,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,i.id&&l.setAttribute("form",i.id),a.parentNode.insertBefore(l,a),i=new FormData(i),l.parentNode.removeChild(l),i}function $p(i,a,l,p,w){if(a==="submit"&&l&&l.stateNode===w){var M=cp((w[Ye]||null).action),U=p.submitter;U&&(a=(a=U[Ye]||null)?cp(a.formAction):U.getAttribute("formAction"),a!==null&&(M=a,U=null));var Q=new Zl("action","action",null,p,w);i.push({event:Q,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(pu!==0){var mt=U?hp(w,U):new FormData(w);Ph(l,{pending:!0,data:mt,method:w.method,action:M},null,mt)}}else typeof M=="function"&&(Q.preventDefault(),mt=U?hp(w,U):new FormData(w),Ph(l,{pending:!0,data:mt,method:w.method,action:M},M,mt))},currentTarget:w}]})}}for(var mu=0;mu<Es.length;mu++){var Sa=Es[mu],_u=Sa.toLowerCase(),ad=Sa[0].toUpperCase()+Sa.slice(1);sn(_u,"on"+ad)}sn(eo,"onAnimationEnd"),sn(gl,"onAnimationIteration"),sn(Co,"onAnimationStart"),sn("dblclick","onDoubleClick"),sn("focusin","onFocus"),sn("focusout","onBlur"),sn(Bc,"onTransitionRun"),sn(Au,"onTransitionStart"),sn(Yl,"onTransitionCancel"),sn(io,"onTransitionEnd"),Hr("onMouseEnter",["mouseout","mouseover"]),Hr("onMouseLeave",["mouseout","mouseover"]),Hr("onPointerEnter",["pointerout","pointerover"]),Hr("onPointerLeave",["pointerout","pointerover"]),Kn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mc));function Qh(i,a){a=(a&4)!==0;for(var l=0;l<i.length;l++){var p=i[l],w=p.event;p=p.listeners;t:{var M=void 0;if(a)for(var U=p.length-1;0<=U;U--){var Q=p[U],mt=Q.instance,Bt=Q.currentTarget;if(Q=Q.listener,mt!==M&&w.isPropagationStopped())break t;M=Q,w.currentTarget=Bt;try{M(w)}catch(Yt){Vs(Yt)}w.currentTarget=null,M=mt}else for(U=0;U<p.length;U++){if(Q=p[U],mt=Q.instance,Bt=Q.currentTarget,Q=Q.listener,mt!==M&&w.isPropagationStopped())break t;M=Q,w.currentTarget=Bt;try{M(w)}catch(Yt){Vs(Yt)}w.currentTarget=null,M=mt}}}}function Oi(i,a){var l=a[nn];l===void 0&&(l=a[nn]=new Set);var p=i+"__bubble";l.has(p)||(rd(a,i,2,!1),l.add(p))}function tf(i,a,l){var p=0;a&&(p|=4),rd(l,i,p,a)}var _h="_reactListening"+Math.random().toString(36).slice(2);function sd(i){if(!i[_h]){i[_h]=!0,Ol.forEach(function(l){l!=="selectionchange"&&(fp.has(l)||tf(l,!1,i),tf(l,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[_h]||(a[_h]=!0,tf("selectionchange",!1,a))}}function rd(i,a,l,p){switch(Ka(a)){case 2:var w=Vo;break;case 8:w=af;break;default:w=sf}l=w.bind(null,a,l,i),w=void 0,!$o||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(w=!0),p?w!==void 0?i.addEventListener(a,l,{capture:!0,passive:w}):i.addEventListener(a,l,!0):w!==void 0?i.addEventListener(a,l,{passive:w}):i.addEventListener(a,l,!1)}function gh(i,a,l,p,w){var M=p;if((a&1)===0&&(a&2)===0&&p!==null)t:for(;;){if(p===null)return;var U=p.tag;if(U===3||U===4){var Q=p.stateNode.containerInfo;if(Q===w)break;if(U===4)for(U=p.return;U!==null;){var mt=U.tag;if((mt===3||mt===4)&&U.stateNode.containerInfo===w)return;U=U.return}for(;Q!==null;){if(U=Mn(Q),U===null)return;if(mt=U.tag,mt===5||mt===6||mt===26||mt===27){p=M=U;continue t}Q=Q.parentNode}}p=p.return}Fl(function(){var Bt=M,Yt=aa(l),te=[];t:{var Ut=tl.get(i);if(Ut!==void 0){var qt=Zl,De=i;switch(i){case"keypress":if(mo(l)===0)break t;case"keydown":case"keyup":qt=Wu;break;case"focusin":De="focus",qt=jl;break;case"focusout":De="blur",qt=jl;break;case"beforeblur":case"afterblur":qt=jl;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qt=_o;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qt=Hu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qt=Ju;break;case eo:case gl:case Co:qt=Vl;break;case io:qt=Su;break;case"scroll":case"scrollend":qt=hi;break;case"wheel":qt=Ia;break;case"copy":case"cut":case"paste":qt=Fs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qt=wu;break;case"toggle":case"beforetoggle":qt=vo}var ni=(a&4)!==0,Dn=!ni&&(i==="scroll"||i==="scrollend"),Lt=ni?Ut!==null?Ut+"Capture":null:Ut;ni=[];for(var xt=Bt,kt;xt!==null;){var Jt=xt;if(kt=Jt.stateNode,Jt=Jt.tag,Jt!==5&&Jt!==26&&Jt!==27||kt===null||Lt===null||(Jt=vs(xt,Lt),Jt!=null&&ni.push(Vu(xt,Jt,kt))),Dn)break;xt=xt.return}0<ni.length&&(Ut=new qt(Ut,De,null,l,Yt),te.push({event:Ut,listeners:ni}))}}if((a&7)===0){t:{if(Ut=i==="mouseover"||i==="pointerover",qt=i==="mouseout"||i==="pointerout",Ut&&l!==Yr&&(De=l.relatedTarget||l.fromElement)&&(Mn(De)||De[ii]))break t;if((qt||Ut)&&(Ut=Yt.window===Yt?Yt:(Ut=Yt.ownerDocument)?Ut.defaultView||Ut.parentWindow:window,qt?(De=l.relatedTarget||l.toElement,qt=Bt,De=De?Mn(De):null,De!==null&&(Dn=it(De),ni=De.tag,De!==Dn||ni!==5&&ni!==27&&ni!==6)&&(De=null)):(qt=null,De=Bt),qt!==De)){if(ni=_o,Jt="onMouseLeave",Lt="onMouseEnter",xt="mouse",(i==="pointerout"||i==="pointerover")&&(ni=wu,Jt="onPointerLeave",Lt="onPointerEnter",xt="pointer"),Dn=qt==null?Ut:es(qt),kt=De==null?Ut:es(De),Ut=new ni(Jt,xt+"leave",qt,l,Yt),Ut.target=Dn,Ut.relatedTarget=kt,Jt=null,Mn(Yt)===Bt&&(ni=new ni(Lt,xt+"enter",De,l,Yt),ni.target=kt,ni.relatedTarget=Dn,Jt=ni),Dn=Jt,qt&&De)e:{for(ni=vh,Lt=qt,xt=De,kt=0,Jt=Lt;Jt;Jt=ni(Jt))kt++;Jt=0;for(var Je=xt;Je;Je=ni(Je))Jt++;for(;0<kt-Jt;)Lt=ni(Lt),kt--;for(;0<Jt-kt;)xt=ni(xt),Jt--;for(;kt--;){if(Lt===xt||xt!==null&&Lt===xt.alternate){ni=Lt;break e}Lt=ni(Lt),xt=ni(xt)}ni=null}else ni=null;qt!==null&&ef(te,Ut,qt,ni,!1),De!==null&&Dn!==null&&ef(te,Dn,De,ni,!0)}}t:{if(Ut=Bt?es(Bt):window,qt=Ut.nodeName&&Ut.nodeName.toLowerCase(),qt==="select"||qt==="input"&&Ut.type==="file")var pn=So;else if(Ga(Ut))if(Xl)pn=Jo;else{pn=$l;var Ne=ss}else qt=Ut.nodeName,!qt||qt.toLowerCase()!=="input"||Ut.type!=="checkbox"&&Ut.type!=="radio"?Bt&&Ho(Bt.elementType)&&(pn=So):pn=Zs;if(pn&&(pn=pn(i,Bt))){Ko(te,pn,l,Yt);break t}Ne&&Ne(i,Ut,Bt),i==="focusout"&&Bt&&Ut.type==="number"&&Bt.memoizedProps.value!=null&&Bs(Ut,"number",Ut.value)}switch(Ne=Bt?es(Bt):window,i){case"focusin":(Ga(Ne)||Ne.contentEditable==="true")&&(Pr=Ne,_l=Bt,to=null);break;case"focusout":to=_l=Pr=null;break;case"mousedown":Dr=!0;break;case"contextmenu":case"mouseup":case"dragend":Dr=!1,Mo(te,l,Yt);break;case"selectionchange":if(Eo)break;case"keydown":case"keyup":Mo(te,l,Yt)}var Ii;if(xo)t:{switch(i){case"compositionstart":var Hi="onCompositionStart";break t;case"compositionend":Hi="onCompositionEnd";break t;case"compositionupdate":Hi="onCompositionUpdate";break t}Hi=void 0}else Lr?Qu(i,l)&&(Hi="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Hi="onCompositionStart");Hi&&(Yo&&l.locale!=="ko"&&(Lr||Hi!=="onCompositionStart"?Hi==="onCompositionEnd"&&Lr&&(Ii=bs()):(er=Yt,po="value"in er?er.value:er.textContent,Lr=!0)),Ne=yh(Bt,Hi),0<Ne.length&&(Hi=new zr(Hi,i,null,l,Yt),te.push({event:Hi,listeners:Ne}),Ii?Hi.data=Ii:(Ii=oi(l),Ii!==null&&(Hi.data=Ii)))),(Ii=bo?Si(i,l):Di(i,l))&&(Hi=yh(Bt,"onBeforeInput"),0<Hi.length&&(Ne=new zr("onBeforeInput","beforeinput",null,l,Yt),te.push({event:Ne,listeners:Hi}),Ne.data=Ii)),$p(te,i,Bt,l,Yt)}Qh(te,a)})}function Vu(i,a,l){return{instance:i,listener:a,currentTarget:l}}function yh(i,a){for(var l=a+"Capture",p=[];i!==null;){var w=i,M=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||M===null||(w=vs(i,l),w!=null&&p.unshift(Vu(i,w,M)),w=vs(i,a),w!=null&&p.push(Vu(i,w,M))),i.tag===3)return p;i=i.return}return[]}function vh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function ef(i,a,l,p,w){for(var M=a._reactName,U=[];l!==null&&l!==p;){var Q=l,mt=Q.alternate,Bt=Q.stateNode;if(Q=Q.tag,mt!==null&&mt===p)break;Q!==5&&Q!==26&&Q!==27||Bt===null||(mt=Bt,w?(Bt=vs(l,M),Bt!=null&&U.unshift(Vu(l,Bt,mt))):w||(Bt=vs(l,M),Bt!=null&&U.push(Vu(l,Bt,mt)))),l=l.return}U.length!==0&&i.push({event:a,listeners:U})}var dp=/\r\n?/g,od=/\u0000|\uFFFD/g;function xh(i){return(typeof i=="string"?i:""+i).replace(dp,`
`).replace(od,"")}function zc(i,a){return a=xh(a),xh(i)===a}function dn(i,a,l,p,w,M){switch(l){case"children":typeof p=="string"?a==="body"||a==="textarea"&&p===""||as(i,p):(typeof p=="number"||typeof p=="bigint")&&a!=="body"&&as(i,""+p);break;case"className":qi(i,"class",p);break;case"tabIndex":qi(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":qi(i,l,p);break;case"style":Mr(i,p,M);break;case"data":if(a!=="object"){qi(i,"data",p);break}case"src":case"href":if(p===""&&(a!=="a"||l!=="href")){i.removeAttribute(l);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(l);break}p=Xo(""+p),i.setAttribute(l,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof M=="function"&&(l==="formAction"?(a!=="input"&&dn(i,a,"name",w.name,w,null),dn(i,a,"formEncType",w.formEncType,w,null),dn(i,a,"formMethod",w.formMethod,w,null),dn(i,a,"formTarget",w.formTarget,w,null)):(dn(i,a,"encType",w.encType,w,null),dn(i,a,"method",w.method,w,null),dn(i,a,"target",w.target,w,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(l);break}p=Xo(""+p),i.setAttribute(l,p);break;case"onClick":p!=null&&(i.onclick=na);break;case"onScroll":p!=null&&Oi("scroll",i);break;case"onScrollEnd":p!=null&&Oi("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(k(61));if(l=p.__html,l!=null){if(w.children!=null)throw Error(k(60));i.innerHTML=l}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}l=Xo(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(l,""+p):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":p===!0?i.setAttribute(l,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(l,p):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(l,p):i.removeAttribute(l);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(l):i.setAttribute(l,p);break;case"popover":Oi("beforetoggle",i),Oi("toggle",i),Ue(i,"popover",p);break;case"xlinkActuate":In(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":In(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":In(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":In(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":In(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":In(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":In(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":In(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":In(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Ue(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Bl.get(l)||l,Ue(i,l,p))}}function bh(i,a,l,p,w,M){switch(l){case"style":Mr(i,p,M);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(k(61));if(l=p.__html,l!=null){if(w.children!=null)throw Error(k(60));i.innerHTML=l}}break;case"children":typeof p=="string"?as(i,p):(typeof p=="number"||typeof p=="bigint")&&as(i,""+p);break;case"onScroll":p!=null&&Oi("scroll",i);break;case"onScrollEnd":p!=null&&Oi("scrollend",i);break;case"onClick":p!=null&&(i.onclick=na);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ja.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(w=l.endsWith("Capture"),a=l.slice(2,w?l.length-7:void 0),M=i[Ye]||null,M=M!=null?M[l]:null,typeof M=="function"&&i.removeEventListener(a,M,w),typeof p=="function")){typeof M!="function"&&M!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(a,p,w);break t}l in i?i[l]=p:p===!0?i.setAttribute(l,""):Ue(i,l,p)}}}function Ba(i,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Oi("error",i),Oi("load",i);var p=!1,w=!1,M;for(M in l)if(l.hasOwnProperty(M)){var U=l[M];if(U!=null)switch(M){case"src":p=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(k(137,a));default:dn(i,a,M,U,l,null)}}w&&dn(i,a,"srcSet",l.srcSet,l,null),p&&dn(i,a,"src",l.src,l,null);return;case"input":Oi("invalid",i);var Q=M=U=w=null,mt=null,Bt=null;for(p in l)if(l.hasOwnProperty(p)){var Yt=l[p];if(Yt!=null)switch(p){case"name":w=Yt;break;case"type":U=Yt;break;case"checked":mt=Yt;break;case"defaultChecked":Bt=Yt;break;case"value":M=Yt;break;case"defaultValue":Q=Yt;break;case"children":case"dangerouslySetInnerHTML":if(Yt!=null)throw Error(k(137,a));break;default:dn(i,a,p,Yt,l,null)}}wi(i,M,Q,mt,Bt,U,w,!1);return;case"select":Oi("invalid",i),p=U=M=null;for(w in l)if(l.hasOwnProperty(w)&&(Q=l[w],Q!=null))switch(w){case"value":M=Q;break;case"defaultValue":U=Q;break;case"multiple":p=Q;default:dn(i,a,w,Q,l,null)}a=M,l=U,i.multiple=!!p,a!=null?an(i,!!p,a,!1):l!=null&&an(i,!!p,l,!0);return;case"textarea":Oi("invalid",i),M=w=p=null;for(U in l)if(l.hasOwnProperty(U)&&(Q=l[U],Q!=null))switch(U){case"value":p=Q;break;case"defaultValue":w=Q;break;case"children":M=Q;break;case"dangerouslySetInnerHTML":if(Q!=null)throw Error(k(91));break;default:dn(i,a,U,Q,l,null)}$r(i,p,w,M);return;case"option":for(mt in l)if(l.hasOwnProperty(mt)&&(p=l[mt],p!=null))switch(mt){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:dn(i,a,mt,p,l,null)}return;case"dialog":Oi("beforetoggle",i),Oi("toggle",i),Oi("cancel",i),Oi("close",i);break;case"iframe":case"object":Oi("load",i);break;case"video":case"audio":for(p=0;p<Mc.length;p++)Oi(Mc[p],i);break;case"image":Oi("error",i),Oi("load",i);break;case"details":Oi("toggle",i);break;case"embed":case"source":case"link":Oi("error",i),Oi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Bt in l)if(l.hasOwnProperty(Bt)&&(p=l[Bt],p!=null))switch(Bt){case"children":case"dangerouslySetInnerHTML":throw Error(k(137,a));default:dn(i,a,Bt,p,l,null)}return;default:if(Ho(a)){for(Yt in l)l.hasOwnProperty(Yt)&&(p=l[Yt],p!==void 0&&bh(i,a,Yt,p,l,void 0));return}}for(Q in l)l.hasOwnProperty(Q)&&(p=l[Q],p!=null&&dn(i,a,Q,p,l,null))}function Yp(i,a,l,p){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,M=null,U=null,Q=null,mt=null,Bt=null,Yt=null;for(qt in l){var te=l[qt];if(l.hasOwnProperty(qt)&&te!=null)switch(qt){case"checked":break;case"value":break;case"defaultValue":mt=te;default:p.hasOwnProperty(qt)||dn(i,a,qt,null,p,te)}}for(var Ut in p){var qt=p[Ut];if(te=l[Ut],p.hasOwnProperty(Ut)&&(qt!=null||te!=null))switch(Ut){case"type":M=qt;break;case"name":w=qt;break;case"checked":Bt=qt;break;case"defaultChecked":Yt=qt;break;case"value":U=qt;break;case"defaultValue":Q=qt;break;case"children":case"dangerouslySetInnerHTML":if(qt!=null)throw Error(k(137,a));break;default:qt!==te&&dn(i,a,Ut,qt,p,te)}}tr(i,U,Q,mt,Bt,Yt,M,w);return;case"select":qt=U=Q=Ut=null;for(M in l)if(mt=l[M],l.hasOwnProperty(M)&&mt!=null)switch(M){case"value":break;case"multiple":qt=mt;default:p.hasOwnProperty(M)||dn(i,a,M,null,p,mt)}for(w in p)if(M=p[w],mt=l[w],p.hasOwnProperty(w)&&(M!=null||mt!=null))switch(w){case"value":Ut=M;break;case"defaultValue":Q=M;break;case"multiple":U=M;default:M!==mt&&dn(i,a,w,M,p,mt)}a=Q,l=U,p=qt,Ut!=null?an(i,!!l,Ut,!1):!!p!=!!l&&(a!=null?an(i,!!l,a,!0):an(i,!!l,l?[]:"",!1));return;case"textarea":qt=Ut=null;for(Q in l)if(w=l[Q],l.hasOwnProperty(Q)&&w!=null&&!p.hasOwnProperty(Q))switch(Q){case"value":break;case"children":break;default:dn(i,a,Q,null,p,w)}for(U in p)if(w=p[U],M=l[U],p.hasOwnProperty(U)&&(w!=null||M!=null))switch(U){case"value":Ut=w;break;case"defaultValue":qt=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(k(91));break;default:w!==M&&dn(i,a,U,w,p,M)}ns(i,Ut,qt);return;case"option":for(var De in l)if(Ut=l[De],l.hasOwnProperty(De)&&Ut!=null&&!p.hasOwnProperty(De))switch(De){case"selected":i.selected=!1;break;default:dn(i,a,De,null,p,Ut)}for(mt in p)if(Ut=p[mt],qt=l[mt],p.hasOwnProperty(mt)&&Ut!==qt&&(Ut!=null||qt!=null))switch(mt){case"selected":i.selected=Ut&&typeof Ut!="function"&&typeof Ut!="symbol";break;default:dn(i,a,mt,Ut,p,qt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ni in l)Ut=l[ni],l.hasOwnProperty(ni)&&Ut!=null&&!p.hasOwnProperty(ni)&&dn(i,a,ni,null,p,Ut);for(Bt in p)if(Ut=p[Bt],qt=l[Bt],p.hasOwnProperty(Bt)&&Ut!==qt&&(Ut!=null||qt!=null))switch(Bt){case"children":case"dangerouslySetInnerHTML":if(Ut!=null)throw Error(k(137,a));break;default:dn(i,a,Bt,Ut,p,qt)}return;default:if(Ho(a)){for(var Dn in l)Ut=l[Dn],l.hasOwnProperty(Dn)&&Ut!==void 0&&!p.hasOwnProperty(Dn)&&bh(i,a,Dn,void 0,p,Ut);for(Yt in p)Ut=p[Yt],qt=l[Yt],!p.hasOwnProperty(Yt)||Ut===qt||Ut===void 0&&qt===void 0||bh(i,a,Yt,Ut,p,qt);return}}for(var Lt in l)Ut=l[Lt],l.hasOwnProperty(Lt)&&Ut!=null&&!p.hasOwnProperty(Lt)&&dn(i,a,Lt,null,p,Ut);for(te in p)Ut=p[te],qt=l[te],!p.hasOwnProperty(te)||Ut===qt||Ut==null&&qt==null||dn(i,a,te,Ut,p,qt)}function n(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function e(){if(typeof performance.getEntriesByType=="function"){for(var i=0,a=0,l=performance.getEntriesByType("resource"),p=0;p<l.length;p++){var w=l[p],M=w.transferSize,U=w.initiatorType,Q=w.duration;if(M&&Q&&n(U)){for(U=0,Q=w.responseEnd,p+=1;p<l.length;p++){var mt=l[p],Bt=mt.startTime;if(Bt>Q)break;var Yt=mt.transferSize,te=mt.initiatorType;Yt&&n(te)&&(mt=mt.responseEnd,U+=Yt*(mt<Q?1:(Q-Bt)/(mt-Bt)))}if(--p,a+=8*(M+U)/(w.duration/1e3),i++,10<i)break}}if(0<i)return a/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var s=null,u=null;function f(i){return i.nodeType===9?i:i.ownerDocument}function y(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function v(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function S(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var E=null;function D(){var i=window.event;return i&&i.type==="popstate"?i===E?!1:(E=i,!0):(E=null,!1)}var R=typeof setTimeout=="function"?setTimeout:void 0,F=typeof clearTimeout=="function"?clearTimeout:void 0,q=typeof Promise=="function"?Promise:void 0,X=typeof queueMicrotask=="function"?queueMicrotask:typeof q<"u"?function(i){return q.resolve(null).then(i).catch(K)}:R;function K(i){setTimeout(function(){throw i})}function W(i){return i==="head"}function st(i,a){var l=a,p=0;do{var w=l.nextSibling;if(i.removeChild(l),w&&w.nodeType===8)if(l=w.data,l==="/$"||l==="/&"){if(p===0){i.removeChild(w),of(a);return}p--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")p++;else if(l==="html")Gt(i.ownerDocument.documentElement);else if(l==="head"){l=i.ownerDocument.head,Gt(l);for(var M=l.firstChild;M;){var U=M.nextSibling,Q=M.nodeName;M[Yi]||Q==="SCRIPT"||Q==="STYLE"||Q==="LINK"&&M.rel.toLowerCase()==="stylesheet"||l.removeChild(M),M=U}}else l==="body"&&Gt(i.ownerDocument.body);l=w}while(l);of(a)}function ut(i,a){var l=i;i=0;do{var p=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),p&&p.nodeType===8)if(l=p.data,l==="/$"){if(i===0)break;i--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||i++;l=p}while(l)}function Ct(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Ct(l),Zn(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function gt(i,a,l,p){for(;i.nodeType===1;){var w=l;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[Yi])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(M=i.getAttribute("rel"),M==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(M!==w.rel||i.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||i.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||i.getAttribute("title")!==(w.title==null?null:w.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(M=i.getAttribute("src"),(M!==(w.src==null?null:w.src)||i.getAttribute("type")!==(w.type==null?null:w.type)||i.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&M&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var M=w.name==null?null:""+w.name;if(w.type==="hidden"&&i.getAttribute("name")===M)return i}else return i;if(i=le(i.nextSibling),i===null)break}return null}function Tt(i,a,l){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=le(i.nextSibling),i===null))return null;return i}function Zt(i,a){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!a||(i=le(i.nextSibling),i===null))return null;return i}function ee(i){return i.data==="$?"||i.data==="$~"}function ye(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function Be(i,a){var l=i.ownerDocument;if(i.data==="$~")i._reactRetry=a;else if(i.data!=="$?"||l.readyState!=="loading")a();else{var p=function(){a(),l.removeEventListener("DOMContentLoaded",p)};l.addEventListener("DOMContentLoaded",p),i._reactRetry=p}}function le(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return i}var de=null;function Ce(i){i=i.nextSibling;for(var a=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"||l==="/&"){if(a===0)return le(i.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}i=i.nextSibling}return null}function Te(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return i;a--}else l!=="/$"&&l!=="/&"||a++}i=i.previousSibling}return null}function be(i,a,l){switch(a=f(l),i){case"html":if(i=a.documentElement,!i)throw Error(k(452));return i;case"head":if(i=a.head,!i)throw Error(k(453));return i;case"body":if(i=a.body,!i)throw Error(k(454));return i;default:throw Error(k(451))}}function Gt(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);Zn(i)}var Se=new Map,Me=new Set;function Ge(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ri=ce.d;ce.d={f:rn,r:Ta,D:Aa,C:Is,L:Ps,m:Ds,X:Ea,S:Yn,M:ms};function rn(){var i=Ri.f(),a=hh();return i||a}function Ta(i){var a=jn(i);a!==null&&a.tag===5&&a.type==="form"?bf(a):Ri.r(i)}var ps=typeof document>"u"?null:document;function Na(i,a,l){var p=ps;if(p&&typeof a=="string"&&a){var w=Ki(a);w='link[rel="'+i+'"][href="'+w+'"]',typeof l=="string"&&(w+='[crossorigin="'+l+'"]'),Me.has(w)||(Me.add(w),i={rel:i,crossOrigin:l,href:a},p.querySelector(w)===null&&(a=p.createElement("link"),Ba(a,"link",i),Vn(a),p.head.appendChild(a)))}}function Aa(i){Ri.D(i),Na("dns-prefetch",i,null)}function Is(i,a){Ri.C(i,a),Na("preconnect",i,a)}function Ps(i,a,l){Ri.L(i,a,l);var p=ps;if(p&&i&&a){var w='link[rel="preload"][as="'+Ki(a)+'"]';a==="image"&&l&&l.imageSrcSet?(w+='[imagesrcset="'+Ki(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(w+='[imagesizes="'+Ki(l.imageSizes)+'"]')):w+='[href="'+Ki(i)+'"]';var M=w;switch(a){case"style":M=_a(i);break;case"script":M=Ai(i)}Se.has(M)||(i=It({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:i,as:a},l),Se.set(M,i),p.querySelector(w)!==null||a==="style"&&p.querySelector(ua(M))||a==="script"&&p.querySelector(Ji(M))||(a=p.createElement("link"),Ba(a,"link",i),Vn(a),p.head.appendChild(a)))}}function Ds(i,a){Ri.m(i,a);var l=ps;if(l&&i){var p=a&&typeof a.as=="string"?a.as:"script",w='link[rel="modulepreload"][as="'+Ki(p)+'"][href="'+Ki(i)+'"]',M=w;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":M=Ai(i)}if(!Se.has(M)&&(i=It({rel:"modulepreload",href:i},a),Se.set(M,i),l.querySelector(w)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Ji(M)))return}p=l.createElement("link"),Ba(p,"link",i),Vn(p),l.head.appendChild(p)}}}function Yn(i,a,l){Ri.S(i,a,l);var p=ps;if(p&&i){var w=Ci(p).hoistableStyles,M=_a(i);a=a||"default";var U=w.get(M);if(!U){var Q={loading:0,preload:null};if(U=p.querySelector(ua(M)))Q.loading=5;else{i=It({rel:"stylesheet",href:i,"data-precedence":a},l),(l=Se.get(M))&&Ln(i,l);var mt=U=p.createElement("link");Vn(mt),Ba(mt,"link",i),mt._p=new Promise(function(Bt,Yt){mt.onload=Bt,mt.onerror=Yt}),mt.addEventListener("load",function(){Q.loading|=1}),mt.addEventListener("error",function(){Q.loading|=2}),Q.loading|=4,_s(U,a,p)}U={type:"stylesheet",instance:U,count:1,state:Q},w.set(M,U)}}}function Ea(i,a){Ri.X(i,a);var l=ps;if(l&&i){var p=Ci(l).hoistableScripts,w=Ai(i),M=p.get(w);M||(M=l.querySelector(Ji(w)),M||(i=It({src:i,async:!0},a),(a=Se.get(w))&&gu(i,a),M=l.createElement("script"),Vn(M),Ba(M,"link",i),l.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},p.set(w,M))}}function ms(i,a){Ri.M(i,a);var l=ps;if(l&&i){var p=Ci(l).hoistableScripts,w=Ai(i),M=p.get(w);M||(M=l.querySelector(Ji(w)),M||(i=It({src:i,async:!0,type:"module"},a),(a=Se.get(w))&&gu(i,a),M=l.createElement("script"),Vn(M),Ba(M,"link",i),l.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},p.set(w,M))}}function Fa(i,a,l,p){var w=(w=xe.current)?Ge(w):null;if(!w)throw Error(k(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=_a(l.href),l=Ci(w).hoistableStyles,p=l.get(a),p||(p={type:"style",instance:null,count:0,state:null},l.set(a,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=_a(l.href);var M=Ci(w).hoistableStyles,U=M.get(i);if(U||(w=w.ownerDocument||w,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},M.set(i,U),(M=w.querySelector(ua(i)))&&!M._p&&(U.instance=M,U.state.loading=5),Se.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Se.set(i,l),M||Xs(w,i,l,U.state))),a&&p===null)throw Error(k(528,""));return U}if(a&&p!==null)throw Error(k(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ai(l),l=Ci(w).hoistableScripts,p=l.get(a),p||(p={type:"script",instance:null,count:0,state:null},l.set(a,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(k(444,i))}}function _a(i){return'href="'+Ki(i)+'"'}function ua(i){return'link[rel="stylesheet"]['+i+"]"}function _r(i){return It({},i,{"data-precedence":i.precedence,precedence:null})}function Xs(i,a,l,p){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?p.loading=1:(a=i.createElement("link"),p.preload=a,a.addEventListener("load",function(){return p.loading|=1}),a.addEventListener("error",function(){return p.loading|=2}),Ba(a,"link",l),Vn(a),i.head.appendChild(a))}function Ai(i){return'[src="'+Ki(i)+'"]'}function Ji(i){return"script[async]"+i}function bn(i,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var p=i.querySelector('style[data-href~="'+Ki(l.href)+'"]');if(p)return a.instance=p,Vn(p),p;var w=It({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Vn(p),Ba(p,"style",w),_s(p,l.precedence,i),a.instance=p;case"stylesheet":w=_a(l.href);var M=i.querySelector(ua(w));if(M)return a.state.loading|=4,a.instance=M,Vn(M),M;p=_r(l),(w=Se.get(w))&&Ln(p,w),M=(i.ownerDocument||i).createElement("link"),Vn(M);var U=M;return U._p=new Promise(function(Q,mt){U.onload=Q,U.onerror=mt}),Ba(M,"link",p),a.state.loading|=4,_s(M,l.precedence,i),a.instance=M;case"script":return M=Ai(l.src),(w=i.querySelector(Ji(M)))?(a.instance=w,Vn(w),w):(p=l,(w=Se.get(M))&&(p=It({},l),gu(p,w)),i=i.ownerDocument||i,w=i.createElement("script"),Vn(w),Ba(w,"link",p),i.head.appendChild(w),a.instance=w);case"void":return null;default:throw Error(k(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(p=a.instance,a.state.loading|=4,_s(p,l.precedence,i));return a.instance}function _s(i,a,l){for(var p=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=p.length?p[p.length-1]:null,M=w,U=0;U<p.length;U++){var Q=p[U];if(Q.dataset.precedence===a)M=Q;else if(M!==w)break}M?M.parentNode.insertBefore(i,M.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(i,a.firstChild))}function Ln(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function gu(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var Zr=null;function jo(i,a,l){if(Zr===null){var p=new Map,w=Zr=new Map;w.set(l,p)}else w=Zr,p=w.get(l),p||(p=new Map,w.set(l,p));if(p.has(i))return p;for(p.set(i,null),l=l.getElementsByTagName(i),w=0;w<l.length;w++){var M=l[w];if(!(M[Yi]||M[Le]||i==="link"&&M.getAttribute("rel")==="stylesheet")&&M.namespaceURI!=="http://www.w3.org/2000/svg"){var U=M.getAttribute(a)||"";U=i+U;var Q=p.get(U);Q?Q.push(M):p.set(U,[M])}}return p}function jr(i,a,l){i=i.ownerDocument||i,i.head.insertBefore(l,a==="title"?i.querySelector("head > title"):null)}function Vr(i,a,l){if(l===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Ma(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function kl(i,a,l,p){if(l.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var w=_a(p.href),M=a.querySelector(ua(w));if(M){a=M._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(i.count++,i=wh.bind(i),a.then(i,i)),l.state.loading|=4,l.instance=M,Vn(M);return}M=a.ownerDocument||a,p=_r(p),(w=Se.get(w))&&Ln(p,w),M=M.createElement("link"),Vn(M);var U=M;U._p=new Promise(function(Q,mt){U.onload=Q,U.onerror=mt}),Ba(M,"link",p),l.instance=M}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(i.count++,l=wh.bind(i),a.addEventListener("load",l),a.addEventListener("error",l))}}var qu=0;function pp(i,a){return i.stylesheets&&i.count===0&&Lc(i,i.stylesheets),0<i.count||0<i.imgCount?function(l){var p=setTimeout(function(){if(i.stylesheets&&Lc(i,i.stylesheets),i.unsuspend){var M=i.unsuspend;i.unsuspend=null,M()}},6e4+a);0<i.imgBytes&&qu===0&&(qu=62500*e());var w=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Lc(i,i.stylesheets),i.unsuspend)){var M=i.unsuspend;i.unsuspend=null,M()}},(i.imgBytes>qu?50:800)+a);return i.unsuspend=l,function(){i.unsuspend=null,clearTimeout(p),clearTimeout(w)}}:null}function wh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Lc(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Cc=null;function Lc(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Cc=new Map,a.forEach(Rl,i),Cc=null,wh.call(i))}function Rl(i,a){if(!(a.state.loading&4)){var l=Cc.get(i);if(l)var p=l.get(null);else{l=new Map,Cc.set(i,l);for(var w=i.querySelectorAll("link[data-precedence],style[data-precedence]"),M=0;M<w.length;M++){var U=w[M];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(l.set(U.dataset.precedence,U),p=U)}p&&l.set(null,p)}w=a.instance,U=w.getAttribute("data-precedence"),M=l.get(U)||p,M===p&&l.set(null,w),l.set(U,w),this.count++,p=wh.bind(this),w.addEventListener("load",p),w.addEventListener("error",p),M?M.parentNode.insertBefore(w,M.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(w,i.firstChild)),a.state.loading|=4}}var Ic={$$typeof:We,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function mp(i,a,l,p,w,M,U,Q,mt){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_t(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_t(0),this.hiddenUpdates=_t(null),this.identifierPrefix=p,this.onUncaughtError=w,this.onCaughtError=M,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=mt,this.incompleteTransitions=new Map}function _p(i,a,l,p,w,M,U,Q,mt,Bt,Yt,te){return i=new mp(i,a,l,U,mt,Bt,Yt,te,Q),a=1,M===!0&&(a|=24),M=da(3,null,null,a),i.current=M,M.stateNode=i,a=lr(),a.refCount++,i.pooledCache=a,a.refCount++,M.memoizedState={element:p,isDehydrated:l,cache:a},ve(M),i}function gp(i){return i?(i=ka,i):ka}function yp(i,a,l,p,w,M){w=gp(w),p.context===null?p.context=w:p.pendingContext=w,p=se(a),p.payload={element:l},M=M===void 0?null:M,M!==null&&(p.callback=M),l=we(i,p,a),l!==null&&(Cs(l,i,a),qe(l,i,a))}function vp(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<a?l:a}}function ld(i,a){vp(i,a),(i=i.alternate)&&vp(i,a)}function xp(i){if(i.tag===13||i.tag===31){var a=Ms(i,67108864);a!==null&&Cs(a,i,67108864),ld(i,67108864)}}function bp(i){if(i.tag===13||i.tag===31){var a=Ur();a=Dt(a);var l=Ms(i,a);l!==null&&Cs(l,i,a),ld(i,a)}}var nf=!0;function Vo(i,a,l,p){var w=Vt.T;Vt.T=null;var M=ce.p;try{ce.p=2,sf(i,a,l,p)}finally{ce.p=M,Vt.T=w}}function af(i,a,l,p){var w=Vt.T;Vt.T=null;var M=ce.p;try{ce.p=8,sf(i,a,l,p)}finally{ce.p=M,Vt.T=w}}function sf(i,a,l,p){if(nf){var w=ud(p);if(w===null)gh(i,a,p,rf,l),Sm(i,p);else if(z_(w,i,a,l,p))p.stopPropagation();else if(Sm(i,p),a&4&&-1<M_.indexOf(i)){for(;w!==null;){var M=jn(w);if(M!==null)switch(M.tag){case 3:if(M=M.stateNode,M.current.memoizedState.isDehydrated){var U=ot(M.pendingLanes);if(U!==0){var Q=M;for(Q.pendingLanes|=2,Q.entangledLanes|=2;U;){var mt=1<<31-un(U);Q.entanglements[1]|=mt,U&=~mt}hl(M),(en&6)===0&&(qh=ia()+500,Tc(0))}}break;case 31:case 13:Q=Ms(M,2),Q!==null&&Cs(Q,M,2),hh(),ld(M,2)}if(M=ud(p),M===null&&gh(i,a,p,rf,l),M===w)break;w=M}w!==null&&p.stopPropagation()}else gh(i,a,p,null,l)}}function ud(i){return i=aa(i),cd(i)}var rf=null;function cd(i){if(rf=null,i=Mn(i),i!==null){var a=it(i);if(a===null)i=null;else{var l=a.tag;if(l===13){if(i=O(a),i!==null)return i;i=null}else if(l===31){if(i=g(a),i!==null)return i;i=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return rf=i,null}function Ka(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gs()){case qr:return 2;case co:return 8;case ie:case Ws:return 32;case ha:return 268435456;default:return 32}default:return 32}}var $s=!1,gr=null,Wa=null,yr=null,vr=new Map,hd=new Map,Pc=[],M_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Sm(i,a){switch(i){case"focusin":case"focusout":gr=null;break;case"dragenter":case"dragleave":Wa=null;break;case"mouseover":case"mouseout":yr=null;break;case"pointerover":case"pointerout":vr.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":hd.delete(a.pointerId)}}function fd(i,a,l,p,w,M){return i===null||i.nativeEvent!==M?(i={blockedOn:a,domEventName:l,eventSystemFlags:p,nativeEvent:M,targetContainers:[w]},a!==null&&(a=jn(a),a!==null&&xp(a)),i):(i.eventSystemFlags|=p,a=i.targetContainers,w!==null&&a.indexOf(w)===-1&&a.push(w),i)}function z_(i,a,l,p,w){switch(a){case"focusin":return gr=fd(gr,i,a,l,p,w),!0;case"dragenter":return Wa=fd(Wa,i,a,l,p,w),!0;case"mouseover":return yr=fd(yr,i,a,l,p,w),!0;case"pointerover":var M=w.pointerId;return vr.set(M,fd(vr.get(M)||null,i,a,l,p,w)),!0;case"gotpointercapture":return M=w.pointerId,hd.set(M,fd(hd.get(M)||null,i,a,l,p,w)),!0}return!1}function Tm(i){var a=Mn(i.target);if(a!==null){var l=it(a);if(l!==null){if(a=l.tag,a===13){if(a=O(l),a!==null){i.blockedOn=a,Pe(i.priority,function(){bp(l)});return}}else if(a===31){if(a=g(l),a!==null){i.blockedOn=a,Pe(i.priority,function(){bp(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function wp(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var l=ud(i.nativeEvent);if(l===null){l=i.nativeEvent;var p=new l.constructor(l.type,l);Yr=p,l.target.dispatchEvent(p),Yr=null}else return a=jn(l),a!==null&&xp(a),i.blockedOn=l,!1;a.shift()}return!0}function Am(i,a,l){wp(i)&&l.delete(a)}function C_(){$s=!1,gr!==null&&wp(gr)&&(gr=null),Wa!==null&&wp(Wa)&&(Wa=null),yr!==null&&wp(yr)&&(yr=null),vr.forEach(Am),hd.forEach(Am)}function Sp(i,a){i.blockedOn===a&&(i.blockedOn=null,$s||($s=!0,x.unstable_scheduleCallback(x.unstable_NormalPriority,C_)))}var Tp=null;function Em(i){Tp!==i&&(Tp=i,x.unstable_scheduleCallback(x.unstable_NormalPriority,function(){Tp===i&&(Tp=null);for(var a=0;a<i.length;a+=3){var l=i[a],p=i[a+1],w=i[a+2];if(typeof p!="function"){if(cd(p||l)===null)continue;break}var M=jn(l);M!==null&&(i.splice(a,3),a-=3,Ph(M,{pending:!0,data:w,method:l.method,action:p},p,w))}}))}function of(i){function a(mt){return Sp(mt,i)}gr!==null&&Sp(gr,i),Wa!==null&&Sp(Wa,i),yr!==null&&Sp(yr,i),vr.forEach(a),hd.forEach(a);for(var l=0;l<Pc.length;l++){var p=Pc[l];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Pc.length&&(l=Pc[0],l.blockedOn===null);)Tm(l),l.blockedOn===null&&Pc.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(p=0;p<l.length;p+=3){var w=l[p],M=l[p+1],U=w[Ye]||null;if(typeof M=="function")U||Em(l);else if(U){var Q=null;if(M&&M.hasAttribute("formAction")){if(w=M,U=M[Ye]||null)Q=U.formAction;else if(cd(w)!==null)continue}else Q=U.action;typeof Q=="function"?l[p+1]=Q:(l.splice(p,3),p-=3),Em(l)}}}function Mm(){function i(M){M.canIntercept&&M.info==="react-transition"&&M.intercept({handler:function(){return new Promise(function(U){return w=U})},focusReset:"manual",scroll:"manual"})}function a(){w!==null&&(w(),w=null),p||setTimeout(l,20)}function l(){if(!p&&!navigation.transition){var M=navigation.currentEntry;M&&M.url!=null&&navigation.navigate(M.url,{state:M.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,w=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){p=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),w!==null&&(w(),w=null)}}}function Kp(i){this._internalRoot=i}Ap.prototype.render=Kp.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(k(409));var l=a.current,p=Ur();yp(l,p,i,a,null,null)},Ap.prototype.unmount=Kp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;yp(i.current,2,null,i,null,null),hh(),a[ii]=null}};function Ap(i){this._internalRoot=i}Ap.prototype.unstable_scheduleHydration=function(i){if(i){var a=ze();i={blockedOn:null,target:i,priority:a};for(var l=0;l<Pc.length&&a!==0&&a<Pc[l].priority;l++);Pc.splice(l,0,i),l===0&&Tm(i)}};var zm=A.version;if(zm!=="19.2.0")throw Error(k(527,zm,"19.2.0"));ce.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(k(188)):(i=Object.keys(i).join(","),Error(k(268,i)));return i=Et(a),i=i!==null?Wt(i):null,i=i===null?null:i.stateNode,i};var L_={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:Vt,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ep=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ep.isDisabled&&Ep.supportsFiber)try{oe=Ep.inject(L_),ke=Ep}catch{}}return pd.createRoot=function(i,a){if(!V(i))throw Error(k(299));var l=!1,p="",w=kd,M=Rd,U=Od;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(p=a.identifierPrefix),a.onUncaughtError!==void 0&&(w=a.onUncaughtError),a.onCaughtError!==void 0&&(M=a.onCaughtError),a.onRecoverableError!==void 0&&(U=a.onRecoverableError)),a=_p(i,1,!1,null,null,l,p,null,w,M,U,Mm),i[ii]=a.current,sd(i),new Kp(a)},pd.hydrateRoot=function(i,a,l){if(!V(i))throw Error(k(299));var p=!1,w="",M=kd,U=Rd,Q=Od,mt=null;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(w=l.identifierPrefix),l.onUncaughtError!==void 0&&(M=l.onUncaughtError),l.onCaughtError!==void 0&&(U=l.onCaughtError),l.onRecoverableError!==void 0&&(Q=l.onRecoverableError),l.formState!==void 0&&(mt=l.formState)),a=_p(i,1,!0,a,l??null,p,w,mt,M,U,Q,Mm),a.context=gp(null),l=a.current,p=Ur(),p=Dt(p),w=se(p),w.callback=null,we(l,w,p),l=p,a.current.lanes=l,yt(a,l),hl(a),i[ii]=a.current,sd(i),new Ap(a)},pd.version="19.2.0",pd}var Nm;function F_(){if(Nm)return Qp.exports;Nm=1;function x(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(x)}catch(A){console.error(A)}}return x(),Qp.exports=N_(),Qp.exports}var U_=F_();function n_(x,A){const C=He.useRef(A);He.useEffect(function(){A!==C.current&&x.attributionControl!=null&&(C.current!=null&&x.attributionControl.removeAttribution(C.current),A!=null&&x.attributionControl.addAttribution(A)),C.current=A},[x,A])}function Z_(x,A,C){A.center!==C.center&&x.setLatLng(A.center),A.radius!=null&&A.radius!==C.radius&&x.setRadius(A.radius)}var a_=i_();const j_=1;function V_(x){return Object.freeze({__version:j_,map:x})}function kp(x,A){return Object.freeze({...x,...A})}const Rp=He.createContext(null);function yd(){const x=He.use(Rp);if(x==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return x}function s_(x){function A(C,k){const{instance:V,context:it}=x(C).current;He.useImperativeHandle(k,()=>V);const{children:O}=C;return O==null?null:Lp.createElement(Rp,{value:it},O)}return He.forwardRef(A)}function q_(x){function A(C,k){const[V,it]=He.useState(!1),{instance:O}=x(C,it).current;He.useImperativeHandle(k,()=>O),He.useEffect(function(){V&&O.update()},[O,V,C.children]);const g=O._contentNode;return g?a_.createPortal(C.children,g):null}return He.forwardRef(A)}function hm(x,A){const C=He.useRef(void 0);He.useEffect(function(){return A!=null&&x.instance.on(A),C.current=A,function(){C.current!=null&&x.instance.off(C.current),C.current=null}},[x,A])}function fm(x,A){const C=x.pane??A.pane;return C?{...x,pane:C}:x}function G_(x,A){return function(k,V){const it=yd(),O=x(fm(k,it),it);return n_(it.map,k.attribution),hm(O.current,k.eventHandlers),A(O.current,it,k,V),O}}var md={exports:{}};var H_=md.exports,Fm;function X_(){return Fm||(Fm=1,(function(x,A){(function(C,k){k(A)})(H_,(function(C){var k="1.9.4";function V(r){var d,b,I,N;for(b=1,I=arguments.length;b<I;b++){N=arguments[b];for(d in N)r[d]=N[d]}return r}var it=Object.create||(function(){function r(){}return function(d){return r.prototype=d,new r}})();function O(r,d){var b=Array.prototype.slice;if(r.bind)return r.bind.apply(r,b.call(arguments,1));var I=b.call(arguments,2);return function(){return r.apply(d,I.length?I.concat(b.call(arguments)):arguments)}}var g=0;function bt(r){return"_leaflet_id"in r||(r._leaflet_id=++g),r._leaflet_id}function Et(r,d,b){var I,N,Y,lt;return lt=function(){I=!1,N&&(Y.apply(b,N),N=!1)},Y=function(){I?N=arguments:(r.apply(b,arguments),setTimeout(lt,d),I=!0)},Y}function Wt(r,d,b){var I=d[1],N=d[0],Y=I-N;return r===I&&b?r:((r-N)%Y+Y)%Y+N}function It(){return!1}function Mt(r,d){if(d===!1)return r;var b=Math.pow(10,d===void 0?6:d);return Math.round(r*b)/b}function Ui(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function Bi(r){return Ui(r).split(/\s+/)}function je(r,d){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?it(r.options):{});for(var b in d)r.options[b]=d[b];return r.options}function gi(r,d,b){var I=[];for(var N in r)I.push(encodeURIComponent(b?N.toUpperCase():N)+"="+encodeURIComponent(r[N]));return(!d||d.indexOf("?")===-1?"?":"&")+I.join("&")}var on=/\{ *([\w_ -]+) *\}/g;function ea(r,d){return r.replace(on,function(b,I){var N=d[I];if(N===void 0)throw new Error("No value provided for variable "+b);return typeof N=="function"&&(N=N(d)),N})}var We=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function Qi(r,d){for(var b=0;b<r.length;b++)if(r[b]===d)return b;return-1}var Ni="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Xi(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var Xe=0;function Un(r){var d=+new Date,b=Math.max(0,16-(d-Xe));return Xe=d+b,window.setTimeout(r,b)}var wn=window.requestAnimationFrame||Xi("RequestAnimationFrame")||Un,ca=window.cancelAnimationFrame||Xi("CancelAnimationFrame")||Xi("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function Fe(r,d,b){if(b&&wn===Un)r.call(d);else return wn.call(window,O(r,d))}function Ei(r){r&&ca.call(window,r)}var Sn={__proto__:null,extend:V,create:it,bind:O,get lastId(){return g},stamp:bt,throttle:Et,wrapNum:Wt,falseFn:It,formatNum:Mt,trim:Ui,splitWords:Bi,setOptions:je,getParamString:gi,template:ea,isArray:We,indexOf:Qi,emptyImageUrl:Ni,requestFn:wn,cancelFn:ca,requestAnimFrame:Fe,cancelAnimFrame:Ei};function Pi(){}Pi.extend=function(r){var d=function(){je(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},b=d.__super__=this.prototype,I=it(b);I.constructor=d,d.prototype=I;for(var N in this)Object.prototype.hasOwnProperty.call(this,N)&&N!=="prototype"&&N!=="__super__"&&(d[N]=this[N]);return r.statics&&V(d,r.statics),r.includes&&($i(r.includes),V.apply(null,[I].concat(r.includes))),V(I,r),delete I.statics,delete I.includes,I.options&&(I.options=b.options?it(b.options):{},V(I.options,r.options)),I._initHooks=[],I.callInitHooks=function(){if(!this._initHooksCalled){b.callInitHooks&&b.callInitHooks.call(this),this._initHooksCalled=!0;for(var Y=0,lt=I._initHooks.length;Y<lt;Y++)I._initHooks[Y].call(this)}},d},Pi.include=function(r){var d=this.prototype.options;return V(this.prototype,r),r.options&&(this.prototype.options=d,this.mergeOptions(r.options)),this},Pi.mergeOptions=function(r){return V(this.prototype.options,r),this},Pi.addInitHook=function(r){var d=Array.prototype.slice.call(arguments,1),b=typeof r=="function"?r:function(){this[r].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(b),this};function $i(r){if(!(typeof L>"u"||!L||!L.Mixin)){r=We(r)?r:[r];for(var d=0;d<r.length;d++)r[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Vt={on:function(r,d,b){if(typeof r=="object")for(var I in r)this._on(I,r[I],d);else{r=Bi(r);for(var N=0,Y=r.length;N<Y;N++)this._on(r[N],d,b)}return this},off:function(r,d,b){if(!arguments.length)delete this._events;else if(typeof r=="object")for(var I in r)this._off(I,r[I],d);else{r=Bi(r);for(var N=arguments.length===1,Y=0,lt=r.length;Y<lt;Y++)N?this._off(r[Y]):this._off(r[Y],d,b)}return this},_on:function(r,d,b,I){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(r,d,b)===!1){b===this&&(b=void 0);var N={fn:d,ctx:b};I&&(N.once=!0),this._events=this._events||{},this._events[r]=this._events[r]||[],this._events[r].push(N)}},_off:function(r,d,b){var I,N,Y;if(this._events&&(I=this._events[r],!!I)){if(arguments.length===1){if(this._firingCount)for(N=0,Y=I.length;N<Y;N++)I[N].fn=It;delete this._events[r];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var lt=this._listens(r,d,b);if(lt!==!1){var At=I[lt];this._firingCount&&(At.fn=It,this._events[r]=I=I.slice()),I.splice(lt,1)}}},fire:function(r,d,b){if(!this.listens(r,b))return this;var I=V({},d,{type:r,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var N=this._events[r];if(N){this._firingCount=this._firingCount+1||1;for(var Y=0,lt=N.length;Y<lt;Y++){var At=N[Y],Ot=At.fn;At.once&&this.off(r,Ot,At.ctx),Ot.call(At.ctx||this,I)}this._firingCount--}}return b&&this._propagateEvent(I),this},listens:function(r,d,b,I){typeof r!="string"&&console.warn('"string" type argument expected');var N=d;typeof d!="function"&&(I=!!d,N=void 0,b=void 0);var Y=this._events&&this._events[r];if(Y&&Y.length&&this._listens(r,N,b)!==!1)return!0;if(I){for(var lt in this._eventParents)if(this._eventParents[lt].listens(r,d,b,I))return!0}return!1},_listens:function(r,d,b){if(!this._events)return!1;var I=this._events[r]||[];if(!d)return!!I.length;b===this&&(b=void 0);for(var N=0,Y=I.length;N<Y;N++)if(I[N].fn===d&&I[N].ctx===b)return N;return!1},once:function(r,d,b){if(typeof r=="object")for(var I in r)this._on(I,r[I],d,!0);else{r=Bi(r);for(var N=0,Y=r.length;N<Y;N++)this._on(r[N],d,b,!0)}return this},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[bt(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[bt(r)],this},_propagateEvent:function(r){for(var d in this._eventParents)this._eventParents[d].fire(r.type,V({layer:r.target,propagatedFrom:r.target},r),!0)}};Vt.addEventListener=Vt.on,Vt.removeEventListener=Vt.clearAllEventListeners=Vt.off,Vt.addOneTimeEventListener=Vt.once,Vt.fireEvent=Vt.fire,Vt.hasEventListeners=Vt.listens;var ce=Pi.extend(Vt);function re(r,d,b){this.x=b?Math.round(r):r,this.y=b?Math.round(d):d}var xi=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};re.prototype={clone:function(){return new re(this.x,this.y)},add:function(r){return this.clone()._add(ge(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(ge(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new re(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new re(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=xi(this.x),this.y=xi(this.y),this},distanceTo:function(r){r=ge(r);var d=r.x-this.x,b=r.y-this.y;return Math.sqrt(d*d+b*b)},equals:function(r){return r=ge(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=ge(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+Mt(this.x)+", "+Mt(this.y)+")"}};function ge(r,d,b){return r instanceof re?r:We(r)?new re(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new re(r.x,r.y):new re(r,d,b)}function dt(r,d){if(r)for(var b=d?[r,d]:r,I=0,N=b.length;I<N;I++)this.extend(b[I])}dt.prototype={extend:function(r){var d,b;if(!r)return this;if(r instanceof re||typeof r[0]=="number"||"x"in r)d=b=ge(r);else if(r=St(r),d=r.min,b=r.max,!d||!b)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=b.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(b.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(b.y,this.max.y)),this},getCenter:function(r){return ge((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return ge(this.min.x,this.max.y)},getTopRight:function(){return ge(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var d,b;return typeof r[0]=="number"||r instanceof re?r=ge(r):r=St(r),r instanceof dt?(d=r.min,b=r.max):d=b=r,d.x>=this.min.x&&b.x<=this.max.x&&d.y>=this.min.y&&b.y<=this.max.y},intersects:function(r){r=St(r);var d=this.min,b=this.max,I=r.min,N=r.max,Y=N.x>=d.x&&I.x<=b.x,lt=N.y>=d.y&&I.y<=b.y;return Y&&lt},overlaps:function(r){r=St(r);var d=this.min,b=this.max,I=r.min,N=r.max,Y=N.x>d.x&&I.x<b.x,lt=N.y>d.y&&I.y<b.y;return Y&&lt},isValid:function(){return!!(this.min&&this.max)},pad:function(r){var d=this.min,b=this.max,I=Math.abs(d.x-b.x)*r,N=Math.abs(d.y-b.y)*r;return St(ge(d.x-I,d.y-N),ge(b.x+I,b.y+N))},equals:function(r){return r?(r=St(r),this.min.equals(r.getTopLeft())&&this.max.equals(r.getBottomRight())):!1}};function St(r,d){return!r||r instanceof dt?r:new dt(r,d)}function Ht(r,d){if(r)for(var b=d?[r,d]:r,I=0,N=b.length;I<N;I++)this.extend(b[I])}Ht.prototype={extend:function(r){var d=this._southWest,b=this._northEast,I,N;if(r instanceof me)I=r,N=r;else if(r instanceof Ht){if(I=r._southWest,N=r._northEast,!I||!N)return this}else return r?this.extend(xe(r)||ae(r)):this;return!d&&!b?(this._southWest=new me(I.lat,I.lng),this._northEast=new me(N.lat,N.lng)):(d.lat=Math.min(I.lat,d.lat),d.lng=Math.min(I.lng,d.lng),b.lat=Math.max(N.lat,b.lat),b.lng=Math.max(N.lng,b.lng)),this},pad:function(r){var d=this._southWest,b=this._northEast,I=Math.abs(d.lat-b.lat)*r,N=Math.abs(d.lng-b.lng)*r;return new Ht(new me(d.lat-I,d.lng-N),new me(b.lat+I,b.lng+N))},getCenter:function(){return new me((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new me(this.getNorth(),this.getWest())},getSouthEast:function(){return new me(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof me||"lat"in r?r=xe(r):r=ae(r);var d=this._southWest,b=this._northEast,I,N;return r instanceof Ht?(I=r.getSouthWest(),N=r.getNorthEast()):I=N=r,I.lat>=d.lat&&N.lat<=b.lat&&I.lng>=d.lng&&N.lng<=b.lng},intersects:function(r){r=ae(r);var d=this._southWest,b=this._northEast,I=r.getSouthWest(),N=r.getNorthEast(),Y=N.lat>=d.lat&&I.lat<=b.lat,lt=N.lng>=d.lng&&I.lng<=b.lng;return Y&&lt},overlaps:function(r){r=ae(r);var d=this._southWest,b=this._northEast,I=r.getSouthWest(),N=r.getNorthEast(),Y=N.lat>d.lat&&I.lat<b.lat,lt=N.lng>d.lng&&I.lng<b.lng;return Y&&lt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,d){return r?(r=ae(r),this._southWest.equals(r.getSouthWest(),d)&&this._northEast.equals(r.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ae(r,d){return r instanceof Ht?r:new Ht(r,d)}function me(r,d,b){if(isNaN(r)||isNaN(d))throw new Error("Invalid LatLng object: ("+r+", "+d+")");this.lat=+r,this.lng=+d,b!==void 0&&(this.alt=+b)}me.prototype={equals:function(r,d){if(!r)return!1;r=xe(r);var b=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return b<=(d===void 0?1e-9:d)},toString:function(r){return"LatLng("+Mt(this.lat,r)+", "+Mt(this.lng,r)+")"},distanceTo:function(r){return Mi.distance(this,xe(r))},wrap:function(){return Mi.wrapLatLng(this)},toBounds:function(r){var d=180*r/40075017,b=d/Math.cos(Math.PI/180*this.lat);return ae([this.lat-d,this.lng-b],[this.lat+d,this.lng+b])},clone:function(){return new me(this.lat,this.lng,this.alt)}};function xe(r,d,b){return r instanceof me?r:We(r)&&typeof r[0]!="object"?r.length===3?new me(r[0],r[1],r[2]):r.length===2?new me(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new me(r.lat,"lng"in r?r.lng:r.lon,r.alt):d===void 0?null:new me(r,d,b)}var Ve={latLngToPoint:function(r,d){var b=this.projection.project(r),I=this.scale(d);return this.transformation._transform(b,I)},pointToLatLng:function(r,d){var b=this.scale(d),I=this.transformation.untransform(r,b);return this.projection.unproject(I)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var d=this.projection.bounds,b=this.scale(r),I=this.transformation.transform(d.min,b),N=this.transformation.transform(d.max,b);return new dt(I,N)},infinite:!1,wrapLatLng:function(r){var d=this.wrapLng?Wt(r.lng,this.wrapLng,!0):r.lng,b=this.wrapLat?Wt(r.lat,this.wrapLat,!0):r.lat,I=r.alt;return new me(b,d,I)},wrapLatLngBounds:function(r){var d=r.getCenter(),b=this.wrapLatLng(d),I=d.lat-b.lat,N=d.lng-b.lng;if(I===0&&N===0)return r;var Y=r.getSouthWest(),lt=r.getNorthEast(),At=new me(Y.lat-I,Y.lng-N),Ot=new me(lt.lat-I,lt.lng-N);return new Ht(At,Ot)}},Mi=V({},Ve,{wrapLng:[-180,180],R:6371e3,distance:function(r,d){var b=Math.PI/180,I=r.lat*b,N=d.lat*b,Y=Math.sin((d.lat-r.lat)*b/2),lt=Math.sin((d.lng-r.lng)*b/2),At=Y*Y+Math.cos(I)*Math.cos(N)*lt*lt,Ot=2*Math.atan2(Math.sqrt(At),Math.sqrt(1-At));return this.R*Ot}}),Vi=6378137,Qa={R:Vi,MAX_LATITUDE:85.0511287798,project:function(r){var d=Math.PI/180,b=this.MAX_LATITUDE,I=Math.max(Math.min(b,r.lat),-b),N=Math.sin(I*d);return new re(this.R*r.lng*d,this.R*Math.log((1+N)/(1-N))/2)},unproject:function(r){var d=180/Math.PI;return new me((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*d,r.x*d/this.R)},bounds:(function(){var r=Vi*Math.PI;return new dt([-r,-r],[r,r])})()};function Ys(r,d,b,I){if(We(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=d,this._c=b,this._d=I}Ys.prototype={transform:function(r,d){return this._transform(r.clone(),d)},_transform:function(r,d){return d=d||1,r.x=d*(this._a*r.x+this._b),r.y=d*(this._c*r.y+this._d),r},untransform:function(r,d){return d=d||1,new re((r.x/d-this._b)/this._a,(r.y/d-this._d)/this._c)}};function za(r,d,b,I){return new Ys(r,d,b,I)}var ks=V({},Mi,{code:"EPSG:3857",projection:Qa,transformation:(function(){var r=.5/(Math.PI*Qa.R);return za(r,.5,-r,.5)})()}),Ua=V({},ks,{code:"EPSG:900913"});function br(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function Nt(r,d){var b="",I,N,Y,lt,At,Ot;for(I=0,Y=r.length;I<Y;I++){for(At=r[I],N=0,lt=At.length;N<lt;N++)Ot=At[N],b+=(N?"L":"M")+Ot.x+" "+Ot.y;b+=d?Ft.svg?"z":"x":""}return b||"M0 0"}var wr=document.documentElement.style,Sr="ActiveXObject"in window,zi=Sr&&!document.addEventListener,ln="msLaunchUri"in navigator&&!("documentMode"in document),Tr=Dt("webkit"),Ar=Dt("android"),Ks=Dt("android 2")||Dt("android 3"),ia=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),gs=Ar&&Dt("Google")&&ia<537&&!("AudioNode"in window),qr=!!window.opera,co=!ln&&Dt("chrome"),ie=Dt("gecko")&&!Tr&&!qr&&!Sr,Ws=!co&&Dt("safari"),ha=Dt("phantom"),Rs="OTransition"in wr,Gr=navigator.platform.indexOf("Win")===0,oe=Sr&&"transition"in wr,ke="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ks,Ie="MozPerspective"in wr,un=!window.L_DISABLE_3D&&(oe||ke||Ie)&&!Rs&&!ha,Ca=typeof orientation<"u"||Dt("mobile"),Qe=Ca&&Tr,Js=Ca&&ke,ts=!window.PointerEvent&&window.MSPointerEvent,ys=!!(window.PointerEvent||ts),Za="ontouchstart"in window||!!window.TouchEvent,ot=!window.L_NO_TOUCH&&(Za||ys),H=Ca&&qr,G=Ca&&ie,tt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,at=(function(){var r=!1;try{var d=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",It,d),window.removeEventListener("testPassiveEventSupport",It,d)}catch{}return r})(),_t=(function(){return!!document.createElement("canvas").getContext})(),yt=!!(document.createElementNS&&br("svg").createSVGRect),zt=!!yt&&(function(){var r=document.createElement("div");return r.innerHTML="<svg/>",(r.firstChild&&r.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ft=!yt&&(function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var d=r.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}})(),jt=navigator.platform.indexOf("Mac")===0,Kt=navigator.platform.indexOf("Linux")===0;function Dt(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var Ft={ie:Sr,ielt9:zi,edge:ln,webkit:Tr,android:Ar,android23:Ks,androidStock:gs,opera:qr,chrome:co,gecko:ie,safari:Ws,phantom:ha,opera12:Rs,win:Gr,ie3d:oe,webkit3d:ke,gecko3d:Ie,any3d:un,mobile:Ca,mobileWebkit:Qe,mobileWebkit3d:Js,msPointer:ts,pointer:ys,touch:ot,touchNative:Za,mobileOpera:H,mobileGecko:G,retina:tt,passiveEvents:at,canvas:_t,svg:yt,vml:ft,inlineSvg:zt,mac:jt,linux:Kt},ze=Ft.msPointer?"MSPointerDown":"pointerdown",Pe=Ft.msPointer?"MSPointerMove":"pointermove",ri=Ft.msPointer?"MSPointerUp":"pointerup",Le=Ft.msPointer?"MSPointerCancel":"pointercancel",Ye={touchstart:ze,touchmove:Pe,touchend:ri,touchcancel:Le},ii={touchstart:Ci,touchmove:es,touchend:es,touchcancel:es},nn={},Tn=!1;function ui(r,d,b){return d==="touchstart"&&jn(),ii[d]?(b=ii[d].bind(this,b),r.addEventListener(Ye[d],b,!1),b):(console.warn("wrong event specified:",d),It)}function Zi(r,d,b){if(!Ye[d]){console.warn("wrong event specified:",d);return}r.removeEventListener(Ye[d],b,!1)}function Yi(r){nn[r.pointerId]=r}function Zn(r){nn[r.pointerId]&&(nn[r.pointerId]=r)}function Mn(r){delete nn[r.pointerId]}function jn(){Tn||(document.addEventListener(ze,Yi,!0),document.addEventListener(Pe,Zn,!0),document.addEventListener(ri,Mn,!0),document.addEventListener(Le,Mn,!0),Tn=!0)}function es(r,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var b in nn)d.touches.push(nn[b]);d.changedTouches=[d],r(d)}}function Ci(r,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&kn(d),es(r,d)}function Vn(r){var d={},b,I;for(I in r)b=r[I],d[I]=b&&b.bind?b.bind(r):b;return r=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var Ol=200;function ja(r,d){r.addEventListener("dblclick",d);var b=0,I;function N(Y){if(Y.detail!==1){I=Y.detail;return}if(!(Y.pointerType==="mouse"||Y.sourceCapabilities&&!Y.sourceCapabilities.firesTouchEvents)){var lt=mo(Y);if(!(lt.some(function(Ot){return Ot instanceof HTMLLabelElement&&Ot.attributes.for})&&!lt.some(function(Ot){return Ot instanceof HTMLInputElement||Ot instanceof HTMLSelectElement}))){var At=Date.now();At-b<=Ol?(I++,I===2&&d(Vn(Y))):I=1,b=At}}}return r.addEventListener("click",N),{dblclick:d,simDblclick:N}}function Kn(r,d){r.removeEventListener("dblclick",d.dblclick),r.removeEventListener("click",d.simDblclick)}var Hr=wi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ga=wi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),La=ga==="webkitTransition"||ga==="OTransition"?ga+"End":"transitionend";function Xr(r){return typeof r=="string"?document.getElementById(r):r}function Os(r,d){var b=r.style[d]||r.currentStyle&&r.currentStyle[d];if((!b||b==="auto")&&document.defaultView){var I=document.defaultView.getComputedStyle(r,null);b=I?I[d]:null}return b==="auto"?null:b}function Ue(r,d,b){var I=document.createElement(r);return I.className=d||"",b&&b.appendChild(I),I}function qi(r){var d=r.parentNode;d&&d.removeChild(r)}function In(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function bi(r){var d=r.parentNode;d&&d.lastChild!==r&&d.appendChild(r)}function Qs(r){var d=r.parentNode;d&&d.firstChild!==r&&d.insertBefore(r,d.firstChild)}function is(r,d){if(r.classList!==void 0)return r.classList.contains(d);var b=ho(r);return b.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(b)}function ai(r,d){if(r.classList!==void 0)for(var b=Bi(d),I=0,N=b.length;I<N;I++)r.classList.add(b[I]);else if(!is(r,d)){var Y=ho(r);Go(r,(Y?Y+" ":"")+d)}}function Fi(r,d){r.classList!==void 0?r.classList.remove(d):Go(r,Ui((" "+ho(r)+" ").replace(" "+d+" "," ")))}function Go(r,d){r.className.baseVal===void 0?r.className=d:r.className.baseVal=d}function ho(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function Ki(r,d){"opacity"in r.style?r.style.opacity=d:"filter"in r.style&&tr(r,d)}function tr(r,d){var b=!1,I="DXImageTransform.Microsoft.Alpha";try{b=r.filters.item(I)}catch{if(d===1)return}d=Math.round(d*100),b?(b.Enabled=d!==100,b.Opacity=d):r.style.filter+=" progid:"+I+"(opacity="+d+")"}function wi(r){for(var d=document.documentElement.style,b=0;b<r.length;b++)if(r[b]in d)return r[b];return!1}function Bs(r,d,b){var I=d||new re(0,0);r.style[Hr]=(Ft.ie3d?"translate("+I.x+"px,"+I.y+"px)":"translate3d("+I.x+"px,"+I.y+"px,0)")+(b?" scale("+b+")":"")}function an(r,d){r._leaflet_pos=d,Ft.any3d?Bs(r,d):(r.style.left=d.x+"px",r.style.top=d.y+"px")}function ns(r){return r._leaflet_pos||new re(0,0)}var $r,as,fo;if("onselectstart"in document)$r=function(){Ke(window,"selectstart",kn)},as=function(){ji(window,"selectstart",kn)};else{var Er=wi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);$r=function(){if(Er){var r=document.documentElement.style;fo=r[Er],r[Er]="none"}},as=function(){Er&&(document.documentElement.style[Er]=fo,fo=void 0)}}function Mr(){Ke(window,"dragstart",kn)}function Ho(){ji(window,"dragstart",kn)}var Bl,Nl;function Xo(r){for(;r.tabIndex===-1;)r=r.parentNode;r.style&&(na(),Bl=r,Nl=r.style.outlineStyle,r.style.outlineStyle="none",Ke(window,"keydown",na))}function na(){Bl&&(Bl.style.outlineStyle=Nl,Bl=void 0,Nl=void 0,ji(window,"keydown",na))}function Yr(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function aa(r){var d=r.getBoundingClientRect();return{x:d.width/r.offsetWidth||1,y:d.height/r.offsetHeight||1,boundingClientRect:d}}var Wn={__proto__:null,TRANSFORM:Hr,TRANSITION:ga,TRANSITION_END:La,get:Xr,getStyle:Os,create:Ue,remove:qi,empty:In,toFront:bi,toBack:Qs,hasClass:is,addClass:ai,removeClass:Fi,setClass:Go,getClass:ho,setOpacity:Ki,testProp:wi,setTransform:Bs,setPosition:an,getPosition:ns,get disableTextSelection(){return $r},get enableTextSelection(){return as},disableImageDrag:Mr,enableImageDrag:Ho,preventOutline:Xo,restoreOutline:na,getSizedParentNode:Yr,getScale:aa};function Ke(r,d,b,I){if(d&&typeof d=="object")for(var N in d)Ns(r,N,d[N],b);else{d=Bi(d);for(var Y=0,lt=d.length;Y<lt;Y++)Ns(r,d[Y],b,I)}return this}var Va="_leaflet_events";function ji(r,d,b,I){if(arguments.length===1)Fl(r),delete r[Va];else if(d&&typeof d=="object")for(var N in d)$o(r,N,d[N],b);else if(d=Bi(d),arguments.length===2)Fl(r,function(At){return Qi(d,At)!==-1});else for(var Y=0,lt=d.length;Y<lt;Y++)$o(r,d[Y],b,I);return this}function Fl(r,d){for(var b in r[Va]){var I=b.split(/\d/)[0];(!d||d(I))&&$o(r,I,null,null,b)}}var vs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ns(r,d,b,I){var N=d+bt(b)+(I?"_"+bt(I):"");if(r[Va]&&r[Va][N])return this;var Y=function(At){return b.call(I||r,At||window.event)},lt=Y;!Ft.touchNative&&Ft.pointer&&d.indexOf("touch")===0?Y=ui(r,d,Y):Ft.touch&&d==="dblclick"?Y=ja(r,Y):"addEventListener"in r?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?r.addEventListener(vs[d]||d,Y,Ft.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(Y=function(At){At=At||window.event,sa(r,At)&&lt(At)},r.addEventListener(vs[d],Y,!1)):r.addEventListener(d,lt,!1):r.attachEvent("on"+d,Y),r[Va]=r[Va]||{},r[Va][N]=Y}function $o(r,d,b,I,N){N=N||d+bt(b)+(I?"_"+bt(I):"");var Y=r[Va]&&r[Va][N];if(!Y)return this;!Ft.touchNative&&Ft.pointer&&d.indexOf("touch")===0?Zi(r,d,Y):Ft.touch&&d==="dblclick"?Kn(r,Y):"removeEventListener"in r?r.removeEventListener(vs[d]||d,Y,!1):r.detachEvent("on"+d,Y),r[Va][N]=null}function xs(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,this}function er(r){return Ns(r,"wheel",xs),this}function po(r){return Ke(r,"mousedown touchstart dblclick contextmenu",xs),r._leaflet_disable_click=!0,this}function kn(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function bs(r){return kn(r),xs(r),this}function mo(r){if(r.composedPath)return r.composedPath();for(var d=[],b=r.target;b;)d.push(b),b=b.parentNode;return d}function Kr(r,d){if(!d)return new re(r.clientX,r.clientY);var b=aa(d),I=b.boundingClientRect;return new re((r.clientX-I.left)/b.x-d.clientLeft,(r.clientY-I.top)/b.y-d.clientTop)}var Ul=Ft.linux&&Ft.chrome?window.devicePixelRatio:Ft.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function fa(r){return Ft.edge?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/Ul:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}function sa(r,d){var b=d.relatedTarget;if(!b)return!0;try{for(;b&&b!==r;)b=b.parentNode}catch{return!1}return b!==r}var Zl={__proto__:null,on:Ke,off:ji,stopPropagation:xs,disableScrollPropagation:er,disableClickPropagation:po,preventDefault:kn,stop:bs,getPropagationPath:mo,getMousePosition:Kr,getWheelDelta:fa,isExternalTarget:sa,addListener:Ke,removeListener:ji},Wr=ce.extend({run:function(r,d,b,I){this.stop(),this._el=r,this._inProgress=!0,this._duration=b||.25,this._easeOutPower=1/Math.max(I||.5,.2),this._startPos=ns(r),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=Fe(this._animate,this),this._step()},_step:function(r){var d=+new Date-this._startTime,b=this._duration*1e3;d<b?this._runFrame(this._easeOut(d/b),r):(this._runFrame(1),this._complete())},_runFrame:function(r,d){var b=this._startPos.add(this._offset.multiplyBy(r));d&&b._round(),an(this._el,b),this.fire("step")},_complete:function(){Ei(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),hi=ce.extend({options:{crs:ks,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,d){d=je(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=O(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(xe(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ga&&Ft.any3d&&!Ft.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ke(this._proxy,La,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,d,b){if(d=d===void 0?this._zoom:this._limitZoom(d),r=this._limitCenter(xe(r),d,this.options.maxBounds),b=b||{},this._stop(),this._loaded&&!b.reset&&b!==!0){b.animate!==void 0&&(b.zoom=V({animate:b.animate},b.zoom),b.pan=V({animate:b.animate,duration:b.duration},b.pan));var I=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,d,b.zoom):this._tryAnimatedPan(r,b.pan);if(I)return clearTimeout(this._sizeTimer),this}return this._resetView(r,d,b.pan&&b.pan.noMoveStart),this},setZoom:function(r,d){return this._loaded?this.setView(this.getCenter(),r,{zoom:d}):(this._zoom=r,this)},zoomIn:function(r,d){return r=r||(Ft.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+r,d)},zoomOut:function(r,d){return r=r||(Ft.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-r,d)},setZoomAround:function(r,d,b){var I=this.getZoomScale(d),N=this.getSize().divideBy(2),Y=r instanceof re?r:this.latLngToContainerPoint(r),lt=Y.subtract(N).multiplyBy(1-1/I),At=this.containerPointToLatLng(N.add(lt));return this.setView(At,d,{zoom:b})},_getBoundsCenterZoom:function(r,d){d=d||{},r=r.getBounds?r.getBounds():ae(r);var b=ge(d.paddingTopLeft||d.padding||[0,0]),I=ge(d.paddingBottomRight||d.padding||[0,0]),N=this.getBoundsZoom(r,!1,b.add(I));if(N=typeof d.maxZoom=="number"?Math.min(d.maxZoom,N):N,N===1/0)return{center:r.getCenter(),zoom:N};var Y=I.subtract(b).divideBy(2),lt=this.project(r.getSouthWest(),N),At=this.project(r.getNorthEast(),N),Ot=this.unproject(lt.add(At).divideBy(2).add(Y),N);return{center:Ot,zoom:N}},fitBounds:function(r,d){if(r=ae(r),!r.isValid())throw new Error("Bounds are not valid.");var b=this._getBoundsCenterZoom(r,d);return this.setView(b.center,b.zoom,d)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,d){return this.setView(r,this._zoom,{pan:d})},panBy:function(r,d){if(r=ge(r).round(),d=d||{},!r.x&&!r.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Wr,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){ai(this._mapPane,"leaflet-pan-anim");var b=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,b,d.duration||.25,d.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,d,b){if(b=b||{},b.animate===!1||!Ft.any3d)return this.setView(r,d,b);this._stop();var I=this.project(this.getCenter()),N=this.project(r),Y=this.getSize(),lt=this._zoom;r=xe(r),d=d===void 0?lt:d;var At=Math.max(Y.x,Y.y),Ot=At*this.getZoomScale(lt,d),$t=N.distanceTo(I)||1,pe=1.42,Re=pe*pe;function _i(Cn){var ei=Cn?-1:1,Rr=Cn?Ot:At,Mu=Ot*Ot-At*At+ei*Re*Re*$t*$t,ko=2*Rr*Re*$t,bl=Mu/ko,hs=Math.sqrt(bl*bl+1)-bl,or=hs<1e-9?-18:Math.log(hs);return or}function oa(Cn){return(Math.exp(Cn)-Math.exp(-Cn))/2}function Rn(Cn){return(Math.exp(Cn)+Math.exp(-Cn))/2}function Ra(Cn){return oa(Cn)/Rn(Cn)}var Li=_i(0);function ci(Cn){return At*(Rn(Li)/Rn(Li+pe*Cn))}function Qt(Cn){return At*(Rn(Li)*Ra(Li+pe*Cn)-oa(Li))/Re}function qs(Cn){return 1-Math.pow(1-Cn,1.5)}var Ha=Date.now(),xl=(_i(1)-Li)/pe,cs=b.duration?1e3*b.duration:1e3*xl*.8;function no(){var Cn=(Date.now()-Ha)/cs,ei=qs(Cn)*xl;Cn<=1?(this._flyToFrame=Fe(no,this),this._move(this.unproject(I.add(N.subtract(I).multiplyBy(Qt(ei)/$t)),lt),this.getScaleZoom(At/ci(ei),lt),{flyTo:!0})):this._move(r,d)._moveEnd(!0)}return this._moveStart(!0,b.noMoveStart),no.call(this),this},flyToBounds:function(r,d){var b=this._getBoundsCenterZoom(r,d);return this.flyTo(b.center,b.zoom,d)},setMaxBounds:function(r){return r=ae(r),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),r.isValid()?(this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(r){var d=this.options.minZoom;return this.options.minZoom=r,this._loaded&&d!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var d=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&d!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,d){this._enforcingBounds=!0;var b=this.getCenter(),I=this._limitCenter(b,this._zoom,ae(r));return b.equals(I)||this.panTo(I,d),this._enforcingBounds=!1,this},panInside:function(r,d){d=d||{};var b=ge(d.paddingTopLeft||d.padding||[0,0]),I=ge(d.paddingBottomRight||d.padding||[0,0]),N=this.project(this.getCenter()),Y=this.project(r),lt=this.getPixelBounds(),At=St([lt.min.add(b),lt.max.subtract(I)]),Ot=At.getSize();if(!At.contains(Y)){this._enforcingBounds=!0;var $t=Y.subtract(At.getCenter()),pe=At.extend(Y).getSize().subtract(Ot);N.x+=$t.x<0?-pe.x:pe.x,N.y+=$t.y<0?-pe.y:pe.y,this.panTo(this.unproject(N),d),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=V({animate:!1,pan:!0},r===!0?{animate:!0}:r);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var b=this.getSize(),I=d.divideBy(2).round(),N=b.divideBy(2).round(),Y=I.subtract(N);return!Y.x&&!Y.y?this:(r.animate&&r.pan?this.panBy(Y):(r.pan&&this._rawPanBy(Y),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(O(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:b}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=V({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=O(this._handleGeolocationResponse,this),b=O(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,b,r):navigator.geolocation.getCurrentPosition(d,b,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){if(this._container._leaflet_id){var d=r.code,b=r.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+b+"."})}},_handleGeolocationResponse:function(r){if(this._container._leaflet_id){var d=r.coords.latitude,b=r.coords.longitude,I=new me(d,b),N=I.toBounds(r.coords.accuracy*2),Y=this._locateOptions;if(Y.setView){var lt=this.getBoundsZoom(N);this.setView(I,Y.maxZoom?Math.min(lt,Y.maxZoom):lt)}var At={latlng:I,bounds:N,timestamp:r.timestamp};for(var Ot in r.coords)typeof r.coords[Ot]=="number"&&(At[Ot]=r.coords[Ot]);this.fire("locationfound",At)}},addHandler:function(r,d){if(!d)return this;var b=this[r]=new d(this);return this._handlers.push(b),this.options[r]&&b.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),qi(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Ei(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)qi(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,d){var b="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),I=Ue("div",b,d||this._mapPane);return r&&(this._panes[r]=I),I},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),d=this.unproject(r.getBottomLeft()),b=this.unproject(r.getTopRight());return new Ht(d,b)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,d,b){r=ae(r),b=ge(b||[0,0]);var I=this.getZoom()||0,N=this.getMinZoom(),Y=this.getMaxZoom(),lt=r.getNorthWest(),At=r.getSouthEast(),Ot=this.getSize().subtract(b),$t=St(this.project(At,I),this.project(lt,I)).getSize(),pe=Ft.any3d?this.options.zoomSnap:1,Re=Ot.x/$t.x,_i=Ot.y/$t.y,oa=d?Math.max(Re,_i):Math.min(Re,_i);return I=this.getScaleZoom(oa,I),pe&&(I=Math.round(I/(pe/100))*(pe/100),I=d?Math.ceil(I/pe)*pe:Math.floor(I/pe)*pe),Math.max(N,Math.min(Y,I))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new re(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,d){var b=this._getTopLeftPoint(r,d);return new dt(b,b.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,d){var b=this.options.crs;return d=d===void 0?this._zoom:d,b.scale(r)/b.scale(d)},getScaleZoom:function(r,d){var b=this.options.crs;d=d===void 0?this._zoom:d;var I=b.zoom(r*b.scale(d));return isNaN(I)?1/0:I},project:function(r,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(xe(r),d)},unproject:function(r,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(ge(r),d)},layerPointToLatLng:function(r){var d=ge(r).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(r){var d=this.project(xe(r))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(xe(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(ae(r))},distance:function(r,d){return this.options.crs.distance(xe(r),xe(d))},containerPointToLayerPoint:function(r){return ge(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return ge(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var d=this.containerPointToLayerPoint(ge(r));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(xe(r)))},mouseEventToContainerPoint:function(r){return Kr(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var d=this._container=Xr(r);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ke(d,"scroll",this._onScroll,this),this._containerId=bt(d)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ft.any3d,ai(r,"leaflet-container"+(Ft.touch?" leaflet-touch":"")+(Ft.retina?" leaflet-retina":"")+(Ft.ielt9?" leaflet-oldie":"")+(Ft.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=Os(r,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),an(this._mapPane,new re(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ai(r.markerPane,"leaflet-zoom-hide"),ai(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,d,b){an(this._mapPane,new re(0,0));var I=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var N=this._zoom!==d;this._moveStart(N,b)._move(r,d)._moveEnd(N),this.fire("viewreset"),I&&this.fire("load")},_moveStart:function(r,d){return r&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(r,d,b,I){d===void 0&&(d=this._zoom);var N=this._zoom!==d;return this._zoom=d,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),I?b&&b.pinch&&this.fire("zoom",b):((N||b&&b.pinch)&&this.fire("zoom",b),this.fire("move",b)),this},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Ei(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){an(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[bt(this._container)]=this;var d=r?ji:Ke;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),Ft.any3d&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Ei(this._resizeRequest),this._resizeRequest=Fe(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,d){for(var b=[],I,N=d==="mouseout"||d==="mouseover",Y=r.target||r.srcElement,lt=!1;Y;){if(I=this._targets[bt(Y)],I&&(d==="click"||d==="preclick")&&this._draggableMoved(I)){lt=!0;break}if(I&&I.listens(d,!0)&&(N&&!sa(Y,r)||(b.push(I),N))||Y===this._container)break;Y=Y.parentNode}return!b.length&&!lt&&!N&&this.listens(d,!0)&&(b=[this]),b},_isClickDisabled:function(r){for(;r&&r!==this._container;){if(r._leaflet_disable_click)return!0;r=r.parentNode}},_handleDOMEvent:function(r){var d=r.target||r.srcElement;if(!(!this._loaded||d._leaflet_disable_events||r.type==="click"&&this._isClickDisabled(d))){var b=r.type;b==="mousedown"&&Xo(d),this._fireDOMEvent(r,b)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,d,b){if(r.type==="click"){var I=V({},r);I.type="preclick",this._fireDOMEvent(I,I.type,b)}var N=this._findEventTargets(r,d);if(b){for(var Y=[],lt=0;lt<b.length;lt++)b[lt].listens(d,!0)&&Y.push(b[lt]);N=Y.concat(N)}if(N.length){d==="contextmenu"&&kn(r);var At=N[0],Ot={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var $t=At.getLatLng&&(!At._radius||At._radius<=10);Ot.containerPoint=$t?this.latLngToContainerPoint(At.getLatLng()):this.mouseEventToContainerPoint(r),Ot.layerPoint=this.containerPointToLayerPoint(Ot.containerPoint),Ot.latlng=$t?At.getLatLng():this.layerPointToLatLng(Ot.layerPoint)}for(lt=0;lt<N.length;lt++)if(N[lt].fire(d,Ot,!0),Ot.originalEvent._stopped||N[lt].options.bubblingMouseEvents===!1&&Qi(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,d=this._handlers.length;r<d;r++)this._handlers[r].disable()},whenReady:function(r,d){return this._loaded?r.call(d||this,{target:this}):this.on("load",r,d),this},_getMapPanePos:function(){return ns(this._mapPane)||new re(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,d){var b=r&&d!==void 0?this._getNewPixelOrigin(r,d):this.getPixelOrigin();return b.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,d){var b=this.getSize()._divideBy(2);return this.project(r,d)._subtract(b)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,d,b){var I=this._getNewPixelOrigin(b,d);return this.project(r,d)._subtract(I)},_latLngBoundsToNewLayerBounds:function(r,d,b){var I=this._getNewPixelOrigin(b,d);return St([this.project(r.getSouthWest(),d)._subtract(I),this.project(r.getNorthWest(),d)._subtract(I),this.project(r.getSouthEast(),d)._subtract(I),this.project(r.getNorthEast(),d)._subtract(I)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,d,b){if(!b)return r;var I=this.project(r,d),N=this.getSize().divideBy(2),Y=new dt(I.subtract(N),I.add(N)),lt=this._getBoundsOffset(Y,b,d);return Math.abs(lt.x)<=1&&Math.abs(lt.y)<=1?r:this.unproject(I.add(lt),d)},_limitOffset:function(r,d){if(!d)return r;var b=this.getPixelBounds(),I=new dt(b.min.add(r),b.max.add(r));return r.add(this._getBoundsOffset(I,d))},_getBoundsOffset:function(r,d,b){var I=St(this.project(d.getNorthEast(),b),this.project(d.getSouthWest(),b)),N=I.min.subtract(r.min),Y=I.max.subtract(r.max),lt=this._rebound(N.x,-Y.x),At=this._rebound(N.y,-Y.y);return new re(lt,At)},_rebound:function(r,d){return r+d>0?Math.round(r-d)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(d))},_limitZoom:function(r){var d=this.getMinZoom(),b=this.getMaxZoom(),I=Ft.any3d?this.options.zoomSnap:1;return I&&(r=Math.round(r/I)*I),Math.max(d,Math.min(b,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Fi(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,d){var b=this._getCenterOffset(r)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(b)?!1:(this.panBy(b,d),!0)},_createAnimProxy:function(){var r=this._proxy=Ue("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(d){var b=Hr,I=this._proxy.style[b];Bs(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),I===this._proxy.style[b]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){qi(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),d=this.getZoom();Bs(this._proxy,this.project(r,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,d,b){if(this._animatingZoom)return!0;if(b=b||{},!this._zoomAnimated||b.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var I=this.getZoomScale(d),N=this._getCenterOffset(r)._divideBy(1-1/I);return b.animate!==!0&&!this.getSize().contains(N)?!1:(Fe(function(){this._moveStart(!0,b.noMoveStart||!1)._animateZoom(r,d,!0)},this),!0)},_animateZoom:function(r,d,b,I){this._mapPane&&(b&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=d,ai(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:d,noUpdate:I}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(O(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Fi(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ir(r,d){return new hi(r,d)}var si=Pi.extend({options:{position:"topright"},initialize:function(r){je(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var d=this._map;return d&&d.removeControl(this),this.options.position=r,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var d=this._container=this.onAdd(r),b=this.getPosition(),I=r._controlCorners[b];return ai(d,"leaflet-control"),b.indexOf("bottom")!==-1?I.insertBefore(d,I.firstChild):I.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(qi(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),ws=function(r){return new si(r)};hi.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},d="leaflet-",b=this._controlContainer=Ue("div",d+"control-container",this._container);function I(N,Y){var lt=d+N+" "+d+Y;r[N+Y]=Ue("div",lt,b)}I("top","left"),I("top","right"),I("bottom","left"),I("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)qi(this._controlCorners[r]);qi(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var fl=si.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,d,b,I){return b<I?-1:I<b?1:0}},initialize:function(r,d,b){je(this,b),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var I in r)this._addLayer(r[I],I);for(I in d)this._addLayer(d[I],I,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return si.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,d){return this._addLayer(r,d),this._map?this._update():this},addOverlay:function(r,d){return this._addLayer(r,d,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var d=this._getLayer(bt(r));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){ai(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(ai(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):Fi(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Fi(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",d=this._container=Ue("div",r),b=this.options.collapsed;d.setAttribute("aria-haspopup",!0),po(d),er(d);var I=this._section=Ue("section",r+"-list");b&&(this._map.on("click",this.collapse,this),Ke(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var N=this._layersLink=Ue("a",r+"-toggle",d);N.href="#",N.title="Layers",N.setAttribute("role","button"),Ke(N,{keydown:function(Y){Y.keyCode===13&&this._expandSafely()},click:function(Y){kn(Y),this._expandSafely()}},this),b||this.expand(),this._baseLayersList=Ue("div",r+"-base",I),this._separator=Ue("div",r+"-separator",I),this._overlaysList=Ue("div",r+"-overlays",I),d.appendChild(I)},_getLayer:function(r){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&bt(this._layers[d].layer)===r)return this._layers[d]},_addLayer:function(r,d,b){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:d,overlay:b}),this.options.sortLayers&&this._layers.sort(O(function(I,N){return this.options.sortFunction(I.layer,N.layer,I.name,N.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;In(this._baseLayersList),In(this._overlaysList),this._layerControlInputs=[];var r,d,b,I,N=0;for(b=0;b<this._layers.length;b++)I=this._layers[b],this._addItem(I),d=d||I.overlay,r=r||!I.overlay,N+=I.overlay?0:1;return this.options.hideSingleBase&&(r=r&&N>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=d&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var d=this._getLayer(bt(r.target)),b=d.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;b&&this._map.fire(b,d)},_createRadioElement:function(r,d){var b='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(d?' checked="checked"':"")+"/>",I=document.createElement("div");return I.innerHTML=b,I.firstChild},_addItem:function(r){var d=document.createElement("label"),b=this._map.hasLayer(r.layer),I;r.overlay?(I=document.createElement("input"),I.type="checkbox",I.className="leaflet-control-layers-selector",I.defaultChecked=b):I=this._createRadioElement("leaflet-base-layers_"+bt(this),b),this._layerControlInputs.push(I),I.layerId=bt(r.layer),Ke(I,"click",this._onInputClick,this);var N=document.createElement("span");N.innerHTML=" "+r.name;var Y=document.createElement("span");d.appendChild(Y),Y.appendChild(I),Y.appendChild(N);var lt=r.overlay?this._overlaysList:this._baseLayersList;return lt.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var r=this._layerControlInputs,d,b,I=[],N=[];this._handlingClick=!0;for(var Y=r.length-1;Y>=0;Y--)d=r[Y],b=this._getLayer(d.layerId).layer,d.checked?I.push(b):d.checked||N.push(b);for(Y=0;Y<N.length;Y++)this._map.hasLayer(N[Y])&&this._map.removeLayer(N[Y]);for(Y=0;Y<I.length;Y++)this._map.hasLayer(I[Y])||this._map.addLayer(I[Y]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,d,b,I=this._map.getZoom(),N=r.length-1;N>=0;N--)d=r[N],b=this._getLayer(d.layerId).layer,d.disabled=b.options.minZoom!==void 0&&I<b.options.minZoom||b.options.maxZoom!==void 0&&I>b.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var r=this._section;this._preventClick=!0,Ke(r,"click",kn),this.expand();var d=this;setTimeout(function(){ji(r,"click",kn),d._preventClick=!1})}}),_o=function(r,d,b){return new fl(r,d,b)},yu=si.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(r){var d="leaflet-control-zoom",b=Ue("div",d+" leaflet-bar"),I=this.options;return this._zoomInButton=this._createButton(I.zoomInText,I.zoomInTitle,d+"-in",b,this._zoomIn),this._zoomOutButton=this._createButton(I.zoomOutText,I.zoomOutTitle,d+"-out",b,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),b},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,d,b,I,N){var Y=Ue("a",b,I);return Y.innerHTML=r,Y.href="#",Y.title=d,Y.setAttribute("role","button"),Y.setAttribute("aria-label",d),po(Y),Ke(Y,"click",bs),Ke(Y,"click",N,this),Ke(Y,"click",this._refocusOnMap,this),Y},_updateDisabled:function(){var r=this._map,d="leaflet-disabled";Fi(this._zoomInButton,d),Fi(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||r._zoom===r.getMinZoom())&&(ai(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||r._zoom===r.getMaxZoom())&&(ai(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});hi.mergeOptions({zoomControl:!0}),hi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new yu,this.addControl(this.zoomControl))});var Hu=function(r){return new yu(r)},Xu=si.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var d="leaflet-control-scale",b=Ue("div",d),I=this.options;return this._addScales(I,d+"-line",b),r.on(I.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),b},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,d,b){r.metric&&(this._mScale=Ue("div",d,b)),r.imperial&&(this._iScale=Ue("div",d,b))},_update:function(){var r=this._map,d=r.getSize().y/2,b=r.distance(r.containerPointToLatLng([0,d]),r.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(b)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var d=this._getRoundNum(r),b=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,b,d/r)},_updateImperial:function(r){var d=r*3.2808399,b,I,N;d>5280?(b=d/5280,I=this._getRoundNum(b),this._updateScale(this._iScale,I+" mi",I/b)):(N=this._getRoundNum(d),this._updateScale(this._iScale,N+" ft",N/d))},_updateScale:function(r,d,b){r.style.width=Math.round(this.options.maxWidth*b)+"px",r.innerHTML=d},_getRoundNum:function(r){var d=Math.pow(10,(Math.floor(r)+"").length-1),b=r/d;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:1,d*b}}),jl=function(r){return new Xu(r)},vu='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Vl=si.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ft.inlineSvg?vu+" ":"")+"Leaflet</a>"},initialize:function(r){je(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=Ue("div","leaflet-control-attribution"),po(this._container);for(var d in r._layers)r._layers[d].getAttribution&&this.addAttribution(r._layers[d].getAttribution());return this._update(),r.on("layeradd",this._addAttribution,this),this._container},onRemove:function(r){r.off("layeradd",this._addAttribution,this)},_addAttribution:function(r){r.layer.getAttribution&&(this.addAttribution(r.layer.getAttribution()),r.layer.once("remove",function(){this.removeAttribution(r.layer.getAttribution())},this))},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(this._map){var r=[];for(var d in this._attributions)this._attributions[d]&&r.push(d);var b=[];this.options.prefix&&b.push(this.options.prefix),r.length&&b.push(r.join(", ")),this._container.innerHTML=b.join(' <span aria-hidden="true">|</span> ')}}});hi.mergeOptions({attributionControl:!0}),hi.addInitHook(function(){this.options.attributionControl&&new Vl().addTo(this)});var $u=function(r){return new Vl(r)};si.Layers=fl,si.Zoom=yu,si.Scale=Xu,si.Attribution=Vl,ws.layers=_o,ws.zoom=Hu,ws.scale=jl,ws.attribution=$u;var Fs=Pi.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Fs.addTo=function(r,d){return r.addHandler(d,this),this};var Yu={Events:Vt},zr=Ft.touch?"touchstart mousedown":"mousedown",Cr=ce.extend({options:{clickTolerance:3},initialize:function(r,d,b,I){je(this,I),this._element=r,this._dragStartTarget=d||r,this._preventOutline=b},enable:function(){this._enabled||(Ke(this._dragStartTarget,zr,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Cr._dragging===this&&this.finishDrag(!0),ji(this._dragStartTarget,zr,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(this._enabled&&(this._moved=!1,!is(this._element,"leaflet-zoom-anim"))){if(r.touches&&r.touches.length!==1){Cr._dragging===this&&this.finishDrag();return}if(!(Cr._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(Cr._dragging=this,this._preventOutline&&Xo(this._element),Mr(),$r(),!this._moving)){this.fire("down");var d=r.touches?r.touches[0]:r,b=Yr(this._element);this._startPoint=new re(d.clientX,d.clientY),this._startPos=ns(this._element),this._parentScale=aa(b);var I=r.type==="mousedown";Ke(document,I?"mousemove":"touchmove",this._onMove,this),Ke(document,I?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(r){if(this._enabled){if(r.touches&&r.touches.length>1){this._moved=!0;return}var d=r.touches&&r.touches.length===1?r.touches[0]:r,b=new re(d.clientX,d.clientY)._subtract(this._startPoint);!b.x&&!b.y||Math.abs(b.x)+Math.abs(b.y)<this.options.clickTolerance||(b.x/=this._parentScale.x,b.y/=this._parentScale.y,kn(r),this._moved||(this.fire("dragstart"),this._moved=!0,ai(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ai(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(b),this._moving=!0,this._lastEvent=r,this._updatePosition())}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),an(this._element,this._newPos),this.fire("drag",r)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(r){Fi(document.body,"leaflet-dragging"),this._lastTarget&&(Fi(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ji(document,"mousemove touchmove",this._onMove,this),ji(document,"mouseup touchend touchcancel",this._onUp,this),Ho(),as();var d=this._moved&&this._moving;this._moving=!1,Cr._dragging=!1,d&&this.fire("dragend",{noInertia:r,distance:this._newPos.distanceTo(this._startPos)})}});function Ku(r,d,b){var I,N=[1,4,2,8],Y,lt,At,Ot,$t,pe,Re,_i;for(Y=0,pe=r.length;Y<pe;Y++)r[Y]._code=Ia(r[Y],d);for(At=0;At<4;At++){for(Re=N[At],I=[],Y=0,pe=r.length,lt=pe-1;Y<pe;lt=Y++)Ot=r[Y],$t=r[lt],Ot._code&Re?$t._code&Re||(_i=yo($t,Ot,Re,d,b),_i._code=Ia(_i,d),I.push(_i)):($t._code&Re&&(_i=yo($t,Ot,Re,d,b),_i._code=Ia(_i,d),I.push(_i)),I.push(Ot));r=I}return r}function xu(r,d){var b,I,N,Y,lt,At,Ot,$t,pe;if(!r||r.length===0)throw new Error("latlngs not passed");qa(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var Re=xe([0,0]),_i=ae(r),oa=_i.getNorthWest().distanceTo(_i.getSouthWest())*_i.getNorthEast().distanceTo(_i.getNorthWest());oa<1700&&(Re=go(r));var Rn=r.length,Ra=[];for(b=0;b<Rn;b++){var Li=xe(r[b]);Ra.push(d.project(xe([Li.lat-Re.lat,Li.lng-Re.lng])))}for(At=Ot=$t=0,b=0,I=Rn-1;b<Rn;I=b++)N=Ra[b],Y=Ra[I],lt=N.y*Y.x-Y.y*N.x,Ot+=(N.x+Y.x)*lt,$t+=(N.y+Y.y)*lt,At+=lt*3;At===0?pe=Ra[0]:pe=[Ot/At,$t/At];var ci=d.unproject(ge(pe));return xe([ci.lat+Re.lat,ci.lng+Re.lng])}function go(r){for(var d=0,b=0,I=0,N=0;N<r.length;N++){var Y=xe(r[N]);d+=Y.lat,b+=Y.lng,I++}return xe([d/I,b/I])}var bu={__proto__:null,clipPolygon:Ku,polygonCenter:xu,centroid:go};function dl(r,d){if(!d||!r.length)return r.slice();var b=d*d;return r=Ju(r,b),r=wu(r,b),r}function Wu(r,d,b){return Math.sqrt(vo(r,d,b,!0))}function Oc(r,d,b){return vo(r,d,b)}function wu(r,d){var b=r.length,I=typeof Uint8Array<"u"?Uint8Array:Array,N=new I(b);N[0]=N[b-1]=1,ql(r,N,d,0,b-1);var Y,lt=[];for(Y=0;Y<b;Y++)N[Y]&&lt.push(r[Y]);return lt}function ql(r,d,b,I,N){var Y=0,lt,At,Ot;for(At=I+1;At<=N-1;At++)Ot=vo(r[At],r[I],r[N],!0),Ot>Y&&(lt=At,Y=Ot);Y>b&&(d[lt]=1,ql(r,d,b,I,lt),ql(r,d,b,lt,N))}function Ju(r,d){for(var b=[r[0]],I=1,N=0,Y=r.length;I<Y;I++)Tu(r[I],r[N])>d&&(b.push(r[I]),N=I);return N<Y-1&&b.push(r[Y-1]),b}var Gl;function Su(r,d,b,I,N){var Y=I?Gl:Ia(r,b),lt=Ia(d,b),At,Ot,$t;for(Gl=lt;;){if(!(Y|lt))return[r,d];if(Y&lt)return!1;At=Y||lt,Ot=yo(r,d,At,b,N),$t=Ia(Ot,b),At===Y?(r=Ot,Y=$t):(d=Ot,lt=$t)}}function yo(r,d,b,I,N){var Y=d.x-r.x,lt=d.y-r.y,At=I.min,Ot=I.max,$t,pe;return b&8?($t=r.x+Y*(Ot.y-r.y)/lt,pe=Ot.y):b&4?($t=r.x+Y*(At.y-r.y)/lt,pe=At.y):b&2?($t=Ot.x,pe=r.y+lt*(Ot.x-r.x)/Y):b&1&&($t=At.x,pe=r.y+lt*(At.x-r.x)/Y),new re($t,pe,N)}function Ia(r,d){var b=0;return r.x<d.min.x?b|=1:r.x>d.max.x&&(b|=2),r.y<d.min.y?b|=4:r.y>d.max.y&&(b|=8),b}function Tu(r,d){var b=d.x-r.x,I=d.y-r.y;return b*b+I*I}function vo(r,d,b,I){var N=d.x,Y=d.y,lt=b.x-N,At=b.y-Y,Ot=lt*lt+At*At,$t;return Ot>0&&($t=((r.x-N)*lt+(r.y-Y)*At)/Ot,$t>1?(N=b.x,Y=b.y):$t>0&&(N+=lt*$t,Y+=At*$t)),lt=r.x-N,At=r.y-Y,I?lt*lt+At*At:new re(N,Y)}function qa(r){return!We(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]<"u"}function xo(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),qa(r)}function Jr(r,d){var b,I,N,Y,lt,At,Ot,$t;if(!r||r.length===0)throw new Error("latlngs not passed");qa(r)||(console.warn("latlngs are not flat! Only the first ring will be used"),r=r[0]);var pe=xe([0,0]),Re=ae(r),_i=Re.getNorthWest().distanceTo(Re.getSouthWest())*Re.getNorthEast().distanceTo(Re.getNorthWest());_i<1700&&(pe=go(r));var oa=r.length,Rn=[];for(b=0;b<oa;b++){var Ra=xe(r[b]);Rn.push(d.project(xe([Ra.lat-pe.lat,Ra.lng-pe.lng])))}for(b=0,I=0;b<oa-1;b++)I+=Rn[b].distanceTo(Rn[b+1])/2;if(I===0)$t=Rn[0];else for(b=0,Y=0;b<oa-1;b++)if(lt=Rn[b],At=Rn[b+1],N=lt.distanceTo(At),Y+=N,Y>I){Ot=(Y-I)/N,$t=[At.x-Ot*(At.x-lt.x),At.y-Ot*(At.y-lt.y)];break}var Li=d.unproject(ge($t));return xe([Li.lat+pe.lat,Li.lng+pe.lng])}var bo={__proto__:null,simplify:dl,pointToSegmentDistance:Wu,closestPointOnSegment:Oc,clipSegment:Su,_getEdgeIntersection:yo,_getBitCode:Ia,_sqClosestPointOnSegment:vo,isFlat:qa,_flat:xo,polylineCenter:Jr},Yo={project:function(r){return new re(r.lng,r.lat)},unproject:function(r){return new me(r.y,r.x)},bounds:new dt([-180,-90],[180,90])},Hl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new dt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var d=Math.PI/180,b=this.R,I=r.lat*d,N=this.R_MINOR/b,Y=Math.sqrt(1-N*N),lt=Y*Math.sin(I),At=Math.tan(Math.PI/4-I/2)/Math.pow((1-lt)/(1+lt),Y/2);return I=-b*Math.log(Math.max(At,1e-10)),new re(r.lng*d*b,I)},unproject:function(r){for(var d=180/Math.PI,b=this.R,I=this.R_MINOR/b,N=Math.sqrt(1-I*I),Y=Math.exp(-r.y/b),lt=Math.PI/2-2*Math.atan(Y),At=0,Ot=.1,$t;At<15&&Math.abs(Ot)>1e-7;At++)$t=N*Math.sin(lt),$t=Math.pow((1-$t)/(1+$t),N/2),Ot=Math.PI/2-2*Math.atan(Y*$t)-lt,lt+=Ot;return new me(lt*d,r.x*d/b)}},zn={__proto__:null,LonLat:Yo,Mercator:Hl,SphericalMercator:Qa},Qu=V({},Mi,{code:"EPSG:3395",projection:Hl,transformation:(function(){var r=.5/(Math.PI*Hl.R);return za(r,.5,-r,.5)})()}),oi=V({},Mi,{code:"EPSG:4326",projection:Yo,transformation:za(1/180,1,-1/180,.5)}),Lr=V({},Ve,{projection:Yo,transformation:za(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,d){var b=d.lng-r.lng,I=d.lat-r.lat;return Math.sqrt(b*b+I*I)},infinite:!0});Ve.Earth=Mi,Ve.EPSG3395=Qu,Ve.EPSG3857=ks,Ve.EPSG900913=Ua,Ve.EPSG4326=oi,Ve.Simple=Lr;var Si=ce.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[bt(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[bt(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var d=r.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var b=this.getEvents();d.on(b,this),this.once("remove",function(){d.off(b,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});hi.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var d=bt(r);return this._layers[d]?this:(this._layers[d]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var d=bt(r);return this._layers[d]?(this._loaded&&r.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return bt(r)in this._layers},eachLayer:function(r,d){for(var b in this._layers)r.call(d,this._layers[b]);return this},_addLayers:function(r){r=r?We(r)?r:[r]:[];for(var d=0,b=r.length;d<b;d++)this.addLayer(r[d])},_addZoomLimit:function(r){(!isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[bt(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var d=bt(r);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,d=-1/0,b=this._getZoomSpan();for(var I in this._zoomBoundLayers){var N=this._zoomBoundLayers[I].options;r=N.minZoom===void 0?r:Math.min(r,N.minZoom),d=N.maxZoom===void 0?d:Math.max(d,N.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=r===1/0?void 0:r,b!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Di=Si.extend({initialize:function(r,d){je(this,d),this._layers={};var b,I;if(r)for(b=0,I=r.length;b<I;b++)this.addLayer(r[b])},addLayer:function(r){var d=this.getLayerId(r);return this._layers[d]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var d=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(r){var d=typeof r=="number"?r:this.getLayerId(r);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var d=Array.prototype.slice.call(arguments,1),b,I;for(b in this._layers)I=this._layers[b],I[r]&&I[r].apply(I,d);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,d){for(var b in this._layers)r.call(d,this._layers[b]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return bt(r)}}),wo=function(r,d){return new Di(r,d)},Ga=Di.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),Di.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),Di.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new Ht;for(var d in this._layers){var b=this._layers[d];r.extend(b.getBounds?b.getBounds():b.getLatLng())}return r}}),Ko=function(r,d){return new Ga(r,d)},Ss=Pi.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(r){je(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,d){var b=this._getIconUrl(r);if(!b){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var I=this._createImg(b,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(I,r),(this.options.crossOrigin||this.options.crossOrigin==="")&&(I.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),I},_setIconStyles:function(r,d){var b=this.options,I=b[d+"Size"];typeof I=="number"&&(I=[I,I]);var N=ge(I),Y=ge(d==="shadow"&&b.shadowAnchor||b.iconAnchor||N&&N.divideBy(2,!0));r.className="leaflet-marker-"+d+" "+(b.className||""),Y&&(r.style.marginLeft=-Y.x+"px",r.style.marginTop=-Y.y+"px"),N&&(r.style.width=N.x+"px",r.style.height=N.y+"px")},_createImg:function(r,d){return d=d||document.createElement("img"),d.src=r,d},_getIconUrl:function(r){return Ft.retina&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function Us(r){return new Ss(r)}var nr=Ss.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return typeof nr.imagePath!="string"&&(nr.imagePath=this._detectIconPath()),(this.options.imagePath||nr.imagePath)+Ss.prototype._getIconUrl.call(this,r)},_stripUrl:function(r){var d=function(b,I,N){var Y=I.exec(b);return Y&&Y[N]};return r=d(r,/^url\((['"])?(.+)\1\)$/,2),r&&d(r,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var r=Ue("div","leaflet-default-icon-path",document.body),d=Os(r,"background-image")||Os(r,"backgroundImage");if(document.body.removeChild(r),d=this._stripUrl(d),d)return d;var b=document.querySelector('link[href$="leaflet.css"]');return b?b.href.substring(0,b.href.length-11-1):""}}),ya=Fs.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new Cr(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ai(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Fi(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var d=this._marker,b=d._map,I=this._marker.options.autoPanSpeed,N=this._marker.options.autoPanPadding,Y=ns(d._icon),lt=b.getPixelBounds(),At=b.getPixelOrigin(),Ot=St(lt.min._subtract(At).add(N),lt.max._subtract(At).subtract(N));if(!Ot.contains(Y)){var $t=ge((Math.max(Ot.max.x,Y.x)-Ot.max.x)/(lt.max.x-Ot.max.x)-(Math.min(Ot.min.x,Y.x)-Ot.min.x)/(lt.min.x-Ot.min.x),(Math.max(Ot.max.y,Y.y)-Ot.max.y)/(lt.max.y-Ot.max.y)-(Math.min(Ot.min.y,Y.y)-Ot.min.y)/(lt.min.y-Ot.min.y)).multiplyBy(I);b.panBy($t,{animate:!1}),this._draggable._newPos._add($t),this._draggable._startPos._add($t),an(d._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=Fe(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(Ei(this._panRequest),this._panRequest=Fe(this._adjustPan.bind(this,r)))},_onDrag:function(r){var d=this._marker,b=d._shadow,I=ns(d._icon),N=d._map.layerPointToLatLng(I);b&&an(b,I),d._latlng=N,r.latlng=N,r.oldLatLng=this._oldLatLng,d.fire("move",r).fire("drag",r)},_onDragEnd:function(r){Ei(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),So=Si.extend({options:{icon:new nr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,d){je(this,d),this._latlng=xe(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var d=this._latlng;return this._latlng=xe(r),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),b=r.icon.createIcon(this._icon),I=!1;b!==this._icon&&(this._icon&&this._removeIcon(),I=!0,r.title&&(b.title=r.title),b.tagName==="IMG"&&(b.alt=r.alt||"")),ai(b,d),r.keyboard&&(b.tabIndex="0",b.setAttribute("role","button")),this._icon=b,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ke(b,"focus",this._panOnFocus,this);var N=r.icon.createShadow(this._shadow),Y=!1;N!==this._shadow&&(this._removeShadow(),Y=!0),N&&(ai(N,d),N.alt=""),this._shadow=N,r.opacity<1&&this._updateOpacity(),I&&this.getPane().appendChild(this._icon),this._initInteraction(),N&&Y&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ji(this._icon,"focus",this._panOnFocus,this),qi(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&qi(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&an(this._icon,r),this._shadow&&an(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var d=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(ai(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ya)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ya(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&Ki(this._icon,r),this._shadow&&Ki(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var r=this._map;if(r){var d=this.options.icon.options,b=d.iconSize?ge(d.iconSize):ge(0,0),I=d.iconAnchor?ge(d.iconAnchor):ge(0,0);r.panInside(this._latlng,{paddingTopLeft:I,paddingBottomRight:b.subtract(I)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Xl(r,d){return new So(r,d)}var Ts=Si.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return je(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),As=Ts.extend({options:{fill:!0,radius:10},initialize:function(r,d){je(this,d),this._latlng=xe(r),this._radius=this.options.radius},setLatLng:function(r){var d=this._latlng;return this._latlng=xe(r),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var d=r&&r.radius||this._radius;return Ts.prototype.setStyle.call(this,r),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,d=this._radiusY||r,b=this._clickTolerance(),I=[r+b,d+b];this._pxBounds=new dt(this._point.subtract(I),this._point.add(I))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Wo(r,d){return new As(r,d)}var Qr=As.extend({initialize:function(r,d,b){if(typeof d=="number"&&(d=V({},b,{radius:d})),je(this,d),this._latlng=xe(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new Ht(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:Ts.prototype.setStyle,_project:function(){var r=this._latlng.lng,d=this._latlng.lat,b=this._map,I=b.options.crs;if(I.distance===Mi.distance){var N=Math.PI/180,Y=this._mRadius/Mi.R/N,lt=b.project([d+Y,r]),At=b.project([d-Y,r]),Ot=lt.add(At).divideBy(2),$t=b.unproject(Ot).lat,pe=Math.acos((Math.cos(Y*N)-Math.sin(d*N)*Math.sin($t*N))/(Math.cos(d*N)*Math.cos($t*N)))/N;(isNaN(pe)||pe===0)&&(pe=Y/Math.cos(Math.PI/180*d)),this._point=Ot.subtract(b.getPixelOrigin()),this._radius=isNaN(pe)?0:Ot.x-b.project([$t,r-pe]).x,this._radiusY=Ot.y-lt.y}else{var Re=I.unproject(I.project(this._latlng).subtract([this._mRadius,0]));this._point=b.latLngToLayerPoint(this._latlng),this._radius=this._point.x-b.latLngToLayerPoint(Re).x}this._updateBounds()}});function To(r,d,b){return new Qr(r,d,b)}var ss=Ts.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,d){je(this,d),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var d=1/0,b=null,I=vo,N,Y,lt=0,At=this._parts.length;lt<At;lt++)for(var Ot=this._parts[lt],$t=1,pe=Ot.length;$t<pe;$t++){N=Ot[$t-1],Y=Ot[$t];var Re=I(r,N,Y,!0);Re<d&&(d=Re,b=I(r,N,Y))}return b&&(b.distance=Math.sqrt(d)),b},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Jr(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(r,d){return d=d||this._defaultShape(),r=xe(r),d.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new Ht,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return qa(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var d=[],b=qa(r),I=0,N=r.length;I<N;I++)b?(d[I]=xe(r[I]),this._bounds.extend(d[I])):d[I]=this._convertLatLngs(r[I]);return d},_project:function(){var r=new dt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),d=new re(r,r);this._rawPxBounds&&(this._pxBounds=new dt([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(r,d,b){var I=r[0]instanceof me,N=r.length,Y,lt;if(I){for(lt=[],Y=0;Y<N;Y++)lt[Y]=this._map.latLngToLayerPoint(r[Y]),b.extend(lt[Y]);d.push(lt)}else for(Y=0;Y<N;Y++)this._projectLatlngs(r[Y],d,b)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,b,I,N,Y,lt,At,Ot;for(b=0,N=0,Y=this._rings.length;b<Y;b++)for(Ot=this._rings[b],I=0,lt=Ot.length;I<lt-1;I++)At=Su(Ot[I],Ot[I+1],r,I,!0),At&&(d[N]=d[N]||[],d[N].push(At[0]),(At[1]!==Ot[I+1]||I===lt-2)&&(d[N].push(At[1]),N++))}},_simplifyPoints:function(){for(var r=this._parts,d=this.options.smoothFactor,b=0,I=r.length;b<I;b++)r[b]=dl(r[b],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,d){var b,I,N,Y,lt,At,Ot=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(b=0,Y=this._parts.length;b<Y;b++)for(At=this._parts[b],I=0,lt=At.length,N=lt-1;I<lt;N=I++)if(!(!d&&I===0)&&Wu(r,At[N],At[I])<=Ot)return!0;return!1}});function $l(r,d){return new ss(r,d)}ss._flat=xo;var Zs=ss.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return xu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(r){var d=ss.prototype._convertLatLngs.call(this,r),b=d.length;return b>=2&&d[0]instanceof me&&d[0].equals(d[b-1])&&d.pop(),d},_setLatLngs:function(r){ss.prototype._setLatLngs.call(this,r),qa(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return qa(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,d=this.options.weight,b=new re(d,d);if(r=new dt(r.min.subtract(b),r.max.add(b)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var I=0,N=this._rings.length,Y;I<N;I++)Y=Ku(this._rings[I],r,!0),Y.length&&this._parts.push(Y)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var d=!1,b,I,N,Y,lt,At,Ot,$t;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(Y=0,Ot=this._parts.length;Y<Ot;Y++)for(b=this._parts[Y],lt=0,$t=b.length,At=$t-1;lt<$t;At=lt++)I=b[lt],N=b[At],I.y>r.y!=N.y>r.y&&r.x<(N.x-I.x)*(r.y-I.y)/(N.y-I.y)+I.x&&(d=!d);return d||ss.prototype._containsPoint.call(this,r,!0)}});function Jo(r,d){return new Zs(r,d)}var ar=Ga.extend({initialize:function(r,d){je(this,d),this._layers={},r&&this.addData(r)},addData:function(r){var d=We(r)?r:r.features,b,I,N;if(d){for(b=0,I=d.length;b<I;b++)N=d[b],(N.geometries||N.geometry||N.features||N.coordinates)&&this.addData(N);return this}var Y=this.options;if(Y.filter&&!Y.filter(r))return this;var lt=ra(r,Y);return lt?(lt.feature=Eo(r),lt.defaultOptions=lt.options,this.resetStyle(lt),Y.onEachFeature&&Y.onEachFeature(r,lt),this.addLayer(lt)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=V({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(d){this._setLayerStyle(d,r)},this)},_setLayerStyle:function(r,d){r.setStyle&&(typeof d=="function"&&(d=d(r.feature)),r.setStyle(d))}});function ra(r,d){var b=r.type==="Feature"?r.geometry:r,I=b?b.coordinates:null,N=[],Y=d&&d.pointToLayer,lt=d&&d.coordsToLatLng||Ao,At,Ot,$t,pe;if(!I&&!b)return null;switch(b.type){case"Point":return At=lt(I),mi(Y,r,At,d);case"MultiPoint":for($t=0,pe=I.length;$t<pe;$t++)At=lt(I[$t]),N.push(mi(Y,r,At,d));return new Ga(N);case"LineString":case"MultiLineString":return Ot=pl(I,b.type==="LineString"?0:1,lt),new ss(Ot,d);case"Polygon":case"MultiPolygon":return Ot=pl(I,b.type==="Polygon"?1:2,lt),new Zs(Ot,d);case"GeometryCollection":for($t=0,pe=b.geometries.length;$t<pe;$t++){var Re=ra({geometry:b.geometries[$t],type:"Feature",properties:r.properties},d);Re&&N.push(Re)}return new Ga(N);case"FeatureCollection":for($t=0,pe=b.features.length;$t<pe;$t++){var _i=ra(b.features[$t],d);_i&&N.push(_i)}return new Ga(N);default:throw new Error("Invalid GeoJSON object.")}}function mi(r,d,b,I){return r?r(d,b):new So(b,I&&I.markersInheritOptions&&I)}function Ao(r){return new me(r[1],r[0],r[2])}function pl(r,d,b){for(var I=[],N=0,Y=r.length,lt;N<Y;N++)lt=d?pl(r[N],d-1,b):(b||Ao)(r[N]),I.push(lt);return I}function ml(r,d){return r=xe(r),r.alt!==void 0?[Mt(r.lng,d),Mt(r.lat,d),Mt(r.alt,d)]:[Mt(r.lng,d),Mt(r.lat,d)]}function sr(r,d,b,I){for(var N=[],Y=0,lt=r.length;Y<lt;Y++)N.push(d?sr(r[Y],qa(r[Y])?0:d-1,b,I):ml(r[Y],I));return!d&&b&&N.length>0&&N.push(N[0].slice()),N}function Ir(r,d){return r.feature?V({},r.feature,{geometry:d}):Eo(d)}function Eo(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var Pr={toGeoJSON:function(r){return Ir(this,{type:"Point",coordinates:ml(this.getLatLng(),r)})}};So.include(Pr),Qr.include(Pr),As.include(Pr),ss.include({toGeoJSON:function(r){var d=!qa(this._latlngs),b=sr(this._latlngs,d?1:0,!1,r);return Ir(this,{type:(d?"Multi":"")+"LineString",coordinates:b})}}),Zs.include({toGeoJSON:function(r){var d=!qa(this._latlngs),b=d&&!qa(this._latlngs[0]),I=sr(this._latlngs,b?2:d?1:0,!0,r);return d||(I=[I]),Ir(this,{type:(b?"Multi":"")+"Polygon",coordinates:I})}}),Di.include({toMultiPoint:function(r){var d=[];return this.eachLayer(function(b){d.push(b.toGeoJSON(r).geometry.coordinates)}),Ir(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(r){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(r);var b=d==="GeometryCollection",I=[];return this.eachLayer(function(N){if(N.toGeoJSON){var Y=N.toGeoJSON(r);if(b)I.push(Y.geometry);else{var lt=Eo(Y);lt.type==="FeatureCollection"?I.push.apply(I,lt.features):I.push(lt)}}}),b?Ir(this,{geometries:I,type:"GeometryCollection"}):{type:"FeatureCollection",features:I}}});function _l(r,d){return new ar(r,d)}var to=_l,Dr=Si.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,d,b){this._url=r,this._bounds=ae(d),je(this,b)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ai(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){qi(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&bi(this._image),this},bringToBack:function(){return this._map&&Qs(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=ae(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",d=this._image=r?this._url:Ue("img");if(ai(d,"leaflet-image-layer"),this._zoomAnimated&&ai(d,"leaflet-zoom-animated"),this.options.className&&ai(d,this.options.className),d.onselectstart=It,d.onmousemove=It,d.onload=O(this.fire,this,"load"),d.onerror=O(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(r){var d=this._map.getZoomScale(r.zoom),b=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;Bs(this._image,b,d)},_reset:function(){var r=this._image,d=new dt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),b=d.getSize();an(r,d.min),r.style.width=b.x+"px",r.style.height=b.y+"px"},_updateOpacity:function(){Ki(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)},getCenter:function(){return this._bounds.getCenter()}}),Mo=function(r,d,b){return new Dr(r,d,b)},rs=Dr.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var r=this._url.tagName==="VIDEO",d=this._image=r?this._url:Ue("video");if(ai(d,"leaflet-image-layer"),this._zoomAnimated&&ai(d,"leaflet-zoom-animated"),this.options.className&&ai(d,this.options.className),d.onselectstart=It,d.onmousemove=It,d.onloadeddata=O(this.fire,this,"load"),r){for(var b=d.getElementsByTagName("source"),I=[],N=0;N<b.length;N++)I.push(b[N].src);this._url=b.length>0?I:[d.src];return}We(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var Y=0;Y<this._url.length;Y++){var lt=Ue("source");lt.src=this._url[Y],d.appendChild(lt)}}});function js(r,d,b){return new rs(r,d,b)}var Qo=Dr.extend({_initImage:function(){var r=this._image=this._url;ai(r,"leaflet-image-layer"),this._zoomAnimated&&ai(r,"leaflet-zoom-animated"),this.options.className&&ai(r,this.options.className),r.onselectstart=It,r.onmousemove=It}});function zo(r,d,b){return new Qo(r,d,b)}var qn=Si.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(r,d){r&&(r instanceof me||We(r))?(this._latlng=xe(r),je(this,d)):(je(this,r),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(r){return r=arguments.length?r:this._source._map,r.hasLayer(this)||r.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(r){return this._map?this.close():(arguments.length?this._source=r:r=this._source,this._prepareOpen(),this.openOn(r._map)),this},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&Ki(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&Ki(this._container,1),this.bringToFront(),this.options.interactive&&(ai(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(r){r._fadeAnimated?(Ki(this._container,0),this._removeTimeout=setTimeout(O(qi,void 0,this._container),200)):qi(this._container),this.options.interactive&&(Fi(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=xe(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&bi(this._container),this},bringToBack:function(){return this._map&&Qs(this._container),this},_prepareOpen:function(r){var d=this._source;if(!d._map)return!1;if(d instanceof Ga){d=null;var b=this._source._layers;for(var I in b)if(b[I]._map){d=b[I];break}if(!d)return!1;this._source=d}if(!r)if(d.getCenter)r=d.getCenter();else if(d.getLatLng)r=d.getLatLng();else if(d.getBounds)r=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(r),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var r=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")r.innerHTML=d;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var r=this._map.latLngToLayerPoint(this._latlng),d=ge(this.options.offset),b=this._getAnchor();this._zoomAnimated?an(this._container,r.add(b)):d=d.add(r).add(b);var I=this._containerBottom=-d.y,N=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=I+"px",this._container.style.left=N+"px"}},_getAnchor:function(){return[0,0]}});hi.include({_initOverlay:function(r,d,b,I){var N=d;return N instanceof r||(N=new r(I).setContent(d)),b&&N.setLatLng(b),N}}),Si.include({_initOverlay:function(r,d,b,I){var N=b;return N instanceof r?(je(N,I),N._source=this):(N=d&&!I?d:new r(I,this),N.setContent(b)),N}});var eo=qn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r=arguments.length?r:this._source._map,!r.hasLayer(this)&&r._popup&&r._popup.options.autoClose&&r.removeLayer(r._popup),r._popup=this,qn.prototype.openOn.call(this,r)},onAdd:function(r){qn.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ts||this._source.on("preclick",xs))},onRemove:function(r){qn.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ts||this._source.off("preclick",xs))},getEvents:function(){var r=qn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this.close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_initLayout:function(){var r="leaflet-popup",d=this._container=Ue("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),b=this._wrapper=Ue("div",r+"-content-wrapper",d);if(this._contentNode=Ue("div",r+"-content",b),po(d),er(this._contentNode),Ke(d,"contextmenu",xs),this._tipContainer=Ue("div",r+"-tip-container",d),this._tip=Ue("div",r+"-tip",this._tipContainer),this.options.closeButton){var I=this._closeButton=Ue("a",r+"-close-button",d);I.setAttribute("role","button"),I.setAttribute("aria-label","Close popup"),I.href="#close",I.innerHTML='<span aria-hidden="true">&#215;</span>',Ke(I,"click",function(N){kn(N),this.close()},this)}},_updateLayout:function(){var r=this._contentNode,d=r.style;d.width="",d.whiteSpace="nowrap";var b=r.offsetWidth;b=Math.min(b,this.options.maxWidth),b=Math.max(b,this.options.minWidth),d.width=b+1+"px",d.whiteSpace="",d.height="";var I=r.offsetHeight,N=this.options.maxHeight,Y="leaflet-popup-scrolled";N&&I>N?(d.height=N+"px",ai(r,Y)):Fi(r,Y),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var d=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),b=this._getAnchor();an(this._container,d.add(b))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var r=this._map,d=parseInt(Os(this._container,"marginBottom"),10)||0,b=this._container.offsetHeight+d,I=this._containerWidth,N=new re(this._containerLeft,-b-this._containerBottom);N._add(ns(this._container));var Y=r.layerPointToContainerPoint(N),lt=ge(this.options.autoPanPadding),At=ge(this.options.autoPanPaddingTopLeft||lt),Ot=ge(this.options.autoPanPaddingBottomRight||lt),$t=r.getSize(),pe=0,Re=0;Y.x+I+Ot.x>$t.x&&(pe=Y.x+I-$t.x+Ot.x),Y.x-pe-At.x<0&&(pe=Y.x-At.x),Y.y+b+Ot.y>$t.y&&(Re=Y.y+b-$t.y+Ot.y),Y.y-Re-At.y<0&&(Re=Y.y-At.y),(pe||Re)&&(this.options.keepInView&&(this._autopanning=!0),r.fire("autopanstart").panBy([pe,Re]))}},_getAnchor:function(){return ge(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),gl=function(r,d){return new eo(r,d)};hi.mergeOptions({closePopupOnClick:!0}),hi.include({openPopup:function(r,d,b){return this._initOverlay(eo,r,d,b).openOn(this),this},closePopup:function(r){return r=arguments.length?r:this._popup,r&&r.close(),this}}),Si.include({bindPopup:function(r,d){return this._popup=this._initOverlay(eo,this._popup,r,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r){return this._popup&&(this instanceof Ga||(this._popup._source=this),this._popup._prepareOpen(r||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){if(!(!this._popup||!this._map)){bs(r);var d=r.layer||r.target;if(this._popup._source===d&&!(d instanceof Ts)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(r.latlng);return}this._popup._source=d,this.openPopup(r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var Co=qn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(r){qn.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(r){qn.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var r=qn.prototype.getEvents.call(this);return this.options.permanent||(r.preclick=this.close),r},_initLayout:function(){var r="leaflet-tooltip",d=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ue("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+bt(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var d,b,I=this._map,N=this._container,Y=I.latLngToContainerPoint(I.getCenter()),lt=I.layerPointToContainerPoint(r),At=this.options.direction,Ot=N.offsetWidth,$t=N.offsetHeight,pe=ge(this.options.offset),Re=this._getAnchor();At==="top"?(d=Ot/2,b=$t):At==="bottom"?(d=Ot/2,b=0):At==="center"?(d=Ot/2,b=$t/2):At==="right"?(d=0,b=$t/2):At==="left"?(d=Ot,b=$t/2):lt.x<Y.x?(At="right",d=0,b=$t/2):(At="left",d=Ot+(pe.x+Re.x)*2,b=$t/2),r=r.subtract(ge(d,b,!0)).add(pe).add(Re),Fi(N,"leaflet-tooltip-right"),Fi(N,"leaflet-tooltip-left"),Fi(N,"leaflet-tooltip-top"),Fi(N,"leaflet-tooltip-bottom"),ai(N,"leaflet-tooltip-"+At),an(N,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&Ki(this._container,r)},_animateZoom:function(r){var d=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(d)},_getAnchor:function(){return ge(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Bc=function(r,d){return new Co(r,d)};hi.include({openTooltip:function(r,d,b){return this._initOverlay(Co,r,d,b).openOn(this),this},closeTooltip:function(r){return r.close(),this}}),Si.include({bindTooltip:function(r,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Co,this._tooltip,r,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var d=r?"off":"on",b={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?b.add=this._openTooltip:(b.mouseover=this._openTooltip,b.mouseout=this.closeTooltip,b.click=this._openTooltip,this._map?this._addFocusListeners():b.add=this._addFocusListeners),this._tooltip.options.sticky&&(b.mousemove=this._moveTooltip),this[d](b),this._tooltipHandlersAdded=!r}},openTooltip:function(r){return this._tooltip&&(this instanceof Ga||(this._tooltip._source=this),this._tooltip._prepareOpen(r)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(r){var d=typeof r.getElement=="function"&&r.getElement();d&&(Ke(d,"focus",function(){this._tooltip._source=r,this.openTooltip()},this),Ke(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(r){var d=typeof r.getElement=="function"&&r.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(r){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(r)});return}this._tooltip._source=r.layer||r.target,this.openTooltip(this._tooltip.options.sticky?r.latlng:void 0)}},_moveTooltip:function(r){var d=r.latlng,b,I;this._tooltip.options.sticky&&r.originalEvent&&(b=this._map.mouseEventToContainerPoint(r.originalEvent),I=this._map.containerPointToLayerPoint(b),d=this._map.layerPointToLatLng(I)),this._tooltip.setLatLng(d)}});var Au=Ss.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var d=r&&r.tagName==="DIV"?r:document.createElement("div"),b=this.options;if(b.html instanceof Element?(In(d),d.appendChild(b.html)):d.innerHTML=b.html!==!1?b.html:"",b.bgPos){var I=ge(b.bgPos);d.style.backgroundPosition=-I.x+"px "+-I.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function Yl(r){return new Au(r)}Ss.Default=nr;var io=Si.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ft.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){je(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),qi(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(bi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Qs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var r=this._clampZoom(this._map.getZoom());r!==this._tileZoom&&(this._tileZoom=r,this._updateLevels()),this._update()}return this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Et(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof re?r:new re(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var d=this.getPane().children,b=-r(-1/0,1/0),I=0,N=d.length,Y;I<N;I++)Y=d[I].style.zIndex,d[I]!==this._container&&Y&&(b=r(b,+Y));isFinite(b)&&(this.options.zIndex=b+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ft.ielt9){Ki(this._container,this.options.opacity);var r=+new Date,d=!1,b=!1;for(var I in this._tiles){var N=this._tiles[I];if(!(!N.current||!N.loaded)){var Y=Math.min(1,(r-N.loaded)/200);Ki(N.el,Y),Y<1?d=!0:(N.active?b=!0:this._onOpaqueTile(N),N.active=!0)}}b&&!this._noPrune&&this._pruneTiles(),d&&(Ei(this._fadeFrame),this._fadeFrame=Fe(this._updateOpacity,this))}},_onOpaqueTile:It,_initContainer:function(){this._container||(this._container=Ue("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,d=this.options.maxZoom;if(r!==void 0){for(var b in this._levels)b=Number(b),this._levels[b].el.children.length||b===r?(this._levels[b].el.style.zIndex=d-Math.abs(r-b),this._onUpdateLevel(b)):(qi(this._levels[b].el),this._removeTilesAtZoom(b),this._onRemoveLevel(b),delete this._levels[b]);var I=this._levels[r],N=this._map;return I||(I=this._levels[r]={},I.el=Ue("div","leaflet-tile-container leaflet-zoom-animated",this._container),I.el.style.zIndex=d,I.origin=N.project(N.unproject(N.getPixelOrigin()),r).round(),I.zoom=r,this._setZoomTransform(I,N.getCenter(),N.getZoom()),It(I.el.offsetWidth),this._onCreateLevel(I)),this._level=I,I}},_onUpdateLevel:It,_onRemoveLevel:It,_onCreateLevel:It,_pruneTiles:function(){if(this._map){var r,d,b=this._map.getZoom();if(b>this.options.maxZoom||b<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)d=this._tiles[r],d.retain=d.current;for(r in this._tiles)if(d=this._tiles[r],d.current&&!d.active){var I=d.coords;this._retainParent(I.x,I.y,I.z,I.z-5)||this._retainChildren(I.x,I.y,I.z,I.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var d in this._tiles)this._tiles[d].coords.z===r&&this._removeTile(d)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)qi(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,d,b,I){var N=Math.floor(r/2),Y=Math.floor(d/2),lt=b-1,At=new re(+N,+Y);At.z=+lt;var Ot=this._tileCoordsToKey(At),$t=this._tiles[Ot];return $t&&$t.active?($t.retain=!0,!0):($t&&$t.loaded&&($t.retain=!0),lt>I?this._retainParent(N,Y,lt,I):!1)},_retainChildren:function(r,d,b,I){for(var N=2*r;N<2*r+2;N++)for(var Y=2*d;Y<2*d+2;Y++){var lt=new re(N,Y);lt.z=b+1;var At=this._tileCoordsToKey(lt),Ot=this._tiles[At];if(Ot&&Ot.active){Ot.retain=!0;continue}else Ot&&Ot.loaded&&(Ot.retain=!0);b+1<I&&this._retainChildren(N,Y,b+1,I)}},_resetView:function(r){var d=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var d=this.options;return d.minNativeZoom!==void 0&&r<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<r?d.maxNativeZoom:r},_setView:function(r,d,b,I){var N=Math.round(d);this.options.maxZoom!==void 0&&N>this.options.maxZoom||this.options.minZoom!==void 0&&N<this.options.minZoom?N=void 0:N=this._clampZoom(N);var Y=this.options.updateWhenZooming&&N!==this._tileZoom;(!I||Y)&&(this._tileZoom=N,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),N!==void 0&&this._update(r),b||this._pruneTiles(),this._noPrune=!!b),this._setZoomTransforms(r,d)},_setZoomTransforms:function(r,d){for(var b in this._levels)this._setZoomTransform(this._levels[b],r,d)},_setZoomTransform:function(r,d,b){var I=this._map.getZoomScale(b,r.zoom),N=r.origin.multiplyBy(I).subtract(this._map._getNewPixelOrigin(d,b)).round();Ft.any3d?Bs(r.el,N,I):an(r.el,N)},_resetGrid:function(){var r=this._map,d=r.options.crs,b=this._tileSize=this.getTileSize(),I=this._tileZoom,N=this._map.getPixelWorldBounds(this._tileZoom);N&&(this._globalTileRange=this._pxBoundsToTileRange(N)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,d.wrapLng[0]],I).x/b.x),Math.ceil(r.project([0,d.wrapLng[1]],I).x/b.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([d.wrapLat[0],0],I).y/b.x),Math.ceil(r.project([d.wrapLat[1],0],I).y/b.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var d=this._map,b=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),I=d.getZoomScale(b,this._tileZoom),N=d.project(r,this._tileZoom).floor(),Y=d.getSize().divideBy(I*2);return new dt(N.subtract(Y),N.add(Y))},_update:function(r){var d=this._map;if(d){var b=this._clampZoom(d.getZoom());if(r===void 0&&(r=d.getCenter()),this._tileZoom!==void 0){var I=this._getTiledPixelBounds(r),N=this._pxBoundsToTileRange(I),Y=N.getCenter(),lt=[],At=this.options.keepBuffer,Ot=new dt(N.getBottomLeft().subtract([At,-At]),N.getTopRight().add([At,-At]));if(!(isFinite(N.min.x)&&isFinite(N.min.y)&&isFinite(N.max.x)&&isFinite(N.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var $t in this._tiles){var pe=this._tiles[$t].coords;(pe.z!==this._tileZoom||!Ot.contains(new re(pe.x,pe.y)))&&(this._tiles[$t].current=!1)}if(Math.abs(b-this._tileZoom)>1){this._setView(r,b);return}for(var Re=N.min.y;Re<=N.max.y;Re++)for(var _i=N.min.x;_i<=N.max.x;_i++){var oa=new re(_i,Re);if(oa.z=this._tileZoom,!!this._isValidTile(oa)){var Rn=this._tiles[this._tileCoordsToKey(oa)];Rn?Rn.current=!0:lt.push(oa)}}if(lt.sort(function(Li,ci){return Li.distanceTo(Y)-ci.distanceTo(Y)}),lt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ra=document.createDocumentFragment();for(_i=0;_i<lt.length;_i++)this._addTile(lt[_i],Ra);this._level.el.appendChild(Ra)}}}},_isValidTile:function(r){var d=this._map.options.crs;if(!d.infinite){var b=this._globalTileRange;if(!d.wrapLng&&(r.x<b.min.x||r.x>b.max.x)||!d.wrapLat&&(r.y<b.min.y||r.y>b.max.y))return!1}if(!this.options.bounds)return!0;var I=this._tileCoordsToBounds(r);return ae(this.options.bounds).overlaps(I)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var d=this._map,b=this.getTileSize(),I=r.scaleBy(b),N=I.add(b),Y=d.unproject(I,r.z),lt=d.unproject(N,r.z);return[Y,lt]},_tileCoordsToBounds:function(r){var d=this._tileCoordsToNwSe(r),b=new Ht(d[0],d[1]);return this.options.noWrap||(b=this._map.wrapLatLngBounds(b)),b},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var d=r.split(":"),b=new re(+d[0],+d[1]);return b.z=+d[2],b},_removeTile:function(r){var d=this._tiles[r];d&&(qi(d.el),delete this._tiles[r],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){ai(r,"leaflet-tile");var d=this.getTileSize();r.style.width=d.x+"px",r.style.height=d.y+"px",r.onselectstart=It,r.onmousemove=It,Ft.ielt9&&this.options.opacity<1&&Ki(r,this.options.opacity)},_addTile:function(r,d){var b=this._getTilePos(r),I=this._tileCoordsToKey(r),N=this.createTile(this._wrapCoords(r),O(this._tileReady,this,r));this._initTile(N),this.createTile.length<2&&Fe(O(this._tileReady,this,r,null,N)),an(N,b),this._tiles[I]={el:N,coords:r,current:!0},d.appendChild(N),this.fire("tileloadstart",{tile:N,coords:r})},_tileReady:function(r,d,b){d&&this.fire("tileerror",{error:d,tile:b,coords:r});var I=this._tileCoordsToKey(r);b=this._tiles[I],b&&(b.loaded=+new Date,this._map._fadeAnimated?(Ki(b.el,0),Ei(this._fadeFrame),this._fadeFrame=Fe(this._updateOpacity,this)):(b.active=!0,this._pruneTiles()),d||(ai(b.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:b.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ft.ielt9||!this._map._fadeAnimated?Fe(this._pruneTiles,this):setTimeout(O(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var d=new re(this._wrapX?Wt(r.x,this._wrapX):r.x,this._wrapY?Wt(r.y,this._wrapY):r.y);return d.z=r.z,d},_pxBoundsToTileRange:function(r){var d=this.getTileSize();return new dt(r.min.unscaleBy(d).floor(),r.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function tl(r){return new io(r)}var Es=io.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(r,d){this._url=r,d=je(this,d),d.detectRetina&&Ft.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(r,d){return this._url===r&&d===void 0&&(d=!0),this._url=r,d||this.redraw(),this},createTile:function(r,d){var b=document.createElement("img");return Ke(b,"load",O(this._tileOnLoad,this,d,b)),Ke(b,"error",O(this._tileOnError,this,d,b)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(b.referrerPolicy=this.options.referrerPolicy),b.alt="",b.src=this.getTileUrl(r),b},getTileUrl:function(r){var d={r:Ft.retina?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var b=this._globalTileRange.max.y-r.y;this.options.tms&&(d.y=b),d["-y"]=b}return ea(this._url,V(d,this.options))},_tileOnLoad:function(r,d){Ft.ielt9?setTimeout(O(r,this,null,d),0):r(null,d)},_tileOnError:function(r,d,b){var I=this.options.errorTileUrl;I&&d.getAttribute("src")!==I&&(d.src=I),r(b,d)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,d=this.options.maxZoom,b=this.options.zoomReverse,I=this.options.zoomOffset;return b&&(r=d-r),r+I},_getSubdomain:function(r){var d=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var r,d;for(r in this._tiles)if(this._tiles[r].coords.z!==this._tileZoom&&(d=this._tiles[r].el,d.onload=It,d.onerror=It,!d.complete)){d.src=Ni;var b=this._tiles[r].coords;qi(d),delete this._tiles[r],this.fire("tileabort",{tile:d,coords:b})}},_removeTile:function(r){var d=this._tiles[r];if(d)return d.el.setAttribute("src",Ni),io.prototype._removeTile.call(this,r)},_tileReady:function(r,d,b){if(!(!this._map||b&&b.getAttribute("src")===Ni))return io.prototype._tileReady.call(this,r,d,b)}});function sn(r,d){return new Es(r,d)}var Vs=Es.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,d){this._url=r;var b=V({},this.defaultWmsParams);for(var I in d)I in this.options||(b[I]=d[I]);d=je(this,d);var N=d.detectRetina&&Ft.retina?2:1,Y=this.getTileSize();b.width=Y.x*N,b.height=Y.y*N,this.wmsParams=b},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,Es.prototype.onAdd.call(this,r)},getTileUrl:function(r){var d=this._tileCoordsToNwSe(r),b=this._crs,I=St(b.project(d[0]),b.project(d[1])),N=I.min,Y=I.max,lt=(this._wmsVersion>=1.3&&this._crs===oi?[N.y,N.x,Y.y,Y.x]:[N.x,N.y,Y.x,Y.y]).join(","),At=Es.prototype.getTileUrl.call(this,r);return At+gi(this.wmsParams,At,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+lt},setParams:function(r,d){return V(this.wmsParams,r),d||this.redraw(),this}});function os(r,d){return new Vs(r,d)}Es.WMS=Vs,sn.wms=os;var Pa=Si.extend({options:{padding:.1},initialize:function(r){je(this,r),bt(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ai(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,d){var b=this._map.getZoomScale(d,this._zoom),I=this._map.getSize().multiplyBy(.5+this.options.padding),N=this._map.project(this._center,d),Y=I.multiplyBy(-b).add(N).subtract(this._map._getNewPixelOrigin(r,d));Ft.any3d?Bs(this._container,Y,b):an(this._container,Y)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,d=this._map.getSize(),b=this._map.containerPointToLayerPoint(d.multiplyBy(-r)).round();this._bounds=new dt(b,b.add(d.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),_n=Pa.extend({options:{tolerance:0},getEvents:function(){var r=Pa.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Pa.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");Ke(r,"mousemove",this._onMouseMove,this),Ke(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ke(r,"mouseout",this._handleMouseOut,this),r._leaflet_disable_events=!0,this._ctx=r.getContext("2d")},_destroyContainer:function(){Ei(this._redrawRequest),delete this._ctx,qi(this._container),ji(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var d in this._layers)r=this._layers[d],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Pa.prototype._update.call(this);var r=this._bounds,d=this._container,b=r.getSize(),I=Ft.retina?2:1;an(d,r.min),d.width=I*b.x,d.height=I*b.y,d.style.width=b.x+"px",d.style.height=b.y+"px",Ft.retina&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){Pa.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[bt(r)]=r;var d=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var d=r._order,b=d.next,I=d.prev;b?b.prev=I:this._drawLast=I,I?I.next=b:this._drawFirst=b,delete r._order,delete this._layers[bt(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var d=r.options.dashArray.split(/[, ]+/),b=[],I,N;for(N=0;N<d.length;N++){if(I=Number(d[N]),isNaN(I))return;b.push(I)}r.options._dashArray=b}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){this._map&&(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||Fe(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var d=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new dt,this._redrawBounds.extend(r._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(r._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var d=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,d=this._redrawBounds;if(this._ctx.save(),d){var b=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,b.x,b.y),this._ctx.clip()}this._drawing=!0;for(var I=this._drawFirst;I;I=I.next)r=I.layer,(!d||r._pxBounds&&r._pxBounds.intersects(d))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,d){if(this._drawing){var b,I,N,Y,lt=r._parts,At=lt.length,Ot=this._ctx;if(At){for(Ot.beginPath(),b=0;b<At;b++){for(I=0,N=lt[b].length;I<N;I++)Y=lt[b][I],Ot[I?"lineTo":"moveTo"](Y.x,Y.y);d&&Ot.closePath()}this._fillStroke(Ot,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var d=r._point,b=this._ctx,I=Math.max(Math.round(r._radius),1),N=(Math.max(Math.round(r._radiusY),1)||I)/I;N!==1&&(b.save(),b.scale(1,N)),b.beginPath(),b.arc(d.x,d.y/N,I,0,Math.PI*2,!1),N!==1&&b.restore(),this._fillStroke(b,r)}},_fillStroke:function(r,d){var b=d.options;b.fill&&(r.globalAlpha=b.fillOpacity,r.fillStyle=b.fillColor||b.color,r.fill(b.fillRule||"evenodd")),b.stroke&&b.weight!==0&&(r.setLineDash&&r.setLineDash(d.options&&d.options._dashArray||[]),r.globalAlpha=b.opacity,r.lineWidth=b.weight,r.strokeStyle=b.color,r.lineCap=b.lineCap,r.lineJoin=b.lineJoin,r.stroke())},_onClick:function(r){for(var d=this._map.mouseEventToLayerPoint(r),b,I,N=this._drawFirst;N;N=N.next)b=N.layer,b.options.interactive&&b._containsPoint(d)&&(!(r.type==="click"||r.type==="preclick")||!this._map._draggableMoved(b))&&(I=b);this._fireEvent(I?[I]:!1,r)},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,d)}},_handleMouseOut:function(r){var d=this._hoveredLayer;d&&(Fi(this._container,"leaflet-interactive"),this._fireEvent([d],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,d){if(!this._mouseHoverThrottled){for(var b,I,N=this._drawFirst;N;N=N.next)b=N.layer,b.options.interactive&&b._containsPoint(d)&&(I=b);I!==this._hoveredLayer&&(this._handleMouseOut(r),I&&(ai(this._container,"leaflet-interactive"),this._fireEvent([I],r,"mouseover"),this._hoveredLayer=I)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,r),this._mouseHoverThrottled=!0,setTimeout(O(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,d,b){this._map._fireDOMEvent(d,b||d.type,r)},_bringToFront:function(r){var d=r._order;if(d){var b=d.next,I=d.prev;if(b)b.prev=I;else return;I?I.next=b:b&&(this._drawFirst=b),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(r)}},_bringToBack:function(r){var d=r._order;if(d){var b=d.next,I=d.prev;if(I)I.next=b;else return;b?b.prev=I:I&&(this._drawLast=I),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(r)}}});function Da(r){return Ft.canvas?new _n(r):null}var Gn=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{}return function(r){return document.createElement("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Lo={_initContainer:function(){this._container=Ue("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Pa.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var d=r._container=Gn("shape");ai(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",r._path=Gn("path"),d.appendChild(r._path),this._updateStyle(r),this._layers[bt(r)]=r},_addPath:function(r){var d=r._container;this._container.appendChild(d),r.options.interactive&&r.addInteractiveTarget(d)},_removePath:function(r){var d=r._container;qi(d),r.removeInteractiveTarget(d),delete this._layers[bt(r)]},_updateStyle:function(r){var d=r._stroke,b=r._fill,I=r.options,N=r._container;N.stroked=!!I.stroke,N.filled=!!I.fill,I.stroke?(d||(d=r._stroke=Gn("stroke")),N.appendChild(d),d.weight=I.weight+"px",d.color=I.color,d.opacity=I.opacity,I.dashArray?d.dashStyle=We(I.dashArray)?I.dashArray.join(" "):I.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=I.lineCap.replace("butt","flat"),d.joinstyle=I.lineJoin):d&&(N.removeChild(d),r._stroke=null),I.fill?(b||(b=r._fill=Gn("fill")),N.appendChild(b),b.color=I.fillColor||I.color,b.opacity=I.fillOpacity):b&&(N.removeChild(b),r._fill=null)},_updateCircle:function(r){var d=r._point.round(),b=Math.round(r._radius),I=Math.round(r._radiusY||b);this._setPath(r,r._empty()?"M0 0":"AL "+d.x+","+d.y+" "+b+","+I+" 0,"+65535*360)},_setPath:function(r,d){r._path.v=d},_bringToFront:function(r){bi(r._container)},_bringToBack:function(r){Qs(r._container)}},Ms=Ft.vml?Gn:br,kr=Pa.extend({_initContainer:function(){this._container=Ms("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ms("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){qi(this._container),ji(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Pa.prototype._update.call(this);var r=this._bounds,d=r.getSize(),b=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,b.setAttribute("width",d.x),b.setAttribute("height",d.y)),an(b,r.min),b.setAttribute("viewBox",[r.min.x,r.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(r){var d=r._path=Ms("path");r.options.className&&ai(d,r.options.className),r.options.interactive&&ai(d,"leaflet-interactive"),this._updateStyle(r),this._layers[bt(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){qi(r._path),r.removeInteractiveTarget(r._path),delete this._layers[bt(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var d=r._path,b=r.options;d&&(b.stroke?(d.setAttribute("stroke",b.color),d.setAttribute("stroke-opacity",b.opacity),d.setAttribute("stroke-width",b.weight),d.setAttribute("stroke-linecap",b.lineCap),d.setAttribute("stroke-linejoin",b.lineJoin),b.dashArray?d.setAttribute("stroke-dasharray",b.dashArray):d.removeAttribute("stroke-dasharray"),b.dashOffset?d.setAttribute("stroke-dashoffset",b.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),b.fill?(d.setAttribute("fill",b.fillColor||b.color),d.setAttribute("fill-opacity",b.fillOpacity),d.setAttribute("fill-rule",b.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(r,d){this._setPath(r,Nt(r._parts,d))},_updateCircle:function(r){var d=r._point,b=Math.max(Math.round(r._radius),1),I=Math.max(Math.round(r._radiusY),1)||b,N="a"+b+","+I+" 0 1,0 ",Y=r._empty()?"M0 0":"M"+(d.x-b)+","+d.y+N+b*2+",0 "+N+-b*2+",0 ";this._setPath(r,Y)},_setPath:function(r,d){r._path.setAttribute("d",d)},_bringToFront:function(r){bi(r._path)},_bringToBack:function(r){Qs(r._path)}});Ft.vml&&kr.include(Lo);function rr(r){return Ft.svg||Ft.vml?new kr(r):null}hi.include({getRenderer:function(r){var d=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var d=this._paneRenderers[r];return d===void 0&&(d=this._createRenderer({pane:r}),this._paneRenderers[r]=d),d},_createRenderer:function(r){return this.options.preferCanvas&&Da(r)||rr(r)}});var ka=Zs.extend({initialize:function(r,d){Zs.prototype.initialize.call(this,this._boundsToLatLngs(r),d)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=ae(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Eu(r,d){return new ka(r,d)}kr.create=Ms,kr.pointsToPath=Nt,ar.geometryToLayer=ra,ar.coordsToLatLng=Ao,ar.coordsToLatLngs=pl,ar.latLngToCoords=ml,ar.latLngsToCoords=sr,ar.getFeature=Ir,ar.asFeature=Eo,hi.mergeOptions({boxZoom:!0});var da=Fs.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){Ke(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ji(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){qi(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),$r(),Mr(),this._startPoint=this._map.mouseEventToContainerPoint(r),Ke(document,{contextmenu:bs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=Ue("div","leaflet-zoom-box",this._container),ai(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var d=new dt(this._point,this._startPoint),b=d.getSize();an(this._box,d.min),this._box.style.width=b.x+"px",this._box.style.height=b.y+"px"},_finish:function(){this._moved&&(qi(this._box),Fi(this._container,"leaflet-crosshair")),as(),Ho(),ji(document,{contextmenu:bs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(O(this._resetState,this),0);var d=new Ht(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(r){r.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});hi.addInitHook("addHandler","boxZoom",da),hi.mergeOptions({doubleClickZoom:!0});var el=Fs.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var d=this._map,b=d.getZoom(),I=d.options.zoomDelta,N=r.originalEvent.shiftKey?b-I:b+I;d.options.doubleClickZoom==="center"?d.setZoom(N):d.setZoomAround(r.containerPoint,N)}});hi.addInitHook("addHandler","doubleClickZoom",el),hi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ls=Fs.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new Cr(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}ai(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Fi(this._map._container,"leaflet-grab"),Fi(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=ae(this._map.options.maxBounds);this._offsetLimit=St(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var d=this._lastTime=+new Date,b=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(b),this._times.push(d),this._prunePositions(d)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,d){return r-(r-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;r.x<d.min.x&&(r.x=this._viscousLimit(r.x,d.min.x)),r.y<d.min.y&&(r.y=this._viscousLimit(r.y,d.min.y)),r.x>d.max.x&&(r.x=this._viscousLimit(r.x,d.max.x)),r.y>d.max.y&&(r.y=this._viscousLimit(r.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,d=Math.round(r/2),b=this._initialWorldOffset,I=this._draggable._newPos.x,N=(I-d+b)%r+d-b,Y=(I+d+b)%r-d-b,lt=Math.abs(N+b)<Math.abs(Y+b)?N:Y;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=lt},_onDragEnd:function(r){var d=this._map,b=d.options,I=!b.inertia||r.noInertia||this._times.length<2;if(d.fire("dragend",r),I)d.fire("moveend");else{this._prunePositions(+new Date);var N=this._lastPos.subtract(this._positions[0]),Y=(this._lastTime-this._times[0])/1e3,lt=b.easeLinearity,At=N.multiplyBy(lt/Y),Ot=At.distanceTo([0,0]),$t=Math.min(b.inertiaMaxSpeed,Ot),pe=At.multiplyBy($t/Ot),Re=$t/(b.inertiaDeceleration*lt),_i=pe.multiplyBy(-Re/2).round();!_i.x&&!_i.y?d.fire("moveend"):(_i=d._limitOffset(_i,d.options.maxBounds),Fe(function(){d.panBy(_i,{duration:Re,easeLinearity:lt,noMoveStart:!0,animate:!0})}))}}});hi.addInitHook("addHandler","dragging",ls),hi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var yl=Fs.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),Ke(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ji(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,d=document.documentElement,b=r.scrollTop||d.scrollTop,I=r.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(I,b)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var d=this._panKeys={},b=this.keyCodes,I,N;for(I=0,N=b.left.length;I<N;I++)d[b.left[I]]=[-1*r,0];for(I=0,N=b.right.length;I<N;I++)d[b.right[I]]=[r,0];for(I=0,N=b.down.length;I<N;I++)d[b.down[I]]=[0,r];for(I=0,N=b.up.length;I<N;I++)d[b.up[I]]=[0,-1*r]},_setZoomDelta:function(r){var d=this._zoomKeys={},b=this.keyCodes,I,N;for(I=0,N=b.zoomIn.length;I<N;I++)d[b.zoomIn[I]]=r;for(I=0,N=b.zoomOut.length;I<N;I++)d[b.zoomOut[I]]=-r},_addHooks:function(){Ke(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ji(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var d=r.keyCode,b=this._map,I;if(d in this._panKeys){if(!b._panAnim||!b._panAnim._inProgress)if(I=this._panKeys[d],r.shiftKey&&(I=ge(I).multiplyBy(3)),b.options.maxBounds&&(I=b._limitOffset(ge(I),b.options.maxBounds)),b.options.worldCopyJump){var N=b.wrapLatLng(b.unproject(b.project(b.getCenter()).add(I)));b.panTo(N)}else b.panBy(I)}else if(d in this._zoomKeys)b.setZoom(b.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&b._popup&&b._popup.options.closeOnEscapeKey)b.closePopup();else return;bs(r)}}});hi.addInitHook("addHandler","keyboard",yl),hi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Io=Fs.extend({addHooks:function(){Ke(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ji(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var d=fa(r),b=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var I=Math.max(b-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(O(this._performZoom,this),I),bs(r)},_performZoom:function(){var r=this._map,d=r.getZoom(),b=this._map.options.zoomSnap||0;r._stop();var I=this._delta/(this._map.options.wheelPxPerZoomLevel*4),N=4*Math.log(2/(1+Math.exp(-Math.abs(I))))/Math.LN2,Y=b?Math.ceil(N/b)*b:N,lt=r._limitZoom(d+(this._delta>0?Y:-Y))-d;this._delta=0,this._startTime=null,lt&&(r.options.scrollWheelZoom==="center"?r.setZoom(d+lt):r.setZoomAround(this._lastMousePos,d+lt))}});hi.addInitHook("addHandler","scrollWheelZoom",Io);var us=600;hi.mergeOptions({tapHold:Ft.touchNative&&Ft.safari&&Ft.mobile,tapTolerance:15});var Po=Fs.extend({addHooks:function(){Ke(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ji(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(clearTimeout(this._holdTimeout),r.touches.length===1){var d=r.touches[0];this._startPos=this._newPos=new re(d.clientX,d.clientY),this._holdTimeout=setTimeout(O(function(){this._cancel(),this._isTapValid()&&(Ke(document,"touchend",kn),Ke(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),us),Ke(document,"touchend touchcancel contextmenu",this._cancel,this),Ke(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function r(){ji(document,"touchend",kn),ji(document,"touchend touchcancel",r)},_cancel:function(){clearTimeout(this._holdTimeout),ji(document,"touchend touchcancel contextmenu",this._cancel,this),ji(document,"touchmove",this._onMove,this)},_onMove:function(r){var d=r.touches[0];this._newPos=new re(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(r,d){var b=new MouseEvent(r,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});b._simulated=!0,d.target.dispatchEvent(b)}});hi.addInitHook("addHandler","tapHold",Po),hi.mergeOptions({touchZoom:Ft.touch,bounceAtZoomLimits:!0});var Do=Fs.extend({addHooks:function(){ai(this._map._container,"leaflet-touch-zoom"),Ke(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Fi(this._map._container,"leaflet-touch-zoom"),ji(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var d=this._map;if(!(!r.touches||r.touches.length!==2||d._animatingZoom||this._zooming)){var b=d.mouseEventToContainerPoint(r.touches[0]),I=d.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(b.add(I)._divideBy(2))),this._startDist=b.distanceTo(I),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Ke(document,"touchmove",this._onTouchMove,this),Ke(document,"touchend touchcancel",this._onTouchEnd,this),kn(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var d=this._map,b=d.mouseEventToContainerPoint(r.touches[0]),I=d.mouseEventToContainerPoint(r.touches[1]),N=b.distanceTo(I)/this._startDist;if(this._zoom=d.getScaleZoom(N,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&N<1||this._zoom>d.getMaxZoom()&&N>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,N===1)return}else{var Y=b._add(I)._divideBy(2)._subtract(this._centerPoint);if(N===1&&Y.x===0&&Y.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(Y),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),Ei(this._animRequest);var lt=O(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=Fe(lt,this,!0),kn(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Ei(this._animRequest),ji(document,"touchmove",this._onTouchMove,this),ji(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});hi.addInitHook("addHandler","touchZoom",Do),hi.BoxZoom=da,hi.DoubleClickZoom=el,hi.Drag=ls,hi.Keyboard=yl,hi.ScrollWheelZoom=Io,hi.TapHold=Po,hi.TouchZoom=Do,C.Bounds=dt,C.Browser=Ft,C.CRS=Ve,C.Canvas=_n,C.Circle=Qr,C.CircleMarker=As,C.Class=Pi,C.Control=si,C.DivIcon=Au,C.DivOverlay=qn,C.DomEvent=Zl,C.DomUtil=Wn,C.Draggable=Cr,C.Evented=ce,C.FeatureGroup=Ga,C.GeoJSON=ar,C.GridLayer=io,C.Handler=Fs,C.Icon=Ss,C.ImageOverlay=Dr,C.LatLng=me,C.LatLngBounds=Ht,C.Layer=Si,C.LayerGroup=Di,C.LineUtil=bo,C.Map=hi,C.Marker=So,C.Mixin=Yu,C.Path=Ts,C.Point=re,C.PolyUtil=bu,C.Polygon=Zs,C.Polyline=ss,C.Popup=eo,C.PosAnimation=Wr,C.Projection=zn,C.Rectangle=ka,C.Renderer=Pa,C.SVG=kr,C.SVGOverlay=Qo,C.TileLayer=Es,C.Tooltip=Co,C.Transformation=Ys,C.Util=Sn,C.VideoOverlay=rs,C.bind=O,C.bounds=St,C.canvas=Da,C.circle=To,C.circleMarker=Wo,C.control=ws,C.divIcon=Yl,C.extend=V,C.featureGroup=Ko,C.geoJSON=_l,C.geoJson=to,C.gridLayer=tl,C.icon=Us,C.imageOverlay=Mo,C.latLng=xe,C.latLngBounds=ae,C.layerGroup=wo,C.map=ir,C.marker=Xl,C.point=ge,C.polygon=Jo,C.polyline=$l,C.popup=gl,C.rectangle=Eu,C.setOptions=je,C.stamp=bt,C.svg=rr,C.svgOverlay=zo,C.tileLayer=sn,C.tooltip=Bc,C.transformation=za,C.version=k,C.videoOverlay=js;var vl=window.L;C.noConflict=function(){return window.L=vl,this},window.L=C}))})(md,md.exports)),md.exports}var Rt=X_();const _d=um(Rt);function $_(x){return x.split(" ").filter(Boolean)}function Y_(x,A){for(const C of $_(A))Rt.DomUtil.addClass(x,C)}function vd(x,A,C){return Object.freeze({instance:x,context:A,container:C})}function dm(x,A){return A==null?function(k,V){const it=He.useRef(void 0);return it.current||(it.current=x(k,V)),it}:function(k,V){const it=He.useRef(void 0);it.current||(it.current=x(k,V));const O=He.useRef(k),{instance:g}=it.current;return He.useEffect(function(){O.current!==k&&(A(g,k,O.current),O.current=k)},[g,k,A]),it}}function r_(x,A){He.useEffect(function(){return(A.layerContainer??A.map).addLayer(x.instance),function(){A.layerContainer?.removeLayer(x.instance),A.map.removeLayer(x.instance)}},[A,x])}function K_(x){return function(C){const k=yd(),V=x(fm(C,k),k);return n_(k.map,C.attribution),hm(V.current,C.eventHandlers),r_(V.current,k),V}}function W_(x,A){const C=He.useRef(void 0);He.useEffect(function(){if(A.pathOptions!==C.current){const V=A.pathOptions??{};x.instance.setStyle(V),C.current=V}},[x,A])}function J_(x){return function(C){const k=yd(),V=x(fm(C,k),k);return hm(V.current,C.eventHandlers),r_(V.current,k),W_(V.current,C),V}}function Q_(x,A){const C=dm(x,A),k=K_(C);return s_(k)}function tg(x,A){const C=dm(x),k=G_(C,A);return q_(k)}function pm(x,A){const C=dm(x,A),k=J_(C);return s_(k)}function lf(){return yd().map}function eg(x){const A=lf();return He.useEffect(function(){return A.on(x),function(){A.off(x)}},[A,x]),A}const Um=pm(function({center:A,children:C,...k},V){const it=new Rt.CircleMarker(A,k);return vd(it,kp(V,{overlayContainer:it}))},Z_);function ig({bounds:x,boundsOptions:A,center:C,children:k,className:V,id:it,placeholder:O,style:g,whenReady:bt,zoom:Et,...Wt},It){const[Mt]=He.useState({className:V,id:it,style:g}),[Ui,Bi]=He.useState(null),je=He.useRef(void 0);He.useImperativeHandle(It,()=>Ui?.map??null,[Ui]);const gi=He.useCallback(ea=>{if(ea!==null&&!je.current){const We=new Rt.Map(ea,Wt);je.current=We,C!=null&&Et!=null?We.setView(C,Et):x!=null&&We.fitBounds(x,A),bt!=null&&We.whenReady(bt),Bi(V_(We))}},[]);He.useEffect(()=>()=>{Ui?.map.remove()},[Ui]);const on=Ui?Lp.createElement(Rp,{value:Ui},k):O??null;return Lp.createElement("div",{...Mt,ref:gi},on)}const ng=He.forwardRef(ig),ag=Q_(function({position:A,...C},k){const V=new Rt.Marker(A,C);return vd(V,kp(k,{overlayContainer:V}))},function(A,C,k){C.position!==k.position&&A.setLatLng(C.position),C.icon!=null&&C.icon!==k.icon&&A.setIcon(C.icon),C.zIndexOffset!=null&&C.zIndexOffset!==k.zIndexOffset&&A.setZIndexOffset(C.zIndexOffset),C.opacity!=null&&C.opacity!==k.opacity&&A.setOpacity(C.opacity),A.dragging!=null&&C.draggable!==k.draggable&&(C.draggable===!0?A.dragging.enable():A.dragging.disable())}),sg=["mapPane","markerPane","overlayPane","popupPane","shadowPane","tilePane","tooltipPane"];function Zm(x,A){const{[A]:C,...k}=x;return k}function rg(x,A,C){if(sg.indexOf(x)!==-1)throw new Error(`You must use a unique name for a pane that is not a default Leaflet pane: ${x}`);if(C.map.getPane(x)!=null)throw new Error(`A pane with this name already exists: ${x}`);const k=A.pane??C.pane,V=k?C.map.getPane(k):void 0,it=C.map.createPane(x,V);if(A.className!=null&&Y_(it,A.className),A.style!=null)for(const O of Object.keys(A.style))it.style[O]=A.style[O];return it}function og(x,A){const[C]=He.useState(x.name),[k,V]=He.useState(null);He.useImperativeHandle(A,()=>k,[k]);const it=yd(),O=He.useMemo(()=>({...it,pane:C}),[it]);return He.useEffect(()=>(V(rg(C,x,it)),function(){it.map.getPane(C)?.remove?.(),it.map._panes!=null&&(it.map._panes=Zm(it.map._panes,C),it.map._paneRenderers=Zm(it.map._paneRenderers,C))}),[]),x.children!=null&&k!=null?a_.createPortal(Lp.createElement(Rp,{value:O},x.children),k):null}const jm=He.forwardRef(og),lg=pm(function({positions:A,...C},k){const V=new Rt.Polygon(A,C);return vd(V,kp(k,{overlayContainer:V}))},function(A,C,k){C.positions!==k.positions&&A.setLatLngs(C.positions)}),Vm=pm(function({positions:A,...C},k){const V=new Rt.Polyline(A,C);return vd(V,kp(k,{overlayContainer:V}))},function(A,C,k){C.positions!==k.positions&&A.setLatLngs(C.positions)}),o_=tg(function(A,C){const k=new Rt.Tooltip(A,C.overlayContainer);return vd(k,C)},function(A,C,{position:k},V){He.useEffect(function(){const O=C.overlayContainer;if(O==null)return;const{instance:g}=A,bt=Wt=>{Wt.tooltip===g&&(k!=null&&g.setLatLng(k),g.update(),V(!0))},Et=Wt=>{Wt.tooltip===g&&V(!1)};return O.on({tooltipopen:bt,tooltipclose:Et}),O.bindTooltip(g),function(){O.off({tooltipopen:bt,tooltipclose:Et}),O._map!=null&&O.unbindTooltip()}},[A,C,V,k])});var qo=63710088e-1,ug={centimeters:qo*100,centimetres:qo*100,degrees:360/(2*Math.PI),feet:qo*3.28084,inches:qo*39.37,kilometers:qo/1e3,kilometres:qo/1e3,meters:qo,metres:qo,miles:qo/1609.344,millimeters:qo*1e3,millimetres:qo*1e3,nauticalmiles:qo/1852,radians:1,yards:qo*1.0936};function cg(x,A,C={}){const k={type:"Feature"};return(C.id===0||C.id)&&(k.id=C.id),C.bbox&&(k.bbox=C.bbox),k.properties={},k.geometry=x,k}function qm(x,A,C={}){if(!x)throw new Error("coordinates is required");if(!Array.isArray(x))throw new Error("coordinates must be an Array");if(x.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Gm(x[0])||!Gm(x[1]))throw new Error("coordinates must contain numbers");return cg({type:"Point",coordinates:x},A,C)}function hg(x,A="kilometers"){const C=ug[A];if(!C)throw new Error(A+" units is invalid");return x*C}function Mp(x){return x%360*Math.PI/180}function Gm(x){return!isNaN(x)&&x!==null&&!Array.isArray(x)}function Hm(x){if(!x)throw new Error("coord is required");if(!Array.isArray(x)){if(x.type==="Feature"&&x.geometry!==null&&x.geometry.type==="Point")return[...x.geometry.coordinates];if(x.type==="Point")return[...x.coordinates]}if(Array.isArray(x)&&x.length>=2&&!Array.isArray(x[0])&&!Array.isArray(x[1]))return[...x];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function fg(x,A,C={}){var k=Hm(x),V=Hm(A),it=Mp(V[1]-k[1]),O=Mp(V[0]-k[0]),g=Mp(k[1]),bt=Mp(V[1]),Et=Math.pow(Math.sin(it/2),2)+Math.pow(Math.sin(O/2),2)*Math.cos(g)*Math.cos(bt);return hg(2*Math.atan2(Math.sqrt(Et),Math.sqrt(1-Et)),C.units)}const Op=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,Sh=document.documentElement.style.pointerEvents==="",kc={cors:Op},dg={attributionWidthOffset:55};let Xm=0;function Bp(x){let A="";x.f=x.f||"json";for(const k in x)if(Object.hasOwn(x,k)){const V=x[k],it=Object.prototype.toString.call(V);let O;A.length&&(A+="&"),it==="[object Array]"?O=Object.prototype.toString.call(V[0])==="[object Object]"?JSON.stringify(V):V.join(","):it==="[object Object]"?O=JSON.stringify(V):it==="[object Date]"?O=V.valueOf():O=V,A+=`${encodeURIComponent(k)}=${encodeURIComponent(O)}`}return A.replaceAll("'","%27")}function mm(x,A){const C=new window.XMLHttpRequest;return C.onerror=function(){C.onreadystatechange=Rt.Util.falseFn,x.call(A,{error:{code:500,message:"XMLHttpRequest error"}},null)},C.onreadystatechange=function(){let k,V;if(C.readyState===4){try{k=JSON.parse(C.responseText)}catch{k=null,V={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!V&&k.error&&(V=k.error,k=null),C.onerror=Rt.Util.falseFn,x.call(A,V,k)}},C.ontimeout=function(){this.onerror()},C}function pg(x,A,C,k){const V=mm(C,k);return V.open("POST",x),typeof k<"u"&&k!==null&&typeof k.options<"u"&&(V.timeout=k.options.timeout),V.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),V.send(Bp(A)),V}function l_(x,A,C,k){const V=mm(C,k);return V.open("GET",`${x}?${Bp(A)}`,!0),typeof k<"u"&&k!==null&&typeof k.options<"u"&&(V.timeout=k.options.timeout,k.options.withCredentials&&(V.withCredentials=!0)),V.send(null),V}function uf(x,A,C,k){const V=Bp(A),it=mm(C,k),O=`${x}?${V}`.length;if(O<=2e3&&kc.cors?it.open("GET",`${x}?${V}`):O>2e3&&kc.cors&&(it.open("POST",x),it.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),typeof k<"u"&&k!==null&&typeof k.options<"u"&&(it.timeout=k.options.timeout,k.options.withCredentials&&(it.withCredentials=!0)),O<=2e3&&kc.cors)it.send(null);else if(O>2e3&&kc.cors)it.send(V);else{if(O<=2e3&&!kc.cors)return _m(x,A,C,k);Rc(`a request to ${x} was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy https://developers.arcgis.com/esri-leaflet/api-reference/request/`);return}return it}function _m(x,A,C,k){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};const V=`c${Xm}`;A.callback=`window._EsriLeafletCallbacks.${V}`,window._EsriLeafletCallbacks[V]=function(O){if(window._EsriLeafletCallbacks[V]!==!0){let g;const bt=Object.prototype.toString.call(O);bt==="[object Object]"||bt==="[object Array]"||(g={error:{code:500,message:"Expected array or object as JSONP response"}},O=null),!g&&O.error&&(g=O,O=null),C.call(k,g,O),window._EsriLeafletCallbacks[V]=!0}};const it=Rt.DomUtil.create("script",null,document.body);return it.type="text/javascript",it.src=`${x}?${Bp(A)}`,it.id=V,it.onerror=function(O){if(O&&window._EsriLeafletCallbacks[V]!==!0){const g={error:{code:500,message:"An unknown error occurred"}};C.call(k,g),window._EsriLeafletCallbacks[V]=!0}},Rt.DomUtil.addClass(it,"esri-leaflet-jsonp"),Xm++,{id:V,url:it.src,abort(){window._EsriLeafletCallbacks._callback[V]({code:0,message:"Request aborted."})}}}const gm=kc.cors?l_:_m;gm.CORS=l_;gm.JSONP=_m;function Rc(...x){console&&console.warn&&console.warn.apply(console,x)}const Ip={request:uf,get:gm,post:pg};var mg=function(A,C,k,V){var it=(V[0]-k[0])*(A[1]-k[1])-(V[1]-k[1])*(A[0]-k[0]),O=(C[0]-A[0])*(A[1]-k[1])-(C[1]-A[1])*(A[0]-k[0]),g=(V[1]-k[1])*(C[0]-A[0])-(V[0]-k[0])*(C[1]-A[1]);if(g!==0){var bt=it/g,Et=O/g;if(bt>=0&&bt<=1&&Et>=0&&Et<=1)return!0}return!1},_g=function(A,C){for(var k=!1,V=-1,it=A.length,O=it-1;++V<it;O=V)(A[V][1]<=C[1]&&C[1]<A[O][1]||A[O][1]<=C[1]&&C[1]<A[V][1])&&C[0]<(A[O][0]-A[V][0])*(C[1]-A[V][1])/(A[O][1]-A[V][1])+A[V][0]&&(k=!k);return k},gg=function(A,C){for(var k=0;k<A.length;k++)if(A[k]!==C[k])return!1;return!0},u_=function(A,C){for(var k=0;k<A.length-1;k++)for(var V=0;V<C.length-1;V++)if(mg(A[k],A[k+1],C[V],C[V+1]))return!0;return!1},am=function(A){return gg(A[0],A[A.length-1])||A.push(A[0]),A},sm=function(A){var C=0,k=0,V=A.length,it=A[k],O;for(k;k<V-1;k++)O=A[k+1],C+=(O[0]-it[0])*(O[1]+it[1]),it=O;return C>=0},c_=function(A){var C={};for(var k in A)A.hasOwnProperty(k)&&(C[k]=A[k]);return C},yg=function(A,C){var k=u_(A,C),V=_g(A,C[0]);return!!(!k&&V)},vg=function(A){for(var C=[],k=[],V,it,O,g=0;g<A.length;g++){var bt=am(A[g].slice(0));if(!(bt.length<4))if(sm(bt)){var Et=[bt.slice().reverse()];C.push(Et)}else k.push(bt.slice().reverse())}for(var Wt=[];k.length;){O=k.pop();var It=!1;for(V=C.length-1;V>=0;V--)if(it=C[V][0],yg(it,O)){C[V].push(O),It=!0;break}It||Wt.push(O)}for(;Wt.length;){O=Wt.pop();var Mt=!1;for(V=C.length-1;V>=0;V--)if(it=C[V][0],u_(it,O)){C[V].push(O),Mt=!0;break}Mt||C.push([O.reverse()])}return C.length===1?{type:"Polygon",coordinates:C[0]}:{type:"MultiPolygon",coordinates:C}},xg=function(A,C){for(var k=C?[C,"OBJECTID","FID"]:["OBJECTID","FID"],V=0;V<k.length;V++){var it=k[V];if(it in A&&(typeof A[it]=="string"||typeof A[it]=="number"))return A[it]}throw Error("No valid id attribute found")},bg=function x(A,C){var k={};if(A.features){k.type="FeatureCollection",k.features=[];for(var V=0;V<A.features.length;V++)k.features.push(x(A.features[V],C))}if(typeof A.x=="number"&&typeof A.y=="number"&&(k.type="Point",k.coordinates=[A.x,A.y],typeof A.z=="number"&&k.coordinates.push(A.z)),A.points&&(k.type="MultiPoint",k.coordinates=A.points.slice(0)),A.paths&&(A.paths.length===1?(k.type="LineString",k.coordinates=A.paths[0].slice(0)):(k.type="MultiLineString",k.coordinates=A.paths.slice(0))),A.rings&&(k=vg(A.rings.slice(0))),typeof A.xmin=="number"&&typeof A.ymin=="number"&&typeof A.xmax=="number"&&typeof A.ymax=="number"&&(k.type="Polygon",k.coordinates=[[[A.xmax,A.ymax],[A.xmin,A.ymax],[A.xmin,A.ymin],[A.xmax,A.ymin],[A.xmax,A.ymax]]]),(A.geometry||A.attributes)&&(k.type="Feature",k.geometry=A.geometry?x(A.geometry):null,k.properties=A.attributes?c_(A.attributes):null,A.attributes))try{k.id=xg(A.attributes,C)}catch{}return JSON.stringify(k.geometry)===JSON.stringify({})&&(k.geometry=null),A.spatialReference&&A.spatialReference.wkid&&A.spatialReference.wkid!==4326&&console.warn("Object converted in non-standard crs - "+JSON.stringify(A.spatialReference)),k},h_=function(A){var C=[],k=A.slice(0),V=am(k.shift().slice(0));if(V.length>=4){sm(V)||V.reverse(),C.push(V);for(var it=0;it<k.length;it++){var O=am(k[it].slice(0));O.length>=4&&(sm(O)&&O.reverse(),C.push(O))}}return C},wg=function(A){for(var C=[],k=0;k<A.length;k++)for(var V=h_(A[k]),it=V.length-1;it>=0;it--){var O=V[it].slice(0);C.push(O)}return C},Sg=function x(A,C){C=C||"OBJECTID";var k={wkid:4326},V={},it;switch(A.type){case"Point":V.x=A.coordinates[0],V.y=A.coordinates[1],A.coordinates[2]!=null&&(V.z=A.coordinates[2]),V.spatialReference=k;break;case"MultiPoint":V.points=A.coordinates.slice(0),A.coordinates[0][2]!=null&&(V.hasZ=!0),V.spatialReference=k;break;case"LineString":V.paths=[A.coordinates.slice(0)],A.coordinates[0][2]!=null&&(V.hasZ=!0),V.spatialReference=k;break;case"MultiLineString":V.paths=A.coordinates.slice(0),A.coordinates[0][0][2]!=null&&(V.hasZ=!0),V.spatialReference=k;break;case"Polygon":V.rings=h_(A.coordinates.slice(0)),A.coordinates[0][0][2]!=null&&(V.hasZ=!0),V.spatialReference=k;break;case"MultiPolygon":V.rings=wg(A.coordinates.slice(0)),A.coordinates[0][0][0][2]!=null&&(V.hasZ=!0),V.spatialReference=k;break;case"Feature":A.geometry&&(V.geometry=x(A.geometry,C)),V.attributes=A.properties?c_(A.properties):{},A.id&&(V.attributes[C]=A.id);break;case"FeatureCollection":for(V=[],it=0;it<A.features.length;it++)V.push(x(A.features[it],C));break;case"GeometryCollection":for(V=[],it=0;it<A.geometries.length;it++)V.push(x(A.geometries[it],C));break}return V};const Tg='Powered by <a href="https://www.esri.com">Esri</a>';function gd(x,A){return Sg(x,A)}function f_(x,A){return bg(x,A)}function rm(x){if(x.xmin!=="NaN"&&x.ymin!=="NaN"&&x.xmax!=="NaN"&&x.ymax!=="NaN"){const A=Rt.latLng(x.ymin,x.xmin),C=Rt.latLng(x.ymax,x.xmax);return Rt.latLngBounds(A,C)}return null}function ym(x){return x=Rt.latLngBounds(x),{xmin:x.getSouthWest().lng,ymin:x.getSouthWest().lat,xmax:x.getNorthEast().lng,ymax:x.getNorthEast().lat,spatialReference:{wkid:4326}}}const d_=/^(OBJECTID|FID|OID|ID)$/i;function p_(x){let A;if(x.objectIdFieldName)A=x.objectIdFieldName;else if(x.fields){for(let C=0;C<=x.fields.length-1;C++)if(x.fields[C].type==="esriFieldTypeOID"){A=x.fields[C].name;break}if(!A){for(let C=0;C<=x.fields.length-1;C++)if(x.fields[C].name.match(d_)){A=x.fields[C].name;break}}}return A}function m_(x){for(const A in x.attributes)if(A.match(d_))return A}function xd(x,A){let C;const k=x.features||x.results,V=k&&k.length;A?C=A:C=p_(x);const it={type:"FeatureCollection",features:[]};if(V)for(let O=k.length-1;O>=0;O--){const g=f_(k[O],C||m_(k[O]));it.features.push(g)}return it}function Np(x){return x=Rt.Util.trim(x),x[x.length-1]!=="/"&&(x+="/"),x}function bd(x){if(x.url.indexOf("?")!==-1){x.requestParams=x.requestParams||{};const A=x.url.substring(x.url.indexOf("?")+1);x.url=x.url.split("?")[0],x.requestParams=JSON.parse(`{"${decodeURI(A).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')}"}`)}return x.url=Np(x.url.split("?")[0]),x}function __(x){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(x)}function om(x){let A;switch(x){case"Point":A="esriGeometryPoint";break;case"MultiPoint":A="esriGeometryMultipoint";break;case"LineString":A="esriGeometryPolyline";break;case"MultiLineString":A="esriGeometryPolyline";break;case"Polygon":A="esriGeometryPolygon";break;case"MultiPolygon":A="esriGeometryPolygon";break}return A}function Pp(x){return`${x.getSize().x-dg.attributionWidthOffset}px`}function wd(x){if(x.attributionControl){if(x.attributionControl._esriAttributionLayerCount||(x.attributionControl._esriAttributionLayerCount=0),x.attributionControl._esriAttributionLayerCount===0){if(!x.attributionControl._esriAttributionAddedOnce){const A=document.createElement("style");A.type="text/css",A.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(A);const C=document.createElement("style");C.type="text/css",C.innerHTML=`.esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: ${Pp(x)};}`,document.getElementsByTagName("head")[0].appendChild(C),x.on("resize",k=>{x.attributionControl&&(x.attributionControl._container.style.maxWidth=Pp(k.target))}),x.attributionControl._esriAttributionAddedOnce=!0}Rt.DomUtil.addClass(x.attributionControl._container,"esri-truncated-attribution:hover"),Rt.DomUtil.addClass(x.attributionControl._container,"esri-truncated-attribution")}x.attributionControl._esriAttributionLayerCount=x.attributionControl._esriAttributionLayerCount+1}}function g_(){return Tg}function Sd(x){x.attributionControl&&(x.attributionControl._esriAttributionLayerCount&&x.attributionControl._esriAttributionLayerCount===1&&(Rt.DomUtil.removeClass(x.attributionControl._container,"esri-truncated-attribution:hover"),Rt.DomUtil.removeClass(x.attributionControl._container,"esri-truncated-attribution")),x.attributionControl._esriAttributionLayerCount=x.attributionControl._esriAttributionLayerCount-1)}function vm(x){const A={geometry:null,geometryType:null};if(x instanceof Rt.LatLngBounds)return A.geometry=ym(x),A.geometryType="esriGeometryEnvelope",A;if(x.getLatLng&&(x=x.getLatLng()),x instanceof Rt.LatLng&&(x={type:"Point",coordinates:[x.lng,x.lat]}),x instanceof Rt.GeoJSON&&(x=x.getLayers()[0].feature.geometry,A.geometry=gd(x),A.geometryType=om(x.type)),x.toGeoJSON&&(x=x.toGeoJSON()),x.type==="Feature"&&(x=x.geometry),x.type==="Point"||x.type==="LineString"||x.type==="Polygon"||x.type==="MultiPolygon")return A.geometry=gd(x),A.geometryType=om(x.type),A;Rc("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object")}function y_(x,A){kc.cors&&uf(x,{},Rt.Util.bind((C,k)=>{if(C)return;A._esriAttributions=[];for(let it=0;it<k.contributors.length;it++){const O=k.contributors[it];for(let g=0;g<O.coverageAreas.length;g++){const bt=O.coverageAreas[g],Et=Rt.latLng(bt.bbox[0],bt.bbox[1]),Wt=Rt.latLng(bt.bbox[2],bt.bbox[3]);A._esriAttributions.push({attribution:O.attribution,score:bt.score,bounds:Rt.latLngBounds(Et,Wt),minZoom:bt.zoomMin,maxZoom:bt.zoomMax})}}A._esriAttributions.sort((it,O)=>O.score-it.score),Dp({target:A})},this))}function Dp(x){const A=x.target,C=A._esriAttributions;if(!A||!A.attributionControl)return;const k=A.attributionControl._container.querySelector(".esri-dynamic-attribution");if(k&&C){let V="";const it=A.getBounds(),O=Rt.latLngBounds(it.getSouthWest().wrap(),it.getNorthEast().wrap()),g=A.getZoom();for(let bt=0;bt<C.length;bt++){const Et=C[bt],Wt=Et.attribution;!V.match(Wt)&&Et.bounds.intersects(O)&&g>=Et.minZoom&&g<=Et.maxZoom&&(V+=`, ${Wt}`)}V=`${g_()} | ${V.substr(2)}`,k.innerHTML=V,k.style.maxWidth=Pp(A),A.fire("attributionupdated",{attribution:V})}}const Th={warn:Rc,cleanUrl:Np,getUrlParams:bd,isArcgisOnline:__,geojsonTypeToArcGIS:om,responseToFeatureCollection:xd,geojsonToArcGIS:gd,arcgisToGeoJSON:f_,boundsToExtent:ym,extentToBounds:rm,calcAttributionWidth:Pp,setEsriAttribution:wd,getEsriAttributionHtmlString:g_,removeEsriAttribution:Sd,_setGeometry:vm,_getAttributionData:y_,_updateMapAttribution:Dp,_findIdAttributeFromFeature:m_,_findIdAttributeFromResponse:p_},xm=Rt.Class.extend({options:{proxy:!1,useCors:Op},generateSetter(x,A){return Rt.Util.bind(function(C){return this.params[x]=C,this},A)},initialize(x){if(x.request&&x.options?(this._service=x,Rt.Util.setOptions(this,x.options)):(Rt.Util.setOptions(this,x),this.options.url=Np(x.url)),this.params=Rt.Util.extend({},this.params||{}),this.setters)for(const A in this.setters){const C=this.setters[A];this[A]=this.generateSetter(C,this)}},token(x){return this._service?this._service.authenticate(x):this.params.token=x,this},apikey(x){return this.token(x)},format(x){return this.params.returnUnformattedValues=!x,this},request(x,A){return this.options.requestParams&&Rt.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,x,A):this._request("request",this.path,this.params,x,A)},_request(x,A,C,k,V){const it=this.options.proxy?`${this.options.proxy}?${this.options.url}${A}`:this.options.url+A;return(x==="get"||x==="request")&&!this.options.useCors?Ip.get.JSONP(it,C,k,V):Ip[x](it,C,k,V)}}),Ag=xm.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelContains",this},intersects(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelIntersects",this},contains(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelWithin",this},crosses(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelCrosses",this},touches(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelTouches",this},overlaps(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects(x){return this._setGeometryParams(x),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby(x,A){return x=Rt.latLng(x),this.params.geometry=[x.lng,x.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=A,this.params.inSR=4326,this},where(x){return this.params.where=x,this},between(x,A){return this.params.time=[x.valueOf(),A.valueOf()],this},simplify(x,A){const C=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=C/x.getSize().y*A,this},orderBy(x,A){return A=A||"ASC",this.params.orderByFields=this.params.orderByFields?`${this.params.orderByFields},`:"",this.params.orderByFields+=[x,A].join(" "),this},run(x,A){return this._cleanParams(),this.options.isModern||__(this.options.url)&&this.options.isModern===void 0?(this.params.f="geojson",this.request(function(C,k){this._trapSQLerrors(C),x.call(A,C,k,k)},this)):this.request(function(C,k){this._trapSQLerrors(C),x.call(A,C,k&&xd(k),k)},this)},count(x,A){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(C,k){x.call(this,C,k&&k.count,k)},A)},ids(x,A){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(C,k){x.call(this,C,k&&k.objectIds,k)},A)},bounds(x,A){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request((C,k)=>{k&&k.extent&&rm(k.extent)?x.call(A,C,rm(k.extent),k):(C={message:"Invalid Bounds"},x.call(A,C,null,k))},A)},distinct(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize(x){const A=Rt.point(x);return this.params.pixelSize=[A.x,A.y],this},layer(x){return this.path=`${x}/query`,this},_trapSQLerrors(x){x&&x.code==="400"&&Rc("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams(x){this.params.inSR=4326;const A=vm(x);this.params.geometry=A.geometry,this.params.geometryType=A.geometryType}});function bm(x){return new Ag(x)}const Eg=xm.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs(x,A){return this.params.layerDefs=this.params.layerDefs?`${this.params.layerDefs};`:"",this.params.layerDefs+=[x,A].join(":"),this},simplify(x,A){const C=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=C/x.getSize().y*A,this},run(x,A){return this.request((C,k)=>{x.call(A,C,k&&xd(k),k)},A)}});function Mg(x){return new Eg(x)}const v_=xm.extend({path:"identify",between(x,A){return this.params.time=[x.valueOf(),A.valueOf()],this}}),zg=v_.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on(x){const A=ym(x.getBounds()),C=x.getSize();return this.params.imageDisplay=[C.x,C.y,96],this.params.mapExtent=[A.xmin,A.ymin,A.xmax,A.ymax],this},at(x){return x.length===2&&(x=Rt.latLng(x)),this._setGeometryParams(x),this},layerDef(x,A){return this.params.layerDefs=this.params.layerDefs?`${this.params.layerDefs};`:"",this.params.layerDefs+=[x,A].join(":"),this},simplify(x,A){const C=Math.abs(x.getBounds().getWest()-x.getBounds().getEast());return this.params.maxAllowableOffset=C/x.getSize().y*A,this},run(x,A){return this.request((C,k)=>{if(C)x.call(A,C,void 0,k);else{const V=xd(k);k.results=k.results.reverse();for(let it=0;it<V.features.length;it++){const O=V.features[it];O.layerId=k.results[it].layerId}x.call(A,void 0,V,k)}})},_setGeometryParams(x){const A=vm(x);this.params.geometry=A.geometry,this.params.geometryType=A.geometryType}});function Cg(x){return new zg(x)}const Lg=v_.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at(x){return x=Rt.latLng(x),this.params.geometry=JSON.stringify({x:x.lng,y:x.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule(){return this.params.mosaicRule},getRenderingRule(){return this.params.renderingRule},getPixelSize(){return this.params.pixelSize},run(x,A){return this.request(function(C,k){x.call(A,C,k&&this._responseToGeoJSON(k),k)},this)},_responseToGeoJSON(x){const A=x.location,C=x.catalogItems,k=x.catalogItemVisibilities,V={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[A.x,A.y]},crs:{type:"EPSG",properties:{code:A.spatialReference.wkid}},properties:{OBJECTID:x.objectId,name:x.name,value:x.value},id:x.objectId}};if(x.properties&&x.properties.Values&&(V.pixel.properties.values=x.properties.Values),C&&C.features&&(V.catalogItems=xd(C),k&&k.length===V.catalogItems.features.length))for(let it=k.length-1;it>=0;it--)V.catalogItems.features[it].properties.catalogItemVisibility=k[it];return V}});function Ig(x){return new Lg(x)}const wm=Rt.Evented.extend({options:{proxy:!1,useCors:Op,timeout:0},initialize(x){x=x||{},this._requestQueue=[],this._authenticating=!1,Rt.Util.setOptions(this,x),this.options.url=Np(this.options.url)},get(x,A,C,k){return this._request("get",x,A,C,k)},post(x,A,C,k){return this._request("post",x,A,C,k)},request(x,A,C,k){return this._request("request",x,A,C,k)},metadata(x,A){return this._request("get","",{},x,A)},authenticate(x){return this._authenticating=!1,this.options.token=x,this._runQueue(),this},getTimeout(){return this.options.timeout},setTimeout(x){this.options.timeout=x},_request(x,A,C,k,V){this.fire("requeststart",{url:this.options.url+A,params:C,method:x},!0);const it=this._createServiceCallback(x,A,C,k,V);if(this.options.token&&(C.token=this.options.token),this.options.requestParams&&Rt.Util.extend(C,this.options.requestParams),this._authenticating)this._requestQueue.push([x,A,C,k,V]);else{const O=this.options.proxy?`${this.options.proxy}?${this.options.url}${A}`:this.options.url+A;return(x==="get"||x==="request")&&!this.options.useCors?Ip.get.JSONP(O,C,it,V):Ip[x](O,C,it,V)}},_createServiceCallback(x,A,C,k,V){return Rt.Util.bind(function(it,O){it&&(it.code===499||it.code===498)&&(this._authenticating=!0,this._requestQueue.push([x,A,C,k,V]),this.fire("authenticationrequired",{authenticate:Rt.Util.bind(this.authenticate,this)},!0),it.authenticate=Rt.Util.bind(this.authenticate,this)),k.call(V,it,O),it?this.fire("requesterror",{url:this.options.url+A,params:C,message:it.message,code:it.code,method:x},!0):this.fire("requestsuccess",{url:this.options.url+A,params:C,response:O,method:x},!0),this.fire("requestend",{url:this.options.url+A,params:C,method:x},!0)},this)},_runQueue(){for(let x=this._requestQueue.length-1;x>=0;x--){const A=this._requestQueue[x],C=A.shift();this[C].apply(this,A)}this._requestQueue=[]}}),Pg=wm.extend({identify(){return Cg(this)},find(){return Mg(this)},query(){return bm(this)}});function x_(x){return new Pg(x)}const Dg=wm.extend({query(){return bm(this)},identify(){return Ig(this)}});function kg(x){return new Dg(x)}const Rg=wm.extend({options:{idAttribute:"OBJECTID"},query(){return bm(this)},addFeature(x,A,C){this.addFeatures(x,A,C)},addFeatures(x,A,C){const k=x.features?x.features:[x];for(let V=k.length-1;V>=0;V--)delete k[V].id;return x=gd(x),x=k.length>1?x:[x],this.post("addFeatures",{features:x},(V,it)=>{const O=it&&it.addResults?it.addResults.length>1?it.addResults:it.addResults[0]:void 0;A&&A.call(C,V||it.addResults[0].error,O)},C)},updateFeature(x,A,C){this.updateFeatures(x,A,C)},updateFeatures(x,A,C){const k=x.features?x.features:[x];return x=gd(x,this.options.idAttribute),x=k.length>1?x:[x],this.post("updateFeatures",{features:x},(V,it)=>{const O=it&&it.updateResults?it.updateResults.length>1?it.updateResults:it.updateResults[0]:void 0;A&&A.call(C,V||it.updateResults[0].error,O)},C)},deleteFeature(x,A,C){this.deleteFeatures(x,A,C)},deleteFeatures(x,A,C){return this.post("deleteFeatures",{objectIds:x},(k,V)=>{const it=V&&V.deleteResults?V.deleteResults.length>1?V.deleteResults:V.deleteResults[0]:void 0;A&&A.call(C,k||V.deleteResults[0].error,it)},C)}});function Og(x){return new Rg(x)}const Ja=window.location.protocol!=="https:"?"http:":"https:",$m=Rt.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:`${Ja}//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:`${Ja}//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Sh?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Sh?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:Sh?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Sh?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:Sh?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:Sh?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:Sh?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:`${Ja}//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:`${Ja}//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:`${Ja}//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:`${Ja}//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}`,options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize(x,A){let C;if(typeof x=="object"&&x.urlTemplate&&x.options)C=x;else if(typeof x=="string"&&$m.TILES[x])C=$m.TILES[x];else throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');const k=Rt.Util.extend(C.options,A);Rt.Util.setOptions(this,k),this.options.ignoreDeprecationWarning||console.warn("WARNING: L.esri.BasemapLayer uses data services that are in mature support and are not being updated. Please use L.esri.Vector.vectorBasemapLayer instead. More info: https://esriurl.com/esri-leaflet-basemap"),this.options.token&&C.urlTemplate.indexOf("token=")===-1&&(C.urlTemplate+=`?token=${this.options.token}`),this.options.proxy&&(C.urlTemplate=`${this.options.proxy}?${C.urlTemplate}`),Rt.TileLayer.prototype.initialize.call(this,C.urlTemplate,k)},onAdd(x){wd(x),this.options.pane==="esri-labels"&&this._initPane(),this.options.attributionUrl&&y_((this.options.proxy?`${this.options.proxy}?`:"")+this.options.attributionUrl,x),x.on("moveend",Dp),Rt.TileLayer.prototype.onAdd.call(this,x)},onRemove(x){Sd(x),x.off("moveend",Dp),Rt.TileLayer.prototype.onRemove.call(this,x)},_initPane(){if(!this._map.getPane(this.options.pane)){const x=this._map.createPane(this.options.pane);x.style.pointerEvents="none",x.style.zIndex=500}},getAttribution(){let x;return this.options.attribution&&(x=`<span class="esri-dynamic-attribution">${this.options.attribution}</span>`),x}}),Bg=Rt.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize(x){x=Rt.Util.setOptions(this,x),x.apikey&&(x.token=x.apikey),x=bd(x),this.tileUrl=`${(x.proxy?`${x.proxy}?`:"")+x.url}tile/{z}/{y}/{x}${x.requestParams&&Object.keys(x.requestParams).length>0?Rt.Util.getParamString(x.requestParams):""}`,x.url.indexOf("{s}")!==-1&&x.subdomains&&(x.url=x.url.replace("{s}",x.subdomains[0])),this.service=x_(x),this.service.addEventParent(this),new RegExp(/tiles.arcgis(online)?\.com/g).test(x.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),x.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+=`?token=${this.options.token}`),Rt.TileLayer.prototype.initialize.call(this,this.tileUrl,x)},getTileUrl(x){const A=this._getZoomForUrl();return Rt.Util.template(this.tileUrl,Rt.Util.extend({s:this._getSubdomain(x),x:x.x,y:x.y,z:this._lodMap&&this._lodMap[A]!==void 0?this._lodMap[A]:A},this.options))},createTile(x,A){const C=document.createElement("img");return Rt.DomEvent.on(C,"load",Rt.Util.bind(this._tileOnLoad,this,A,C)),Rt.DomEvent.on(C,"error",Rt.Util.bind(this._tileOnError,this,A,C)),this.options.crossOrigin&&(C.crossOrigin=""),C.alt="",this._lodMap==="crs"||this._lodMap&&this._lodMap[this._getZoomForUrl()]!==void 0?C.src=this.getTileUrl(x):this.once("lodmap",function(){C.src=this.getTileUrl(x)},this),C},onAdd(x){wd(x),this._lodMap||this.metadata(function(A,C){if(!A&&C.spatialReference){const k=C.spatialReference.latestWkid||C.spatialReference.wkid;if(!this.options.attribution&&x.attributionControl&&C.copyrightText&&(this.options.attribution=C.copyrightText,x.attributionControl.addAttribution(this.getAttribution())),x.options.crs===Rt.CRS.EPSG3857&&(k===102100||k===3857)){this._lodMap={};const V=C.tileInfo.lods,it=Bg.MercatorZoomLevels;for(let O=0;O<V.length;O++){const g=V[O];for(const bt in it){const Et=it[bt];if(this._withinPercentage(g.resolution,Et,this.options.zoomOffsetAllowance)){this._lodMap[bt]=g.level;break}}}this.fire("lodmap")}else x.options.crs&&x.options.crs.code&&x.options.crs.code.indexOf(k)>-1?(this._lodMap="crs",this.fire("lodmap")):Rc("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet https://developers.arcgis.com/esri-leaflet/samples/non-mercator-projection/")}},this),Rt.TileLayer.prototype.onAdd.call(this,x)},onRemove(x){Sd(x),Rt.TileLayer.prototype.onRemove.call(this,x)},metadata(x,A){return this.service.metadata(x,A),this},identify(){return this.service.identify()},find(){return this.service.find()},query(){return this.service.query()},authenticate(x){const A=`?token=${x}`;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,A):this.tileUrl+A,this.options.token=x,this.service.authenticate(x),this},_withinPercentage(x,A,C){return Math.abs(x/A-1)<C}}),Ng=Rt.ImageOverlay.extend({onAdd(x){this._topLeft=x.getPixelBounds().min,Rt.ImageOverlay.prototype.onAdd.call(this,x)},_reset(){this._map.options.crs===Rt.CRS.EPSG3857?Rt.ImageOverlay.prototype._reset.call(this):Rt.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),b_=Rt.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:Op,attribution:null,interactive:!1,alt:""},onAdd(x){wd(x),this.options.zIndex&&(this.options.position=null),this._update=Rt.Util.throttle(this._update,this.options.updateInterval,this),x.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?x.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(A,C){!A&&!this.options.attribution&&x.attributionControl&&C.copyrightText&&(this.options.attribution=C.copyrightText,x.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove(x){Sd(x),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup(x,A){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=Rt.popup(A),this._popupFunction=x,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex(x){return this.options.zIndex=x,this._currentImage&&this._currentImage.setZIndex(x),this},_setAutoZIndex(x){if(!this._currentImage)return;const A=this._currentImage.getPane().children;let C=-x(-1/0,1/0);for(let k=0,V=A.length,it;k<V;k++)it=A[k].style.zIndex,A[k]!==this._currentImage._image&&it&&(C=x(C,+it));isFinite(C)&&(this.options.zIndex=C+x(-1,1),this.setZIndex(this.options.zIndex))},getAttribution(){return this.options.attribution},getOpacity(){return this.options.opacity},setOpacity(x){return this.options.opacity=x,this._currentImage&&this._currentImage.setOpacity(x),this},getTimeRange(){return[this.options.from,this.options.to]},setTimeRange(x,A){return this.options.from=x,this.options.to=A,this._update(),this},metadata(x,A){return this.service.metadata(x,A),this},authenticate(x){return this.service.authenticate(x),this},redraw(){this._update()},_renderImage(x,A,C){if(this._map){if(C&&(x=`data:${C};base64,${x}`),!x)return;const k=new Ng(x,A,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map);let V;const it=function(){this._map.removeLayer(k),this.fire("error"),k.off("load",V,this)};V=function(O){if(k.off("error",it,this),this._map){const g=O.target,bt=this._currentImage;g._bounds.equals(A)&&g._bounds.equals(this._map.getBounds())?(this._currentImage=g,this.options.position==="front"?this.bringToFront():this.options.position==="back"&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),bt&&this._map&&this._map.removeLayer(bt),bt&&bt._map&&bt._map.removeLayer(bt)):this._map.removeLayer(g)}this.fire("load",{bounds:A})},k.once("error",it,this),k.once("load",V,this)}},_update(){if(!this._map)return;const x=this._map.getZoom(),A=this._map.getBounds();if(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress)return;if(x>this.options.maxZoom||x<this.options.minZoom){this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);return}const C=this._buildExportParams();Rt.Util.extend(C,this.options.requestParams),C?(this._requestExport(C,A),this.fire("loading",{bounds:A})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)},_renderPopup(x,A,C,k){if(x=Rt.latLng(x),this._shouldRenderPopup&&this._lastClick.equals(x)){const V=this._popupFunction(A,C,k);V&&this._popup.setLatLng(x).setContent(V).openOn(this._map)}},_resetPopupState(x){this._shouldRenderPopup=!1,this._lastClick=x.latlng},_calculateBbox(){const x=this._map.getPixelBounds(),A=this._map.unproject(x.getBottomLeft()),C=this._map.unproject(x.getTopRight()),k=this._map.options.crs.project(C),V=this._map.options.crs.project(A),it=Rt.bounds(k,V);return[it.getBottomLeft().x,it.getBottomLeft().y,it.getTopRight().x,it.getTopRight().y].join(",")},_calculateImageSize(){const x=this._map.getPixelBounds(),A=this._map.getSize(),C=this._map.unproject(x.getBottomLeft()),k=this._map.unproject(x.getTopRight()),V=this._map.latLngToLayerPoint(k).y,it=this._map.latLngToLayerPoint(C).y;return(V>0||it<A.y)&&(A.y=it-V),`${A.x},${A.y}`}});b_.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query(){return this.service.query()},identify(){return this.service.identify()},initialize(x){x=bd(x),this.service=kg(x),this.service.addEventParent(this),Rt.Util.setOptions(this,x)},setPixelType(x){return this.options.pixelType=x,this._update(),this},getPixelType(){return this.options.pixelType},setBandIds(x){return Rt.Util.isArray(x)?this.options.bandIds=x.join(","):this.options.bandIds=x.toString(),this._update(),this},getBandIds(){return this.options.bandIds},setNoData(x,A){return Rt.Util.isArray(x)?this.options.noData=x.join(","):this.options.noData=x.toString(),A&&(this.options.noDataInterpretation=A),this._update(),this},getNoData(){return this.options.noData},getNoDataInterpretation(){return this.options.noDataInterpretation},setRenderingRule(x){this.options.renderingRule=x,this._update()},getRenderingRule(){return this.options.renderingRule},setMosaicRule(x){this.options.mosaicRule=x,this._update()},getMosaicRule(){return this.options.mosaicRule},_getPopupData(x){const A=Rt.Util.bind(function(k,V,it){k||setTimeout(Rt.Util.bind(function(){this._renderPopup(x.latlng,k,V,it)},this),300)},this),C=this.identify().at(x.latlng);this.options.mosaicRule&&C.setMosaicRule(this.options.mosaicRule),C.run(A),this._shouldRenderPopup=!0,this._lastClick=x.latlng},_buildExportParams(){const x=parseInt(this._map.options.crs.code.split(":")[1],10),A={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:x,imageSR:x};return this.options.from&&this.options.to&&(A.time=`${this.options.from.valueOf()},${this.options.to.valueOf()}`),this.options.pixelType&&(A.pixelType=this.options.pixelType),this.options.interpolation&&(A.interpolation=this.options.interpolation),this.options.compressionQuality&&(A.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(A.bandIds=this.options.bandIds),(this.options.noData===0||this.options.noData)&&(A.noData=this.options.noData),this.options.noDataInterpretation&&(A.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(A.token=this.service.options.token),this.options.renderingRule&&(A.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(A.mosaicRule=JSON.stringify(this.options.mosaicRule)),A},_requestExport(x,A){if(this.options.f==="json")this.service.request("exportImage",x,function(C,k){C||(this.options.token&&(k.href+=`?token=${this.options.token}`),this.options.proxy&&(k.href=`${this.options.proxy}?${k.href}`),this._renderImage(k.href,A))},this);else{x.f="image";let C=`${this.options.url}exportImage${Rt.Util.getParamString(x)}`;this.options.proxy&&(C=`${this.options.proxy}?${C}`),this._renderImage(C,A)}}});const Fg=b_.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize(x){x=bd(x),this.service=x_(x),this.service.addEventParent(this),Rt.Util.setOptions(this,x)},getDynamicLayers(){return this.options.dynamicLayers},setDynamicLayers(x){return this.options.dynamicLayers=x,this._update(),this},getLayers(){return this.options.layers},setLayers(x){return this.options.layers=x,this._update(),this},getLayerDefs(){return this.options.layerDefs},setLayerDefs(x){return this.options.layerDefs=x,this._update(),this},getTimeOptions(){return this.options.timeOptions},setTimeOptions(x){return this.options.timeOptions=x,this._update(),this},query(){return this.service.query()},identify(){return this.service.identify()},find(){return this.service.find()},_getPopupData(x){const A=Rt.Util.bind(function(k,V,it){k||setTimeout(Rt.Util.bind(function(){this._renderPopup(x.latlng,k,V,it)},this),300)},this);let C;if(this.options.popup?C=this.options.popup.on(this._map).at(x.latlng):C=this.identify().on(this._map).at(x.latlng),C.params.maxAllowableOffset||C.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?C.layers(`visible:${this.options.layers.join(",")}`):C.layers("visible")),this.options.layerDefs&&typeof this.options.layerDefs!="string"&&!C.params.layerDefs)for(const k in this.options.layerDefs)Object.hasOwn(this.options.layerDefs,k)&&C.layerDef(k,this.options.layerDefs[k]);C.run(A),this._shouldRenderPopup=!0,this._lastClick=x.latlng},_buildExportParams(){const x=parseInt(this._map.options.crs.code.split(":")[1],10),A={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:x,imageSR:x};if(this.options.dynamicLayers&&(A.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(this.options.layers.length===0)return;A.layers=`show:${this.options.layers.join(",")}`}return this.options.layerDefs&&(A.layerDefs=typeof this.options.layerDefs=="string"?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(A.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(A.time=`${this.options.from.valueOf()},${this.options.to.valueOf()}`),this.service.options.token&&(A.token=this.service.options.token),this.options.proxy&&(A.proxy=this.options.proxy),this.options.disableCache&&(A._ts=Date.now()),A},_requestExport(x,A){if(this.options.f==="json")this.service.request("export",x,function(C,k){C||(this.options.token&&k.href&&(k.href+=`?token=${this.options.token}`),this.options.proxy&&k.href&&(k.href=`${this.options.proxy}?${k.href}`),k.href?this._renderImage(k.href,A):this._renderImage(k.imageData,A,k.contentType))},this);else{x.f="image";let C=`${this.options.url}export${Rt.Util.getParamString(x)}`;this.options.proxy&&(C=`${this.options.proxy}?${C}`),this._renderImage(C,A)}}});function w_(x,A){return new Fg(x,A)}const zp=Rt.Layer.extend({options:{cellSize:512,updateWhenIdle:Rt.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize(x){Rt.Util.setOptions(this,x)},onAdd(){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove(){this._removeAllCells(),this._cellZoom=void 0},isLoading(){return this._loading},redraw(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents(){const x={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Rt.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),x.move=this._onMove),x},createCell(){return document.createElement("div")},removeCell(){},reuseCell(){},cellLeave(){},cellEnter(){},getCellSize(){const x=this.options.cellSize;return x instanceof Rt.Point?x:new Rt.Point(x,x)},_pruneCells(){if(!this._map)return;let x,A;for(x in this._cells)A=this._cells[x],A.retain=A.current;for(x in this._cells)if(A=this._cells[x],A.current&&!A.active){const C=A.coords;this._retainParent(C.x,C.y,C.z,C.z-5)||this._retainChildren(C.x,C.y,C.z,C.z+2)}for(x in this._cells)this._cells[x].retain||this._removeCell(x)},_removeAllCells(){for(const x in this._cells)this._removeCell(x)},_invalidateAll(){this._removeAllCells(),this._cellZoom=void 0},_retainParent(x,A,C,k){const V=Math.floor(x/2),it=Math.floor(A/2),O=C-1,g=new Rt.Point(+V,+it);g.z=+O;const bt=this._cellCoordsToKey(g),Et=this._cells[bt];return Et&&Et.active?(Et.retain=!0,!0):(Et&&Et.loaded&&(Et.retain=!0),O>k?this._retainParent(V,it,O,k):!1)},_retainChildren(x,A,C,k){for(let V=2*x;V<2*x+2;V++)for(let it=2*A;it<2*A+2;it++){const O=new Rt.Point(V,it);O.z=C+1;const g=this._cellCoordsToKey(O),bt=this._cells[g];if(bt&&bt.active){bt.retain=!0;continue}else bt&&bt.loaded&&(bt.retain=!0);C+1<k&&this._retainChildren(V,it,C+1,k)}},_resetView(x){const A=x&&(x.pinch||x.flyTo);A||this._setView(this._map.getCenter(),this._map.getZoom(),A,A)},_setView(x,A,C,k){const V=Math.round(A);k||(this._cellZoom=V,this._abortLoading&&this._abortLoading(),this._resetGrid(),V!==void 0&&this._update(x),C||this._pruneCells(),this._noPrune=!!C)},_resetGrid(){const x=this._map,A=x.options.crs,C=this._cellSize=this.getCellSize(),k=this._cellZoom,V=this._map.getPixelWorldBounds(this._cellZoom);V&&(this._globalCellRange=this._pxBoundsToCellRange(V)),this._wrapX=A.wrapLng&&!this.options.noWrap&&[Math.floor(x.project([0,A.wrapLng[0]],k).x/C.x),Math.ceil(x.project([0,A.wrapLng[1]],k).x/C.y)],this._wrapY=A.wrapLat&&!this.options.noWrap&&[Math.floor(x.project([A.wrapLat[0],0],k).y/C.x),Math.ceil(x.project([A.wrapLat[1],0],k).y/C.y)]},_onMoveEnd(x){x&&(x.pinch||x.flyTo)||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds(x){const A=this._map,C=A._animatingZoom?Math.max(A._animateToZoom,A.getZoom()):A.getZoom(),k=A.getZoomScale(C,this._cellZoom),V=A.project(x,this._cellZoom).floor(),it=A.getSize().divideBy(k*2);return new Rt.Bounds(V.subtract(it),V.add(it))},_update(x){const A=this._map;if(!A)return;const C=Math.round(A.getZoom());x===void 0&&(x=A.getCenter());const k=this._getCelldPixelBounds(x),V=this._pxBoundsToCellRange(k),it=V.getCenter(),O=[],g=this.options.keepBuffer,bt=new Rt.Bounds(V.getBottomLeft().subtract([g,-g]),V.getTopRight().add([g,-g]));if(!(isFinite(V.min.x)&&isFinite(V.min.y)&&isFinite(V.max.x)&&isFinite(V.max.y)))throw new Error("Attempted to load an infinite number of cells");for(const Et in this._cells){const Wt=this._cells[Et].coords;(Wt.z!==this._cellZoom||!bt.contains(new Rt.Point(Wt.x,Wt.y)))&&(this._cells[Et].current=!1)}if(Math.abs(C-this._cellZoom)>1){this._setView(x,C);return}for(let Et=V.min.y;Et<=V.max.y;Et++)for(let Wt=V.min.x;Wt<=V.max.x;Wt++){const It=new Rt.Point(Wt,Et);if(It.z=this._cellZoom,!this._isValidCell(It))continue;const Mt=this._cells[this._cellCoordsToKey(It)];Mt?Mt.current=!0:O.push(It)}if(O.sort((Et,Wt)=>Et.distanceTo(it)-Wt.distanceTo(it)),O.length!==0){this._loading||(this._loading=!0);for(let Et=0;Et<O.length;Et++){const Wt=this._cellCoordsToKey(O[Et]),It=this._keyToCellCoords(Wt);this._activeCells[It]?this._reuseCell(O[Et]):this._createCell(O[Et])}}},_isValidCell(x){const A=this._map.options.crs;if(!A.infinite){const k=this._globalCellRange;if(!A.wrapLng&&(x.x<k.min.x||x.x>k.max.x)||!A.wrapLat&&(x.y<k.min.y||x.y>k.max.y))return!1}if(!this.options.bounds)return!0;const C=this._cellCoordsToBounds(x);return Rt.latLngBounds(this.options.bounds).overlaps(C)},_keyToBounds(x){return this._cellCoordsToBounds(this._keyToCellCoords(x))},_cellCoordsToNwSe(x){const A=this._map,C=this.getCellSize(),k=x.scaleBy(C),V=k.add(C),it=A.unproject(k,x.z),O=A.unproject(V,x.z);return[it,O]},_cellCoordsToBounds(x){const A=this._cellCoordsToNwSe(x);let C=new Rt.LatLngBounds(A[0],A[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_cellCoordsToKey(x){return`${x.x}:${x.y}:${x.z}`},_keyToCellCoords(x){const A=x.split(":"),C=new Rt.Point(+A[0],+A[1]);return C.z=+A[2],C},_removeCell(x){const A=this._cells[x];if(!A)return;const C=this._keyToCellCoords(x),k=this._wrapCoords(C),V=this._cellCoordsToBounds(this._wrapCoords(C));A.current=!1,delete this._cells[x],this._activeCells[x]=A,this.cellLeave(V,k,x),this.fire("cellleave",{key:x,coords:k,bounds:V})},_reuseCell(x){const A=this._cellCoordsToKey(x);this._cells[A]=this._activeCells[A],this._cells[A].current=!0;const C=this._wrapCoords(x),k=this._cellCoordsToBounds(this._wrapCoords(x));this.cellEnter(k,C,A),this.fire("cellenter",{key:A,coords:C,bounds:k})},_createCell(x){const A=this._cellCoordsToKey(x),C=this._wrapCoords(x),k=this._cellCoordsToBounds(this._wrapCoords(x));this.createCell(k,C,A),this.fire("cellcreate",{key:A,coords:C,bounds:k}),this._cells[A]={coords:x,current:!0},Rt.Util.requestAnimFrame(this._pruneCells,this)},_cellReady(x,A,C){const k=this._cellCoordsToKey(x);C=this._cells[k],C&&(C.loaded=+new Date,C.active=!0)},_getCellPos(x){return x.scaleBy(this.getCellSize())},_wrapCoords(x){const A=new Rt.Point(this._wrapX?Rt.Util.wrapNum(x.x,this._wrapX):x.x,this._wrapY?Rt.Util.wrapNum(x.y,this._wrapY):x.y);return A.z=x.z,A},_pxBoundsToCellRange(x){const A=this.getCellSize();return new Rt.Bounds(x.min.unscaleBy(A).floor(),x.max.unscaleBy(A).ceil().subtract([1,1]))}});function Gu(x){this.values=[].concat(x||[])}Gu.prototype.query=function(x){var A=this.getIndex(x);return this.values[A]};Gu.prototype.getIndex=function(A){this.dirty&&this.sort();for(var C=0,k=this.values.length-1,V,it;C<=k;)if(V=(C+k)/2|0,it=this.values[Math.round(V)],+it.value<+A)C=V+1;else if(+it.value>+A)k=V-1;else return V;return Math.abs(~k)};Gu.prototype.between=function(A,C){var k=this.getIndex(A),V=this.getIndex(C);if(k===0&&V===0)return[];for(;this.values[k-1]&&this.values[k-1].value===A;)k--;for(;this.values[V+1]&&this.values[V+1].value===C;)V++;return this.values[V]&&this.values[V].value===C&&this.values[V+1]&&V++,this.values.slice(k,V)};Gu.prototype.insert=function(A){return this.values.splice(this.getIndex(A.value),0,A),this};Gu.prototype.bulkAdd=function(A,C){return this.values=this.values.concat([].concat(A||[])),C?this.sort():this.dirty=!0,this};Gu.prototype.sort=function(){return this.values.sort(function(A,C){return+C.value-+A.value}).reverse(),this.dirty=!1,this};const nm=zp.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize(x){if(zp.prototype.initialize.call(this,x),x=bd(x),x=Rt.Util.setOptions(this,x),this.service=Og(x),this.service.addEventParent(this),this.options.fields[0]!=="*"){let A=!1;for(let C=0;C<this.options.fields.length;C++)this.options.fields[C].match(/^(OBJECTID|FID|OID|ID)$/i)&&(A=!0);A===!1&&Rc("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new Gu,this._endTimeIndex=new Gu):this.options.timeField&&(this._timeIndex=new Gu),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd(x){return wd(x),this.service.metadata(function(A,C){if(!A){const k=C.supportedQueryFormats;let V=!1;(this.service.options.isModern===!1||this.options.fetchAllFeatures)&&(V=!0),!V&&k&&k.indexOf("geoJSON")!==-1&&(this.service.options.isModern=!0),C.objectIdField&&(this.service.options.idAttribute=C.objectIdField),!this.options.attribution&&x.attributionControl&&C.copyrightText&&(this.options.attribution=C.copyrightText,x.attributionControl.addAttribution(this.getAttribution()))}},this),x.on("zoomend",this._handleZoomChange,this),zp.prototype.onAdd.call(this,x)},onRemove(x){return Sd(x),x.off("zoomend",this._handleZoomChange,this),zp.prototype.onRemove.call(this,x)},getAttribution(){return this.options.attribution},createCell(x,A){this._visibleZoom()&&this._requestFeatures(x,A)},_requestFeatures(x,A,C,k){this._activeRequests++,k=k||0;const V=this.options.where;return this._activeRequests===1&&this.fire("loading",{bounds:x},!0),this._buildQuery(x,k).run(function(it,O,g){g&&g.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===V&&(!it&&O&&O.features.length&&Rt.Util.requestAnimFrame(Rt.Util.bind(function(){this._addFeatures(O.features,A),this._postProcessFeatures(x)},this)),!it&&O&&!O.features.length&&this._postProcessFeatures(x),it&&this._postProcessFeatures(x),C&&C.call(this,it,O),g&&(g.exceededTransferLimit||g.properties&&g.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(x,A,C,k+O.features.length))},this)},_postProcessFeatures(x){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:x})},_cacheKey(x){return`${x.z}:${x.x}:${x.y}`},_addFeatures(x,A){let C;A&&(C=this._cacheKey(A),this._cache[C]=this._cache[C]||[]);for(let k=x.length-1;k>=0;k--){const V=x[k].id;this._currentSnapshot.indexOf(V)===-1&&this._currentSnapshot.push(V),typeof C<"u"&&this._cache[C].indexOf(V)===-1&&this._cache[C].push(V)}this.options.timeField&&this._buildTimeIndexes(x),this.createLayers(x)},_buildQuery(x,A){let C=this.service.query().intersects(x).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(A))&&(C=C.offset(A)),C.params.resultType="tile",this.options.requestParams&&Rt.Util.extend(C.params,this.options.requestParams),this.options.simplifyFactor&&C.simplify(this._map,this.options.simplifyFactor),this.options.timeFilterMode==="server"&&this.options.from&&this.options.to&&C.between(this.options.from,this.options.to),C},setWhere(x,A,C){this.options.where=x&&x.length?x:"1=1";const k=[],V=[];let it=0,O=null;const g=Rt.Util.bind(function(bt,Et){if(bt&&(O=bt),Et)for(let Wt=Et.features.length-1;Wt>=0;Wt--)V.push(Et.features[Wt].id);it--,it<=0&&this._visibleZoom()&&x===this.options.where&&(this._currentSnapshot=V,Rt.Util.requestAnimFrame(Rt.Util.bind(function(){this.removeLayers(k),this.addLayers(V),A&&A.call(C,O)},this)))},this);for(let bt=this._currentSnapshot.length-1;bt>=0;bt--)k.push(this._currentSnapshot[bt]);this._cache={};for(const bt in this._cells){it++;const Et=this._keyToCellCoords(bt),Wt=this._cellCoordsToBounds(Et);this._requestFeatures(Wt,Et,g)}return this},getWhere(){return this.options.where},getTimeRange(){return[this.options.from,this.options.to]},setTimeRange(x,A,C,k){const V=this.options.from,it=this.options.to;let O=0,g=null;const bt=Rt.Util.bind(function(Et){Et&&(g=Et),this._filterExistingFeatures(V,it,x,A),O--,C&&O<=0&&C.call(k,g)},this);if(this.options.from=x,this.options.to=A,this._filterExistingFeatures(V,it,x,A),this.options.timeFilterMode==="server")for(const Et in this._cells){O++;const Wt=this._keyToCellCoords(Et),It=this._cellCoordsToBounds(Wt);this._requestFeatures(It,Wt,bt)}return this},refresh(){this.setWhere(this.options.where)},_filterExistingFeatures(x,A,C,k){const V=x&&A?this._getFeaturesInTimeRange(x,A):this._currentSnapshot,it=this._getFeaturesInTimeRange(C,k);if(it.indexOf)for(let O=0;O<it.length;O++){const g=V.indexOf(it[O]);g>=0&&V.splice(g,1)}Rt.Util.requestAnimFrame(Rt.Util.bind(function(){this.removeLayers(V),this.addLayers(it)},this))},_getFeaturesInTimeRange(x,A){const C=[];let k;if(this.options.timeField.start&&this.options.timeField.end){const V=this._startTimeIndex.between(x,A),it=this._endTimeIndex.between(x,A);k=V.concat(it)}else if(this._timeIndex)k=this._timeIndex.between(x,A);else return Rc("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];for(let V=k.length-1;V>=0;V--)C.push(k[V].id);return C},_buildTimeIndexes(x){let A,C;if(this.options.timeField.start&&this.options.timeField.end){const k=[],V=[];for(A=x.length-1;A>=0;A--)C=x[A],k.push({id:C.id,value:new Date(C.properties[this.options.timeField.start])}),V.push({id:C.id,value:new Date(C.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(k),this._endTimeIndex.bulkAdd(V)}else{const k=[];for(A=x.length-1;A>=0;A--)C=x[A],k.push({id:C.id,value:new Date(C.properties[this.options.timeField])});this._timeIndex.bulkAdd(k)}},_featureWithinTimeRange(x){if(!this.options.from||!this.options.to)return!0;const A=+this.options.from.valueOf(),C=+this.options.to.valueOf();if(typeof this.options.timeField=="string"){const k=+x.properties[this.options.timeField];return k>=A&&k<=C}if(this.options.timeField.start&&this.options.timeField.end){const k=+x.properties[this.options.timeField.start],V=+x.properties[this.options.timeField.end];return k>=A&&k<=C||V>=A&&V<=C||k<=A&&V>=C}},_visibleZoom(){if(!this._map)return!1;const x=this._map.getZoom();return!(x>this.options.maxZoom||x<this.options.minZoom)},_handleZoomChange(){if(!this._visibleZoom())this.removeLayers(this._currentSnapshot),this._currentSnapshot=[];else for(const x in this._cells){const A=this._cells[x].coords,C=this._cacheKey(A);this._cache[C]&&this.addLayers(this._cache[C])}},authenticate(x){return this.service.authenticate(x),this},metadata(x,A){return this.service.metadata(x,A),this},query(){return this.service.query()},_getMetadata(x){this._metadata?x(void 0,this._metadata):this.metadata(Rt.Util.bind(function(A,C){this._metadata=C,x(A,this._metadata)},this))},addFeature(x,A,C){this.addFeatures(x,A,C)},addFeatures(x,A,C){this._getMetadata(Rt.Util.bind(function(k,V){if(k){A&&A.call(this,k,null);return}const it=x.features?x.features:[x];this.service.addFeatures(x,Rt.Util.bind(function(O,g){if(!O){for(let bt=it.length-1;bt>=0;bt--)it[bt].properties[V.objectIdField]=it.length>1?g[bt].objectId:g.objectId,it[bt].id=it.length>1?g[bt].objectId:g.objectId;this._addFeatures(it)}A&&A.call(C,O,g)},this))},this))},updateFeature(x,A,C){this.updateFeatures(x,A,C)},updateFeatures(x,A,C){const k=x.features?x.features:[x];this.service.updateFeatures(x,function(V,it){if(!V){for(let O=k.length-1;O>=0;O--)this.removeLayers([k[O].id],!0);this._addFeatures(k)}A&&A.call(C,V,it)},this)},deleteFeature(x,A,C){this.deleteFeatures(x,A,C)},deleteFeatures(x,A,C){return this.service.deleteFeatures(x,function(k,V){const it=V.length?V:[V];if(!k&&it.length>0)for(let O=it.length-1;O>=0;O--)this.removeLayers([it[O].objectId],!0);A&&A.call(C,k,V)},this)}});nm.extend({options:{cacheLayers:!0},initialize(x){x.apikey&&(x.token=x.apikey),nm.prototype.initialize.call(this,x),this._originalStyle=this.options.style,this._layers={}},onRemove(x){for(const A in this._layers)x.removeLayer(this._layers[A]),this.fire("removefeature",{feature:this._layers[A].feature,permanent:!1},!0);return nm.prototype.onRemove.call(this,x)},createNewLayer(x){const A=Rt.GeoJSON.geometryToLayer(x,this.options);return A&&(A.defaultOptions=A.options),A},_updateLayer(x,A){let C=[];const k=this.options.coordsToLatLng||Rt.GeoJSON.coordsToLatLng;switch(A.properties&&(x.feature.properties=A.properties),A.geometry.type){case"Point":C=Rt.GeoJSON.coordsToLatLng(A.geometry.coordinates),x.setLatLng(C);break;case"LineString":C=Rt.GeoJSON.coordsToLatLngs(A.geometry.coordinates,0,k),x.setLatLngs(C);break;case"MultiLineString":C=Rt.GeoJSON.coordsToLatLngs(A.geometry.coordinates,1,k),x.setLatLngs(C);break;case"Polygon":C=Rt.GeoJSON.coordsToLatLngs(A.geometry.coordinates,1,k),x.setLatLngs(C);break;case"MultiPolygon":C=Rt.GeoJSON.coordsToLatLngs(A.geometry.coordinates,2,k),x.setLatLngs(C);break}this.redraw(x.feature.id)},createLayers(x){for(let A=x.length-1;A>=0;A--){const C=x[A],k=this._layers[C.id];let V;this._visibleZoom()&&k&&!this._map.hasLayer(k)&&(!this.options.timeField||this._featureWithinTimeRange(C))&&(this._map.addLayer(k),this.fire("addfeature",{feature:k.feature},!0)),k&&(k.setLatLngs||k.setLatLng)&&this._updateLayer(k,C),k||(V=this.createNewLayer(C),V?(V.feature=C,V.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(V.feature,V),this._layers[V.feature.id]=V,this.setFeatureStyle(V.feature.id,this.options.style),this.fire("createfeature",{feature:V.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(C))&&this._map.addLayer(V)):Rc("invalid GeoJSON encountered"))}},addLayers(x){for(let A=x.length-1;A>=0;A--){const C=this._layers[x[A]];C&&(!this.options.timeField||this._featureWithinTimeRange(C.feature))&&(this._map.addLayer(C),this.fire("addfeature",{feature:C.feature},!0))}},removeLayers(x,A){for(let C=x.length-1;C>=0;C--){const k=x[C],V=this._layers[k];V&&(this.fire("removefeature",{feature:V.feature,permanent:A},!0),this._map.removeLayer(V)),V&&A&&delete this._layers[k]}},cellEnter(x,A){this._visibleZoom()&&!this._zooming&&this._map&&Rt.Util.requestAnimFrame(Rt.Util.bind(function(){const C=this._cacheKey(A),k=this._cellCoordsToKey(A),V=this._cache[C];this._activeCells[k]&&V&&this.addLayers(V)},this))},cellLeave(x,A){this._zooming||Rt.Util.requestAnimFrame(Rt.Util.bind(function(){if(this._map){const C=this._cacheKey(A),k=this._cellCoordsToKey(A),V=this._cache[C],it=this._map.getBounds();if(!this._activeCells[k]&&V){let O=!0;for(let g=0;g<V.length;g++){const bt=this._layers[V[g]];bt&&bt.getBounds&&it.intersects(bt.getBounds())&&(O=!1)}O&&this.removeLayers(V,!this.options.cacheLayers),!this.options.cacheLayers&&O&&(delete this._cache[C],delete this._cells[k],delete this._activeCells[k])}}},this))},resetStyle(){return this.options.style=this._originalStyle,this.eachFeature(function(x){this.resetFeatureStyle(x.feature.id)},this),this},setStyle(x){return this.options.style=x,this.eachFeature(function(A){this.setFeatureStyle(A.feature.id,x)},this),this},resetFeatureStyle(x){const A=this._layers[x],C=this._originalStyle||Rt.Path.prototype.options;return A&&(Rt.Util.extend(A.options,A.defaultOptions),this.setFeatureStyle(x,C)),this},setFeatureStyle(x,A){const C=this._layers[x];return typeof A=="function"&&(A=A(C.feature)),C.setStyle&&C.setStyle(A),this},eachActiveFeature(x,A){if(this._map){const C=this._map.getBounds();for(const k in this._layers)this._currentSnapshot.indexOf(this._layers[k].feature.id)!==-1&&(typeof this._layers[k].getLatLng=="function"&&C.contains(this._layers[k].getLatLng())?x.call(A,this._layers[k]):typeof this._layers[k].getBounds=="function"&&C.intersects(this._layers[k].getBounds())&&x.call(A,this._layers[k]))}return this},eachFeature(x,A){for(const C in this._layers)x.call(A,this._layers[C]);return this},getFeature(x){return this._layers[x]},bringToBack(){this.eachFeature(x=>{x.bringToBack&&x.bringToBack()})},bringToFront(){this.eachFeature(x=>{x.bringToFront&&x.bringToFront()})},redraw(x){return x&&this._redraw(x),this},_redraw(x){const A=this._layers[x],C=A.feature;if(A&&A.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){const V=this.options.pointToLayer(C,Rt.latLng(C.geometry.coordinates[1],C.geometry.coordinates[0])).options.icon;A.setIcon(V)}if(A&&A.setStyle&&this.options.pointToLayer){const V=this.options.pointToLayer(C,Rt.latLng(C.geometry.coordinates[1],C.geometry.coordinates[0])).options;this.setFeatureStyle(C.id,V)}A&&A.setStyle&&this.options.style&&this.resetFeatureStyle(C.id)},openPopup(x){return this._popup&&this._popup._prepareOpen(x||this._latlng)&&this._popup.openOn(this._map),this},openTooltip(x){return this._tooltip&&this._tooltip._prepareOpen(x)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this)),this}});function Ug(x,A){if(x.includes("/"))throw new Error(`${x} is a v2 style enumeration. Set version:2 to request this style`);let C=`https://basemaps-api.arcgis.com/arcgis/rest/services/styles/${x}?type=style`;return A&&(C=`${C}&token=${A}`),C}function Zg(x,A,C){if(x.startsWith("osm/")&&console.log("L.esri.Vector.vectorBasemapLayer: All 'osm/*' styles are retired are no longer receiving updates and were last updated in 2024. Please use 'open/*' styles instead."),x.includes(":"))throw new Error(`${x} is a v1 style enumeration. Set version:1 to request this style`);let k=C.baseUrl||"https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/styles/";if(!(x.startsWith("open/")||x.startsWith("osm/")||x.startsWith("arcgis/"))&&x.length===32){if(k=`${k}items/${x}`,C.language)throw new Error("The 'language' parameter is not supported for custom basemap styles")}else k=k+x;if(!A)throw new Error("A token is required to access basemap styles.");return k=`${k}?token=${A}`,C.language&&(k=`${k}&language=${C.language}`),C.worldview&&(k=`${k}&worldview=${C.worldview}`),C.places&&(k=`${k}&places=${C.places}`),k}function jg(x,A,C){const k=/^https?:\/\//,V=/\/VectorTileServer\/?$/;k.test(x)&&V.test(x)?T_(x,A,C):Vg(x,A,C)}function S_(x,A,C){const k=A.token?{token:A.token}:{};uf(x,k,C)}function Ym(x,A,C){const k=A.token?{token:A.token}:{},V=`${A.portalUrl}/sharing/rest/content/items/${x}`;uf(V,k,C)}function Vg(x,A,C){const k=lm(`${A.portalUrl}/sharing/rest/content/items/${x}/resources/styles/root.json`);A_(k,A,(V,it)=>{V?Ym(x,A,(O,g)=>{if(O){C(O);return}T_(g.url,A,C)}):Ym(x,A,(O,g)=>{if(O){C(O);return}S_(g.url,A,(bt,Et)=>{C(bt,it,k,Et,g.url)})})})}function T_(x,A,C){S_(x,A,(k,V)=>{if(k){C(k);return}let it=x;x.charAt(x.length-1)==="/"&&(it=x.slice(0,x.length-1));let O;V.defaultStyles.charAt(0)==="/"?O=`${it+V.defaultStyles}/root.json`:O=`${it}/${V.defaultStyles}/root.json`,A_(O,A,(g,bt)=>{if(g){C(g);return}C(null,bt,O,V,x)})})}function A_(x,A,C){const k=A.token?{token:A.token}:{};uf(x,k,C)}function Km(x,A){return new URL(x).hostname===new URL(A).hostname}function lm(x){if(!x)return x||null;let A=x;return A&&(A=qg(A),A=A.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),A=A.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),A=A.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),A}function qg(x){const A=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,C=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,k=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return A.test(x)?x=x.replace(A,"https://www.arcgis.com"):C.test(x)?x=x.replace(C,"https://devext.arcgis.com"):k.test(x)&&(x=x.replace(k,"https://qaext.arcgis.com")),x}function Gg(x,A,C,k){const V=Object.keys(x.sources);for(let O=0;O<V.length;O++){const g=x.sources[V[O]];g.url.indexOf("http")===-1&&(g.url=A.replace("/resources/styles/root.json","")),g.url.charAt(g.url.length-1)==="/"&&(g.url=g.url.slice(0,g.url.length-1)),g.tiles||(C.tiles&&C.tiles[0].charAt(0)!=="/"&&(C.tiles[0]=`/${C.tiles[0]}`),g.tiles=[g.url+C.tiles[0]]),g.url+="?f=json",g.url+=k?`&token=${k}`:"",g.tiles[0]+=k?`?token=${k}`:"",g.minzoom=C.minLOD||C.tileInfo.lods[0].level,g.maxzoom=C.maxLOD||C.tileInfo.lods[C.tileInfo.lods.length-1].level}const it=x.sources[V[V.length-1]];it.attribution=C.copyrightText||"",it.copyrightText=C.copyrightText||"";for(let O=0;O<x.layers.length;O++){const g=x.layers[O];g.layout&&g.layout["text-font"]&&g.layout["text-font"].length>1&&(g.layout["text-font"]=[g.layout["text-font"][0]])}return x.sprite&&x.sprite.indexOf("http")===-1&&(x.sprite=A.replace("styles/root.json",x.sprite.replace("../",""))),x.glyphs&&(x.glyphs=lm(x.glyphs)),x.sprite&&(x.sprite=lm(x.sprite)),x.sprite&&k&&(Km(A,x.sprite)?x.sprite+=`?token=${k}`:console.warn("Passing a token but sprite URL is not on same base URL, so you must pass the token manually.")),x.glyphs&&x.glyphs.indexOf("http")===-1&&(x.glyphs=A.replace("styles/root.json",x.glyphs.replace("../",""))),x.glyphs&&k&&(Km(A,x.glyphs)?x.glyphs+=`?token=${k}`:console.warn("Passing a token but glyph URL is not on same base URL, so you must pass the token manually.")),x}function Hg(x,A){kc.cors&&uf(x,{},(C,k)=>{if(C)return;A._esriAttributions=A._esriAttributions||[];for(let it=0;it<k.contributors.length;it++){const O=k.contributors[it];for(let g=0;g<O.coverageAreas.length;g++){const bt=O.coverageAreas[g],Et=Rt.latLng(bt.bbox[0],bt.bbox[1]),Wt=Rt.latLng(bt.bbox[2],bt.bbox[3]);A._esriAttributions.push({attribution:O.attribution,score:bt.score,bounds:Rt.latLngBounds(Et,Wt),minZoom:bt.zoomMin,maxZoom:bt.zoomMax})}}A._esriAttributions.sort((it,O)=>O.score-it.score);const V={target:A};Th._updateMapAttribution(V)})}const Xg=[3857,102100,102113];function $g(x){return Xg.indexOf(x)>=0}var Cp={exports:{}};var Yg=Cp.exports,Wm;function Kg(){return Wm||(Wm=1,(function(x,A){(function(C,k){x.exports=k()})(Yg,(function(){var C={},k={};function V(O,g,bt){if(k[O]=bt,O==="index"){var Et="var sharedModule = {}; ("+k.shared+")(sharedModule); ("+k.worker+")(sharedModule);",Wt={};return k.shared(Wt),k.index(C,Wt),typeof window<"u"&&C.setWorkerUrl(window.URL.createObjectURL(new Blob([Et],{type:"text/javascript"}))),C}}V("shared",["exports"],(function(O){function g(n,e,s,u){return new(s||(s=Promise))((function(f,y){function v(D){try{E(u.next(D))}catch(R){y(R)}}function S(D){try{E(u.throw(D))}catch(R){y(R)}}function E(D){var R;D.done?f(D.value):(R=D.value,R instanceof s?R:new s((function(F){F(R)}))).then(v,S)}E((u=u.apply(n,e||[])).next())}))}function bt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}typeof SuppressedError=="function"&&SuppressedError;var Et=Wt;function Wt(n,e){this.x=n,this.y=e}Wt.prototype={clone:function(){return new Wt(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,s=n.y-this.y;return e*e+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),s=Math.sin(n),u=s*this.x+e*this.y;return this.x=e*this.x-s*this.y,this.y=u,this},_rotateAround:function(n,e){var s=Math.cos(n),u=Math.sin(n),f=e.y+u*(this.x-e.x)+s*(this.y-e.y);return this.x=e.x+s*(this.x-e.x)-u*(this.y-e.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Wt.convert=function(n){return n instanceof Wt?n:Array.isArray(n)?new Wt(n[0],n[1]):n};var It=bt(Et),Mt=Ui;function Ui(n,e,s,u){this.cx=3*n,this.bx=3*(s-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(u-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=s,this.p2y=u}Ui.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(e===void 0&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var s=n,u=0;u<8;u++){var f=this.sampleCurveX(s)-n;if(Math.abs(f)<e)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=f/y}var v=0,S=1;for(s=n,u=0;u<20&&(f=this.sampleCurveX(s),!(Math.abs(f-n)<e));u++)n>f?v=s:S=s,s=.5*(S-v)+v;return s},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var Bi=bt(Mt);let je,gi;function on(){return je==null&&(je=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),je}function ea(){if(gi==null&&(gi=!1,on())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let u=0;u<25;u++){const f=4*u;e.fillStyle=`rgb(${f},${f+1},${f+2})`,e.fillRect(u%5,Math.floor(u/5),1,1)}const s=e.getImageData(0,0,5,5).data;for(let u=0;u<100;u++)if(u%4!=3&&s[u]!==u){gi=!0;break}}}return gi||!1}function We(n,e,s,u){const f=new Bi(n,e,s,u);return y=>f.solve(y)}const Qi=We(.25,.1,.25,1);function Ni(n,e,s){return Math.min(s,Math.max(e,n))}function Xi(n,e,s){const u=s-e,f=((n-e)%u+u)%u+e;return f===e?s:f}function Xe(n,...e){for(const s of e)for(const u in s)n[u]=s[u];return n}let Un=1;function wn(n,e,s){const u={};for(const f in n)u[f]=e.call(this,n[f],f,n);return u}function ca(n,e,s){const u={};for(const f in n)e.call(this,n[f],f,n)&&(u[f]=n[f]);return u}function Fe(n){return Array.isArray(n)?n.map(Fe):typeof n=="object"&&n?wn(n,Fe):n}const Ei={};function Sn(n){Ei[n]||(typeof console<"u"&&console.warn(n),Ei[n]=!0)}function Pi(n,e,s){return(s.y-n.y)*(e.x-n.x)>(e.y-n.y)*(s.x-n.x)}function $i(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let Vt=null;function ce(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function xi(n,e,s,u,f){return g(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(n,{timestamp:0});try{const v=y?.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const S=v.startsWith("BGR"),E=new Uint8ClampedArray(u*f*4);if(yield y.copyTo(E,(function(D,R,F,q,X){const K=4*Math.max(-R,0),W=(Math.max(0,F)-F)*q*4+K,st=4*q,ut=Math.max(0,R),Ct=Math.max(0,F);return{rect:{x:ut,y:Ct,width:Math.min(D.width,R+q)-ut,height:Math.min(D.height,F+X)-Ct},layout:[{offset:W,stride:st}]}})(n,e,s,u,f)),S)for(let D=0;D<E.length;D+=4){const R=E[D];E[D]=E[D+2],E[D+2]=R}return E}finally{y.close()}}))}let ge,dt;const St="AbortError";function Ht(){return new Error(St)}const ae={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function me(n){return ae.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const xe="global-dispatcher";class Ve extends Error{constructor(e,s,u,f){super(`AJAXError: ${s} (${e}): ${u}`),this.status=e,this.statusText=s,this.url=u,this.body=f}}const Mi=()=>$i(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Vi=function(n,e){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const u=me(n.url);if(u)return u(n,e);if($i(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:xe},e)}if(!(/^file:/.test(s=n.url)||/^file:/.test(Mi())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(u,f){return g(this,void 0,void 0,(function*(){const y=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:Mi(),signal:f.signal});u.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");const v=yield fetch(y);if(!v.ok){const D=yield v.blob();throw new Ve(v.status,v.statusText,u.url,D)}let S;S=u.type==="arrayBuffer"||u.type==="image"?v.arrayBuffer():u.type==="json"?v.json():v.text();const E=yield S;if(f.signal.aborted)throw Ht();return{data:E,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}}))})(n,e);if($i(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:xe},e)}var s;return(function(u,f){return new Promise(((y,v)=>{var S;const E=new XMLHttpRequest;E.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(E.responseType="arraybuffer");for(const D in u.headers)E.setRequestHeader(D,u.headers[D]);u.type==="json"&&(E.responseType="text",!((S=u.headers)===null||S===void 0)&&S.Accept||E.setRequestHeader("Accept","application/json")),E.withCredentials=u.credentials==="include",E.onerror=()=>{v(new Error(E.statusText))},E.onload=()=>{if(!f.signal.aborted)if((E.status>=200&&E.status<300||E.status===0)&&E.response!==null){let D=E.response;if(u.type==="json")try{D=JSON.parse(E.response)}catch(R){return void v(R)}y({data:D,cacheControl:E.getResponseHeader("Cache-Control"),expires:E.getResponseHeader("Expires")})}else{const D=new Blob([E.response],{type:E.getResponseHeader("Content-Type")});v(new Ve(E.status,E.statusText,u.url,D))}},f.signal.addEventListener("abort",(()=>{E.abort(),v(Ht())})),E.send(u.body)}))})(n,e)};function Qa(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const e=new URL(n),s=window.location;return e.protocol===s.protocol&&e.host===s.host}function Ys(n,e,s){s[n]&&s[n].indexOf(e)!==-1||(s[n]=s[n]||[],s[n].push(e))}function za(n,e,s){if(s&&s[n]){const u=s[n].indexOf(e);u!==-1&&s[n].splice(u,1)}}class ks{constructor(e,s={}){Xe(this,s),this.type=e}}class Ua extends ks{constructor(e,s={}){super("error",Xe({error:e},s))}}class br{on(e,s){return this._listeners=this._listeners||{},Ys(e,s,this._listeners),this}off(e,s){return za(e,s,this._listeners),za(e,s,this._oneTimeListeners),this}once(e,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Ys(e,s,this._oneTimeListeners),this):new Promise((u=>this.once(e,u)))}fire(e,s){typeof e=="string"&&(e=new ks(e,s||{}));const u=e.type;if(this.listens(u)){e.target=this;const f=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const S of f)S.call(this,e);const y=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const S of y)za(u,S,this._oneTimeListeners),S.call(this,e);const v=this._eventedParent;v&&(Xe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(e))}else e instanceof Ua&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,s){return this._eventedParent=e,this._eventedParentData=s,this}}var Nt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const wr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Sr(n,e){const s={};for(const u in n)u!=="ref"&&(s[u]=n[u]);return wr.forEach((u=>{u in e&&(s[u]=e[u])})),s}function zi(n,e){if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let s=0;s<n.length;s++)if(!zi(n[s],e[s]))return!1;return!0}if(typeof n=="object"&&n!==null&&e!==null){if(typeof e!="object"||Object.keys(n).length!==Object.keys(e).length)return!1;for(const s in n)if(!zi(n[s],e[s]))return!1;return!0}return n===e}function ln(n,e){n.push(e)}function Tr(n,e,s){ln(s,{command:"addSource",args:[n,e[n]]})}function Ar(n,e,s){ln(e,{command:"removeSource",args:[n]}),s[n]=!0}function Ks(n,e,s,u){Ar(n,s,u),Tr(n,e,s)}function ia(n,e,s){let u;for(u in n[s])if(Object.prototype.hasOwnProperty.call(n[s],u)&&u!=="data"&&!zi(n[s][u],e[s][u]))return!1;for(u in e[s])if(Object.prototype.hasOwnProperty.call(e[s],u)&&u!=="data"&&!zi(n[s][u],e[s][u]))return!1;return!0}function gs(n,e,s,u,f,y){n=n||{},e=e||{};for(const v in n)Object.prototype.hasOwnProperty.call(n,v)&&(zi(n[v],e[v])||s.push({command:y,args:[u,v,e[v],f]}));for(const v in e)Object.prototype.hasOwnProperty.call(e,v)&&!Object.prototype.hasOwnProperty.call(n,v)&&(zi(n[v],e[v])||s.push({command:y,args:[u,v,e[v],f]}))}function qr(n){return n.id}function co(n,e){return n[e.id]=e,n}class ie{constructor(e,s,u,f){this.message=(e?`${e}: `:"")+u,f&&(this.identifier=f),s!=null&&s.__line__&&(this.line=s.__line__)}}function Ws(n,...e){for(const s of e)for(const u in s)n[u]=s[u];return n}class ha extends Error{constructor(e,s){super(s),this.message=s,this.key=e}}class Rs{constructor(e,s=[]){this.parent=e,this.bindings={};for(const[u,f]of s)this.bindings[u]=f}concat(e){return new Rs(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Gr={kind:"null"},oe={kind:"number"},ke={kind:"string"},Ie={kind:"boolean"},un={kind:"color"},Ca={kind:"object"},Qe={kind:"value"},Js={kind:"collator"},ts={kind:"formatted"},ys={kind:"padding"},Za={kind:"resolvedImage"},ot={kind:"variableAnchorOffsetCollection"};function H(n,e){return{kind:"array",itemType:n,N:e}}function G(n){if(n.kind==="array"){const e=G(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const tt=[Gr,oe,ke,Ie,un,ts,Ca,H(Qe),ys,Za,ot];function at(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!at(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const s of tt)if(!at(s,e))return null}}return`Expected ${G(n)} but found ${G(e)} instead.`}function _t(n,e){return e.some((s=>s.kind===n.kind))}function yt(n,e){return e.some((s=>s==="null"?n===null:s==="array"?Array.isArray(n):s==="object"?n&&!Array.isArray(n)&&typeof n=="object":s===typeof n))}function zt(n,e){return n.kind==="array"&&e.kind==="array"?n.itemType.kind===e.itemType.kind&&typeof n.N=="number":n.kind===e.kind}const ft=.96422,jt=.82521,Kt=4/29,Dt=6/29,Ft=3*Dt*Dt,ze=Dt*Dt*Dt,Pe=Math.PI/180,ri=180/Math.PI;function Le(n){return(n%=360)<0&&(n+=360),n}function Ye([n,e,s,u]){let f,y;const v=nn((.2225045*(n=ii(n))+.7168786*(e=ii(e))+.0606169*(s=ii(s)))/1);n===e&&e===s?f=y=v:(f=nn((.4360747*n+.3850649*e+.1430804*s)/ft),y=nn((.0139322*n+.0971045*e+.7141733*s)/jt));const S=116*v-16;return[S<0?0:S,500*(f-v),200*(v-y),u]}function ii(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function nn(n){return n>ze?Math.pow(n,1/3):n/Ft+Kt}function Tn([n,e,s,u]){let f=(n+16)/116,y=isNaN(e)?f:f+e/500,v=isNaN(s)?f:f-s/200;return f=1*Zi(f),y=ft*Zi(y),v=jt*Zi(v),[ui(3.1338561*y-1.6168667*f-.4906146*v),ui(-.9787684*y+1.9161415*f+.033454*v),ui(.0719453*y-.2289914*f+1.4052427*v),u]}function ui(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function Zi(n){return n>Dt?n*n*n:Ft*(n-Kt)}function Yi(n){return parseInt(n.padEnd(2,n),16)/255}function Zn(n,e){return Mn(e?n/100:n,0,1)}function Mn(n,e,s){return Math.min(Math.max(e,n),s)}function jn(n){return!n.some(Number.isNaN)}const es={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ci{constructor(e,s,u,f=1,y=!0){this.r=e,this.g=s,this.b=u,this.a=f,y||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[e,s,u,f]))}static parse(e){if(e instanceof Ci)return e;if(typeof e!="string")return;const s=(function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=es[u];if(f){const[v,S,E]=f;return[v/255,S/255,E/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const v=u.length<6?1:2;let S=1;return[Yi(u.slice(S,S+=v)),Yi(u.slice(S,S+=v)),Yi(u.slice(S,S+=v)),Yi(u.slice(S,S+v)||"ff")]}if(u.startsWith("rgb")){const v=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[S,E,D,R,F,q,X,K,W,st,ut,Ct]=v,gt=[R||" ",X||" ",st].join("");if(gt==="  "||gt==="  /"||gt===",,"||gt===",,,"){const Tt=[D,q,W].join(""),Zt=Tt==="%%%"?100:Tt===""?255:0;if(Zt){const ee=[Mn(+E/Zt,0,1),Mn(+F/Zt,0,1),Mn(+K/Zt,0,1),ut?Zn(+ut,Ct):1];if(jn(ee))return ee}}return}}const y=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,S,E,D,R,F,q,X,K]=y,W=[E||" ",R||" ",q].join("");if(W==="  "||W==="  /"||W===",,"||W===",,,"){const st=[+S,Mn(+D,0,100),Mn(+F,0,100),X?Zn(+X,K):1];if(jn(st))return(function([ut,Ct,gt,Tt]){function Zt(ee){const ye=(ee+ut/30)%12,Be=Ct*Math.min(gt,1-gt);return gt-Be*Math.max(-1,Math.min(ye-3,9-ye,1))}return ut=Le(ut),Ct/=100,gt/=100,[Zt(0),Zt(8),Zt(4),Tt]})(st)}}})(e);return s?new Ci(...s,!1):void 0}get rgb(){const{r:e,g:s,b:u,a:f}=this,y=f||1/0;return this.overwriteGetter("rgb",[e/y,s/y,u/y,f])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[s,u,f,y]=Ye(e),v=Math.sqrt(u*u+f*f);return[Math.round(1e4*v)?Le(Math.atan2(f,u)*ri):NaN,v,s,y]})(this.rgb))}get lab(){return this.overwriteGetter("lab",Ye(this.rgb))}overwriteGetter(e,s){return Object.defineProperty(this,e,{value:s}),s}toString(){const[e,s,u,f]=this.rgb;return`rgba(${[e,s,u].map((y=>Math.round(255*y))).join(",")},${f})`}}Ci.black=new Ci(0,0,0,1),Ci.white=new Ci(1,1,1,1),Ci.transparent=new Ci(0,0,0,0),Ci.red=new Ci(1,0,0,1);class Vn{constructor(e,s,u){this.sensitivity=e?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,s){return this.collator.compare(e,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ol{constructor(e,s,u,f,y){this.text=e,this.image=s,this.scale=u,this.fontStack=f,this.textColor=y}}class ja{constructor(e){this.sections=e}static fromString(e){return new ja([new Ol(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof ja?e:ja.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class Kn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Kn)return e;if(typeof e=="number")return new Kn([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const s of e)if(typeof s!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Kn(e)}}toString(){return JSON.stringify(this.values)}}const Hr=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ga{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof ga)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let s=0;s<e.length;s+=2){const u=e[s],f=e[s+1];if(typeof u!="string"||!Hr.has(u)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new ga(e)}}toString(){return JSON.stringify(this.values)}}class La{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new La({name:e,available:!1}):null}}function Xr(n,e,s,u){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[n,e,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[n,e,s,u]:[n,e,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Os(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Ci||n instanceof Vn||n instanceof ja||n instanceof Kn||n instanceof ga||n instanceof La)return!0;if(Array.isArray(n)){for(const e of n)if(!Os(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!Os(n[e]))return!1;return!0}return!1}function Ue(n){if(n===null)return Gr;if(typeof n=="string")return ke;if(typeof n=="boolean")return Ie;if(typeof n=="number")return oe;if(n instanceof Ci)return un;if(n instanceof Vn)return Js;if(n instanceof ja)return ts;if(n instanceof Kn)return ys;if(n instanceof ga)return ot;if(n instanceof La)return Za;if(Array.isArray(n)){const e=n.length;let s;for(const u of n){const f=Ue(u);if(s){if(s===f)continue;s=Qe;break}s=f}return H(s||Qe,e)}return Ca}function qi(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof Ci||n instanceof ja||n instanceof Kn||n instanceof ga||n instanceof La?n.toString():JSON.stringify(n)}class In{constructor(e,s){this.type=e,this.value=s}static parse(e,s){if(e.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Os(e[1]))return s.error("invalid value");const u=e[1];let f=Ue(u);const y=s.expectedType;return f.kind!=="array"||f.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(f=y),new In(f,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class bi{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Qs={string:ke,number:oe,boolean:Ie,object:Ca};class is{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");let u,f=1;const y=e[0];if(y==="array"){let S,E;if(e.length>2){const D=e[1];if(typeof D!="string"||!(D in Qs)||D==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);S=Qs[D],f++}else S=Qe;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return s.error('The length argument to "array" must be a positive integer literal',2);E=e[2],f++}u=H(S,E)}else{if(!Qs[y])throw new Error(`Types doesn't contain name = ${y}`);u=Qs[y]}const v=[];for(;f<e.length;f++){const S=s.parse(e[f],f,Qe);if(!S)return null;v.push(S)}return new is(u,v)}evaluate(e){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(e);if(!at(this.type,Ue(u)))return u;if(s===this.args.length-1)throw new bi(`Expected value to be of type ${G(this.type)}, but found ${G(Ue(u))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const ai={"to-boolean":Ie,"to-color":un,"to-number":oe,"to-string":ke};class Fi{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");const u=e[0];if(!ai[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&e.length!==2)return s.error("Expected one argument.");const f=ai[u],y=[];for(let v=1;v<e.length;v++){const S=s.parse(e[v],v,Qe);if(!S)return null;y.push(S)}return new Fi(f,y)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let s,u;for(const f of this.args){if(s=f.evaluate(e),u=null,s instanceof Ci)return s;if(typeof s=="string"){const y=e.parseColor(s);if(y)return y}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Xr(s[0],s[1],s[2],s[3]),!u))return new Ci(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new bi(u||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const u of this.args){s=u.evaluate(e);const f=Kn.parse(s);if(f)return f}throw new bi(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const u of this.args){s=u.evaluate(e);const f=ga.parse(s);if(f)return f}throw new bi(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const u of this.args){if(s=u.evaluate(e),s===null)return 0;const f=Number(s);if(!isNaN(f))return f}throw new bi(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return ja.fromString(qi(this.args[0].evaluate(e)));case"resolvedImage":return La.fromString(qi(this.args[0].evaluate(e)));default:return qi(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Go=["Unknown","Point","LineString","Polygon"];class ho{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Go[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let s=this._parseColorCache[e];return s||(s=this._parseColorCache[e]=Ci.parse(e)),s}}class Ki{constructor(e,s,u=[],f,y=new Rs,v=[]){this.registry=e,this.path=u,this.key=u.map((S=>`[${S}]`)).join(""),this.scope=y,this.errors=v,this.expectedType=f,this._isConstant=s}parse(e,s,u,f,y={}){return s?this.concat(s,u,f)._parse(e,y):this._parse(e,y)}_parse(e,s){function u(f,y,v){return v==="assert"?new is(y,[f]):v==="coerce"?new Fi(y,[f]):f}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=e[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let v=y.parse(e,this);if(!v)return null;if(this.expectedType){const S=this.expectedType,E=v.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||E.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string")if(S.kind!=="padding"||E.kind!=="value"&&E.kind!=="number"&&E.kind!=="array")if(S.kind!=="variableAnchorOffsetCollection"||E.kind!=="value"&&E.kind!=="array"){if(this.checkSubtype(S,E))return null}else v=u(v,S,s.typeAnnotation||"coerce");else v=u(v,S,s.typeAnnotation||"coerce");else v=u(v,S,s.typeAnnotation||"coerce");else v=u(v,S,s.typeAnnotation||"assert")}if(!(v instanceof In)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const S=new ho;try{v=new In(v.type,v.evaluate(S))}catch(E){return this.error(E.message),null}}return v}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,s,u){const f=typeof e=="number"?this.path.concat(e):this.path,y=u?this.scope.concat(u):this.scope;return new Ki(this.registry,this._isConstant,f,s||null,y,this.errors)}error(e,...s){const u=`${this.key}${s.map((f=>`[${f}]`)).join("")}`;this.errors.push(new ha(u,e))}checkSubtype(e,s){const u=at(e,s);return u&&this.error(u),u}}class tr{constructor(e,s){this.type=s.type,this.bindings=[].concat(e),this.result=s}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const s of this.bindings)e(s[1]);e(this.result)}static parse(e,s){if(e.length<4)return s.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const u=[];for(let y=1;y<e.length-1;y+=2){const v=e[y];if(typeof v!="string")return s.error(`Expected string, but found ${typeof v} instead.`,y);if(/[^a-zA-Z0-9_]/.test(v))return s.error("Variable names must contain only alphanumeric characters or '_'.",y);const S=s.parse(e[y+1],y+1);if(!S)return null;u.push([v,S])}const f=s.parse(e[e.length-1],e.length-1,s.expectedType,u);return f?new tr(u,f):null}outputDefined(){return this.result.outputDefined()}}class wi{constructor(e,s){this.type=s.type,this.name=e,this.boundExpression=s}static parse(e,s){if(e.length!==2||typeof e[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=e[1];return s.scope.has(u)?new wi(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Bs{constructor(e,s,u){this.type=e,this.index=s,this.input=u}static parse(e,s){if(e.length!==3)return s.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=s.parse(e[1],1,oe),f=s.parse(e[2],2,H(s.expectedType||Qe));return u&&f?new Bs(f.type.itemType,u,f):null}evaluate(e){const s=this.index.evaluate(e),u=this.input.evaluate(e);if(s<0)throw new bi(`Array index out of bounds: ${s} < 0.`);if(s>=u.length)throw new bi(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s!==Math.floor(s))throw new bi(`Array index must be an integer, but found ${s} instead.`);return u[s]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class an{constructor(e,s){this.type=Ie,this.needle=e,this.haystack=s}static parse(e,s){if(e.length!==3)return s.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=s.parse(e[1],1,Qe),f=s.parse(e[2],2,Qe);return u&&f?_t(u.type,[Ie,ke,oe,Gr,Qe])?new an(u,f):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${G(u.type)} instead`):null}evaluate(e){const s=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!u)return!1;if(!yt(s,["boolean","string","number","null"]))throw new bi(`Expected first argument to be of type boolean, string, number or null, but found ${G(Ue(s))} instead.`);if(!yt(u,["string","array"]))throw new bi(`Expected second argument to be of type array or string, but found ${G(Ue(u))} instead.`);return u.indexOf(s)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class ns{constructor(e,s,u){this.type=oe,this.needle=e,this.haystack=s,this.fromIndex=u}static parse(e,s){if(e.length<=2||e.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=s.parse(e[1],1,Qe),f=s.parse(e[2],2,Qe);if(!u||!f)return null;if(!_t(u.type,[Ie,ke,oe,Gr,Qe]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${G(u.type)} instead`);if(e.length===4){const y=s.parse(e[3],3,oe);return y?new ns(u,f,y):null}return new ns(u,f)}evaluate(e){const s=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!yt(s,["boolean","string","number","null"]))throw new bi(`Expected first argument to be of type boolean, string, number or null, but found ${G(Ue(s))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(e)),yt(u,["string"])){const y=u.indexOf(s,f);return y===-1?-1:[...u.slice(0,y)].length}if(yt(u,["array"]))return u.indexOf(s,f);throw new bi(`Expected second argument to be of type array or string, but found ${G(Ue(u))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class $r{constructor(e,s,u,f,y,v){this.inputType=e,this.type=s,this.input=u,this.cases=f,this.outputs=y,this.otherwise=v}static parse(e,s){if(e.length<5)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return s.error("Expected an even number of arguments.");let u,f;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);const y={},v=[];for(let D=2;D<e.length-1;D+=2){let R=e[D];const F=e[D+1];Array.isArray(R)||(R=[R]);const q=s.concat(D);if(R.length===0)return q.error("Expected at least one branch label.");for(const K of R){if(typeof K!="number"&&typeof K!="string")return q.error("Branch labels must be numbers or strings.");if(typeof K=="number"&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof K=="number"&&Math.floor(K)!==K)return q.error("Numeric branch labels must be integer values.");if(u){if(q.checkSubtype(u,Ue(K)))return null}else u=Ue(K);if(y[String(K)]!==void 0)return q.error("Branch labels must be unique.");y[String(K)]=v.length}const X=s.parse(F,D,f);if(!X)return null;f=f||X.type,v.push(X)}const S=s.parse(e[1],1,Qe);if(!S)return null;const E=s.parse(e[e.length-1],e.length-1,f);return E?S.type.kind!=="value"&&s.concat(1).checkSubtype(u,S.type)?null:new $r(u,f,S,y,v,E):null}evaluate(e){const s=this.input.evaluate(e);return(Ue(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class as{constructor(e,s,u){this.type=e,this.branches=s,this.otherwise=u}static parse(e,s){if(e.length<4)return s.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const f=[];for(let v=1;v<e.length-1;v+=2){const S=s.parse(e[v],v,Ie);if(!S)return null;const E=s.parse(e[v+1],v+1,u);if(!E)return null;f.push([S,E]),u=u||E.type}const y=s.parse(e[e.length-1],e.length-1,u);if(!y)return null;if(!u)throw new Error("Can't infer output type");return new as(u,f,y)}evaluate(e){for(const[s,u]of this.branches)if(s.evaluate(e))return u.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[s,u]of this.branches)e(s),e(u);e(this.otherwise)}outputDefined(){return this.branches.every((([e,s])=>s.outputDefined()))&&this.otherwise.outputDefined()}}class fo{constructor(e,s,u,f){this.type=e,this.input=s,this.beginIndex=u,this.endIndex=f}static parse(e,s){if(e.length<=2||e.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=s.parse(e[1],1,Qe),f=s.parse(e[2],2,oe);if(!u||!f)return null;if(!_t(u.type,[H(Qe),ke,Qe]))return s.error(`Expected first argument to be of type array or string, but found ${G(u.type)} instead`);if(e.length===4){const y=s.parse(e[3],3,oe);return y?new fo(u.type,u,f,y):null}return new fo(u.type,u,f)}evaluate(e){const s=this.input.evaluate(e),u=this.beginIndex.evaluate(e);let f;if(this.endIndex&&(f=this.endIndex.evaluate(e)),yt(s,["string"]))return[...s].slice(u,f).join("");if(yt(s,["array"]))return s.slice(u,f);throw new bi(`Expected first argument to be of type array or string, but found ${G(Ue(s))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Er(n,e){const s=n.length-1;let u,f,y=0,v=s,S=0;for(;y<=v;)if(S=Math.floor((y+v)/2),u=n[S],f=n[S+1],u<=e){if(S===s||e<f)return S;y=S+1}else{if(!(u>e))throw new bi("Input is not a number.");v=S-1}return 0}class Mr{constructor(e,s,u){this.type=e,this.input=s,this.labels=[],this.outputs=[];for(const[f,y]of u)this.labels.push(f),this.outputs.push(y)}static parse(e,s){if(e.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(e[1],1,oe);if(!u)return null;const f=[];let y=null;s.expectedType&&s.expectedType.kind!=="value"&&(y=s.expectedType);for(let v=1;v<e.length;v+=2){const S=v===1?-1/0:e[v],E=e[v+1],D=v,R=v+1;if(typeof S!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(f.length&&f[f.length-1][0]>=S)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const F=s.parse(E,R,y);if(!F)return null;y=y||F.type,f.push([S,F])}return new Mr(y,u,f)}evaluate(e){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(e);const f=this.input.evaluate(e);if(f<=s[0])return u[0].evaluate(e);const y=s.length;return f>=s[y-1]?u[y-1].evaluate(e):u[Er(s,f)].evaluate(e)}eachChild(e){e(this.input);for(const s of this.outputs)e(s)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Ho(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Bl=Nl;function Nl(n,e,s,u){this.cx=3*n,this.bx=3*(s-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(u-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=s,this.p2y=u}Nl.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(e===void 0&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var s=n,u=0;u<8;u++){var f=this.sampleCurveX(s)-n;if(Math.abs(f)<e)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=f/y}var v=0,S=1;for(s=n,u=0;u<20&&(f=this.sampleCurveX(s),!(Math.abs(f-n)<e));u++)n>f?v=s:S=s,s=.5*(S-v)+v;return s},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var Xo=Ho(Bl);function na(n,e,s){return n+s*(e-n)}function Yr(n,e,s){return n.map(((u,f)=>na(u,e[f],s)))}const aa={number:na,color:function(n,e,s,u="rgb"){switch(u){case"rgb":{const[f,y,v,S]=Yr(n.rgb,e.rgb,s);return new Ci(f,y,v,S,!1)}case"hcl":{const[f,y,v,S]=n.hcl,[E,D,R,F]=e.hcl;let q,X;if(isNaN(f)||isNaN(E))isNaN(f)?isNaN(E)?q=NaN:(q=E,v!==1&&v!==0||(X=D)):(q=f,R!==1&&R!==0||(X=y));else{let Ct=E-f;E>f&&Ct>180?Ct-=360:E<f&&f-E>180&&(Ct+=360),q=f+s*Ct}const[K,W,st,ut]=(function([Ct,gt,Tt,Zt]){return Ct=isNaN(Ct)?0:Ct*Pe,Tn([Tt,Math.cos(Ct)*gt,Math.sin(Ct)*gt,Zt])})([q,X??na(y,D,s),na(v,R,s),na(S,F,s)]);return new Ci(K,W,st,ut,!1)}case"lab":{const[f,y,v,S]=Tn(Yr(n.lab,e.lab,s));return new Ci(f,y,v,S,!1)}}},array:Yr,padding:function(n,e,s){return new Kn(Yr(n.values,e.values,s))},variableAnchorOffsetCollection:function(n,e,s){const u=n.values,f=e.values;if(u.length!==f.length)throw new bi(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${e.toString()}`);const y=[];for(let v=0;v<u.length;v+=2){if(u[v]!==f[v])throw new bi(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${u[v]}, to[${v}]: ${f[v]}`);y.push(u[v]);const[S,E]=u[v+1],[D,R]=f[v+1];y.push([na(S,D,s),na(E,R,s)])}return new ga(y)}};class Wn{constructor(e,s,u,f,y){this.type=e,this.operator=s,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(const[v,S]of y)this.labels.push(v),this.outputs.push(S)}static interpolationFactor(e,s,u,f){let y=0;if(e.name==="exponential")y=Ke(s,e.base,u,f);else if(e.name==="linear")y=Ke(s,1,u,f);else if(e.name==="cubic-bezier"){const v=e.controlPoints;y=new Xo(v[0],v[1],v[2],v[3]).solve(Ke(s,1,u,f))}return y}static parse(e,s){let[u,f,y,...v]=e;if(!Array.isArray(f)||f.length===0)return s.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const D=f[1];if(typeof D!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:D}}else{if(f[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const D=f.slice(1);if(D.length!==4||D.some((R=>typeof R!="number"||R<0||R>1)))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:D}}}if(e.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(y=s.parse(y,2,oe),!y)return null;const S=[];let E=null;u==="interpolate-hcl"||u==="interpolate-lab"?E=un:s.expectedType&&s.expectedType.kind!=="value"&&(E=s.expectedType);for(let D=0;D<v.length;D+=2){const R=v[D],F=v[D+1],q=D+3,X=D+4;if(typeof R!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(S.length&&S[S.length-1][0]>=R)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const K=s.parse(F,X,E);if(!K)return null;E=E||K.type,S.push([R,K])}return zt(E,oe)||zt(E,un)||zt(E,ys)||zt(E,ot)||zt(E,H(oe))?new Wn(E,u,f,y,S):s.error(`Type ${G(E)} is not interpolatable.`)}evaluate(e){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(e);const f=this.input.evaluate(e);if(f<=s[0])return u[0].evaluate(e);const y=s.length;if(f>=s[y-1])return u[y-1].evaluate(e);const v=Er(s,f),S=Wn.interpolationFactor(this.interpolation,f,s[v],s[v+1]),E=u[v].evaluate(e),D=u[v+1].evaluate(e);switch(this.operator){case"interpolate":return aa[this.type.kind](E,D,S);case"interpolate-hcl":return aa.color(E,D,S,"hcl");case"interpolate-lab":return aa.color(E,D,S,"lab")}}eachChild(e){e(this.input);for(const s of this.outputs)e(s)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function Ke(n,e,s,u){const f=u-s,y=n-s;return f===0?0:e===1?y/f:(Math.pow(e,y)-1)/(Math.pow(e,f)-1)}class Va{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expectected at least one argument.");let u=null;const f=s.expectedType;f&&f.kind!=="value"&&(u=f);const y=[];for(const S of e.slice(1)){const E=s.parse(S,1+y.length,u,void 0,{typeAnnotation:"omit"});if(!E)return null;u=u||E.type,y.push(E)}if(!u)throw new Error("No output type");const v=f&&y.some((S=>at(f,S.type)));return new Va(v?Qe:u,y)}evaluate(e){let s,u=null,f=0;for(const y of this.args)if(f++,u=y.evaluate(e),u&&u instanceof La&&!u.available&&(s||(s=u.name),u=null,f===this.args.length&&(u=s)),u!==null)break;return u}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function ji(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Fl(n,e,s,u){return u.compare(e,s)===0}function vs(n,e,s){const u=n!=="=="&&n!=="!=";return class E_{constructor(y,v,S){this.type=Ie,this.lhs=y,this.rhs=v,this.collator=S,this.hasUntypedArgument=y.type.kind==="value"||v.type.kind==="value"}static parse(y,v){if(y.length!==3&&y.length!==4)return v.error("Expected two or three arguments.");const S=y[0];let E=v.parse(y[1],1,Qe);if(!E)return null;if(!ji(S,E.type))return v.concat(1).error(`"${S}" comparisons are not supported for type '${G(E.type)}'.`);let D=v.parse(y[2],2,Qe);if(!D)return null;if(!ji(S,D.type))return v.concat(2).error(`"${S}" comparisons are not supported for type '${G(D.type)}'.`);if(E.type.kind!==D.type.kind&&E.type.kind!=="value"&&D.type.kind!=="value")return v.error(`Cannot compare types '${G(E.type)}' and '${G(D.type)}'.`);u&&(E.type.kind==="value"&&D.type.kind!=="value"?E=new is(D.type,[E]):E.type.kind!=="value"&&D.type.kind==="value"&&(D=new is(E.type,[D])));let R=null;if(y.length===4){if(E.type.kind!=="string"&&D.type.kind!=="string"&&E.type.kind!=="value"&&D.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(R=v.parse(y[3],3,Js),!R)return null}return new E_(E,D,R)}evaluate(y){const v=this.lhs.evaluate(y),S=this.rhs.evaluate(y);if(u&&this.hasUntypedArgument){const E=Ue(v),D=Ue(S);if(E.kind!==D.kind||E.kind!=="string"&&E.kind!=="number")throw new bi(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${E.kind}, ${D.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const E=Ue(v),D=Ue(S);if(E.kind!=="string"||D.kind!=="string")return e(y,v,S)}return this.collator?s(y,v,S,this.collator.evaluate(y)):e(y,v,S)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Ns=vs("==",(function(n,e,s){return e===s}),Fl),$o=vs("!=",(function(n,e,s){return e!==s}),(function(n,e,s,u){return!Fl(0,e,s,u)})),xs=vs("<",(function(n,e,s){return e<s}),(function(n,e,s,u){return u.compare(e,s)<0})),er=vs(">",(function(n,e,s){return e>s}),(function(n,e,s,u){return u.compare(e,s)>0})),po=vs("<=",(function(n,e,s){return e<=s}),(function(n,e,s,u){return u.compare(e,s)<=0})),kn=vs(">=",(function(n,e,s){return e>=s}),(function(n,e,s,u){return u.compare(e,s)>=0}));class bs{constructor(e,s,u){this.type=Js,this.locale=u,this.caseSensitive=e,this.diacriticSensitive=s}static parse(e,s){if(e.length!==2)return s.error("Expected one argument.");const u=e[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const f=s.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Ie);if(!f)return null;const y=s.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Ie);if(!y)return null;let v=null;return u.locale&&(v=s.parse(u.locale,1,ke),!v)?null:new bs(f,y,v)}evaluate(e){return new Vn(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class mo{constructor(e,s,u,f,y){this.type=ke,this.number=e,this.locale=s,this.currency=u,this.minFractionDigits=f,this.maxFractionDigits=y}static parse(e,s){if(e.length!==3)return s.error("Expected two arguments.");const u=s.parse(e[1],1,oe);if(!u)return null;const f=e[2];if(typeof f!="object"||Array.isArray(f))return s.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=s.parse(f.locale,1,ke),!y))return null;let v=null;if(f.currency&&(v=s.parse(f.currency,1,ke),!v))return null;let S=null;if(f["min-fraction-digits"]&&(S=s.parse(f["min-fraction-digits"],1,oe),!S))return null;let E=null;return f["max-fraction-digits"]&&(E=s.parse(f["max-fraction-digits"],1,oe),!E)?null:new mo(u,y,v,S,E)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Kr{constructor(e){this.type=ts,this.sections=e}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");const u=e[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const f=[];let y=!1;for(let v=1;v<=e.length-1;++v){const S=e[v];if(y&&typeof S=="object"&&!Array.isArray(S)){y=!1;let E=null;if(S["font-scale"]&&(E=s.parse(S["font-scale"],1,oe),!E))return null;let D=null;if(S["text-font"]&&(D=s.parse(S["text-font"],1,H(ke)),!D))return null;let R=null;if(S["text-color"]&&(R=s.parse(S["text-color"],1,un),!R))return null;const F=f[f.length-1];F.scale=E,F.font=D,F.textColor=R}else{const E=s.parse(e[v],1,Qe);if(!E)return null;const D=E.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:E,scale:null,font:null,textColor:null})}}return new Kr(f)}evaluate(e){return new ja(this.sections.map((s=>{const u=s.content.evaluate(e);return Ue(u)===Za?new Ol("",u,null,null,null):new Ol(qi(u),null,s.scale?s.scale.evaluate(e):null,s.font?s.font.evaluate(e).join(","):null,s.textColor?s.textColor.evaluate(e):null)})))}eachChild(e){for(const s of this.sections)e(s.content),s.scale&&e(s.scale),s.font&&e(s.font),s.textColor&&e(s.textColor)}outputDefined(){return!1}}class Ul{constructor(e){this.type=Za,this.input=e}static parse(e,s){if(e.length!==2)return s.error("Expected two arguments.");const u=s.parse(e[1],1,ke);return u?new Ul(u):s.error("No image name provided.")}evaluate(e){const s=this.input.evaluate(e),u=La.fromString(s);return u&&e.availableImages&&(u.available=e.availableImages.indexOf(s)>-1),u}eachChild(e){e(this.input)}outputDefined(){return!1}}class fa{constructor(e){this.type=oe,this.input=e}static parse(e,s){if(e.length!==2)return s.error(`Expected 1 argument, but found ${e.length-1} instead.`);const u=s.parse(e[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${G(u.type)} instead.`):new fa(u):null}evaluate(e){const s=this.input.evaluate(e);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new bi(`Expected value to be of type string or array, but found ${G(Ue(s))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const sa=8192;function Zl(n,e){const s=(180+n[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,f=Math.pow(2,e.z);return[Math.round(s*f*sa),Math.round(u*f*sa)]}function Wr(n,e){const s=Math.pow(2,e.z);return[(f=(n[0]/sa+e.x)/s,360*f-180),(u=(n[1]/sa+e.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,f}function hi(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function ir(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function si(n,e,s){const u=n[0]-e[0],f=n[1]-e[1],y=n[0]-s[0],v=n[1]-s[1];return u*v-y*f==0&&u*y<=0&&f*v<=0}function ws(n,e,s,u){return(f=[u[0]-s[0],u[1]-s[1]])[0]*(y=[e[0]-n[0],e[1]-n[1]])[1]-f[1]*y[0]!=0&&!(!jl(n,e,s,u)||!jl(s,u,n,e));var f,y}function fl(n,e,s){for(const u of s)for(let f=0;f<u.length-1;++f)if(ws(n,e,u[f],u[f+1]))return!0;return!1}function _o(n,e,s=!1){let u=!1;for(const S of e)for(let E=0;E<S.length-1;E++){if(si(n,S[E],S[E+1]))return s;(y=S[E])[1]>(f=n)[1]!=(v=S[E+1])[1]>f[1]&&f[0]<(v[0]-y[0])*(f[1]-y[1])/(v[1]-y[1])+y[0]&&(u=!u)}var f,y,v;return u}function yu(n,e){for(const s of e)if(_o(n,s))return!0;return!1}function Hu(n,e){for(const s of n)if(!_o(s,e))return!1;for(let s=0;s<n.length-1;++s)if(fl(n[s],n[s+1],e))return!1;return!0}function Xu(n,e){for(const s of e)if(Hu(n,s))return!0;return!1}function jl(n,e,s,u){const f=u[0]-s[0],y=u[1]-s[1],v=(n[0]-s[0])*y-f*(n[1]-s[1]),S=(e[0]-s[0])*y-f*(e[1]-s[1]);return v>0&&S<0||v<0&&S>0}function vu(n,e,s){const u=[];for(let f=0;f<n.length;f++){const y=[];for(let v=0;v<n[f].length;v++){const S=Zl(n[f][v],s);hi(e,S),y.push(S)}u.push(y)}return u}function Vl(n,e,s){const u=[];for(let f=0;f<n.length;f++){const y=vu(n[f],e,s);u.push(y)}return u}function $u(n,e,s,u){if(n[0]<s[0]||n[0]>s[2]){const f=.5*u;let y=n[0]-s[0]>f?-u:s[0]-n[0]>f?u:0;y===0&&(y=n[0]-s[2]>f?-u:s[2]-n[0]>f?u:0),n[0]+=y}hi(e,n)}function Fs(n,e,s,u){const f=Math.pow(2,u.z)*sa,y=[u.x*sa,u.y*sa],v=[];for(const S of n)for(const E of S){const D=[E.x+y[0],E.y+y[1]];$u(D,e,s,f),v.push(D)}return v}function Yu(n,e,s,u){const f=Math.pow(2,u.z)*sa,y=[u.x*sa,u.y*sa],v=[];for(const E of n){const D=[];for(const R of E){const F=[R.x+y[0],R.y+y[1]];hi(e,F),D.push(F)}v.push(D)}if(e[2]-e[0]<=f/2){(S=e)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const E of v)for(const D of E)$u(D,e,s,f)}var S;return v}class zr{constructor(e,s){this.type=Ie,this.geojson=e,this.geometries=s}static parse(e,s){if(e.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Os(e[1])){const u=e[1];if(u.type==="FeatureCollection"){const f=[];for(const y of u.features){const{type:v,coordinates:S}=y.geometry;v==="Polygon"&&f.push(S),v==="MultiPolygon"&&f.push(...S)}if(f.length)return new zr(u,{type:"MultiPolygon",coordinates:f})}else if(u.type==="Feature"){const f=u.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new zr(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new zr(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(s,u){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(u.type==="Polygon"){const S=vu(u.coordinates,y,v),E=Fs(s.geometry(),f,y,v);if(!ir(f,y))return!1;for(const D of E)if(!_o(D,S))return!1}if(u.type==="MultiPolygon"){const S=Vl(u.coordinates,y,v),E=Fs(s.geometry(),f,y,v);if(!ir(f,y))return!1;for(const D of E)if(!yu(D,S))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(s,u){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(u.type==="Polygon"){const S=vu(u.coordinates,y,v),E=Yu(s.geometry(),f,y,v);if(!ir(f,y))return!1;for(const D of E)if(!Hu(D,S))return!1}if(u.type==="MultiPolygon"){const S=Vl(u.coordinates,y,v),E=Yu(s.geometry(),f,y,v);if(!ir(f,y))return!1;for(const D of E)if(!Xu(D,S))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Cr=class{constructor(n=[],e=((s,u)=>s<u?-1:s>u?1:0)){if(this.data=n,this.length=this.data.length,this.compare=e,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:e,compare:s}=this,u=e[n];for(;n>0;){const f=n-1>>1,y=e[f];if(s(u,y)>=0)break;e[n]=y,n=f}e[n]=u}_down(n){const{data:e,compare:s}=this,u=this.length>>1,f=e[n];for(;n<u;){let y=1+(n<<1);const v=y+1;if(v<this.length&&s(e[v],e[y])<0&&(y=v),s(e[y],f)>=0)break;e[n]=e[y],n=y}e[n]=f}};function Ku(n,e,s,u,f){xu(n,e,s,u||n.length-1,f||bu)}function xu(n,e,s,u,f){for(;u>s;){if(u-s>600){var y=u-s+1,v=e-s+1,S=Math.log(y),E=.5*Math.exp(2*S/3),D=.5*Math.sqrt(S*E*(y-E)/y)*(v-y/2<0?-1:1);xu(n,e,Math.max(s,Math.floor(e-v*E/y+D)),Math.min(u,Math.floor(e+(y-v)*E/y+D)),f)}var R=n[e],F=s,q=u;for(go(n,s,e),f(n[u],R)>0&&go(n,s,u);F<q;){for(go(n,F,q),F++,q--;f(n[F],R)<0;)F++;for(;f(n[q],R)>0;)q--}f(n[s],R)===0?go(n,s,q):go(n,++q,u),q<=e&&(s=q+1),e<=q&&(u=q-1)}}function go(n,e,s){var u=n[e];n[e]=n[s],n[s]=u}function bu(n,e){return n<e?-1:n>e?1:0}function dl(n,e){if(n.length<=1)return[n];const s=[];let u,f;for(const y of n){const v=Oc(y);v!==0&&(y.area=Math.abs(v),f===void 0&&(f=v<0),f===v<0?(u&&s.push(u),u=[y]):u.push(y))}if(u&&s.push(u),e>1)for(let y=0;y<s.length;y++)s[y].length<=e||(Ku(s[y],e,1,s[y].length-1,Wu),s[y]=s[y].slice(0,e));return s}function Wu(n,e){return e.area-n.area}function Oc(n){let e=0;for(let s,u,f=0,y=n.length,v=y-1;f<y;v=f++)s=n[f],u=n[v],e+=(u.x-s.x)*(s.y+u.y);return e}const wu=1/298.257223563,ql=wu*(2-wu),Ju=Math.PI/180;class Gl{constructor(e){const s=6378.137*Ju*1e3,u=Math.cos(e*Ju),f=1/(1-ql*(1-u*u)),y=Math.sqrt(f);this.kx=s*y*u,this.ky=s*y*f*(1-ql)}distance(e,s){const u=this.wrap(e[0]-s[0])*this.kx,f=(e[1]-s[1])*this.ky;return Math.sqrt(u*u+f*f)}pointOnLine(e,s){let u,f,y,v,S=1/0;for(let E=0;E<e.length-1;E++){let D=e[E][0],R=e[E][1],F=this.wrap(e[E+1][0]-D)*this.kx,q=(e[E+1][1]-R)*this.ky,X=0;F===0&&q===0||(X=(this.wrap(s[0]-D)*this.kx*F+(s[1]-R)*this.ky*q)/(F*F+q*q),X>1?(D=e[E+1][0],R=e[E+1][1]):X>0&&(D+=F/this.kx*X,R+=q/this.ky*X)),F=this.wrap(s[0]-D)*this.kx,q=(s[1]-R)*this.ky;const K=F*F+q*q;K<S&&(S=K,u=D,f=R,y=E,v=X)}return{point:[u,f],index:y,t:Math.max(0,Math.min(1,v))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function Su(n,e){return e[0]-n[0]}function yo(n){return n[1]-n[0]+1}function Ia(n,e){return n[1]>=n[0]&&n[1]<e}function Tu(n,e){if(n[0]>n[1])return[null,null];const s=yo(n);if(e){if(s===2)return[n,null];const f=Math.floor(s/2);return[[n[0],n[0]+f],[n[0]+f,n[1]]]}if(s===1)return[n,null];const u=Math.floor(s/2)-1;return[[n[0],n[0]+u],[n[0]+u+1,n[1]]]}function vo(n,e){if(!Ia(e,n.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let u=e[0];u<=e[1];++u)hi(s,n[u]);return s}function qa(n){const e=[1/0,1/0,-1/0,-1/0];for(const s of n)for(const u of s)hi(e,u);return e}function xo(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function Jr(n,e,s){if(!xo(n)||!xo(e))return NaN;let u=0,f=0;return n[2]<e[0]&&(u=e[0]-n[2]),n[0]>e[2]&&(u=n[0]-e[2]),n[1]>e[3]&&(f=n[1]-e[3]),n[3]<e[1]&&(f=e[1]-n[3]),s.distance([0,0],[u,f])}function bo(n,e,s){const u=s.pointOnLine(e,n);return s.distance(n,u.point)}function Yo(n,e,s,u,f){const y=Math.min(bo(n,[s,u],f),bo(e,[s,u],f)),v=Math.min(bo(s,[n,e],f),bo(u,[n,e],f));return Math.min(y,v)}function Hl(n,e,s,u,f){if(!Ia(e,n.length)||!Ia(u,s.length))return 1/0;let y=1/0;for(let v=e[0];v<e[1];++v){const S=n[v],E=n[v+1];for(let D=u[0];D<u[1];++D){const R=s[D],F=s[D+1];if(ws(S,E,R,F))return 0;y=Math.min(y,Yo(S,E,R,F,f))}}return y}function zn(n,e,s,u,f){if(!Ia(e,n.length)||!Ia(u,s.length))return NaN;let y=1/0;for(let v=e[0];v<=e[1];++v)for(let S=u[0];S<=u[1];++S)if(y=Math.min(y,f.distance(n[v],s[S])),y===0)return y;return y}function Qu(n,e,s){if(_o(n,e,!0))return 0;let u=1/0;for(const f of e){const y=f[0],v=f[f.length-1];if(y!==v&&(u=Math.min(u,bo(n,[v,y],s)),u===0))return u;const S=s.pointOnLine(f,n);if(u=Math.min(u,s.distance(n,S.point)),u===0)return u}return u}function oi(n,e,s,u){if(!Ia(e,n.length))return NaN;for(let y=e[0];y<=e[1];++y)if(_o(n[y],s,!0))return 0;let f=1/0;for(let y=e[0];y<e[1];++y){const v=n[y],S=n[y+1];for(const E of s)for(let D=0,R=E.length,F=R-1;D<R;F=D++){const q=E[F],X=E[D];if(ws(v,S,q,X))return 0;f=Math.min(f,Yo(v,S,q,X,u))}}return f}function Lr(n,e){for(const s of n)for(const u of s)if(_o(u,e,!0))return!0;return!1}function Si(n,e,s,u=1/0){const f=qa(n),y=qa(e);if(u!==1/0&&Jr(f,y,s)>=u)return u;if(ir(f,y)){if(Lr(n,e))return 0}else if(Lr(e,n))return 0;let v=1/0;for(const S of n)for(let E=0,D=S.length,R=D-1;E<D;R=E++){const F=S[R],q=S[E];for(const X of e)for(let K=0,W=X.length,st=W-1;K<W;st=K++){const ut=X[st],Ct=X[K];if(ws(F,q,ut,Ct))return 0;v=Math.min(v,Yo(F,q,ut,Ct,s))}}return v}function Di(n,e,s,u,f,y){if(!y)return;const v=Jr(vo(u,y),f,s);v<e&&n.push([v,y,[0,0]])}function wo(n,e,s,u,f,y,v){if(!y||!v)return;const S=Jr(vo(u,y),vo(f,v),s);S<e&&n.push([S,y,v])}function Ga(n,e,s,u,f=1/0){let y=Math.min(u.distance(n[0],s[0][0]),f);if(y===0)return y;const v=new Cr([[0,[0,n.length-1],[0,0]]],Su),S=qa(s);for(;v.length>0;){const E=v.pop();if(E[0]>=y)continue;const D=E[1],R=e?50:100;if(yo(D)<=R){if(!Ia(D,n.length))return NaN;if(e){const F=oi(n,D,s,u);if(isNaN(F)||F===0)return F;y=Math.min(y,F)}else for(let F=D[0];F<=D[1];++F){const q=Qu(n[F],s,u);if(y=Math.min(y,q),y===0)return 0}}else{const F=Tu(D,e);Di(v,y,u,n,S,F[0]),Di(v,y,u,n,S,F[1])}}return y}function Ko(n,e,s,u,f,y=1/0){let v=Math.min(y,f.distance(n[0],s[0]));if(v===0)return v;const S=new Cr([[0,[0,n.length-1],[0,s.length-1]]],Su);for(;S.length>0;){const E=S.pop();if(E[0]>=v)continue;const D=E[1],R=E[2],F=e?50:100,q=u?50:100;if(yo(D)<=F&&yo(R)<=q){if(!Ia(D,n.length)&&Ia(R,s.length))return NaN;let X;if(e&&u)X=Hl(n,D,s,R,f),v=Math.min(v,X);else if(e&&!u){const K=n.slice(D[0],D[1]+1);for(let W=R[0];W<=R[1];++W)if(X=bo(s[W],K,f),v=Math.min(v,X),v===0)return v}else if(!e&&u){const K=s.slice(R[0],R[1]+1);for(let W=D[0];W<=D[1];++W)if(X=bo(n[W],K,f),v=Math.min(v,X),v===0)return v}else X=zn(n,D,s,R,f),v=Math.min(v,X)}else{const X=Tu(D,e),K=Tu(R,u);wo(S,v,f,n,s,X[0],K[0]),wo(S,v,f,n,s,X[0],K[1]),wo(S,v,f,n,s,X[1],K[0]),wo(S,v,f,n,s,X[1],K[1])}}return v}function Ss(n){return n.type==="MultiPolygon"?n.coordinates.map((e=>({type:"Polygon",coordinates:e}))):n.type==="MultiLineString"?n.coordinates.map((e=>({type:"LineString",coordinates:e}))):n.type==="MultiPoint"?n.coordinates.map((e=>({type:"Point",coordinates:e}))):[n]}class Us{constructor(e,s){this.type=oe,this.geojson=e,this.geometries=s}static parse(e,s){if(e.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Os(e[1])){const u=e[1];if(u.type==="FeatureCollection")return new Us(u,u.features.map((f=>Ss(f.geometry))).flat());if(u.type==="Feature")return new Us(u,Ss(u.geometry));if("type"in u&&"coordinates"in u)return new Us(u,Ss(u))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(s,u){const f=s.geometry(),y=f.flat().map((E=>Wr([E.x,E.y],s.canonical)));if(f.length===0)return NaN;const v=new Gl(y[0][1]);let S=1/0;for(const E of u){switch(E.type){case"Point":S=Math.min(S,Ko(y,!1,[E.coordinates],!1,v,S));break;case"LineString":S=Math.min(S,Ko(y,!1,E.coordinates,!0,v,S));break;case"Polygon":S=Math.min(S,Ga(y,!1,E.coordinates,v,S))}if(S===0)return S}return S})(e,this.geometries);if(e.geometryType()==="LineString")return(function(s,u){const f=s.geometry(),y=f.flat().map((E=>Wr([E.x,E.y],s.canonical)));if(f.length===0)return NaN;const v=new Gl(y[0][1]);let S=1/0;for(const E of u){switch(E.type){case"Point":S=Math.min(S,Ko(y,!0,[E.coordinates],!1,v,S));break;case"LineString":S=Math.min(S,Ko(y,!0,E.coordinates,!0,v,S));break;case"Polygon":S=Math.min(S,Ga(y,!0,E.coordinates,v,S))}if(S===0)return S}return S})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(s,u){const f=s.geometry();if(f.length===0||f[0].length===0)return NaN;const y=dl(f,0).map((E=>E.map((D=>D.map((R=>Wr([R.x,R.y],s.canonical))))))),v=new Gl(y[0][0][0][1]);let S=1/0;for(const E of u)for(const D of y){switch(E.type){case"Point":S=Math.min(S,Ga([E.coordinates],!1,D,v,S));break;case"LineString":S=Math.min(S,Ga(E.coordinates,!0,D,v,S));break;case"Polygon":S=Math.min(S,Si(D,E.coordinates,v,S))}if(S===0)return S}return S})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const nr={"==":Ns,"!=":$o,">":er,"<":xs,">=":kn,"<=":po,array:is,at:Bs,boolean:is,case:as,coalesce:Va,collator:bs,format:Kr,image:Ul,in:an,"index-of":ns,interpolate:Wn,"interpolate-hcl":Wn,"interpolate-lab":Wn,length:fa,let:tr,literal:In,match:$r,number:is,"number-format":mo,object:is,slice:fo,step:Mr,string:is,"to-boolean":Fi,"to-color":Fi,"to-number":Fi,"to-string":Fi,var:wi,within:zr,distance:Us};class ya{constructor(e,s,u,f){this.name=e,this.type=s,this._evaluate=u,this.args=f}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,s){const u=e[0],f=ya.definitions[u];if(!f)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,S=v.filter((([D])=>!Array.isArray(D)||D.length===e.length-1));let E=null;for(const[D,R]of S){E=new Ki(s.registry,Wo,s.path,null,s.scope);const F=[];let q=!1;for(let X=1;X<e.length;X++){const K=e[X],W=Array.isArray(D)?D[X-1]:D.type,st=E.parse(K,1+F.length,W);if(!st){q=!0;break}F.push(st)}if(!q)if(Array.isArray(D)&&D.length!==F.length)E.error(`Expected ${D.length} arguments, but found ${F.length} instead.`);else{for(let X=0;X<F.length;X++){const K=Array.isArray(D)?D[X]:D.type,W=F[X];E.concat(X+1).checkSubtype(K,W.type)}if(E.errors.length===0)return new ya(u,y,R,F)}}if(S.length===1)s.errors.push(...E.errors);else{const D=(S.length?S:v).map((([F])=>{return q=F,Array.isArray(q)?`(${q.map(G).join(", ")})`:`(${G(q.type)}...)`;var q})).join(" | "),R=[];for(let F=1;F<e.length;F++){const q=s.parse(e[F],1+R.length);if(!q)return null;R.push(G(q.type))}s.error(`Expected arguments of type ${D}, but found (${R.join(", ")}) instead.`)}return null}static register(e,s){ya.definitions=s;for(const u in s)e[u]=ya}}function So(n,[e,s,u,f]){e=e.evaluate(n),s=s.evaluate(n),u=u.evaluate(n);const y=f?f.evaluate(n):1,v=Xr(e,s,u,y);if(v)throw new bi(v);return new Ci(e/255,s/255,u/255,y,!1)}function Xl(n,e){return n in e}function Ts(n,e){const s=e[n];return s===void 0?null:s}function As(n){return{type:n}}function Wo(n){if(n instanceof wi)return Wo(n.boundExpression);if(n instanceof ya&&n.name==="error"||n instanceof bs||n instanceof zr||n instanceof Us)return!1;const e=n instanceof Fi||n instanceof is;let s=!0;return n.eachChild((u=>{s=e?s&&Wo(u):s&&u instanceof In})),!!s&&Qr(n)&&ss(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Qr(n){if(n instanceof ya&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof zr||n instanceof Us)return!1;let e=!0;return n.eachChild((s=>{e&&!Qr(s)&&(e=!1)})),e}function To(n){if(n instanceof ya&&n.name==="feature-state")return!1;let e=!0;return n.eachChild((s=>{e&&!To(s)&&(e=!1)})),e}function ss(n,e){if(n instanceof ya&&e.indexOf(n.name)>=0)return!1;let s=!0;return n.eachChild((u=>{s&&!ss(u,e)&&(s=!1)})),s}function $l(n){return{result:"success",value:n}}function Zs(n){return{result:"error",value:n}}function Jo(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function ar(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function ra(n){return!!n.expression&&n.expression.interpolated}function mi(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Ao(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function pl(n){return n}function ml(n,e){const s=e.type==="color",u=n.stops&&typeof n.stops[0][0]=="object",f=u||!(u||n.property!==void 0),y=n.type||(ra(e)?"exponential":"interval");if(s||e.type==="padding"){const R=s?Ci.parse:Kn.parse;(n=Ws({},n)).stops&&(n.stops=n.stops.map((F=>[F[0],R(F[1])]))),n.default=R(n.default?n.default:e.default)}if(n.colorSpace&&(v=n.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var v;let S,E,D;if(y==="exponential")S=Pr;else if(y==="interval")S=Eo;else if(y==="categorical"){S=Ir,E=Object.create(null);for(const R of n.stops)E[R[0]]=R[1];D=typeof n.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);S=_l}if(u){const R={},F=[];for(let K=0;K<n.stops.length;K++){const W=n.stops[K],st=W[0].zoom;R[st]===void 0&&(R[st]={zoom:st,type:n.type,property:n.property,default:n.default,stops:[]},F.push(st)),R[st].stops.push([W[0].value,W[1]])}const q=[];for(const K of F)q.push([R[K].zoom,ml(R[K],e)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:Wn.interpolationFactor.bind(void 0,X),zoomStops:q.map((K=>K[0])),evaluate:({zoom:K},W)=>Pr({stops:q,base:n.base},e,K).evaluate(K,W)}}if(f){const R=y==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Wn.interpolationFactor.bind(void 0,R),zoomStops:n.stops.map((F=>F[0])),evaluate:({zoom:F})=>S(n,e,F,E,D)}}return{kind:"source",evaluate(R,F){const q=F&&F.properties?F.properties[n.property]:void 0;return q===void 0?sr(n.default,e.default):S(n,e,q,E,D)}}}function sr(n,e,s){return n!==void 0?n:e!==void 0?e:s!==void 0?s:void 0}function Ir(n,e,s,u,f){return sr(typeof s===f?u[s]:void 0,n.default,e.default)}function Eo(n,e,s){if(mi(s)!=="number")return sr(n.default,e.default);const u=n.stops.length;if(u===1||s<=n.stops[0][0])return n.stops[0][1];if(s>=n.stops[u-1][0])return n.stops[u-1][1];const f=Er(n.stops.map((y=>y[0])),s);return n.stops[f][1]}function Pr(n,e,s){const u=n.base!==void 0?n.base:1;if(mi(s)!=="number")return sr(n.default,e.default);const f=n.stops.length;if(f===1||s<=n.stops[0][0])return n.stops[0][1];if(s>=n.stops[f-1][0])return n.stops[f-1][1];const y=Er(n.stops.map((R=>R[0])),s),v=(function(R,F,q,X){const K=X-q,W=R-q;return K===0?0:F===1?W/K:(Math.pow(F,W)-1)/(Math.pow(F,K)-1)})(s,u,n.stops[y][0],n.stops[y+1][0]),S=n.stops[y][1],E=n.stops[y+1][1],D=aa[e.type]||pl;return typeof S.evaluate=="function"?{evaluate(...R){const F=S.evaluate.apply(void 0,R),q=E.evaluate.apply(void 0,R);if(F!==void 0&&q!==void 0)return D(F,q,v,n.colorSpace)}}:D(S,E,v,n.colorSpace)}function _l(n,e,s){switch(e.type){case"color":s=Ci.parse(s);break;case"formatted":s=ja.fromString(s.toString());break;case"resolvedImage":s=La.fromString(s.toString());break;case"padding":s=Kn.parse(s);break;default:mi(s)===e.type||e.type==="enum"&&e.values[s]||(s=void 0)}return sr(s,n.default,e.default)}ya.register(nr,{error:[{kind:"error"},[ke],(n,[e])=>{throw new bi(e.evaluate(n))}],typeof:[ke,[Qe],(n,[e])=>G(Ue(e.evaluate(n)))],"to-rgba":[H(oe,4),[un],(n,[e])=>{const[s,u,f,y]=e.evaluate(n).rgb;return[255*s,255*u,255*f,y]}],rgb:[un,[oe,oe,oe],So],rgba:[un,[oe,oe,oe,oe],So],has:{type:Ie,overloads:[[[ke],(n,[e])=>Xl(e.evaluate(n),n.properties())],[[ke,Ca],(n,[e,s])=>Xl(e.evaluate(n),s.evaluate(n))]]},get:{type:Qe,overloads:[[[ke],(n,[e])=>Ts(e.evaluate(n),n.properties())],[[ke,Ca],(n,[e,s])=>Ts(e.evaluate(n),s.evaluate(n))]]},"feature-state":[Qe,[ke],(n,[e])=>Ts(e.evaluate(n),n.featureState||{})],properties:[Ca,[],n=>n.properties()],"geometry-type":[ke,[],n=>n.geometryType()],id:[Qe,[],n=>n.id()],zoom:[oe,[],n=>n.globals.zoom],"heatmap-density":[oe,[],n=>n.globals.heatmapDensity||0],"line-progress":[oe,[],n=>n.globals.lineProgress||0],accumulated:[Qe,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[oe,As(oe),(n,e)=>{let s=0;for(const u of e)s+=u.evaluate(n);return s}],"*":[oe,As(oe),(n,e)=>{let s=1;for(const u of e)s*=u.evaluate(n);return s}],"-":{type:oe,overloads:[[[oe,oe],(n,[e,s])=>e.evaluate(n)-s.evaluate(n)],[[oe],(n,[e])=>-e.evaluate(n)]]},"/":[oe,[oe,oe],(n,[e,s])=>e.evaluate(n)/s.evaluate(n)],"%":[oe,[oe,oe],(n,[e,s])=>e.evaluate(n)%s.evaluate(n)],ln2:[oe,[],()=>Math.LN2],pi:[oe,[],()=>Math.PI],e:[oe,[],()=>Math.E],"^":[oe,[oe,oe],(n,[e,s])=>Math.pow(e.evaluate(n),s.evaluate(n))],sqrt:[oe,[oe],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[oe,[oe],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[oe,[oe],(n,[e])=>Math.log(e.evaluate(n))],log2:[oe,[oe],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[oe,[oe],(n,[e])=>Math.sin(e.evaluate(n))],cos:[oe,[oe],(n,[e])=>Math.cos(e.evaluate(n))],tan:[oe,[oe],(n,[e])=>Math.tan(e.evaluate(n))],asin:[oe,[oe],(n,[e])=>Math.asin(e.evaluate(n))],acos:[oe,[oe],(n,[e])=>Math.acos(e.evaluate(n))],atan:[oe,[oe],(n,[e])=>Math.atan(e.evaluate(n))],min:[oe,As(oe),(n,e)=>Math.min(...e.map((s=>s.evaluate(n))))],max:[oe,As(oe),(n,e)=>Math.max(...e.map((s=>s.evaluate(n))))],abs:[oe,[oe],(n,[e])=>Math.abs(e.evaluate(n))],round:[oe,[oe],(n,[e])=>{const s=e.evaluate(n);return s<0?-Math.round(-s):Math.round(s)}],floor:[oe,[oe],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[oe,[oe],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[Ie,[ke,Qe],(n,[e,s])=>n.properties()[e.value]===s.value],"filter-id-==":[Ie,[Qe],(n,[e])=>n.id()===e.value],"filter-type-==":[Ie,[ke],(n,[e])=>n.geometryType()===e.value],"filter-<":[Ie,[ke,Qe],(n,[e,s])=>{const u=n.properties()[e.value],f=s.value;return typeof u==typeof f&&u<f}],"filter-id-<":[Ie,[Qe],(n,[e])=>{const s=n.id(),u=e.value;return typeof s==typeof u&&s<u}],"filter->":[Ie,[ke,Qe],(n,[e,s])=>{const u=n.properties()[e.value],f=s.value;return typeof u==typeof f&&u>f}],"filter-id->":[Ie,[Qe],(n,[e])=>{const s=n.id(),u=e.value;return typeof s==typeof u&&s>u}],"filter-<=":[Ie,[ke,Qe],(n,[e,s])=>{const u=n.properties()[e.value],f=s.value;return typeof u==typeof f&&u<=f}],"filter-id-<=":[Ie,[Qe],(n,[e])=>{const s=n.id(),u=e.value;return typeof s==typeof u&&s<=u}],"filter->=":[Ie,[ke,Qe],(n,[e,s])=>{const u=n.properties()[e.value],f=s.value;return typeof u==typeof f&&u>=f}],"filter-id->=":[Ie,[Qe],(n,[e])=>{const s=n.id(),u=e.value;return typeof s==typeof u&&s>=u}],"filter-has":[Ie,[Qe],(n,[e])=>e.value in n.properties()],"filter-has-id":[Ie,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[Ie,[H(ke)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[Ie,[H(Qe)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[Ie,[ke,H(Qe)],(n,[e,s])=>s.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[Ie,[ke,H(Qe)],(n,[e,s])=>(function(u,f,y,v){for(;y<=v;){const S=y+v>>1;if(f[S]===u)return!0;f[S]>u?v=S-1:y=S+1}return!1})(n.properties()[e.value],s.value,0,s.value.length-1)],all:{type:Ie,overloads:[[[Ie,Ie],(n,[e,s])=>e.evaluate(n)&&s.evaluate(n)],[As(Ie),(n,e)=>{for(const s of e)if(!s.evaluate(n))return!1;return!0}]]},any:{type:Ie,overloads:[[[Ie,Ie],(n,[e,s])=>e.evaluate(n)||s.evaluate(n)],[As(Ie),(n,e)=>{for(const s of e)if(s.evaluate(n))return!0;return!1}]]},"!":[Ie,[Ie],(n,[e])=>!e.evaluate(n)],"is-supported-script":[Ie,[ke],(n,[e])=>{const s=n.globals&&n.globals.isSupportedScript;return!s||s(e.evaluate(n))}],upcase:[ke,[ke],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[ke,[ke],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[ke,As(Qe),(n,e)=>e.map((s=>qi(s.evaluate(n)))).join("")],"resolved-locale":[ke,[Js],(n,[e])=>e.evaluate(n).resolvedLocale()]});class to{constructor(e,s){var u;this.expression=e,this._warningHistory={},this._evaluator=new ho,this._defaultValue=s?(u=s).type==="color"&&Ao(u.default)?new Ci(0,0,0,0):u.type==="color"?Ci.parse(u.default)||null:u.type==="padding"?Kn.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?ga.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(e,s,u,f,y,v){return this._evaluator.globals=e,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(e,s,u,f,y,v){this._evaluator.globals=e,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=f,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=v||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new bi(`Expected value to be one of ${Object.keys(this._enumValues).map((E=>JSON.stringify(E))).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function Dr(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in nr}function Mo(n,e){const s=new Ki(nr,Wo,[],e?(function(f){const y={color:un,string:ke,number:oe,enum:ke,boolean:Ie,formatted:ts,padding:ys,resolvedImage:Za,variableAnchorOffsetCollection:ot};return f.type==="array"?H(y[f.value]||Qe,f.length):y[f.type]})(e):void 0),u=s.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?$l(new to(u,e)):Zs(s.errors)}class rs{constructor(e,s){this.kind=e,this._styleExpression=s,this.isStateDependent=e!=="constant"&&!To(s.expression)}evaluateWithoutErrorHandling(e,s,u,f,y,v){return this._styleExpression.evaluateWithoutErrorHandling(e,s,u,f,y,v)}evaluate(e,s,u,f,y,v){return this._styleExpression.evaluate(e,s,u,f,y,v)}}class js{constructor(e,s,u,f){this.kind=e,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=e!=="camera"&&!To(s.expression),this.interpolationType=f}evaluateWithoutErrorHandling(e,s,u,f,y,v){return this._styleExpression.evaluateWithoutErrorHandling(e,s,u,f,y,v)}evaluate(e,s,u,f,y,v){return this._styleExpression.evaluate(e,s,u,f,y,v)}interpolationFactor(e,s,u){return this.interpolationType?Wn.interpolationFactor(this.interpolationType,e,s,u):0}}function Qo(n,e){const s=Mo(n,e);if(s.result==="error")return s;const u=s.value.expression,f=Qr(u);if(!f&&!Jo(e))return Zs([new ha("","data expressions not supported")]);const y=ss(u,["zoom"]);if(!y&&!ar(e))return Zs([new ha("","zoom expressions not supported")]);const v=qn(u);return v||y?v instanceof ha?Zs([v]):v instanceof Wn&&!ra(e)?Zs([new ha("",'"interpolate" expressions cannot be used with this property')]):$l(v?new js(f?"camera":"composite",s.value,v.labels,v instanceof Wn?v.interpolation:void 0):new rs(f?"constant":"source",s.value)):Zs([new ha("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class zo{constructor(e,s){this._parameters=e,this._specification=s,Ws(this,ml(this._parameters,this._specification))}static deserialize(e){return new zo(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function qn(n){let e=null;if(n instanceof tr)e=qn(n.result);else if(n instanceof Va){for(const s of n.args)if(e=qn(s),e)break}else(n instanceof Mr||n instanceof Wn)&&n.input instanceof ya&&n.input.name==="zoom"&&(e=n);return e instanceof ha||n.eachChild((s=>{const u=qn(s);u instanceof ha?e=u:!e&&u?e=new ha("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&u&&e!==u&&(e=new ha("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function eo(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!eo(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const gl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Co(n){if(n==null)return{filter:()=>!0,needGeometry:!1};eo(n)||(n=Yl(n));const e=Mo(n,gl);if(e.result==="error")throw new Error(e.value.map((s=>`${s.key}: ${s.message}`)).join(", "));return{filter:(s,u,f)=>e.value.evaluate(s,u,{},f),needGeometry:Au(n)}}function Bc(n,e){return n<e?-1:n>e?1:0}function Au(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let e=1;e<n.length;e++)if(Au(n[e]))return!0;return!1}function Yl(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?io(n[1],n[2],"=="):e==="!="?sn(io(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?io(n[1],n[2],e):e==="any"?(s=n.slice(1),["any"].concat(s.map(Yl))):e==="all"?["all"].concat(n.slice(1).map(Yl)):e==="none"?["all"].concat(n.slice(1).map(Yl).map(sn)):e==="in"?tl(n[1],n.slice(2)):e==="!in"?sn(tl(n[1],n.slice(2))):e==="has"?Es(n[1]):e!=="!has"||sn(Es(n[1]));var s}function io(n,e,s){switch(n){case"$type":return[`filter-type-${s}`,e];case"$id":return[`filter-id-${s}`,e];default:return[`filter-${s}`,n,e]}}function tl(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((s=>typeof s!=typeof e[0]))?["filter-in-large",n,["literal",e.sort(Bc)]]:["filter-in-small",n,["literal",e]]}}function Es(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function sn(n){return["!",n]}function Vs(n){const e=typeof n;if(e==="number"||e==="boolean"||e==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let f="[";for(const y of n)f+=`${Vs(y)},`;return`${f}]`}const s=Object.keys(n).sort();let u="{";for(let f=0;f<s.length;f++)u+=`${JSON.stringify(s[f])}:${Vs(n[s[f]])},`;return`${u}}`}function os(n){let e="";for(const s of wr)e+=`/${Vs(n[s])}`;return e}function Pa(n){const e=n.value;return e?[new ie(n.key,e,"constants have been deprecated as of v8")]:[]}function _n(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Da(n){if(Array.isArray(n))return n.map(Da);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const s in n)e[s]=Da(n[s]);return e}return _n(n)}function Gn(n){const e=n.key,s=n.value,u=n.valueSpec||{},f=n.objectElementValidators||{},y=n.style,v=n.styleSpec,S=n.validateSpec;let E=[];const D=mi(s);if(D!=="object")return[new ie(e,s,`object expected, ${D} found`)];for(const R in s){const F=R.split(".")[0],q=u[F]||u["*"];let X;if(f[F])X=f[F];else if(u[F])X=S;else if(f["*"])X=f["*"];else{if(!u["*"]){E.push(new ie(e,s[R],`unknown property "${R}"`));continue}X=S}E=E.concat(X({key:(e&&`${e}.`)+R,value:s[R],valueSpec:q,style:y,styleSpec:v,object:s,objectKey:R,validateSpec:S},s))}for(const R in u)f[R]||u[R].required&&u[R].default===void 0&&s[R]===void 0&&E.push(new ie(e,s,`missing required property "${R}"`));return E}function Lo(n){const e=n.value,s=n.valueSpec,u=n.style,f=n.styleSpec,y=n.key,v=n.arrayElementValidator||n.validateSpec;if(mi(e)!=="array")return[new ie(y,e,`array expected, ${mi(e)} found`)];if(s.length&&e.length!==s.length)return[new ie(y,e,`array length ${s.length} expected, length ${e.length} found`)];if(s["min-length"]&&e.length<s["min-length"])return[new ie(y,e,`array length at least ${s["min-length"]} expected, length ${e.length} found`)];let S={type:s.value,values:s.values};f.$version<7&&(S.function=s.function),mi(s.value)==="object"&&(S=s.value);let E=[];for(let D=0;D<e.length;D++)E=E.concat(v({array:e,arrayIndex:D,value:e[D],valueSpec:S,validateSpec:n.validateSpec,style:u,styleSpec:f,key:`${y}[${D}]`}));return E}function Ms(n){const e=n.key,s=n.value,u=n.valueSpec;let f=mi(s);return f==="number"&&s!=s&&(f="NaN"),f!=="number"?[new ie(e,s,`number expected, ${f} found`)]:"minimum"in u&&s<u.minimum?[new ie(e,s,`${s} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&s>u.maximum?[new ie(e,s,`${s} is greater than the maximum value ${u.maximum}`)]:[]}function kr(n){const e=n.valueSpec,s=_n(n.value.type);let u,f,y,v={};const S=s!=="categorical"&&n.value.property===void 0,E=!S,D=mi(n.value.stops)==="array"&&mi(n.value.stops[0])==="array"&&mi(n.value.stops[0][0])==="object",R=Gn({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(X){if(s==="identity")return[new ie(X.key,X.value,'identity function may not have a "stops" property')];let K=[];const W=X.value;return K=K.concat(Lo({key:X.key,value:W,valueSpec:X.valueSpec,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:F})),mi(W)==="array"&&W.length===0&&K.push(new ie(X.key,W,"array must have at least one stop")),K},default:function(X){return X.validateSpec({key:X.key,value:X.value,valueSpec:e,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec})}}});return s==="identity"&&S&&R.push(new ie(n.key,n.value,'missing required property "property"')),s==="identity"||n.value.stops||R.push(new ie(n.key,n.value,'missing required property "stops"')),s==="exponential"&&n.valueSpec.expression&&!ra(n.valueSpec)&&R.push(new ie(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(E&&!Jo(n.valueSpec)?R.push(new ie(n.key,n.value,"property functions not supported")):S&&!ar(n.valueSpec)&&R.push(new ie(n.key,n.value,"zoom functions not supported"))),s!=="categorical"&&!D||n.value.property!==void 0||R.push(new ie(n.key,n.value,'"property" property is required')),R;function F(X){let K=[];const W=X.value,st=X.key;if(mi(W)!=="array")return[new ie(st,W,`array expected, ${mi(W)} found`)];if(W.length!==2)return[new ie(st,W,`array length 2 expected, length ${W.length} found`)];if(D){if(mi(W[0])!=="object")return[new ie(st,W,`object expected, ${mi(W[0])} found`)];if(W[0].zoom===void 0)return[new ie(st,W,"object stop key must have zoom")];if(W[0].value===void 0)return[new ie(st,W,"object stop key must have value")];if(y&&y>_n(W[0].zoom))return[new ie(st,W[0].zoom,"stop zoom values must appear in ascending order")];_n(W[0].zoom)!==y&&(y=_n(W[0].zoom),f=void 0,v={}),K=K.concat(Gn({key:`${st}[0]`,value:W[0],valueSpec:{zoom:{}},validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:Ms,value:q}}))}else K=K.concat(q({key:`${st}[0]`,value:W[0],validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec},W));return Dr(Da(W[1]))?K.concat([new ie(`${st}[1]`,W[1],"expressions are not allowed in function stops.")]):K.concat(X.validateSpec({key:`${st}[1]`,value:W[1],valueSpec:e,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec}))}function q(X,K){const W=mi(X.value),st=_n(X.value),ut=X.value!==null?X.value:K;if(u){if(W!==u)return[new ie(X.key,ut,`${W} stop domain type must match previous stop domain type ${u}`)]}else u=W;if(W!=="number"&&W!=="string"&&W!=="boolean")return[new ie(X.key,ut,"stop domain value must be a number, string, or boolean")];if(W!=="number"&&s!=="categorical"){let Ct=`number expected, ${W} found`;return Jo(e)&&s===void 0&&(Ct+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ie(X.key,ut,Ct)]}return s!=="categorical"||W!=="number"||isFinite(st)&&Math.floor(st)===st?s!=="categorical"&&W==="number"&&f!==void 0&&st<f?[new ie(X.key,ut,"stop domain values must appear in ascending order")]:(f=st,s==="categorical"&&st in v?[new ie(X.key,ut,"stop domain values must be unique")]:(v[st]=!0,[])):[new ie(X.key,ut,`integer expected, found ${st}`)]}}function rr(n){const e=(n.expressionContext==="property"?Qo:Mo)(Da(n.value),n.valueSpec);if(e.result==="error")return e.value.map((u=>new ie(`${n.key}${u.key}`,n.value,u.message)));const s=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!s.outputDefined())return[new ie(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!To(s))return[new ie(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!To(s))return[new ie(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!ss(s,["zoom","feature-state"]))return[new ie(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!Qr(s))return[new ie(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ka(n){const e=n.key,s=n.value,u=n.valueSpec,f=[];return Array.isArray(u.values)?u.values.indexOf(_n(s))===-1&&f.push(new ie(e,s,`expected one of [${u.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(u.values).indexOf(_n(s))===-1&&f.push(new ie(e,s,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(s)} found`)),f}function Eu(n){return eo(Da(n.value))?rr(Ws({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):da(n)}function da(n){const e=n.value,s=n.key;if(mi(e)!=="array")return[new ie(s,e,`array expected, ${mi(e)} found`)];const u=n.styleSpec;let f,y=[];if(e.length<1)return[new ie(s,e,"filter array must have at least 1 element")];switch(y=y.concat(ka({key:`${s}[0]`,value:e[0],valueSpec:u.filter_operator,style:n.style,styleSpec:n.styleSpec})),_n(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&_n(e[1])==="$type"&&y.push(new ie(s,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&y.push(new ie(s,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(f=mi(e[1]),f!=="string"&&y.push(new ie(`${s}[1]`,e[1],`string expected, ${f} found`)));for(let v=2;v<e.length;v++)f=mi(e[v]),_n(e[1])==="$type"?y=y.concat(ka({key:`${s}[${v}]`,value:e[v],valueSpec:u.geometry_type,style:n.style,styleSpec:n.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&y.push(new ie(`${s}[${v}]`,e[v],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let v=1;v<e.length;v++)y=y.concat(da({key:`${s}[${v}]`,value:e[v],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":f=mi(e[1]),e.length!==2?y.push(new ie(s,e,`filter array for "${e[0]}" operator must have 2 elements`)):f!=="string"&&y.push(new ie(`${s}[1]`,e[1],`string expected, ${f} found`))}return y}function el(n,e){const s=n.key,u=n.validateSpec,f=n.style,y=n.styleSpec,v=n.value,S=n.objectKey,E=y[`${e}_${n.layerType}`];if(!E)return[];const D=S.match(/^(.*)-transition$/);if(e==="paint"&&D&&E[D[1]]&&E[D[1]].transition)return u({key:s,value:v,valueSpec:y.transition,style:f,styleSpec:y});const R=n.valueSpec||E[S];if(!R)return[new ie(s,v,`unknown property "${S}"`)];let F;if(mi(v)==="string"&&Jo(R)&&!R.tokens&&(F=/^{([^}]+)}$/.exec(v)))return[new ie(s,v,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const q=[];return n.layerType==="symbol"&&(S==="text-field"&&f&&!f.glyphs&&q.push(new ie(s,v,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&Ao(Da(v))&&_n(v.type)==="identity"&&q.push(new ie(s,v,'"text-font" does not support identity functions'))),q.concat(u({key:n.key,value:v,valueSpec:R,style:f,styleSpec:y,expressionContext:"property",propertyType:e,propertyKey:S}))}function ls(n){return el(n,"paint")}function yl(n){return el(n,"layout")}function Io(n){let e=[];const s=n.value,u=n.key,f=n.style,y=n.styleSpec;s.type||s.ref||e.push(new ie(u,s,'either "type" or "ref" is required'));let v=_n(s.type);const S=_n(s.ref);if(s.id){const E=_n(s.id);for(let D=0;D<n.arrayIndex;D++){const R=f.layers[D];_n(R.id)===E&&e.push(new ie(u,s.id,`duplicate layer id "${s.id}", previously used at line ${R.id.__line__}`))}}if("ref"in s){let E;["type","source","source-layer","filter","layout"].forEach((D=>{D in s&&e.push(new ie(u,s[D],`"${D}" is prohibited for ref layers`))})),f.layers.forEach((D=>{_n(D.id)===S&&(E=D)})),E?E.ref?e.push(new ie(u,s.ref,"ref cannot reference another ref layer")):v=_n(E.type):e.push(new ie(u,s.ref,`ref layer "${S}" not found`))}else if(v!=="background")if(s.source){const E=f.sources&&f.sources[s.source],D=E&&_n(E.type);E?D==="vector"&&v==="raster"?e.push(new ie(u,s.source,`layer "${s.id}" requires a raster source`)):D!=="raster-dem"&&v==="hillshade"?e.push(new ie(u,s.source,`layer "${s.id}" requires a raster-dem source`)):D==="raster"&&v!=="raster"?e.push(new ie(u,s.source,`layer "${s.id}" requires a vector source`)):D!=="vector"||s["source-layer"]?D==="raster-dem"&&v!=="hillshade"?e.push(new ie(u,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!s.paint||!s.paint["line-gradient"]||D==="geojson"&&E.lineMetrics||e.push(new ie(u,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new ie(u,s,`layer "${s.id}" must specify a "source-layer"`)):e.push(new ie(u,s.source,`source "${s.source}" not found`))}else e.push(new ie(u,s,'missing required property "source"'));return e=e.concat(Gn({key:u,value:s,valueSpec:y.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${u}.type`,value:s.type,valueSpec:y.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:s,objectKey:"type"}),filter:Eu,layout:E=>Gn({layer:s,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":D=>yl(Ws({layerType:v},D))}}),paint:E=>Gn({layer:s,key:E.key,value:E.value,style:E.style,styleSpec:E.styleSpec,validateSpec:E.validateSpec,objectElementValidators:{"*":D=>ls(Ws({layerType:v},D))}})}})),e}function us(n){const e=n.value,s=n.key,u=mi(e);return u!=="string"?[new ie(s,e,`string expected, ${u} found`)]:[]}const Po={promoteId:function({key:n,value:e}){if(mi(e)==="string")return us({key:n,value:e});{const s=[];for(const u in e)s.push(...us({key:`${n}.${u}`,value:e[u]}));return s}}};function Do(n){const e=n.value,s=n.key,u=n.styleSpec,f=n.style,y=n.validateSpec;if(!e.type)return[new ie(s,e,'"type" is required')];const v=_n(e.type);let S;switch(v){case"vector":case"raster":return S=Gn({key:s,value:e,valueSpec:u[`source_${v.replace("-","_")}`],style:n.style,styleSpec:u,objectElementValidators:Po,validateSpec:y}),S;case"raster-dem":return S=(function(E){var D;const R=(D=E.sourceName)!==null&&D!==void 0?D:"",F=E.value,q=E.styleSpec,X=q.source_raster_dem,K=E.style;let W=[];const st=mi(F);if(F===void 0)return W;if(st!=="object")return W.push(new ie("source_raster_dem",F,`object expected, ${st} found`)),W;const ut=_n(F.encoding)==="custom",Ct=["redFactor","greenFactor","blueFactor","baseShift"],gt=E.value.encoding?`"${E.value.encoding}"`:"Default";for(const Tt in F)!ut&&Ct.includes(Tt)?W.push(new ie(Tt,F[Tt],`In "${R}": "${Tt}" is only valid when "encoding" is set to "custom". ${gt} encoding found`)):X[Tt]?W=W.concat(E.validateSpec({key:Tt,value:F[Tt],valueSpec:X[Tt],validateSpec:E.validateSpec,style:K,styleSpec:q})):W.push(new ie(Tt,F[Tt],`unknown property "${Tt}"`));return W})({sourceName:s,value:e,style:n.style,styleSpec:u,validateSpec:y}),S;case"geojson":if(S=Gn({key:s,value:e,valueSpec:u.source_geojson,style:f,styleSpec:u,validateSpec:y,objectElementValidators:Po}),e.cluster)for(const E in e.clusterProperties){const[D,R]=e.clusterProperties[E],F=typeof D=="string"?[D,["accumulated"],["get",E]]:D;S.push(...rr({key:`${s}.${E}.map`,value:R,expressionContext:"cluster-map"})),S.push(...rr({key:`${s}.${E}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return S;case"video":return Gn({key:s,value:e,valueSpec:u.source_video,style:f,validateSpec:y,styleSpec:u});case"image":return Gn({key:s,value:e,valueSpec:u.source_image,style:f,validateSpec:y,styleSpec:u});case"canvas":return[new ie(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ka({key:`${s}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function vl(n){const e=n.value,s=n.styleSpec,u=s.light,f=n.style;let y=[];const v=mi(e);if(e===void 0)return y;if(v!=="object")return y=y.concat([new ie("light",e,`object expected, ${v} found`)]),y;for(const S in e){const E=S.match(/^(.*)-transition$/);y=y.concat(E&&u[E[1]]&&u[E[1]].transition?n.validateSpec({key:S,value:e[S],valueSpec:s.transition,validateSpec:n.validateSpec,style:f,styleSpec:s}):u[S]?n.validateSpec({key:S,value:e[S],valueSpec:u[S],validateSpec:n.validateSpec,style:f,styleSpec:s}):[new ie(S,e[S],`unknown property "${S}"`)])}return y}function r(n){const e=n.value,s=n.styleSpec,u=s.sky,f=n.style,y=mi(e);if(e===void 0)return[];if(y!=="object")return[new ie("sky",e,`object expected, ${y} found`)];let v=[];for(const S in e)v=v.concat(u[S]?n.validateSpec({key:S,value:e[S],valueSpec:u[S],style:f,styleSpec:s}):[new ie(S,e[S],`unknown property "${S}"`)]);return v}function d(n){const e=n.value,s=n.styleSpec,u=s.terrain,f=n.style;let y=[];const v=mi(e);if(e===void 0)return y;if(v!=="object")return y=y.concat([new ie("terrain",e,`object expected, ${v} found`)]),y;for(const S in e)y=y.concat(u[S]?n.validateSpec({key:S,value:e[S],valueSpec:u[S],validateSpec:n.validateSpec,style:f,styleSpec:s}):[new ie(S,e[S],`unknown property "${S}"`)]);return y}function b(n){let e=[];const s=n.value,u=n.key;if(Array.isArray(s)){const f=[],y=[];for(const v in s)s[v].id&&f.includes(s[v].id)&&e.push(new ie(u,s,`all the sprites' ids must be unique, but ${s[v].id} is duplicated`)),f.push(s[v].id),s[v].url&&y.includes(s[v].url)&&e.push(new ie(u,s,`all the sprites' URLs must be unique, but ${s[v].url} is duplicated`)),y.push(s[v].url),e=e.concat(Gn({key:`${u}[${v}]`,value:s[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return e}return us({key:u,value:s})}const I={"*":()=>[],array:Lo,boolean:function(n){const e=n.value,s=n.key,u=mi(e);return u!=="boolean"?[new ie(s,e,`boolean expected, ${u} found`)]:[]},number:Ms,color:function(n){const e=n.key,s=n.value,u=mi(s);return u!=="string"?[new ie(e,s,`color expected, ${u} found`)]:Ci.parse(String(s))?[]:[new ie(e,s,`color expected, "${s}" found`)]},constants:Pa,enum:ka,filter:Eu,function:kr,layer:Io,object:Gn,source:Do,light:vl,sky:r,terrain:d,projection:function(n){const e=n.value,s=n.styleSpec,u=s.projection,f=n.style,y=mi(e);if(e===void 0)return[];if(y!=="object")return[new ie("projection",e,`object expected, ${y} found`)];let v=[];for(const S in e)v=v.concat(u[S]?n.validateSpec({key:S,value:e[S],valueSpec:u[S],style:f,styleSpec:s}):[new ie(S,e[S],`unknown property "${S}"`)]);return v},string:us,formatted:function(n){return us(n).length===0?[]:rr(n)},resolvedImage:function(n){return us(n).length===0?[]:rr(n)},padding:function(n){const e=n.key,s=n.value;if(mi(s)==="array"){if(s.length<1||s.length>4)return[new ie(e,s,`padding requires 1 to 4 values; ${s.length} values found`)];const u={type:"number"};let f=[];for(let y=0;y<s.length;y++)f=f.concat(n.validateSpec({key:`${e}[${y}]`,value:s[y],validateSpec:n.validateSpec,valueSpec:u}));return f}return Ms({key:e,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(n){const e=n.key,s=n.value,u=mi(s),f=n.styleSpec;if(u!=="array"||s.length<1||s.length%2!=0)return[new ie(e,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let v=0;v<s.length;v+=2)y=y.concat(ka({key:`${e}[${v}]`,value:s[v],valueSpec:f.layout_symbol["text-anchor"]})),y=y.concat(Lo({key:`${e}[${v+1}]`,value:s[v+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:f}));return y},sprite:b};function N(n){const e=n.value,s=n.valueSpec,u=n.styleSpec;return n.validateSpec=N,s.expression&&Ao(_n(e))?kr(n):s.expression&&Dr(Da(e))?rr(n):s.type&&I[s.type]?I[s.type](n):Gn(Ws({},n,{valueSpec:s.type?u[s.type]:s}))}function Y(n){const e=n.value,s=n.key,u=us(n);return u.length||(e.indexOf("{fontstack}")===-1&&u.push(new ie(s,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&u.push(new ie(s,e,'"glyphs" url must include a "{range}" token'))),u}function lt(n,e=Nt){let s=[];return s=s.concat(N({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,validateSpec:N,objectElementValidators:{glyphs:Y,"*":()=>[]}})),n.constants&&(s=s.concat(Pa({key:"constants",value:n.constants}))),Ot(s)}function At(n){return function(e){return n({...e,validateSpec:N})}}function Ot(n){return[].concat(n).sort(((e,s)=>e.line-s.line))}function $t(n){return function(...e){return Ot(n.apply(this,e))}}lt.source=$t(At(Do)),lt.sprite=$t(At(b)),lt.glyphs=$t(At(Y)),lt.light=$t(At(vl)),lt.sky=$t(At(r)),lt.terrain=$t(At(d)),lt.layer=$t(At(Io)),lt.filter=$t(At(Eu)),lt.paintProperty=$t(At(ls)),lt.layoutProperty=$t(At(yl));const pe=lt,Re=pe.light,_i=pe.sky,oa=pe.paintProperty,Rn=pe.layoutProperty;function Ra(n,e){let s=!1;if(e&&e.length)for(const u of e)n.fire(new Ua(new Error(u.message))),s=!0;return s}class Li{constructor(e,s,u){const f=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const v=new Int32Array(this.arrayBuffer);e=v[0],this.d=(s=v[1])+2*(u=v[2]);for(let E=0;E<this.d*this.d;E++){const D=v[3+E],R=v[3+E+1];f.push(D===R?null:v.subarray(D,R))}const S=v[3+f.length+1];this.keys=v.subarray(v[3+f.length],S),this.bboxes=v.subarray(S),this.insert=this._insertReadonly}else{this.d=s+2*u;for(let v=0;v<this.d*this.d;v++)f.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=e,this.padding=u,this.scale=s/e,this.uid=0;const y=u/s*e;this.min=-y,this.max=e+y}insert(e,s,u,f,y){this._forEachCell(s,u,f,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,s,u,f,y,v){this.cells[y].push(v)}query(e,s,u,f,y){const v=this.min,S=this.max;if(e<=v&&s<=v&&S<=u&&S<=f&&!y)return Array.prototype.slice.call(this.keys);{const E=[];return this._forEachCell(e,s,u,f,this._queryCell,E,{},y),E}}_queryCell(e,s,u,f,y,v,S,E){const D=this.cells[y];if(D!==null){const R=this.keys,F=this.bboxes;for(let q=0;q<D.length;q++){const X=D[q];if(S[X]===void 0){const K=4*X;(E?E(F[K+0],F[K+1],F[K+2],F[K+3]):e<=F[K+2]&&s<=F[K+3]&&u>=F[K+0]&&f>=F[K+1])?(S[X]=!0,v.push(R[X])):S[X]=!1}}}}_forEachCell(e,s,u,f,y,v,S,E){const D=this._convertToCellCoord(e),R=this._convertToCellCoord(s),F=this._convertToCellCoord(u),q=this._convertToCellCoord(f);for(let X=D;X<=F;X++)for(let K=R;K<=q;K++){const W=this.d*K+X;if((!E||E(this._convertFromCellCoord(X),this._convertFromCellCoord(K),this._convertFromCellCoord(X+1),this._convertFromCellCoord(K+1)))&&y.call(this,e,s,u,f,W,v,S,E))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,s=3+this.cells.length+1+1;let u=0;for(let v=0;v<this.cells.length;v++)u+=this.cells[v].length;const f=new Int32Array(s+u+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let y=s;for(let v=0;v<e.length;v++){const S=e[v];f[3+v]=y,f.set(S,y),y+=S.length}return f[3+e.length]=y,f.set(this.keys,y),y+=this.keys.length,f[3+e.length+1]=y,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer}static serialize(e,s){const u=e.toArrayBuffer();return s&&s.push(u),{buffer:u}}static deserialize(e){return new Li(e.buffer)}}const ci={};function Qt(n,e,s={}){if(ci[n])throw new Error(`${n} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),ci[n]={klass:e,omit:s.omit||[],shallow:s.shallow||[]}}Qt("Object",Object),Qt("TransferableGridIndex",Li),Qt("Color",Ci),Qt("Error",Error),Qt("AJAXError",Ve),Qt("ResolvedImage",La),Qt("StylePropertyFunction",zo),Qt("StyleExpression",to,{omit:["_evaluator"]}),Qt("ZoomDependentExpression",js),Qt("ZoomConstantExpression",rs),Qt("CompoundExpression",ya,{omit:["_evaluate"]});for(const n in nr)nr[n]._classRegistryKey||Qt(`Expression_${n}`,nr[n]);function qs(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function Ha(n){return n.$name||n.constructor._classRegistryKey}function xl(n){return!(function(e){if(e===null||typeof e!="object")return!1;const s=Ha(e);return!(!s||s==="Object")})(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||qs(n)||ce(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function cs(n,e){if(xl(n))return(qs(n)||ce(n))&&e&&e.push(n),ArrayBuffer.isView(n)&&e&&e.push(n.buffer),n instanceof ImageData&&e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const y=[];for(const v of n)y.push(cs(v,e));return y}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const s=Ha(n);if(!s)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!ci[s])throw new Error(`${s} is not registered.`);const{klass:u}=ci[s],f=u.serialize?u.serialize(n,e):{};if(u.serialize){if(e&&f===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in n){if(!n.hasOwnProperty(y)||ci[s].omit.indexOf(y)>=0)continue;const v=n[y];f[y]=ci[s].shallow.indexOf(y)>=0?v:cs(v,e)}n instanceof Error&&(f.message=n.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(f.$name=s),f}function no(n){if(xl(n))return n;if(Array.isArray(n))return n.map(no);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const e=Ha(n)||"Object";if(!ci[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:s}=ci[e];if(!s)throw new Error(`can't deserialize unregistered class ${e}`);if(s.deserialize)return s.deserialize(n);const u=Object.create(s.prototype);for(const f of Object.keys(n)){if(f==="$name")continue;const y=n[f];u[f]=ci[e].shallow.indexOf(f)>=0?y:no(y)}return u}class Cn{constructor(){this.first=!0}update(e,s){const u=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=s),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=u,!0))}}const ei={"Latin-1 Supplement":n=>n>=128&&n<=255,"Hangul Jamo":n=>n>=4352&&n<=4607,Khmer:n=>n>=6016&&n<=6143,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Katakana:n=>n>=12448&&n<=12543,Kanbun:n=>n>=12688&&n<=12703,"CJK Strokes":n=>n>=12736&&n<=12783,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"Private Use Area":n=>n>=57344&&n<=63743,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function Rr(n){for(const e of n)if(ao(e.charCodeAt(0)))return!0;return!1}function Mu(n){for(const e of n)if(!hs(e.charCodeAt(0)))return!1;return!0}function ko(n){const e=n.map((s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}})).filter((s=>s));return new RegExp(e.join("|"),"u")}const bl=ko(["Arab","Dupl","Mong","Ougr","Syrc"]);function hs(n){return!bl.test(String.fromCodePoint(n))}const or=ko(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function ao(n){return!(n!==746&&n!==747&&(n<4352||!(ei["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||ei["CJK Compatibility"](n)||ei["CJK Strokes"](n)||!(!ei["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||ei["Enclosed CJK Letters and Months"](n)||ei["Ideographic Description Characters"](n)||ei.Kanbun(n)||ei.Katakana(n)&&n!==12540||!(!ei["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!ei["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||ei["Vertical Forms"](n)||ei["Yijing Hexagram Symbols"](n)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(n))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(n))||or.test(String.fromCodePoint(n)))))}function so(n){return!(ao(n)||(function(e){return!!(ei["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||ei["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||ei["Letterlike Symbols"](e)||ei["Number Forms"](e)||ei["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||ei["Control Pictures"](e)&&e!==9251||ei["Optical Character Recognition"](e)||ei["Enclosed Alphanumerics"](e)||ei["Geometric Shapes"](e)||ei["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ei["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ei["CJK Symbols and Punctuation"](e)||ei.Katakana(e)||ei["Private Use Area"](e)||ei["CJK Compatibility Forms"](e)||ei["Small Form Variants"](e)||ei["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)})(n))}const Nc=ko(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function zu(n){return Nc.test(String.fromCodePoint(n))}function Kl(n,e){return!(!e&&zu(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||ei.Khmer(n))}function tc(n){for(const e of n)if(zu(e.charCodeAt(0)))return!0;return!1}const pa=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class fi{constructor(e,s){this.zoom=e,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Cn,this.transition={})}isSupportedScript(e){return(function(s,u){for(const f of s)if(!Kl(f.charCodeAt(0),u))return!1;return!0})(e,pa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,s=e-Math.floor(e),u=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*s}}}class Ro{constructor(e,s){this.property=e,this.value=s,this.expression=(function(u,f){if(Ao(u))return new zo(u,f);if(Dr(u)){const y=Qo(u,f);if(y.result==="error")throw new Error(y.value.map((v=>`${v.key}: ${v.message}`)).join(", "));return y.value}{let y=u;return f.type==="color"&&typeof u=="string"?y=Ci.parse(u):f.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(u)&&(y=ga.parse(u)):y=Kn.parse(u),{kind:"constant",evaluate:()=>y}}})(s===void 0?e.specification.default:s,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,s,u){return this.property.possiblyEvaluate(this,e,s,u)}}class Cu{constructor(e){this.property=e,this.value=new Ro(e,void 0)}transitioned(e,s){return new Ah(this.property,this.value,s,Xe({},e.transition,this.transition),e.now)}untransitioned(){return new Ah(this.property,this.value,null,{},0)}}class ec{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Fe(this._values[e].value.value)}setValue(e,s){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Cu(this._values[e].property)),this._values[e].value=new Ro(this._values[e].property,s===null?void 0:Fe(s))}getTransition(e){return Fe(this._values[e].transition)}setTransition(e,s){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Cu(this._values[e].property)),this._values[e].transition=Fe(s)||void 0}serialize(){const e={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(e[s]=u);const f=this.getTransition(s);f!==void 0&&(e[`${s}-transition`]=f)}return e}transitioned(e,s){const u=new Lu(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].transitioned(e,s._values[f]);return u}untransitioned(){const e=new Lu(this._properties);for(const s of Object.keys(this._values))e._values[s]=this._values[s].untransitioned();return e}}class Ah{constructor(e,s,u,f,y){this.property=e,this.value=s,this.begin=y+f.delay||0,this.end=this.begin+f.duration||0,e.specification.transition&&(f.delay||f.duration)&&(this.prior=u)}possiblyEvaluate(e,s,u){const f=e.now||0,y=this.value.possiblyEvaluate(e,s,u),v=this.prior;if(v){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return v.possiblyEvaluate(e,s,u);{const S=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,s,u),y,(function(E){if(E<=0)return 0;if(E>=1)return 1;const D=E*E,R=D*E;return 4*(E<.5?R:3*(E-D)+R-.75)})(S))}}return y}}class Lu{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,s,u){const f=new Oo(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(e,s,u);return f}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Pn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Fe(this._values[e].value)}setValue(e,s){this._values[e]=new Ro(this._values[e].property,s===null?void 0:Fe(s))}serialize(){const e={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(e[s]=u)}return e}possiblyEvaluate(e,s,u){const f=new Oo(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(e,s,u);return f}}class lr{constructor(e,s,u){this.property=e,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,s,u,f){return this.property.evaluate(this.value,this.parameters,e,s,u,f)}}class Oo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ee{constructor(e){this.specification=e}possiblyEvaluate(e,s){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(s)}interpolate(e,s,u){const f=aa[this.specification.type];return f?f(e,s,u):e}}class Oe{constructor(e,s){this.specification=e,this.overrides=s}possiblyEvaluate(e,s,u,f){return new lr(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(s,null,{},u,f)}:e.expression,s)}interpolate(e,s,u){if(e.value.kind!=="constant"||s.value.kind!=="constant")return e;if(e.value.value===void 0||s.value.value===void 0)return new lr(this,{kind:"constant",value:void 0},e.parameters);const f=aa[this.specification.type];if(f){const y=f(e.value.value,s.value.value,u);return new lr(this,{kind:"constant",value:y},e.parameters)}return e}evaluate(e,s,u,f,y,v){return e.kind==="constant"?e.value:e.evaluate(s,u,f,y,v)}}class Bo extends Oe{possiblyEvaluate(e,s,u,f){if(e.value===void 0)return new lr(this,{kind:"constant",value:void 0},s);if(e.expression.kind==="constant"){const y=e.expression.evaluate(s,null,{},u,f),v=e.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,S=this._calculate(v,v,v,s);return new lr(this,{kind:"constant",value:S},s)}if(e.expression.kind==="camera"){const y=this._calculate(e.expression.evaluate({zoom:s.zoom-1}),e.expression.evaluate({zoom:s.zoom}),e.expression.evaluate({zoom:s.zoom+1}),s);return new lr(this,{kind:"constant",value:y},s)}return new lr(this,e.expression,s)}evaluate(e,s,u,f,y,v){if(e.kind==="source"){const S=e.evaluate(s,u,f,y,v);return this._calculate(S,S,S,s)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(s.zoom)-1},u,f),e.evaluate({zoom:Math.floor(s.zoom)},u,f),e.evaluate({zoom:Math.floor(s.zoom)+1},u,f),s):e.value}_calculate(e,s,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:s}:{from:u,to:s}}interpolate(e){return e}}class No{constructor(e){this.specification=e}possiblyEvaluate(e,s,u,f){if(e.value!==void 0){if(e.expression.kind==="constant"){const y=e.expression.evaluate(s,null,{},u,f);return this._calculate(y,y,y,s)}return this._calculate(e.expression.evaluate(new fi(Math.floor(s.zoom-1),s)),e.expression.evaluate(new fi(Math.floor(s.zoom),s)),e.expression.evaluate(new fi(Math.floor(s.zoom+1),s)),s)}}_calculate(e,s,u,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:s}:{from:u,to:s}}interpolate(e){return e}}class Fc{constructor(e){this.specification=e}possiblyEvaluate(e,s,u,f){return!!e.expression.evaluate(s,null,{},u,f)}interpolate(){return!1}}class _{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in e){const u=e[s];u.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new Ro(u,void 0),y=this.defaultTransitionablePropertyValues[s]=new Cu(u);this.defaultTransitioningPropertyValues[s]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate({})}}}Qt("DataDrivenProperty",Oe),Qt("DataConstantProperty",Ee),Qt("CrossFadedDataDrivenProperty",Bo),Qt("CrossFadedProperty",No),Qt("ColorRampProperty",Fc);const t="-transition";class o extends br{constructor(e,s){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),s.layout&&(this._unevaluatedLayout=new Pn(s.layout)),s.paint)){this._transitionablePaint=new ec(s.paint);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Oo(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,s,u={}){s!=null&&this._validate(Rn,`layers.${this.id}.layout.${e}`,e,s,u)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,s):this.visibility=s)}getPaintProperty(e){return e.endsWith(t)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,s,u={}){if(s!=null&&this._validate(oa,`layers.${this.id}.paint.${e}`,e,s,u))return!1;if(e.endsWith(t))return this._transitionablePaint.setTransition(e.slice(0,-11),s||void 0),!1;{const f=this._transitionablePaint._values[e],y=f.property.specification["property-type"]==="cross-faded-data-driven",v=f.value.isDataDriven(),S=f.value;this._transitionablePaint.setValue(e,s),this._handleSpecialPaintPropertyUpdate(e);const E=this._transitionablePaint._values[e].value;return E.isDataDriven()||v||y||this._handleOverridablePaintPropertyUpdate(e,S,E)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,s,u){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,s){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,s)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),ca(e,((s,u)=>!(s===void 0||u==="layout"&&!Object.keys(s).length||u==="paint"&&!Object.keys(s).length)))}_validate(e,s,u,f,y={}){return(!y||y.validate!==!1)&&Ra(this,e.call(pe,{key:s,layerType:this.type,objectKey:u,value:f,styleSpec:Nt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const s=this.paint.get(e);if(s instanceof lr&&Jo(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const c={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class h{constructor(e,s){this._structArray=e,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class m{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,s){return e._trim(),s&&(e.isTransferred=!0,s.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const s=Object.create(this.prototype);return s.arrayBuffer=e.arrayBuffer,s.length=e.length,s.capacity=e.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function T(n,e=1){let s=0,u=0;return{members:n.map((f=>{const y=c[f.type].BYTES_PER_ELEMENT,v=s=z(s,Math.max(e,y)),S=f.components||1;return u=Math.max(u,y),s+=y*S,{name:f.name,type:f.type,components:S,offset:v}})),size:z(s,Math.max(u,e)),alignment:e}}function z(n,e){return Math.ceil(n/e)*e}class P extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,s)}emplace(e,s,u){const f=2*e;return this.int16[f+0]=s,this.int16[f+1]=u,e}}P.prototype.bytesPerElement=4,Qt("StructArrayLayout2i4",P);class B extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,s,u)}emplace(e,s,u,f){const y=3*e;return this.int16[y+0]=s,this.int16[y+1]=u,this.int16[y+2]=f,e}}B.prototype.bytesPerElement=6,Qt("StructArrayLayout3i6",B);class Z extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,u,f){const y=this.length;return this.resize(y+1),this.emplace(y,e,s,u,f)}emplace(e,s,u,f,y){const v=4*e;return this.int16[v+0]=s,this.int16[v+1]=u,this.int16[v+2]=f,this.int16[v+3]=y,e}}Z.prototype.bytesPerElement=8,Qt("StructArrayLayout4i8",Z);class j extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v){const S=this.length;return this.resize(S+1),this.emplace(S,e,s,u,f,y,v)}emplace(e,s,u,f,y,v,S){const E=6*e;return this.int16[E+0]=s,this.int16[E+1]=u,this.int16[E+2]=f,this.int16[E+3]=y,this.int16[E+4]=v,this.int16[E+5]=S,e}}j.prototype.bytesPerElement=12,Qt("StructArrayLayout2i4i12",j);class $ extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v){const S=this.length;return this.resize(S+1),this.emplace(S,e,s,u,f,y,v)}emplace(e,s,u,f,y,v,S){const E=4*e,D=8*e;return this.int16[E+0]=s,this.int16[E+1]=u,this.uint8[D+4]=f,this.uint8[D+5]=y,this.uint8[D+6]=v,this.uint8[D+7]=S,e}}$.prototype.bytesPerElement=8,Qt("StructArrayLayout2i4ub8",$);class J extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,s)}emplace(e,s,u){const f=2*e;return this.float32[f+0]=s,this.float32[f+1]=u,e}}J.prototype.bytesPerElement=8,Qt("StructArrayLayout2f8",J);class et extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v,S,E,D,R){const F=this.length;return this.resize(F+1),this.emplace(F,e,s,u,f,y,v,S,E,D,R)}emplace(e,s,u,f,y,v,S,E,D,R,F){const q=10*e;return this.uint16[q+0]=s,this.uint16[q+1]=u,this.uint16[q+2]=f,this.uint16[q+3]=y,this.uint16[q+4]=v,this.uint16[q+5]=S,this.uint16[q+6]=E,this.uint16[q+7]=D,this.uint16[q+8]=R,this.uint16[q+9]=F,e}}et.prototype.bytesPerElement=20,Qt("StructArrayLayout10ui20",et);class rt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v,S,E,D,R,F,q){const X=this.length;return this.resize(X+1),this.emplace(X,e,s,u,f,y,v,S,E,D,R,F,q)}emplace(e,s,u,f,y,v,S,E,D,R,F,q,X){const K=12*e;return this.int16[K+0]=s,this.int16[K+1]=u,this.int16[K+2]=f,this.int16[K+3]=y,this.uint16[K+4]=v,this.uint16[K+5]=S,this.uint16[K+6]=E,this.uint16[K+7]=D,this.int16[K+8]=R,this.int16[K+9]=F,this.int16[K+10]=q,this.int16[K+11]=X,e}}rt.prototype.bytesPerElement=24,Qt("StructArrayLayout4i4ui4i24",rt);class ct extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,s,u)}emplace(e,s,u,f){const y=3*e;return this.float32[y+0]=s,this.float32[y+1]=u,this.float32[y+2]=f,e}}ct.prototype.bytesPerElement=12,Qt("StructArrayLayout3f12",ct);class ht extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.uint32[1*e+0]=s,e}}ht.prototype.bytesPerElement=4,Qt("StructArrayLayout1ul4",ht);class pt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v,S,E,D){const R=this.length;return this.resize(R+1),this.emplace(R,e,s,u,f,y,v,S,E,D)}emplace(e,s,u,f,y,v,S,E,D,R){const F=10*e,q=5*e;return this.int16[F+0]=s,this.int16[F+1]=u,this.int16[F+2]=f,this.int16[F+3]=y,this.int16[F+4]=v,this.int16[F+5]=S,this.uint32[q+3]=E,this.uint16[F+8]=D,this.uint16[F+9]=R,e}}pt.prototype.bytesPerElement=20,Qt("StructArrayLayout6i1ul2ui20",pt);class nt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v){const S=this.length;return this.resize(S+1),this.emplace(S,e,s,u,f,y,v)}emplace(e,s,u,f,y,v,S){const E=6*e;return this.int16[E+0]=s,this.int16[E+1]=u,this.int16[E+2]=f,this.int16[E+3]=y,this.int16[E+4]=v,this.int16[E+5]=S,e}}nt.prototype.bytesPerElement=12,Qt("StructArrayLayout2i2i2i12",nt);class vt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,s,u,f,y)}emplace(e,s,u,f,y,v){const S=4*e,E=8*e;return this.float32[S+0]=s,this.float32[S+1]=u,this.float32[S+2]=f,this.int16[E+6]=y,this.int16[E+7]=v,e}}vt.prototype.bytesPerElement=16,Qt("StructArrayLayout2f1f2i16",vt);class wt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v){const S=this.length;return this.resize(S+1),this.emplace(S,e,s,u,f,y,v)}emplace(e,s,u,f,y,v,S){const E=16*e,D=4*e,R=8*e;return this.uint8[E+0]=s,this.uint8[E+1]=u,this.float32[D+1]=f,this.float32[D+2]=y,this.int16[R+6]=v,this.int16[R+7]=S,e}}wt.prototype.bytesPerElement=16,Qt("StructArrayLayout2ub2f2i16",wt);class Pt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,s,u)}emplace(e,s,u,f){const y=3*e;return this.uint16[y+0]=s,this.uint16[y+1]=u,this.uint16[y+2]=f,e}}Pt.prototype.bytesPerElement=6,Qt("StructArrayLayout3ui6",Pt);class Xt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v,S,E,D,R,F,q,X,K,W,st,ut){const Ct=this.length;return this.resize(Ct+1),this.emplace(Ct,e,s,u,f,y,v,S,E,D,R,F,q,X,K,W,st,ut)}emplace(e,s,u,f,y,v,S,E,D,R,F,q,X,K,W,st,ut,Ct){const gt=24*e,Tt=12*e,Zt=48*e;return this.int16[gt+0]=s,this.int16[gt+1]=u,this.uint16[gt+2]=f,this.uint16[gt+3]=y,this.uint32[Tt+2]=v,this.uint32[Tt+3]=S,this.uint32[Tt+4]=E,this.uint16[gt+10]=D,this.uint16[gt+11]=R,this.uint16[gt+12]=F,this.float32[Tt+7]=q,this.float32[Tt+8]=X,this.uint8[Zt+36]=K,this.uint8[Zt+37]=W,this.uint8[Zt+38]=st,this.uint32[Tt+10]=ut,this.int16[gt+22]=Ct,e}}Xt.prototype.bytesPerElement=48,Qt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Xt);class ne extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,u,f,y,v,S,E,D,R,F,q,X,K,W,st,ut,Ct,gt,Tt,Zt,ee,ye,Be,le,de,Ce,Te){const be=this.length;return this.resize(be+1),this.emplace(be,e,s,u,f,y,v,S,E,D,R,F,q,X,K,W,st,ut,Ct,gt,Tt,Zt,ee,ye,Be,le,de,Ce,Te)}emplace(e,s,u,f,y,v,S,E,D,R,F,q,X,K,W,st,ut,Ct,gt,Tt,Zt,ee,ye,Be,le,de,Ce,Te,be){const Gt=32*e,Se=16*e;return this.int16[Gt+0]=s,this.int16[Gt+1]=u,this.int16[Gt+2]=f,this.int16[Gt+3]=y,this.int16[Gt+4]=v,this.int16[Gt+5]=S,this.int16[Gt+6]=E,this.int16[Gt+7]=D,this.uint16[Gt+8]=R,this.uint16[Gt+9]=F,this.uint16[Gt+10]=q,this.uint16[Gt+11]=X,this.uint16[Gt+12]=K,this.uint16[Gt+13]=W,this.uint16[Gt+14]=st,this.uint16[Gt+15]=ut,this.uint16[Gt+16]=Ct,this.uint16[Gt+17]=gt,this.uint16[Gt+18]=Tt,this.uint16[Gt+19]=Zt,this.uint16[Gt+20]=ee,this.uint16[Gt+21]=ye,this.uint16[Gt+22]=Be,this.uint32[Se+12]=le,this.float32[Se+13]=de,this.float32[Se+14]=Ce,this.uint16[Gt+30]=Te,this.uint16[Gt+31]=be,e}}ne.prototype.bytesPerElement=64,Qt("StructArrayLayout8i15ui1ul2f2ui64",ne);class ue extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.float32[1*e+0]=s,e}}ue.prototype.bytesPerElement=4,Qt("StructArrayLayout1f4",ue);class ve extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,s,u)}emplace(e,s,u,f){const y=3*e;return this.uint16[6*e+0]=s,this.float32[y+1]=u,this.float32[y+2]=f,e}}ve.prototype.bytesPerElement=12,Qt("StructArrayLayout1ui2f12",ve);class he extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,s,u)}emplace(e,s,u,f){const y=4*e;return this.uint32[2*e+0]=s,this.uint16[y+2]=u,this.uint16[y+3]=f,e}}he.prototype.bytesPerElement=8,Qt("StructArrayLayout1ul2ui8",he);class se extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,s)}emplace(e,s,u){const f=2*e;return this.uint16[f+0]=s,this.uint16[f+1]=u,e}}se.prototype.bytesPerElement=4,Qt("StructArrayLayout2ui4",se);class we extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.uint16[1*e+0]=s,e}}we.prototype.bytesPerElement=2,Qt("StructArrayLayout1ui2",we);class qe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,u,f){const y=this.length;return this.resize(y+1),this.emplace(y,e,s,u,f)}emplace(e,s,u,f,y){const v=4*e;return this.float32[v+0]=s,this.float32[v+1]=u,this.float32[v+2]=f,this.float32[v+3]=y,e}}qe.prototype.bytesPerElement=16,Qt("StructArrayLayout4f16",qe);class fe extends h{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new It(this.anchorPointX,this.anchorPointY)}}fe.prototype.size=20;class _e extends pt{get(e){return new fe(this,e)}}Qt("CollisionBoxArray",_e);class Ze extends h{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ze.prototype.size=48;class tn extends Xt{get(e){return new Ze(this,e)}}Qt("PlacedSymbolArray",tn);class li extends h{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}li.prototype.size=64;class yi extends ne{get(e){return new li(this,e)}}Qt("SymbolInstanceArray",yi);class Wi extends ue{getoffsetX(e){return this.float32[1*e+0]}}Qt("GlyphOffsetArray",Wi);class ma extends B{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Qt("SymbolLineVertexArray",ma);class ur extends h{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ur.prototype.size=12;class cn extends ve{get(e){return new ur(this,e)}}Qt("TextAnchorOffsetArray",cn);class Xa extends h{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Xa.prototype.size=8;class gn extends he{get(e){return new Xa(this,e)}}Qt("FeatureIndexArray",gn);class yn extends P{}class Hn extends P{}class cr extends P{}class wl extends j{}class Or extends ${}class va extends J{}class Gi extends et{}class Sl extends rt{}class Br extends ct{}class $e extends ht{}class Ti extends nt{}class vn extends wt{}class zs extends Pt{}class Xn extends se{}const $n=T([{name:"a_pos",components:2,type:"Int16"}],4),{members:$a}=$n;class di{constructor(e=[]){this.segments=e}prepareSegment(e,s,u,f){let y=this.segments[this.segments.length-1];return e>di.MAX_VERTEX_ARRAY_LENGTH&&Sn(`Max vertices per segment is ${di.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!y||y.vertexLength+e>di.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f)&&(y={vertexOffset:s.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},f!==void 0&&(y.sortKey=f),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const e of this.segments)for(const s in e.vaos)e.vaos[s].destroy()}static simpleSegment(e,s,u,f){return new di([{vertexOffset:e,primitiveOffset:s,vertexLength:u,primitiveLength:f,vaos:{},sortKey:0}])}}function hr(n,e){return 256*(n=Ni(Math.floor(n),0,255))+Ni(Math.floor(e),0,255)}di.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qt("SegmentVector",di);const Wl=T([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var xn={exports:{}},ic={exports:{}};ic.exports=function(n,e){var s,u,f,y,v,S,E,D;for(u=n.length-(s=3&n.length),f=e,v=3432918353,S=461845907,D=0;D<u;)E=255&n.charCodeAt(D)|(255&n.charCodeAt(++D))<<8|(255&n.charCodeAt(++D))<<16|(255&n.charCodeAt(++D))<<24,++D,f=27492+(65535&(y=5*(65535&(f=(f^=E=(65535&(E=(E=(65535&E)*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*S+(((E>>>16)*S&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(E=0,s){case 3:E^=(255&n.charCodeAt(D+2))<<16;case 2:E^=(255&n.charCodeAt(D+1))<<8;case 1:f^=E=(65535&(E=(E=(65535&(E^=255&n.charCodeAt(D)))*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*S+(((E>>>16)*S&65535)<<16)&4294967295}return f^=n.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var Uc=ic.exports,Zc={exports:{}};Zc.exports=function(n,e){for(var s,u=n.length,f=e^u,y=0;u>=4;)s=1540483477*(65535&(s=255&n.charCodeAt(y)|(255&n.charCodeAt(++y))<<8|(255&n.charCodeAt(++y))<<16|(255&n.charCodeAt(++y))<<24))+((1540483477*(s>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),u-=4,++y;switch(u){case 3:f^=(255&n.charCodeAt(y+2))<<16;case 2:f^=(255&n.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&n.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Fo=Uc,Eh=Zc.exports;xn.exports=Fo,xn.exports.murmur3=Fo,xn.exports.murmur2=Eh;var Jl=bt(xn.exports);class Tl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,s,u,f){this.ids.push(Ql(e)),this.positions.push(s,u,f)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Ql(e);let u=0,f=this.ids.length-1;for(;u<f;){const v=u+f>>1;this.ids[v]>=s?f=v:u=v+1}const y=[];for(;this.ids[u]===s;)y.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return y}static serialize(e,s){const u=new Float64Array(e.ids),f=new Uint32Array(e.positions);return xa(u,f,0,u.length-1),s&&s.push(u.buffer,f.buffer),{ids:u,positions:f}}static deserialize(e){const s=new Tl;return s.ids=e.ids,s.positions=e.positions,s.indexed=!0,s}}function Ql(n){const e=+n;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Jl(String(n))}function xa(n,e,s,u){for(;s<u;){const f=n[s+u>>1];let y=s-1,v=u+1;for(;;){do y++;while(n[y]<f);do v--;while(n[v]>f);if(y>=v)break;An(n,y,v),An(e,3*y,3*v),An(e,3*y+1,3*v+1),An(e,3*y+2,3*v+2)}v-s<u-v?(xa(n,e,s,v),s=v+1):(xa(n,e,v+1,u),u=v)}}function An(n,e,s){const u=n[e];n[e]=n[s],n[s]=u}Qt("FeaturePositionMap",Tl);class il{constructor(e,s){this.gl=e.gl,this.location=s}}class tu extends il{constructor(e,s){super(e,s),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class jc extends il{constructor(e,s){super(e,s),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Mh extends il{constructor(e,s){super(e,s),this.current=Ci.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Al=new Float32Array(16);function nc(n){return[hr(255*n.r,255*n.g),hr(255*n.b,255*n.a)]}class Iu{constructor(e,s,u){this.value=e,this.uniformNames=s.map((f=>`u_${f}`)),this.type=u}setUniform(e,s,u){e.set(u.constantOr(this.value))}getBinding(e,s,u){return this.type==="color"?new Mh(e,s):new tu(e,s)}}class eu{constructor(e,s){this.uniformNames=s.map((u=>`u_${u}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=e.tlbr}setUniform(e,s,u,f){const y=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&e.set(y)}getBinding(e,s,u){return u.substr(0,9)==="u_pattern"?new jc(e,s):new tu(e,s)}}class nl{constructor(e,s,u,f){this.expression=e,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map((y=>({name:`a_${y}`,type:"Float32",components:u==="color"?2:1,offset:0}))),this.paintVertexArray=new f}populatePaintArray(e,s,u,f,y){const v=this.paintVertexArray.length,S=this.expression.evaluate(new fi(0),s,{},f,[],y);this.paintVertexArray.resize(e),this._setPaintValue(v,e,S)}updatePaintArray(e,s,u,f){const y=this.expression.evaluate({zoom:0},u,f);this._setPaintValue(e,s,y)}_setPaintValue(e,s,u){if(this.type==="color"){const f=nc(u);for(let y=e;y<s;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=e;f<s;f++)this.paintVertexArray.emplace(f,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ro{constructor(e,s,u,f,y,v){this.expression=e,this.uniformNames=s.map((S=>`u_${S}_t`)),this.type=u,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=s.map((S=>({name:`a_${S}`,type:"Float32",components:u==="color"?4:2,offset:0}))),this.paintVertexArray=new v}populatePaintArray(e,s,u,f,y){const v=this.expression.evaluate(new fi(this.zoom),s,{},f,[],y),S=this.expression.evaluate(new fi(this.zoom+1),s,{},f,[],y),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,v,S)}updatePaintArray(e,s,u,f){const y=this.expression.evaluate({zoom:this.zoom},u,f),v=this.expression.evaluate({zoom:this.zoom+1},u,f);this._setPaintValue(e,s,y,v)}_setPaintValue(e,s,u,f){if(this.type==="color"){const y=nc(u),v=nc(f);for(let S=e;S<s;S++)this.paintVertexArray.emplace(S,y[0],y[1],v[0],v[1])}else{for(let y=e;y<s;y++)this.paintVertexArray.emplace(y,u,f);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(f))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,s){const u=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,f=Ni(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);e.set(f)}getBinding(e,s,u){return new tu(e,s)}}class El{constructor(e,s,u,f,y,v){this.expression=e,this.type=s,this.useIntegerZoom=u,this.zoom=f,this.layerId=v,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(e,s,u){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(f,e,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(e,s,u,f,y){this._setPaintValues(e,s,u.patterns&&u.patterns[this.layerId],y)}_setPaintValues(e,s,u,f){if(!f||!u)return;const{min:y,mid:v,max:S}=u,E=f[y],D=f[v],R=f[S];if(E&&D&&R)for(let F=e;F<s;F++)this.zoomInPaintVertexArray.emplace(F,D.tl[0],D.tl[1],D.br[0],D.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],D.pixelRatio,E.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,D.tl[0],D.tl[1],D.br[0],D.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],D.pixelRatio,R.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Wl.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Wl.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class cf{constructor(e,s,u){this.binders={},this._buffers=[];const f=[];for(const y in e.paint._values){if(!u(y))continue;const v=e.paint.get(y);if(!(v instanceof lr&&Jo(v.property.specification)))continue;const S=Td(y,e.type),E=v.value,D=v.property.specification.type,R=v.property.useIntegerZoom,F=v.property.specification["property-type"],q=F==="cross-faded"||F==="cross-faded-data-driven";if(E.kind==="constant")this.binders[y]=q?new eu(E.value,S):new Iu(E.value,S,D),f.push(`/u_${y}`);else if(E.kind==="source"||q){const X=zh(y,D,"source");this.binders[y]=q?new El(E,D,R,s,X,e.id):new nl(E,S,D,X),f.push(`/a_${y}`)}else{const X=zh(y,D,"composite");this.binders[y]=new ro(E,S,D,R,s,X),f.push(`/z_${y}`)}}this.cacheKey=f.sort().join("")}getMaxValue(e){const s=this.binders[e];return s instanceof nl||s instanceof ro?s.maxValue:0}populatePaintArrays(e,s,u,f,y){for(const v in this.binders){const S=this.binders[v];(S instanceof nl||S instanceof ro||S instanceof El)&&S.populatePaintArray(e,s,u,f,y)}}setConstantPatternPositions(e,s){for(const u in this.binders){const f=this.binders[u];f instanceof eu&&f.setConstantPatternPositions(e,s)}}updatePaintArrays(e,s,u,f,y){let v=!1;for(const S in e){const E=s.getPositions(S);for(const D of E){const R=u.feature(D.index);for(const F in this.binders){const q=this.binders[F];if((q instanceof nl||q instanceof ro||q instanceof El)&&q.expression.isStateDependent===!0){const X=f.paint.get(F);q.expression=X.value,q.updatePaintArray(D.start,D.end,R,e[S],y),v=!0}}}}return v}defines(){const e=[];for(const s in this.binders){const u=this.binders[s];(u instanceof Iu||u instanceof eu)&&e.push(...u.uniformNames.map((f=>`#define HAS_UNIFORM_${f}`)))}return e}getBinderAttributes(){const e=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof nl||u instanceof ro)for(let f=0;f<u.paintVertexAttributes.length;f++)e.push(u.paintVertexAttributes[f].name);else if(u instanceof El)for(let f=0;f<Wl.members.length;f++)e.push(Wl.members[f].name)}return e}getBinderUniforms(){const e=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Iu||u instanceof eu||u instanceof ro)for(const f of u.uniformNames)e.push(f)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,s){const u=[];for(const f in this.binders){const y=this.binders[f];if(y instanceof Iu||y instanceof eu||y instanceof ro){for(const v of y.uniformNames)if(s[v]){const S=y.getBinding(e,s[v],v);u.push({name:v,property:f,binding:S})}}}return u}setUniforms(e,s,u,f){for(const{name:y,property:v,binding:S}of s)this.binders[v].setUniform(S,f,u.get(v),y)}updatePaintBuffers(e){this._buffers=[];for(const s in this.binders){const u=this.binders[s];if(e&&u instanceof El){const f=e.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(u instanceof nl||u instanceof ro)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(e){for(const s in this.binders){const u=this.binders[s];(u instanceof nl||u instanceof ro||u instanceof El)&&u.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const s=this.binders[e];(s instanceof nl||s instanceof ro||s instanceof El)&&s.destroy()}}}class iu{constructor(e,s,u=(()=>!0)){this.programConfigurations={};for(const f of e)this.programConfigurations[f.id]=new cf(f,s,u);this.needsUpload=!1,this._featureMap=new Tl,this._bufferOffset=0}populatePaintArrays(e,s,u,f,y,v){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,s,f,y,v);s.id!==void 0&&this._featureMap.add(s.id,u,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,s,u,f){for(const y of u)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,s,y,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Td(n,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}function zh(n,e,s){const u={color:{source:J,composite:qe},number:{source:ue,composite:J}},f=(function(y){return{"line-pattern":{source:Gi,composite:Gi},"fill-pattern":{source:Gi,composite:Gi},"fill-extrusion-pattern":{source:Gi,composite:Gi}}[y]})(n);return f&&f[s]||u[e][s]}Qt("ConstantBinder",Iu),Qt("CrossFadedConstantBinder",eu),Qt("SourceExpressionBinder",nl),Qt("CrossFadedCompositeBinder",El),Qt("CompositeExpressionBinder",ro),Qt("ProgramConfiguration",cf,{omit:["_buffers"]}),Qt("ProgramConfigurationSet",iu);const Jn=8192,hf=Math.pow(2,14)-1,ff=-hf-1;function nu(n){const e=Jn/n.extent,s=n.loadGeometry();for(let u=0;u<s.length;u++){const f=s[u];for(let y=0;y<f.length;y++){const v=f[y],S=Math.round(v.x*e),E=Math.round(v.y*e);v.x=Ni(S,ff,hf),v.y=Ni(E,ff,hf),(S<v.x||S>v.x+1||E<v.y||E>v.y+1)&&Sn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function au(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?nu(n):[]}}function ac(n,e,s,u,f){n.emplaceBack(2*e+(u+1)/2,2*s+(f+1)/2)}class Ch{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Hn,this.indexArray=new zs,this.segments=new di,this.programConfigurations=new iu(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(e,s,u){const f=this.layers[0],y=[];let v=null,S=!1;f.type==="circle"&&(v=f.layout.get("circle-sort-key"),S=!v.isConstant());for(const{feature:E,id:D,index:R,sourceLayerIndex:F}of e){const q=this.layers[0]._featureFilter.needGeometry,X=au(E,q);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),X,u))continue;const K=S?v.evaluate(X,{},u):void 0,W={id:D,properties:E.properties,type:E.type,sourceLayerIndex:F,index:R,geometry:q?X.geometry:nu(E),patterns:{},sortKey:K};y.push(W)}S&&y.sort(((E,D)=>E.sortKey-D.sortKey));for(const E of y){const{geometry:D,index:R,sourceLayerIndex:F}=E,q=e[R].feature;this.addFeature(E,D,R,u),s.featureIndex.insert(q,D,R,F,this.index)}}update(e,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$a),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,s,u,f){for(const y of s)for(const v of y){const S=v.x,E=v.y;if(S<0||S>=Jn||E<0||E>=Jn)continue;const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),R=D.vertexLength;ac(this.layoutVertexArray,S,E,-1,-1),ac(this.layoutVertexArray,S,E,1,-1),ac(this.layoutVertexArray,S,E,1,1),ac(this.layoutVertexArray,S,E,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+3,R+2),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{},f)}}function df(n,e){for(let s=0;s<n.length;s++)if(Ml(e,n[s]))return!0;for(let s=0;s<e.length;s++)if(Ml(n,e[s]))return!0;return!!mf(n,e)}function Ad(n,e,s){return!!Ml(n,e)||!!su(e,n,s)}function pf(n,e){if(n.length===1)return Vc(e,n[0]);for(let s=0;s<e.length;s++){const u=e[s];for(let f=0;f<u.length;f++)if(Ml(n,u[f]))return!0}for(let s=0;s<n.length;s++)if(Vc(e,n[s]))return!0;for(let s=0;s<e.length;s++)if(mf(n,e[s]))return!0;return!1}function Ed(n,e,s){if(n.length>1){if(mf(n,e))return!0;for(let u=0;u<e.length;u++)if(su(e[u],n,s))return!0}for(let u=0;u<n.length;u++)if(su(n[u],e,s))return!0;return!1}function mf(n,e){if(n.length===0||e.length===0)return!1;for(let s=0;s<n.length-1;s++){const u=n[s],f=n[s+1];for(let y=0;y<e.length-1;y++)if(Md(u,f,e[y],e[y+1]))return!0}return!1}function Md(n,e,s,u){return Pi(n,s,u)!==Pi(e,s,u)&&Pi(n,e,s)!==Pi(n,e,u)}function su(n,e,s){const u=s*s;if(e.length===1)return n.distSqr(e[0])<u;for(let f=1;f<e.length;f++)if(_f(n,e[f-1],e[f])<u)return!0;return!1}function _f(n,e,s){const u=e.distSqr(s);if(u===0)return n.distSqr(e);const f=((n.x-e.x)*(s.x-e.x)+(n.y-e.y)*(s.y-e.y))/u;return n.distSqr(f<0?e:f>1?s:s.sub(e)._mult(f)._add(e))}function Vc(n,e){let s,u,f,y=!1;for(let v=0;v<n.length;v++){s=n[v];for(let S=0,E=s.length-1;S<s.length;E=S++)u=s[S],f=s[E],u.y>e.y!=f.y>e.y&&e.x<(f.x-u.x)*(e.y-u.y)/(f.y-u.y)+u.x&&(y=!y)}return y}function Ml(n,e){let s=!1;for(let u=0,f=n.length-1;u<n.length;f=u++){const y=n[u],v=n[f];y.y>e.y!=v.y>e.y&&e.x<(v.x-y.x)*(e.y-y.y)/(v.y-y.y)+y.x&&(s=!s)}return s}function zd(n,e,s){const u=s[0],f=s[2];if(n.x<u.x&&e.x<u.x||n.x>f.x&&e.x>f.x||n.y<u.y&&e.y<u.y||n.y>f.y&&e.y>f.y)return!1;const y=Pi(n,e,s[0]);return y!==Pi(n,e,s[1])||y!==Pi(n,e,s[2])||y!==Pi(n,e,s[3])}function Pu(n,e,s){const u=e.paint.get(n).value;return u.kind==="constant"?u.value:s.programConfigurations.get(e.id).getMaxValue(n)}function Lh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function qc(n,e,s,u,f){if(!e[0]&&!e[1])return n;const y=It.convert(e)._mult(f);s==="viewport"&&y._rotate(-u);const v=[];for(let S=0;S<n.length;S++)v.push(n[S].sub(y));return v}let gf,yf;Qt("CircleBucket",Ch,{omit:["layers"]});var Cd={get paint(){return yf=yf||new _({"circle-radius":new Oe(Nt.paint_circle["circle-radius"]),"circle-color":new Oe(Nt.paint_circle["circle-color"]),"circle-blur":new Oe(Nt.paint_circle["circle-blur"]),"circle-opacity":new Oe(Nt.paint_circle["circle-opacity"]),"circle-translate":new Ee(Nt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ee(Nt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ee(Nt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ee(Nt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Oe(Nt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Oe(Nt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Oe(Nt.paint_circle["circle-stroke-opacity"])})},get layout(){return gf=gf||new _({"circle-sort-key":new Oe(Nt.layout_circle["circle-sort-key"])})}},fs=1e-6,ru=typeof Float32Array<"u"?Float32Array:Array;function Ih(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function vf(n,e,s){var u=e[0],f=e[1],y=e[2],v=e[3],S=e[4],E=e[5],D=e[6],R=e[7],F=e[8],q=e[9],X=e[10],K=e[11],W=e[12],st=e[13],ut=e[14],Ct=e[15],gt=s[0],Tt=s[1],Zt=s[2],ee=s[3];return n[0]=gt*u+Tt*S+Zt*F+ee*W,n[1]=gt*f+Tt*E+Zt*q+ee*st,n[2]=gt*y+Tt*D+Zt*X+ee*ut,n[3]=gt*v+Tt*R+Zt*K+ee*Ct,n[4]=(gt=s[4])*u+(Tt=s[5])*S+(Zt=s[6])*F+(ee=s[7])*W,n[5]=gt*f+Tt*E+Zt*q+ee*st,n[6]=gt*y+Tt*D+Zt*X+ee*ut,n[7]=gt*v+Tt*R+Zt*K+ee*Ct,n[8]=(gt=s[8])*u+(Tt=s[9])*S+(Zt=s[10])*F+(ee=s[11])*W,n[9]=gt*f+Tt*E+Zt*q+ee*st,n[10]=gt*y+Tt*D+Zt*X+ee*ut,n[11]=gt*v+Tt*R+Zt*K+ee*Ct,n[12]=(gt=s[12])*u+(Tt=s[13])*S+(Zt=s[14])*F+(ee=s[15])*W,n[13]=gt*f+Tt*E+Zt*q+ee*st,n[14]=gt*y+Tt*D+Zt*X+ee*ut,n[15]=gt*v+Tt*R+Zt*K+ee*Ct,n}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var Du,Ld=vf;function Gc(n,e,s){var u=e[0],f=e[1],y=e[2],v=e[3];return n[0]=s[0]*u+s[4]*f+s[8]*y+s[12]*v,n[1]=s[1]*u+s[5]*f+s[9]*y+s[13]*v,n[2]=s[2]*u+s[6]*f+s[10]*y+s[14]*v,n[3]=s[3]*u+s[7]*f+s[11]*y+s[15]*v,n}Du=new ru(4),ru!=Float32Array&&(Du[0]=0,Du[1]=0,Du[2]=0,Du[3]=0);class Fp extends o{constructor(e){super(e,Cd)}createBucket(e){return new Ch(e)}queryRadius(e){const s=e;return Pu("circle-radius",this,s)+Pu("circle-stroke-width",this,s)+Lh(this.paint.get("circle-translate"))}queryIntersectsFeature(e,s,u,f,y,v,S,E){const D=qc(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,S),R=this.paint.get("circle-radius").evaluate(s,u)+this.paint.get("circle-stroke-width").evaluate(s,u),F=this.paint.get("circle-pitch-alignment")==="map",q=F?D:(function(K,W){return K.map((st=>Ph(st,W)))})(D,E),X=F?R*S:R;for(const K of f)for(const W of K){const st=F?W:Ph(W,E);let ut=X;const Ct=Gc([],[W.x,W.y,0,1],E);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ut*=Ct[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ut*=v.cameraToCenterDistance/Ct[3]),Ad(q,st,ut))return!0}return!1}}function Ph(n,e){const s=Gc([],[n.x,n.y,0,1],e);return new It(s[0]/s[3],s[1]/s[3])}class xf extends Ch{}let bf;Qt("HeatmapBucket",xf,{omit:["layers"]});var wf={get paint(){return bf=bf||new _({"heatmap-radius":new Oe(Nt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Oe(Nt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ee(Nt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fc(Nt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ee(Nt.paint_heatmap["heatmap-opacity"])})}};function Dh(n,{width:e,height:s},u,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==e*s*u)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${e*s*u}`)}else f=new Uint8Array(e*s*u);return n.width=e,n.height=s,n.data=f,n}function Sf(n,{width:e,height:s},u){if(e===n.width&&s===n.height)return;const f=Dh({},{width:e,height:s},u);Tf(n,f,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,s)},u),n.width=e,n.height=s,n.data=f.data}function Tf(n,e,s,u,f,y){if(f.width===0||f.height===0)return e;if(f.width>n.width||f.height>n.height||s.x>n.width-f.width||s.y>n.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>e.width||f.height>e.height||u.x>e.width-f.width||u.y>e.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const v=n.data,S=e.data;if(v===S)throw new Error("srcData equals dstData, so image is already copied");for(let E=0;E<f.height;E++){const D=((s.y+E)*n.width+s.x)*y,R=((u.y+E)*e.width+u.x)*y;for(let F=0;F<f.width*y;F++)S[R+F]=v[D+F]}return e}class Hc{constructor(e,s){Dh(this,e,1,s)}resize(e){Sf(this,e,1)}clone(){return new Hc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,s,u,f,y){Tf(e,s,u,f,y,1)}}class fr{constructor(e,s){Dh(this,e,4,s)}resize(e){Sf(this,e,4)}replace(e,s){s?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new fr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,s,u,f,y){Tf(e,s,u,f,y,4)}}function sc(n){const e={},s=n.resolution||256,u=n.clips?n.clips.length:1,f=n.image||new fr({width:s,height:u});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const y=(v,S,E)=>{e[n.evaluationKey]=E;const D=n.expression.evaluate(e);f.data[v+S+0]=Math.floor(255*D.r/D.a),f.data[v+S+1]=Math.floor(255*D.g/D.a),f.data[v+S+2]=Math.floor(255*D.b/D.a),f.data[v+S+3]=Math.floor(255*D.a)};if(n.clips)for(let v=0,S=0;v<u;++v,S+=4*s)for(let E=0,D=0;E<s;E++,D+=4){const R=E/(s-1),{start:F,end:q}=n.clips[v];y(S,D,F*(1-R)+q*R)}else for(let v=0,S=0;v<s;v++,S+=4)y(0,S,v/(s-1));return f}Qt("AlphaImage",Hc),Qt("RGBAImage",fr);const Xc="big-fb";class kh extends o{createBucket(e){return new xf(e)}constructor(e){super(e,wf),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=sc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Xc)&&this.heatmapFbos.delete(Xc)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Af;var Id={get paint(){return Af=Af||new _({"hillshade-illumination-direction":new Ee(Nt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ee(Nt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ee(Nt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ee(Nt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ee(Nt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ee(Nt.paint_hillshade["hillshade-accent-color"])})}};class $c extends o{constructor(e){super(e,Id)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const Pd=T([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ef}=Pd;function Mf(n,e,s=2){const u=e&&e.length,f=u?e[0]*s:n.length;let y=Rh(n,0,f,s,!0);const v=[];if(!y||y.next===y.prev)return v;let S,E,D;if(u&&(y=(function(R,F,q,X){const K=[];for(let W=0,st=F.length;W<st;W++){const ut=Rh(R,F[W]*X,W<st-1?F[W+1]*X:R.length,X,!1);ut===ut.next&&(ut.steiner=!0),K.push(Nd(ut))}K.sort(Od);for(let W=0;W<K.length;W++)q=Oh(K[W],q);return q})(n,e,y,s)),n.length>80*s){S=1/0,E=1/0;let R=-1/0,F=-1/0;for(let q=s;q<f;q+=s){const X=n[q],K=n[q+1];X<S&&(S=X),K<E&&(E=K),X>R&&(R=X),K>F&&(F=K)}D=Math.max(R-S,F-E),D=D!==0?32767/D:0}return rc(y,v,s,S,E,D,0),v}function Rh(n,e,s,u,f){let y;if(f===(function(v,S,E,D){let R=0;for(let F=S,q=E-D;F<E;F+=D)R+=(v[q]-v[F])*(v[F+1]+v[q+1]),q=F;return R})(n,e,s,u)>0)for(let v=e;v<s;v+=u)y=lc(v/u|0,n[v],n[v+1],y);else for(let v=s-u;v>=e;v-=u)y=lc(v/u|0,n[v],n[v+1],y);return y&&Qn(y,y.next)&&(uc(y),y=y.next),y}function zl(n,e){if(!n)return n;e||(e=n);let s,u=n;do if(s=!1,u.steiner||!Qn(u,u.next)&&On(u.prev,u,u.next)!==0)u=u.next;else{if(uc(u),u=e=u.prev,u===u.next)break;s=!0}while(s||u!==e);return e}function rc(n,e,s,u,f,y,v){if(!n)return;!v&&y&&(function(E,D,R,F){let q=E;do q.z===0&&(q.z=Yc(q.x,q.y,D,R,F)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==E);q.prevZ.nextZ=null,q.prevZ=null,(function(X){let K,W=1;do{let st,ut=X;X=null;let Ct=null;for(K=0;ut;){K++;let gt=ut,Tt=0;for(let ee=0;ee<W&&(Tt++,gt=gt.nextZ,gt);ee++);let Zt=W;for(;Tt>0||Zt>0&&gt;)Tt!==0&&(Zt===0||!gt||ut.z<=gt.z)?(st=ut,ut=ut.nextZ,Tt--):(st=gt,gt=gt.nextZ,Zt--),Ct?Ct.nextZ=st:X=st,st.prevZ=Ct,Ct=st;ut=gt}Ct.nextZ=null,W*=2}while(K>1)})(q)})(n,u,f,y);let S=n;for(;n.prev!==n.next;){const E=n.prev,D=n.next;if(y?ku(n,u,f,y):Dd(n))e.push(E.i,n.i,D.i),uc(n),n=D.next,S=D.next;else if((n=D)===S){v?v===1?rc(n=kd(zl(n),e),e,s,u,f,y,2):v===2&&Rd(n,e,s,u,f,y):rc(zl(n),e,s,u,f,y,1);break}}}function Dd(n){const e=n.prev,s=n,u=n.next;if(On(e,s,u)>=0)return!1;const f=e.x,y=s.x,v=u.x,S=e.y,E=s.y,D=u.y,R=f<y?f<v?f:v:y<v?y:v,F=S<E?S<D?S:D:E<D?E:D,q=f>y?f>v?f:v:y>v?y:v,X=S>E?S>D?S:D:E>D?E:D;let K=u.next;for(;K!==e;){if(K.x>=R&&K.x<=q&&K.y>=F&&K.y<=X&&Ru(f,S,y,E,v,D,K.x,K.y)&&On(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function ku(n,e,s,u){const f=n.prev,y=n,v=n.next;if(On(f,y,v)>=0)return!1;const S=f.x,E=y.x,D=v.x,R=f.y,F=y.y,q=v.y,X=S<E?S<D?S:D:E<D?E:D,K=R<F?R<q?R:q:F<q?F:q,W=S>E?S>D?S:D:E>D?E:D,st=R>F?R>q?R:q:F>q?F:q,ut=Yc(X,K,e,s,u),Ct=Yc(W,st,e,s,u);let gt=n.prevZ,Tt=n.nextZ;for(;gt&&gt.z>=ut&&Tt&&Tt.z<=Ct;){if(gt.x>=X&&gt.x<=W&&gt.y>=K&&gt.y<=st&&gt!==f&&gt!==v&&Ru(S,R,E,F,D,q,gt.x,gt.y)&&On(gt.prev,gt,gt.next)>=0||(gt=gt.prevZ,Tt.x>=X&&Tt.x<=W&&Tt.y>=K&&Tt.y<=st&&Tt!==f&&Tt!==v&&Ru(S,R,E,F,D,q,Tt.x,Tt.y)&&On(Tt.prev,Tt,Tt.next)>=0))return!1;Tt=Tt.nextZ}for(;gt&&gt.z>=ut;){if(gt.x>=X&&gt.x<=W&&gt.y>=K&&gt.y<=st&&gt!==f&&gt!==v&&Ru(S,R,E,F,D,q,gt.x,gt.y)&&On(gt.prev,gt,gt.next)>=0)return!1;gt=gt.prevZ}for(;Tt&&Tt.z<=Ct;){if(Tt.x>=X&&Tt.x<=W&&Tt.y>=K&&Tt.y<=st&&Tt!==f&&Tt!==v&&Ru(S,R,E,F,D,q,Tt.x,Tt.y)&&On(Tt.prev,Tt,Tt.next)>=0)return!1;Tt=Tt.nextZ}return!0}function kd(n,e){let s=n;do{const u=s.prev,f=s.next.next;!Qn(u,f)&&Ya(u,s,s.next,f)&&oc(u,f)&&oc(f,u)&&(e.push(u.i,s.i,f.i),uc(s),uc(s.next),s=n=f),s=s.next}while(s!==n);return zl(s)}function Rd(n,e,s,u,f,y){let v=n;do{let S=v.next.next;for(;S!==v.prev;){if(v.i!==S.i&&Up(v,S)){let E=zf(v,S);return v=zl(v,v.next),E=zl(E,E.next),rc(v,e,s,u,f,y,0),void rc(E,e,s,u,f,y,0)}S=S.next}v=v.next}while(v!==n)}function Od(n,e){return n.x-e.x}function Oh(n,e){const s=(function(f,y){let v=y;const S=f.x,E=f.y;let D,R=-1/0;do{if(E<=v.y&&E>=v.next.y&&v.next.y!==v.y){const W=v.x+(E-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(W<=S&&W>R&&(R=W,D=v.x<v.next.x?v:v.next,W===S))return D}v=v.next}while(v!==y);if(!D)return null;const F=D,q=D.x,X=D.y;let K=1/0;v=D;do{if(S>=v.x&&v.x>=q&&S!==v.x&&Ru(E<X?S:R,E,q,X,E<X?R:S,E,v.x,v.y)){const W=Math.abs(E-v.y)/(S-v.x);oc(v,f)&&(W<K||W===K&&(v.x>D.x||v.x===D.x&&Bd(D,v)))&&(D=v,K=W)}v=v.next}while(v!==F);return D})(n,e);if(!s)return e;const u=zf(s,n);return zl(u,u.next),zl(s,s.next)}function Bd(n,e){return On(n.prev,n,e.prev)<0&&On(e.next,n,n.next)<0}function Yc(n,e,s,u,f){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-s)*f|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-u)*f|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Nd(n){let e=n,s=n;do(e.x<s.x||e.x===s.x&&e.y<s.y)&&(s=e),e=e.next;while(e!==n);return s}function Ru(n,e,s,u,f,y,v,S){return(f-v)*(e-S)>=(n-v)*(y-S)&&(n-v)*(u-S)>=(s-v)*(e-S)&&(s-v)*(y-S)>=(f-v)*(u-S)}function Up(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!(function(s,u){let f=s;do{if(f.i!==s.i&&f.next.i!==s.i&&f.i!==u.i&&f.next.i!==u.i&&Ya(f,f.next,s,u))return!0;f=f.next}while(f!==s);return!1})(n,e)&&(oc(n,e)&&oc(e,n)&&(function(s,u){let f=s,y=!1;const v=(s.x+u.x)/2,S=(s.y+u.y)/2;do f.y>S!=f.next.y>S&&f.next.y!==f.y&&v<(f.next.x-f.x)*(S-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next;while(f!==s);return y})(n,e)&&(On(n.prev,n,e.prev)||On(n,e.prev,e))||Qn(n,e)&&On(n.prev,n,n.next)>0&&On(e.prev,e,e.next)>0)}function On(n,e,s){return(e.y-n.y)*(s.x-e.x)-(e.x-n.x)*(s.y-e.y)}function Qn(n,e){return n.x===e.x&&n.y===e.y}function Ya(n,e,s,u){const f=Wc(On(n,e,s)),y=Wc(On(n,e,u)),v=Wc(On(s,u,n)),S=Wc(On(s,u,e));return f!==y&&v!==S||!(f!==0||!Kc(n,s,e))||!(y!==0||!Kc(n,u,e))||!(v!==0||!Kc(s,n,u))||!(S!==0||!Kc(s,e,u))}function Kc(n,e,s){return e.x<=Math.max(n.x,s.x)&&e.x>=Math.min(n.x,s.x)&&e.y<=Math.max(n.y,s.y)&&e.y>=Math.min(n.y,s.y)}function Wc(n){return n>0?1:n<0?-1:0}function oc(n,e){return On(n.prev,n,n.next)<0?On(n,e,n.next)>=0&&On(n,n.prev,e)>=0:On(n,e,n.prev)<0||On(n,n.next,e)<0}function zf(n,e){const s=cc(n.i,n.x,n.y),u=cc(e.i,e.x,e.y),f=n.next,y=e.prev;return n.next=e,e.prev=n,s.next=f,f.prev=s,u.next=s,s.prev=u,y.next=u,u.prev=y,u}function lc(n,e,s,u){const f=cc(n,e,s);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function uc(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function cc(n,e,s){return{i:n,x:e,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Bh(n,e,s){const u=s.patternDependencies;let f=!1;for(const y of e){const v=y.paint.get(`${n}-pattern`);v.isConstant()||(f=!0);const S=v.constantOr(null);S&&(f=!0,u[S.to]=!0,u[S.from]=!0)}return f}function Cf(n,e,s,u,f){const y=f.patternDependencies;for(const v of e){const S=v.paint.get(`${n}-pattern`).value;if(S.kind!=="constant"){let E=S.evaluate({zoom:u-1},s,{},f.availableImages),D=S.evaluate({zoom:u},s,{},f.availableImages),R=S.evaluate({zoom:u+1},s,{},f.availableImages);E=E&&E.name?E.name:E,D=D&&D.name?D.name:D,R=R&&R.name?R.name:R,y[E]=!0,y[D]=!0,y[R]=!0,s.patterns[v.id]={min:E,mid:D,max:R}}}return s}class hc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new cr,this.indexArray=new zs,this.indexArray2=new Xn,this.programConfigurations=new iu(e.layers,e.zoom),this.segments=new di,this.segments2=new di,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(e,s,u){this.hasPattern=Bh("fill",this.layers,s);const f=this.layers[0].layout.get("fill-sort-key"),y=!f.isConstant(),v=[];for(const{feature:S,id:E,index:D,sourceLayerIndex:R}of e){const F=this.layers[0]._featureFilter.needGeometry,q=au(S,F);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),q,u))continue;const X=y?f.evaluate(q,{},u,s.availableImages):void 0,K={id:E,properties:S.properties,type:S.type,sourceLayerIndex:R,index:D,geometry:F?q.geometry:nu(S),patterns:{},sortKey:X};v.push(K)}y&&v.sort(((S,E)=>S.sortKey-E.sortKey));for(const S of v){const{geometry:E,index:D,sourceLayerIndex:R}=S;if(this.hasPattern){const F=Cf("fill",this.layers,S,this.zoom,s);this.patternFeatures.push(F)}else this.addFeature(S,E,D,u,{});s.featureIndex.insert(e[D].feature,E,D,R,this.index)}}update(e,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,u)}addFeatures(e,s,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,s,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ef),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,s,u,f,y){for(const v of dl(s,500)){let S=0;for(const X of v)S+=X.length;const E=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),D=E.vertexLength,R=[],F=[];for(const X of v){if(X.length===0)continue;X!==v[0]&&F.push(R.length/2);const K=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),W=K.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(W+X.length-1,W),R.push(X[0].x),R.push(X[0].y);for(let st=1;st<X.length;st++)this.layoutVertexArray.emplaceBack(X[st].x,X[st].y),this.indexArray2.emplaceBack(W+st-1,W+st),R.push(X[st].x),R.push(X[st].y);K.vertexLength+=X.length,K.primitiveLength+=X.length}const q=Mf(R,F);for(let X=0;X<q.length;X+=3)this.indexArray.emplaceBack(D+q[X],D+q[X+1],D+q[X+2]);E.vertexLength+=S,E.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,y,f)}}let Nh,Lf;Qt("FillBucket",hc,{omit:["layers","patternFeatures"]});var Fd={get paint(){return Lf=Lf||new _({"fill-antialias":new Ee(Nt.paint_fill["fill-antialias"]),"fill-opacity":new Oe(Nt.paint_fill["fill-opacity"]),"fill-color":new Oe(Nt.paint_fill["fill-color"]),"fill-outline-color":new Oe(Nt.paint_fill["fill-outline-color"]),"fill-translate":new Ee(Nt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ee(Nt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Bo(Nt.paint_fill["fill-pattern"])})},get layout(){return Nh=Nh||new _({"fill-sort-key":new Oe(Nt.layout_fill["fill-sort-key"])})}};class Ud extends o{constructor(e){super(e,Fd)}recalculate(e,s){super.recalculate(e,s);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new hc(e)}queryRadius(){return Lh(this.paint.get("fill-translate"))}queryIntersectsFeature(e,s,u,f,y,v,S){return pf(qc(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,S),f)}isTileClipped(){return!0}}const If=T([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Pf=T([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Df}=If;var Cl={},kf=Et,Jc=ou;function ou(n,e,s,u,f){this.properties={},this.extent=s,this.type=0,this._pbf=n,this._geometry=-1,this._keys=u,this._values=f,n.readFields(Zd,this,e)}function Zd(n,e,s){n==1?e.id=s.readVarint():n==2?(function(u,f){for(var y=u.readVarint()+u.pos;u.pos<y;){var v=f._keys[u.readVarint()],S=f._values[u.readVarint()];f.properties[v]=S}})(s,e):n==3?e.type=s.readVarint():n==4&&(e._geometry=s.pos)}function Rf(n){for(var e,s,u=0,f=0,y=n.length,v=y-1;f<y;v=f++)u+=((s=n[v]).x-(e=n[f]).x)*(e.y+s.y);return u}ou.types=["Unknown","Point","LineString","Polygon"],ou.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,s=n.readVarint()+n.pos,u=1,f=0,y=0,v=0,S=[];n.pos<s;){if(f<=0){var E=n.readVarint();u=7&E,f=E>>3}if(f--,u===1||u===2)y+=n.readSVarint(),v+=n.readSVarint(),u===1&&(e&&S.push(e),e=[]),e.push(new kf(y,v));else{if(u!==7)throw new Error("unknown command "+u);e&&e.push(e[0].clone())}}return e&&S.push(e),S},ou.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,s=1,u=0,f=0,y=0,v=1/0,S=-1/0,E=1/0,D=-1/0;n.pos<e;){if(u<=0){var R=n.readVarint();s=7&R,u=R>>3}if(u--,s===1||s===2)(f+=n.readSVarint())<v&&(v=f),f>S&&(S=f),(y+=n.readSVarint())<E&&(E=y),y>D&&(D=y);else if(s!==7)throw new Error("unknown command "+s)}return[v,E,S,D]},ou.prototype.toGeoJSON=function(n,e,s){var u,f,y=this.extent*Math.pow(2,s),v=this.extent*n,S=this.extent*e,E=this.loadGeometry(),D=ou.types[this.type];function R(X){for(var K=0;K<X.length;K++){var W=X[K];X[K]=[360*(W.x+v)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(W.y+S)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var F=[];for(u=0;u<E.length;u++)F[u]=E[u][0];R(E=F);break;case 2:for(u=0;u<E.length;u++)R(E[u]);break;case 3:for(E=(function(X){var K=X.length;if(K<=1)return[X];for(var W,st,ut=[],Ct=0;Ct<K;Ct++){var gt=Rf(X[Ct]);gt!==0&&(st===void 0&&(st=gt<0),st===gt<0?(W&&ut.push(W),W=[X[Ct]]):W.push(X[Ct]))}return W&&ut.push(W),ut})(E),u=0;u<E.length;u++)for(f=0;f<E[u].length;f++)R(E[u][f])}E.length===1?E=E[0]:D="Multi"+D;var q={type:"Feature",geometry:{type:D,coordinates:E},properties:this.properties};return"id"in this&&(q.id=this.id),q};var jd=Jc,al=Fh;function Fh(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(Zp,this,e),this.length=this._features.length}function Zp(n,e,s){n===15?e.version=s.readVarint():n===1?e.name=s.readString():n===5?e.extent=s.readVarint():n===2?e._features.push(s.pos):n===3?e._keys.push(s.readString()):n===4&&e._values.push((function(u){for(var f=null,y=u.readVarint()+u.pos;u.pos<y;){var v=u.readVarint()>>3;f=v===1?u.readString():v===2?u.readFloat():v===3?u.readDouble():v===4?u.readVarint64():v===5?u.readVarint():v===6?u.readSVarint():v===7?u.readBoolean():null}return f})(s))}Fh.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new jd(this._pbf,e,this.extent,this._keys,this._values)};var Vd=al;function Ll(n,e,s){if(n===3){var u=new Vd(s,s.readVarint()+s.pos);u.length&&(e[u.name]=u)}}Cl.VectorTile=function(n,e){this.layers=n.readFields(Ll,{},e)},Cl.VectorTileFeature=Jc,Cl.VectorTileLayer=al;const Of=Cl.VectorTileFeature.types,Uh=Math.pow(2,13);function lu(n,e,s,u,f,y,v,S){n.emplaceBack(e,s,2*Math.floor(u*Uh)+v,f*Uh*2,y*Uh*2,Math.round(S))}class Ou{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new wl,this.centroidVertexArray=new yn,this.indexArray=new zs,this.programConfigurations=new iu(e.layers,e.zoom),this.segments=new di,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(e,s,u){this.features=[],this.hasPattern=Bh("fill-extrusion",this.layers,s);for(const{feature:f,id:y,index:v,sourceLayerIndex:S}of e){const E=this.layers[0]._featureFilter.needGeometry,D=au(f,E);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),D,u))continue;const R={id:y,sourceLayerIndex:S,index:v,geometry:E?D.geometry:nu(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Cf("fill-extrusion",this.layers,R,this.zoom,s)):this.addFeature(R,R.geometry,v,u,{}),s.featureIndex.insert(f,R.geometry,v,S,this.index,!0)}}addFeatures(e,s,u){for(const f of this.features){const{geometry:y}=f;this.addFeature(f,y,f.index,s,u)}}update(e,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Df),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Pf.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,s,u,f,y){for(const v of dl(s,500)){const S={x:0,y:0,vertexCount:0};let E=0;for(const K of v)E+=K.length;let D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const K of v){if(K.length===0||jp(K))continue;let W=0;for(let st=0;st<K.length;st++){const ut=K[st];if(st>=1){const Ct=K[st-1];if(!Bn(ut,Ct)){D.vertexLength+4>di.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const gt=ut.sub(Ct)._perp()._unit(),Tt=Ct.dist(ut);W+Tt>32768&&(W=0),lu(this.layoutVertexArray,ut.x,ut.y,gt.x,gt.y,0,0,W),lu(this.layoutVertexArray,ut.x,ut.y,gt.x,gt.y,0,1,W),S.x+=2*ut.x,S.y+=2*ut.y,S.vertexCount+=2,W+=Tt,lu(this.layoutVertexArray,Ct.x,Ct.y,gt.x,gt.y,0,0,W),lu(this.layoutVertexArray,Ct.x,Ct.y,gt.x,gt.y,0,1,W),S.x+=2*Ct.x,S.y+=2*Ct.y,S.vertexCount+=2;const Zt=D.vertexLength;this.indexArray.emplaceBack(Zt,Zt+2,Zt+1),this.indexArray.emplaceBack(Zt+1,Zt+2,Zt+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+E>di.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray)),Of[e.type]!=="Polygon")continue;const R=[],F=[],q=D.vertexLength;for(const K of v)if(K.length!==0){K!==v[0]&&F.push(R.length/2);for(let W=0;W<K.length;W++){const st=K[W];lu(this.layoutVertexArray,st.x,st.y,0,0,1,1,0),S.x+=st.x,S.y+=st.y,S.vertexCount+=1,R.push(st.x),R.push(st.y)}}const X=Mf(R,F);for(let K=0;K<X.length;K+=3)this.indexArray.emplaceBack(q+X[K],q+X[K+2],q+X[K+1]);D.primitiveLength+=X.length/3,D.vertexLength+=E;for(let K=0;K<S.vertexCount;K++){const W=Math.floor(S.x/S.vertexCount),st=Math.floor(S.y/S.vertexCount);this.centroidVertexArray.emplaceBack(W,st)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,y,f)}}function Bn(n,e){return n.x===e.x&&(n.x<0||n.x>Jn)||n.y===e.y&&(n.y<0||n.y>Jn)}function jp(n){return n.every((e=>e.x<0))||n.every((e=>e.x>Jn))||n.every((e=>e.y<0))||n.every((e=>e.y>Jn))}let qd;Qt("FillExtrusionBucket",Ou,{omit:["layers","features"]});var Gd={get paint(){return qd=qd||new _({"fill-extrusion-opacity":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Oe(Nt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Bo(Nt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Oe(Nt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Oe(Nt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ee(Nt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Qc extends o{constructor(e){super(e,Gd)}createBucket(e){return new Ou(e)}queryRadius(){return Lh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,s,u,f,y,v,S,E){const D=qc(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,S),R=this.paint.get("fill-extrusion-height").evaluate(s,u),F=this.paint.get("fill-extrusion-base").evaluate(s,u),q=(function(K,W,st,ut){const Ct=[];for(const gt of K){const Tt=[gt.x,gt.y,0,1];Gc(Tt,Tt,W),Ct.push(new It(Tt[0]/Tt[3],Tt[1]/Tt[3]))}return Ct})(D,E),X=(function(K,W,st,ut){const Ct=[],gt=[],Tt=ut[8]*W,Zt=ut[9]*W,ee=ut[10]*W,ye=ut[11]*W,Be=ut[8]*st,le=ut[9]*st,de=ut[10]*st,Ce=ut[11]*st;for(const Te of K){const be=[],Gt=[];for(const Se of Te){const Me=Se.x,Ge=Se.y,Ri=ut[0]*Me+ut[4]*Ge+ut[12],rn=ut[1]*Me+ut[5]*Ge+ut[13],Ta=ut[2]*Me+ut[6]*Ge+ut[14],ps=ut[3]*Me+ut[7]*Ge+ut[15],Na=Ta+ee,Aa=ps+ye,Is=Ri+Be,Ps=rn+le,Ds=Ta+de,Yn=ps+Ce,Ea=new It((Ri+Tt)/Aa,(rn+Zt)/Aa);Ea.z=Na/Aa,be.push(Ea);const ms=new It(Is/Yn,Ps/Yn);ms.z=Ds/Yn,Gt.push(ms)}Ct.push(be),gt.push(Gt)}return[Ct,gt]})(f,F,R,E);return(function(K,W,st){let ut=1/0;pf(st,W)&&(ut=Bf(st,W[0]));for(let Ct=0;Ct<W.length;Ct++){const gt=W[Ct],Tt=K[Ct];for(let Zt=0;Zt<gt.length-1;Zt++){const ee=gt[Zt],ye=[ee,gt[Zt+1],Tt[Zt+1],Tt[Zt],ee];df(st,ye)&&(ut=Math.min(ut,Bf(st,ye)))}}return ut!==1/0&&ut})(X[0],X[1],q)}}function oo(n,e){return n.x*e.x+n.y*e.y}function Bf(n,e){if(n.length===1){let s=0;const u=e[s++];let f;for(;!f||u.equals(f);)if(f=e[s++],!f)return 1/0;for(;s<e.length;s++){const y=e[s],v=n[0],S=f.sub(u),E=y.sub(u),D=v.sub(u),R=oo(S,S),F=oo(S,E),q=oo(E,E),X=oo(D,S),K=oo(D,E),W=R*q-F*F,st=(q*X-F*K)/W,ut=(R*K-F*X)/W,Ct=u.z*(1-st-ut)+f.z*st+y.z*ut;if(isFinite(Ct))return Ct}return 1/0}{let s=1/0;for(const u of e)s=Math.min(s,u.z);return s}}const Hd=T([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:th}=Hd,sl=T([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Xd}=sl,Nf=Cl.VectorTileFeature.types,$d=Math.cos(Math.PI/180*37.5),Zh=Math.pow(2,14)/.5;class eh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((s=>{this.gradients[s.id]={}})),this.layoutVertexArray=new Or,this.layoutVertexArray2=new va,this.indexArray=new zs,this.programConfigurations=new iu(e.layers,e.zoom),this.segments=new di,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(e,s,u){this.hasPattern=Bh("line",this.layers,s);const f=this.layers[0].layout.get("line-sort-key"),y=!f.isConstant(),v=[];for(const{feature:S,id:E,index:D,sourceLayerIndex:R}of e){const F=this.layers[0]._featureFilter.needGeometry,q=au(S,F);if(!this.layers[0]._featureFilter.filter(new fi(this.zoom),q,u))continue;const X=y?f.evaluate(q,{},u):void 0,K={id:E,properties:S.properties,type:S.type,sourceLayerIndex:R,index:D,geometry:F?q.geometry:nu(S),patterns:{},sortKey:X};v.push(K)}y&&v.sort(((S,E)=>S.sortKey-E.sortKey));for(const S of v){const{geometry:E,index:D,sourceLayerIndex:R}=S;if(this.hasPattern){const F=Cf("line",this.layers,S,this.zoom,s);this.patternFeatures.push(F)}else this.addFeature(S,E,D,u,{});s.featureIndex.insert(e[D].feature,E,D,R,this.index)}}update(e,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,u)}addFeatures(e,s,u){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,s,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Xd)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,th),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,s,u,f,y){const v=this.layers[0].layout,S=v.get("line-join").evaluate(e,{}),E=v.get("line-cap"),D=v.get("line-miter-limit"),R=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const F of s)this.addLine(F,e,S,E,D,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,y,f)}addLine(e,s,u,f,y,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ut=0;ut<e.length-1;ut++)this.totalDistance+=e[ut].dist(e[ut+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=Nf[s.type]==="Polygon";let E=e.length;for(;E>=2&&e[E-1].equals(e[E-2]);)E--;let D=0;for(;D<E-1&&e[D].equals(e[D+1]);)D++;if(E<(S?3:2))return;u==="bevel"&&(y=1.05);const R=this.overscaling<=16?15*Jn/(512*this.overscaling):0,F=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let q,X,K,W,st;this.e1=this.e2=-1,S&&(q=e[E-2],st=e[D].sub(q)._unit()._perp());for(let ut=D;ut<E;ut++){if(K=ut===E-1?S?e[D+1]:void 0:e[ut+1],K&&e[ut].equals(K))continue;st&&(W=st),q&&(X=q),q=e[ut],st=K?K.sub(q)._unit()._perp():W,W=W||st;let Ct=W.add(st);Ct.x===0&&Ct.y===0||Ct._unit();const gt=W.x*st.x+W.y*st.y,Tt=Ct.x*st.x+Ct.y*st.y,Zt=Tt!==0?1/Tt:1/0,ee=2*Math.sqrt(2-2*Tt),ye=Tt<$d&&X&&K,Be=W.x*st.y-W.y*st.x>0;if(ye&&ut>D){const Ce=q.dist(X);if(Ce>2*R){const Te=q.sub(q.sub(X)._mult(R/Ce)._round());this.updateDistance(X,Te),this.addCurrentVertex(Te,W,0,0,F),X=Te}}const le=X&&K;let de=le?u:S?"butt":f;if(le&&de==="round"&&(Zt<v?de="miter":Zt<=2&&(de="fakeround")),de==="miter"&&Zt>y&&(de="bevel"),de==="bevel"&&(Zt>2&&(de="flipbevel"),Zt<y&&(de="miter")),X&&this.updateDistance(X,q),de==="miter")Ct._mult(Zt),this.addCurrentVertex(q,Ct,0,0,F);else if(de==="flipbevel"){if(Zt>100)Ct=st.mult(-1);else{const Ce=Zt*W.add(st).mag()/W.sub(st).mag();Ct._perp()._mult(Ce*(Be?-1:1))}this.addCurrentVertex(q,Ct,0,0,F),this.addCurrentVertex(q,Ct.mult(-1),0,0,F)}else if(de==="bevel"||de==="fakeround"){const Ce=-Math.sqrt(Zt*Zt-1),Te=Be?Ce:0,be=Be?0:Ce;if(X&&this.addCurrentVertex(q,W,Te,be,F),de==="fakeround"){const Gt=Math.round(180*ee/Math.PI/20);for(let Se=1;Se<Gt;Se++){let Me=Se/Gt;if(Me!==.5){const Ri=Me-.5;Me+=Me*Ri*(Me-1)*((1.0904+gt*(gt*(3.55645-1.43519*gt)-3.2452))*Ri*Ri+(.848013+gt*(.215638*gt-1.06021)))}const Ge=st.sub(W)._mult(Me)._add(W)._unit()._mult(Be?-1:1);this.addHalfVertex(q,Ge.x,Ge.y,!1,Be,0,F)}}K&&this.addCurrentVertex(q,st,-Te,-be,F)}else if(de==="butt")this.addCurrentVertex(q,Ct,0,0,F);else if(de==="square"){const Ce=X?1:-1;this.addCurrentVertex(q,Ct,Ce,Ce,F)}else de==="round"&&(X&&(this.addCurrentVertex(q,W,0,0,F),this.addCurrentVertex(q,W,1,1,F,!0)),K&&(this.addCurrentVertex(q,st,-1,-1,F,!0),this.addCurrentVertex(q,st,0,0,F)));if(ye&&ut<E-1){const Ce=q.dist(K);if(Ce>2*R){const Te=q.add(K.sub(q)._mult(R/Ce)._round());this.updateDistance(q,Te),this.addCurrentVertex(Te,st,0,0,F),q=Te}}}}addCurrentVertex(e,s,u,f,y,v=!1){const S=s.y*f-s.x,E=-s.y-s.x*f;this.addHalfVertex(e,s.x+s.y*u,s.y-s.x*u,v,!1,u,y),this.addHalfVertex(e,S,E,v,!0,-f,y),this.distance>Zh/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,s,u,f,y,v))}addHalfVertex({x:e,y:s},u,f,y,v,S,E){const D=.5*(this.lineClips?this.scaledDistance*(Zh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(y?1:0),(s<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(S===0?0:S<0?-1:1)|(63&D)<<2,D>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const R=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),E.primitiveLength++),v?this.e2=R:this.e1=R}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,s){this.distance+=e.dist(s),this.updateScaledDistance()}}let ih,Ff;Qt("LineBucket",eh,{omit:["layers","patternFeatures"]});var rl={get paint(){return Ff=Ff||new _({"line-opacity":new Oe(Nt.paint_line["line-opacity"]),"line-color":new Oe(Nt.paint_line["line-color"]),"line-translate":new Ee(Nt.paint_line["line-translate"]),"line-translate-anchor":new Ee(Nt.paint_line["line-translate-anchor"]),"line-width":new Oe(Nt.paint_line["line-width"]),"line-gap-width":new Oe(Nt.paint_line["line-gap-width"]),"line-offset":new Oe(Nt.paint_line["line-offset"]),"line-blur":new Oe(Nt.paint_line["line-blur"]),"line-dasharray":new No(Nt.paint_line["line-dasharray"]),"line-pattern":new Bo(Nt.paint_line["line-pattern"]),"line-gradient":new Fc(Nt.paint_line["line-gradient"])})},get layout(){return ih=ih||new _({"line-cap":new Ee(Nt.layout_line["line-cap"]),"line-join":new Oe(Nt.layout_line["line-join"]),"line-miter-limit":new Ee(Nt.layout_line["line-miter-limit"]),"line-round-limit":new Ee(Nt.layout_line["line-round-limit"]),"line-sort-key":new Oe(Nt.layout_line["line-sort-key"])})}};class ba extends Oe{possiblyEvaluate(e,s){return s=new fi(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(e,s)}evaluate(e,s,u,f){return s=Xe({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(e,s,u,f)}}let fc;class Yd extends o{constructor(e){super(e,rl),this.gradientVersion=0,fc||(fc=new ba(rl.paint.properties["line-width"].specification),fc.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!(function(u){return u._styleExpression!==void 0})(s)&&s._styleExpression.expression instanceof Mr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,s){super.recalculate(e,s),this.paint._values["line-floorwidth"]=fc.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new eh(e)}queryRadius(e){const s=e,u=Oa(Pu("line-width",this,s),Pu("line-gap-width",this,s)),f=Pu("line-offset",this,s);return u/2+Math.abs(f)+Lh(this.paint.get("line-translate"))}queryIntersectsFeature(e,s,u,f,y,v,S){const E=qc(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,S),D=S/2*Oa(this.paint.get("line-width").evaluate(s,u),this.paint.get("line-gap-width").evaluate(s,u)),R=this.paint.get("line-offset").evaluate(s,u);return R&&(f=(function(F,q){const X=[];for(let K=0;K<F.length;K++){const W=F[K],st=[];for(let ut=0;ut<W.length;ut++){const Ct=W[ut-1],gt=W[ut],Tt=W[ut+1],Zt=ut===0?new It(0,0):gt.sub(Ct)._unit()._perp(),ee=ut===W.length-1?new It(0,0):Tt.sub(gt)._unit()._perp(),ye=Zt._add(ee)._unit(),Be=ye.x*ee.x+ye.y*ee.y;Be!==0&&ye._mult(1/Be),st.push(ye._mult(q)._add(gt))}X.push(st)}return X})(f,R*S)),(function(F,q,X){for(let K=0;K<q.length;K++){const W=q[K];if(F.length>=3){for(let st=0;st<W.length;st++)if(Ml(F,W[st]))return!0}if(Ed(F,W,X))return!0}return!1})(E,f,D)}isTileClipped(){return!0}}function Oa(n,e){return e>0?e+2*n:n}const Vp=T([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Kd=T([{name:"a_projected_pos",components:3,type:"Float32"}],4);T([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Wd=T([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);T([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Nn=T([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),dr=T([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Il(n,e,s){return n.sections.forEach((u=>{u.text=(function(f,y,v){const S=y.layout.get("text-transform").evaluate(v,{});return S==="uppercase"?f=f.toLocaleUpperCase():S==="lowercase"&&(f=f.toLocaleLowerCase()),pa.applyArabicShaping&&(f=pa.applyArabicShaping(f)),f})(u.text,e,s)})),n}T([{name:"triangle",components:3,type:"Uint16"}]),T([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),T([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),T([{type:"Float32",name:"offsetX"}]),T([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),T([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const dc={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var la=24,Uf=pi,Jd=function(n,e,s,u,f){var y,v,S=8*f-u-1,E=(1<<S)-1,D=E>>1,R=-7,F=f-1,q=-1,X=n[e+F];for(F+=q,y=X&(1<<-R)-1,X>>=-R,R+=S;R>0;y=256*y+n[e+F],F+=q,R-=8);for(v=y&(1<<-R)-1,y>>=-R,R+=u;R>0;v=256*v+n[e+F],F+=q,R-=8);if(y===0)y=1-D;else{if(y===E)return v?NaN:1/0*(X?-1:1);v+=Math.pow(2,u),y-=D}return(X?-1:1)*v*Math.pow(2,y-u)},nh=function(n,e,s,u,f,y){var v,S,E,D=8*y-f-1,R=(1<<D)-1,F=R>>1,q=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=0,K=1,W=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(S=isNaN(e)?1:0,v=R):(v=Math.floor(Math.log(e)/Math.LN2),e*(E=Math.pow(2,-v))<1&&(v--,E*=2),(e+=v+F>=1?q/E:q*Math.pow(2,1-F))*E>=2&&(v++,E/=2),v+F>=R?(S=0,v=R):v+F>=1?(S=(e*E-1)*Math.pow(2,f),v+=F):(S=e*Math.pow(2,F-1)*Math.pow(2,f),v=0));f>=8;n[s+X]=255&S,X+=K,S/=256,f-=8);for(v=v<<f|S,D+=f;D>0;n[s+X]=255&v,X+=K,v/=256,D-=8);n[s+X-K]|=128*W};function pi(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}pi.Varint=0,pi.Fixed64=1,pi.Bytes=2,pi.Fixed32=5;var Nr=4294967296,Zf=1/Nr,Gs=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function ol(n){return n.type===pi.Bytes?n.readVarint()+n.pos:n.pos+1}function pr(n,e,s){return s?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function uu(n,e,s){var u=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));s.realloc(u);for(var f=s.pos-1;f>=n;f--)s.buf[f+u]=s.buf[f]}function Pl(n,e){for(var s=0;s<n.length;s++)e.writeVarint(n[s])}function jf(n,e){for(var s=0;s<n.length;s++)e.writeSVarint(n[s])}function Vf(n,e){for(var s=0;s<n.length;s++)e.writeFloat(n[s])}function Uo(n,e){for(var s=0;s<n.length;s++)e.writeDouble(n[s])}function Qd(n,e){for(var s=0;s<n.length;s++)e.writeBoolean(n[s])}function pc(n,e){for(var s=0;s<n.length;s++)e.writeFixed32(n[s])}function ah(n,e){for(var s=0;s<n.length;s++)e.writeSFixed32(n[s])}function sh(n,e){for(var s=0;s<n.length;s++)e.writeFixed64(n[s])}function mc(n,e){for(var s=0;s<n.length;s++)e.writeSFixed64(n[s])}function rh(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function Bu(n,e,s){n[s]=e,n[s+1]=e>>>8,n[s+2]=e>>>16,n[s+3]=e>>>24}function _c(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}pi.prototype={destroy:function(){this.buf=null},readFields:function(n,e,s){for(s=s||this.length;this.pos<s;){var u=this.readVarint(),f=u>>3,y=this.pos;this.type=7&u,n(f,e,this),this.pos===y&&this.skip(u)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=rh(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=_c(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=rh(this.buf,this.pos)+rh(this.buf,this.pos+4)*Nr;return this.pos+=8,n},readSFixed64:function(){var n=rh(this.buf,this.pos)+_c(this.buf,this.pos+4)*Nr;return this.pos+=8,n},readFloat:function(){var n=Jd(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=Jd(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,s,u=this.buf;return e=127&(s=u[this.pos++]),s<128?e:(e|=(127&(s=u[this.pos++]))<<7,s<128?e:(e|=(127&(s=u[this.pos++]))<<14,s<128?e:(e|=(127&(s=u[this.pos++]))<<21,s<128?e:(function(f,y,v){var S,E,D=v.buf;if(S=(112&(E=D[v.pos++]))>>4,E<128||(S|=(127&(E=D[v.pos++]))<<3,E<128)||(S|=(127&(E=D[v.pos++]))<<10,E<128)||(S|=(127&(E=D[v.pos++]))<<17,E<128)||(S|=(127&(E=D[v.pos++]))<<24,E<128)||(S|=(1&(E=D[v.pos++]))<<31,E<128))return pr(f,S,y);throw new Error("Expected varint not more than 10 bytes")})(e|=(15&(s=u[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&Gs?(function(s,u,f){return Gs.decode(s.subarray(u,f))})(this.buf,e,n):(function(s,u,f){for(var y="",v=u;v<f;){var S,E,D,R=s[v],F=null,q=R>239?4:R>223?3:R>191?2:1;if(v+q>f)break;q===1?R<128&&(F=R):q===2?(192&(S=s[v+1]))==128&&(F=(31&R)<<6|63&S)<=127&&(F=null):q===3?(E=s[v+2],(192&(S=s[v+1]))==128&&(192&E)==128&&((F=(15&R)<<12|(63&S)<<6|63&E)<=2047||F>=55296&&F<=57343)&&(F=null)):q===4&&(E=s[v+2],D=s[v+3],(192&(S=s[v+1]))==128&&(192&E)==128&&(192&D)==128&&((F=(15&R)<<18|(63&S)<<12|(63&E)<<6|63&D)<=65535||F>=1114112)&&(F=null)),F===null?(F=65533,q=1):F>65535&&(F-=65536,y+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),y+=String.fromCharCode(F),v+=q}return y})(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==pi.Bytes)return n.push(this.readVarint(e));var s=ol(this);for(n=n||[];this.pos<s;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==pi.Bytes)return n.push(this.readSVarint());var e=ol(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==pi.Bytes)return n.push(this.readBoolean());var e=ol(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==pi.Bytes)return n.push(this.readFloat());var e=ol(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==pi.Bytes)return n.push(this.readDouble());var e=ol(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==pi.Bytes)return n.push(this.readFixed32());var e=ol(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==pi.Bytes)return n.push(this.readSFixed32());var e=ol(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==pi.Bytes)return n.push(this.readFixed64());var e=ol(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==pi.Bytes)return n.push(this.readSFixed64());var e=ol(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===pi.Varint)for(;this.buf[this.pos++]>127;);else if(e===pi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===pi.Fixed32)this.pos+=4;else{if(e!==pi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var s=new Uint8Array(e);s.set(this.buf),this.buf=s,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Bu(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Bu(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Bu(this.buf,-1&n,this.pos),Bu(this.buf,Math.floor(n*Zf),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Bu(this.buf,-1&n,this.pos),Bu(this.buf,Math.floor(n*Zf),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?(function(e,s){var u,f;if(e>=0?(u=e%4294967296|0,f=e/4294967296|0):(f=~(-e/4294967296),4294967295^(u=~(-e%4294967296))?u=u+1|0:(u=0,f=f+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),(function(y,v,S){S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,y>>>=7,S.buf[S.pos++]=127&y|128,S.buf[S.pos]=127&(y>>>=7)})(u,0,s),(function(y,v){var S=(7&y)<<4;v.buf[v.pos++]|=S|((y>>>=3)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y)))))})(f,s)})(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=(function(u,f,y){for(var v,S,E=0;E<f.length;E++){if((v=f.charCodeAt(E))>55295&&v<57344){if(!S){v>56319||E+1===f.length?(u[y++]=239,u[y++]=191,u[y++]=189):S=v;continue}if(v<56320){u[y++]=239,u[y++]=191,u[y++]=189,S=v;continue}v=S-55296<<10|v-56320|65536,S=null}else S&&(u[y++]=239,u[y++]=191,u[y++]=189,S=null);v<128?u[y++]=v:(v<2048?u[y++]=v>>6|192:(v<65536?u[y++]=v>>12|224:(u[y++]=v>>18|240,u[y++]=v>>12&63|128),u[y++]=v>>6&63|128),u[y++]=63&v|128)}return y})(this.buf,n,this.pos);var s=this.pos-e;s>=128&&uu(e,s,this),this.pos=e-1,this.writeVarint(s),this.pos+=s},writeFloat:function(n){this.realloc(4),nh(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),nh(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var s=0;s<e;s++)this.buf[this.pos++]=n[s]},writeRawMessage:function(n,e){this.pos++;var s=this.pos;n(e,this);var u=this.pos-s;u>=128&&uu(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u},writeMessage:function(n,e,s){this.writeTag(n,pi.Bytes),this.writeRawMessage(e,s)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,Pl,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,jf,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,Qd,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,Vf,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,Uo,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,pc,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,ah,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,sh,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,mc,e)},writeBytesField:function(n,e){this.writeTag(n,pi.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,pi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,pi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,pi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,pi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,pi.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,pi.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,pi.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,pi.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,pi.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,!!e)}};var jh=bt(Uf);const gc=3;function tp(n,e,s){n===1&&s.readMessage(qp,e)}function qp(n,e,s){if(n===3){const{id:u,bitmap:f,width:y,height:v,left:S,top:E,advance:D}=s.readMessage(Gp,{});e.push({id:u,bitmap:new Hc({width:y+2*gc,height:v+2*gc},f),metrics:{width:y,height:v,left:S,top:E,advance:D}})}}function Gp(n,e,s){n===1?e.id=s.readVarint():n===2?e.bitmap=s.readBytes():n===3?e.width=s.readVarint():n===4?e.height=s.readVarint():n===5?e.left=s.readSVarint():n===6?e.top=s.readSVarint():n===7&&(e.advance=s.readVarint())}const en=gc;function En(n){let e=0,s=0;for(const v of n)e+=v.w*v.h,s=Math.max(s,v.w);n.sort(((v,S)=>S.h-v.h));const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let f=0,y=0;for(const v of n)for(let S=u.length-1;S>=0;S--){const E=u[S];if(!(v.w>E.w||v.h>E.h)){if(v.x=E.x,v.y=E.y,y=Math.max(y,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===E.w&&v.h===E.h){const D=u.pop();S<u.length&&(u[S]=D)}else v.h===E.h?(E.x+=v.w,E.w-=v.w):v.w===E.w?(E.y+=v.h,E.h-=v.h):(u.push({x:E.x+v.w,y:E.y,w:E.w-v.w,h:v.h}),E.y+=v.h,E.h-=v.h);break}}return{w:f,h:y,fill:e/(f*y)||0}}const ti=1;class ki{constructor(e,{pixelRatio:s,version:u,stretchX:f,stretchY:y,content:v,textFitWidth:S,textFitHeight:E}){this.paddedRect=e,this.pixelRatio=s,this.stretchX=f,this.stretchY=y,this.content=v,this.version=u,this.textFitWidth=S,this.textFitHeight=E}get tl(){return[this.paddedRect.x+ti,this.paddedRect.y+ti]}get br(){return[this.paddedRect.x+this.paddedRect.w-ti,this.paddedRect.y+this.paddedRect.h-ti]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ti)/this.pixelRatio,(this.paddedRect.h-2*ti)/this.pixelRatio]}}class hn{constructor(e,s){const u={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(e,u,y),this.addImages(s,f,y);const{w:v,h:S}=En(y),E=new fr({width:v||1,height:S||1});for(const D in e){const R=e[D],F=u[D].paddedRect;fr.copy(R.data,E,{x:0,y:0},{x:F.x+ti,y:F.y+ti},R.data)}for(const D in s){const R=s[D],F=f[D].paddedRect,q=F.x+ti,X=F.y+ti,K=R.data.width,W=R.data.height;fr.copy(R.data,E,{x:0,y:0},{x:q,y:X},R.data),fr.copy(R.data,E,{x:0,y:W-1},{x:q,y:X-1},{width:K,height:1}),fr.copy(R.data,E,{x:0,y:0},{x:q,y:X+W},{width:K,height:1}),fr.copy(R.data,E,{x:K-1,y:0},{x:q-1,y:X},{width:1,height:W}),fr.copy(R.data,E,{x:0,y:0},{x:q+K,y:X},{width:1,height:W})}this.image=E,this.iconPositions=u,this.patternPositions=f}addImages(e,s,u){for(const f in e){const y=e[f],v={x:0,y:0,w:y.data.width+2*ti,h:y.data.height+2*ti};u.push(v),s[f]=new ki(v,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(e,s){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in e.updatedImages)this.patchUpdatedImage(this.iconPositions[u],e.getImage(u),s),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u),s)}patchUpdatedImage(e,s,u){if(!e||!s||e.version===s.version)return;e.version=s.version;const[f,y]=e.tl;u.update(s.data,void 0,{x:f,y})}}var wa;Qt("ImagePosition",ki),Qt("ImageAtlas",hn),O.ah=void 0,(wa=O.ah||(O.ah={}))[wa.none=0]="none",wa[wa.horizontal=1]="horizontal",wa[wa.vertical=2]="vertical",wa[wa.horizontalOnly=3]="horizontalOnly";const lo=-17;class ll{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,s){const u=new ll;return u.scale=e||1,u.fontStack=s,u}static forImage(e){const s=new ll;return s.imageName=e,s}}class cu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,s){const u=new cu;for(let f=0;f<e.sections.length;f++){const y=e.sections[f];y.image?u.addImageSection(y):u.addTextSection(y,s)}return u}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=(function(e){let s="";for(let u=0;u<e.length;u++){const f=e.charCodeAt(u+1)||null,y=e.charCodeAt(u-1)||null;s+=f&&so(f)&&!dc[e[u+1]]||y&&so(y)&&!dc[e[u-1]]||!dc[e[u]]?e[u]:dc[e[u]]}return s})(this.text)}trim(){let e=0;for(let u=0;u<this.text.length&&Fn[this.text.charCodeAt(u)];u++)e++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=e&&Fn[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(e,s),this.sectionIndex=this.sectionIndex.slice(e,s)}substring(e,s){const u=new cu;return u.text=this.text.substring(e,s),u.sectionIndex=this.sectionIndex.slice(e,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,s)=>Math.max(e,this.sections[s].scale)),0)}addTextSection(e,s){this.text+=e.text,this.sections.push(ll.forText(e.scale,e.fontStack||s));const u=this.sections.length-1;for(let f=0;f<e.text.length;++f)this.sectionIndex.push(u)}addImageSection(e){const s=e.image?e.image.name:"";if(s.length===0)return void Sn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(ll.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Sn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function uo(n,e,s,u,f,y,v,S,E,D,R,F,q,X,K){const W=cu.fromFeature(n,f);let st;F===O.ah.vertical&&W.verticalizePunctuation();const{processBidirectionalText:ut,processStyledBidirectionalText:Ct}=pa;if(ut&&W.sections.length===1){st=[];const Zt=ut(W.toString(),oh(W,D,y,e,u,X));for(const ee of Zt){const ye=new cu;ye.text=ee,ye.sections=W.sections;for(let Be=0;Be<ee.length;Be++)ye.sectionIndex.push(0);st.push(ye)}}else if(Ct){st=[];const Zt=Ct(W.text,W.sectionIndex,oh(W,D,y,e,u,X));for(const ee of Zt){const ye=new cu;ye.text=ee[0],ye.sectionIndex=ee[1],ye.sections=W.sections,st.push(ye)}}else st=(function(Zt,ee){const ye=[],Be=Zt.text;let le=0;for(const de of ee)ye.push(Zt.substring(le,de)),le=de;return le<Be.length&&ye.push(Zt.substring(le,Be.length)),ye})(W,oh(W,D,y,e,u,X));const gt=[],Tt={positionedLines:gt,text:W.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:F,iconsInText:!1,verticalizable:!1};return(function(Zt,ee,ye,Be,le,de,Ce,Te,be,Gt,Se,Me){let Ge=0,Ri=lo,rn=0,Ta=0;const ps=Te==="right"?1:Te==="left"?0:.5;let Na=0;for(const Yn of le){Yn.trim();const Ea=Yn.getMaxScale(),ms=(Ea-1)*la,Fa={positionedGlyphs:[],lineOffset:0};Zt.positionedLines[Na]=Fa;const _a=Fa.positionedGlyphs;let ua=0;if(!Yn.length()){Ri+=de,++Na;continue}for(let Xs=0;Xs<Yn.length();Xs++){const Ai=Yn.getSection(Xs),Ji=Yn.getSectionIndex(Xs),bn=Yn.getCharCode(Xs);let _s=0,Ln=null,gu=null,Zr=null,jo=la;const jr=!(be===O.ah.horizontal||!Se&&!ao(bn)||Se&&(Fn[bn]||(Aa=bn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Aa)))));if(Ai.imageName){const Vr=Be[Ai.imageName];if(!Vr)continue;Zr=Ai.imageName,Zt.iconsInText=Zt.iconsInText||!0,gu=Vr.paddedRect;const Ma=Vr.displaySize;Ai.scale=Ai.scale*la/Me,Ln={width:Ma[0],height:Ma[1],left:ti,top:-en,advance:jr?Ma[1]:Ma[0]},_s=ms+(la-Ma[1]*Ai.scale),jo=Ln.advance;const kl=jr?Ma[0]*Ai.scale-la*Ea:Ma[1]*Ai.scale-la*Ea;kl>0&&kl>ua&&(ua=kl)}else{const Vr=ye[Ai.fontStack],Ma=Vr&&Vr[bn];if(Ma&&Ma.rect)gu=Ma.rect,Ln=Ma.metrics;else{const kl=ee[Ai.fontStack],qu=kl&&kl[bn];if(!qu)continue;Ln=qu.metrics}_s=(Ea-Ai.scale)*la}jr?(Zt.verticalizable=!0,_a.push({glyph:bn,imageName:Zr,x:Ge,y:Ri+_s,vertical:jr,scale:Ai.scale,fontStack:Ai.fontStack,sectionIndex:Ji,metrics:Ln,rect:gu}),Ge+=jo*Ai.scale+Gt):(_a.push({glyph:bn,imageName:Zr,x:Ge,y:Ri+_s,vertical:jr,scale:Ai.scale,fontStack:Ai.fontStack,sectionIndex:Ji,metrics:Ln,rect:gu}),Ge+=Ln.advance*Ai.scale+Gt)}_a.length!==0&&(rn=Math.max(Ge-Gt,rn),ep(_a,0,_a.length-1,ps,ua)),Ge=0;const _r=de*Ea+ua;Fa.lineOffset=Math.max(ua,ms),Ri+=_r,Ta=Math.max(_r,Ta),++Na}var Aa;const Is=Ri-lo,{horizontalAlign:Ps,verticalAlign:Ds}=xc(Ce);(function(Yn,Ea,ms,Fa,_a,ua,_r,Xs,Ai){const Ji=(Ea-ms)*_a;let bn=0;bn=ua!==_r?-Xs*Fa-lo:(-Fa*Ai+.5)*_r;for(const _s of Yn)for(const Ln of _s.positionedGlyphs)Ln.x+=Ji,Ln.y+=bn})(Zt.positionedLines,ps,Ps,Ds,rn,Ta,de,Is,le.length),Zt.top+=-Ds*Is,Zt.bottom=Zt.top+Is,Zt.left+=-Ps*rn,Zt.right=Zt.left+rn})(Tt,e,s,u,st,v,S,E,F,D,q,K),!(function(Zt){for(const ee of Zt)if(ee.positionedGlyphs.length!==0)return!1;return!0})(gt)&&Tt}const Fn={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hu={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Nu={40:!0};function Vh(n,e,s,u,f,y){if(e.imageName){const v=u[e.imageName];return v?v.displaySize[0]*e.scale*la/y+f:0}{const v=s[e.fontStack],S=v&&v[n];return S?S.metrics.advance*e.scale+f:0}}function mr(n,e,s,u){const f=Math.pow(n-e,2);return u?n<e?f/2:2*f:f+Math.abs(s)*s}function yc(n,e,s){let u=0;return n===10&&(u-=1e4),s&&(u+=150),n!==40&&n!==65288||(u+=50),e!==41&&e!==65289||(u+=50),u}function vc(n,e,s,u,f,y){let v=null,S=mr(e,s,f,y);for(const E of u){const D=mr(e-E.x,s,f,y)+E.badness;D<=S&&(v=E,S=D)}return{index:n,x:e,priorBreak:v,badness:S}}function Hs(n){return n?Hs(n.priorBreak).concat(n.index):[]}function oh(n,e,s,u,f,y){if(!n)return[];const v=[],S=(function(F,q,X,K,W,st){let ut=0;for(let Ct=0;Ct<F.length();Ct++){const gt=F.getSection(Ct);ut+=Vh(F.getCharCode(Ct),gt,K,W,q,st)}return ut/Math.max(1,Math.ceil(ut/X))})(n,e,s,u,f,y),E=n.text.indexOf("")>=0;let D=0;for(let F=0;F<n.length();F++){const q=n.getSection(F),X=n.getCharCode(F);if(Fn[X]||(D+=Vh(X,q,u,f,e,y)),F<n.length()-1){const K=!((R=X)<11904)&&(!!ei["CJK Compatibility Forms"](R)||!!ei["CJK Compatibility"](R)||!!ei["CJK Strokes"](R)||!!ei["CJK Symbols and Punctuation"](R)||!!ei["Enclosed CJK Letters and Months"](R)||!!ei["Halfwidth and Fullwidth Forms"](R)||!!ei["Ideographic Description Characters"](R)||!!ei["Vertical Forms"](R)||or.test(String.fromCodePoint(R)));(hu[X]||K||q.imageName||F!==n.length()-2&&Nu[n.getCharCode(F+1)])&&v.push(vc(F+1,D,S,v,yc(X,n.getCharCode(F+1),K&&E),!1))}}var R;return Hs(vc(n.length(),D,S,v,0,!0))}function xc(n){let e=.5,s=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:e,verticalAlign:s}}function ep(n,e,s,u,f){if(!u&&!f)return;const y=n[s],v=(n[s].x+y.metrics.advance*y.scale)*u;for(let S=e;S<=s;S++)n[S].x-=v,n[S].y+=f}function qh(n,e,s){const{horizontalAlign:u,verticalAlign:f}=xc(s),y=e[0]-n.displaySize[0]*u,v=e[1]-n.displaySize[1]*f;return{image:n,top:v,bottom:v+n.displaySize[1],left:y,right:y+n.displaySize[0]}}function lh(n){var e,s;let u=n.left,f=n.top,y=n.right-u,v=n.bottom-f;const S=(e=n.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",E=(s=n.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",D=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(E==="proportional"){if(S==="stretchOnly"&&y/v<D||S==="proportional"){const R=Math.ceil(v*D);u*=R/y,y=R}}else if(S==="proportional"&&E==="stretchOnly"&&D!==0&&y/v>D){const R=Math.ceil(y/D);f*=R/v,v=R}return{x1:u,y1:f,x2:u+y,y2:f+v}}function Dl(n,e,s,u,f,y){const v=n.image;let S;if(v.content){const st=v.content,ut=v.pixelRatio||1;S=[st[0]/ut,st[1]/ut,v.displaySize[0]-st[2]/ut,v.displaySize[1]-st[3]/ut]}const E=e.left*y,D=e.right*y;let R,F,q,X;s==="width"||s==="both"?(X=f[0]+E-u[3],F=f[0]+D+u[1]):(X=f[0]+(E+D-v.displaySize[0])/2,F=X+v.displaySize[0]);const K=e.top*y,W=e.bottom*y;return s==="height"||s==="both"?(R=f[1]+K-u[0],q=f[1]+W+u[2]):(R=f[1]+(K+W-v.displaySize[1])/2,q=R+v.displaySize[1]),{image:v,top:R,right:F,bottom:q,left:X,collisionPadding:S}}const ta=255,ds=128,Fr=ta*ds;function ul(n,e){const{expression:s}=e;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new fi(n+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:f}=s;let y=0;for(;y<u.length&&u[y]<=n;)y++;y=Math.max(0,y-1);let v=y;for(;v<u.length&&u[v]<n+1;)v++;v=Math.min(u.length-1,v);const S=u[y],E=u[v];return s.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:E,interpolationType:f}:{kind:"camera",minZoom:S,maxZoom:E,minSize:s.evaluate(new fi(S)),maxSize:s.evaluate(new fi(E)),interpolationType:f}}}function uh(n,e,s){let u="never";const f=n.get(e);return f?u=f:n.get(s)&&(u="always"),u}const qf=Cl.VectorTileFeature.types,ip=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fu(n,e,s,u,f,y,v,S,E,D,R,F,q){const X=S?Math.min(Fr,Math.round(S[0])):0,K=S?Math.min(Fr,Math.round(S[1])):0;n.emplaceBack(e,s,Math.round(32*u),Math.round(32*f),y,v,(X<<1)+(E?1:0),K,16*D,16*R,256*F,256*q)}function ch(n,e,s){n.emplaceBack(e.x,e.y,s),n.emplaceBack(e.x,e.y,s),n.emplaceBack(e.x,e.y,s),n.emplaceBack(e.x,e.y,s)}function Ur(n){for(const e of n.sections)if(tc(e.text))return!0;return!1}class Gh{constructor(e){this.layoutVertexArray=new Sl,this.indexArray=new zs,this.programConfigurations=e,this.segments=new di,this.dynamicLayoutVertexArray=new Br,this.opacityVertexArray=new $e,this.hasVisibleVertices=!1,this.placedSymbolArray=new tn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,s,u,f){this.isEmpty()||(u&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Vp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Kd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ip,!0),this.opacityVertexBuffer.itemSize=1),(u||f)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Qt("SymbolBuffers",Gh);class Cs{constructor(e,s,u){this.layoutVertexArray=new e,this.layoutAttributes=s,this.indexArray=new u,this.segments=new di,this.collisionVertexArray=new vn}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Wd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Qt("CollisionBuffers",Cs);class Fu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((v=>v.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ih([]),this.placementViewportMatrix=Ih([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ul(this.zoom,s["text-size"]),this.iconSizeData=ul(this.zoom,s["icon-size"]);const u=this.layers[0].layout,f=u.get("symbol-sort-key"),y=u.get("symbol-z-order");this.canOverlap=uh(u,"text-overlap","text-allow-overlap")!=="never"||uh(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map((v=>O.ah[v]))),this.stateDependentLayerIds=this.layers.filter((v=>v.isStateDependent())).map((v=>v.id)),this.sourceID=e.sourceID}createArrays(){this.text=new Gh(new iu(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new Gh(new iu(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new Wi,this.lineVertexArray=new ma,this.symbolInstances=new yi,this.textAnchorOffsets=new cn}calculateGlyphDependencies(e,s,u,f,y){for(let v=0;v<e.length;v++)if(s[e.charCodeAt(v)]=!0,(u||f)&&y){const S=dc[e.charAt(v)];S&&(s[S.charCodeAt(0)]=!0)}}populate(e,s,u){const f=this.layers[0],y=f.layout,v=y.get("text-font"),S=y.get("text-field"),E=y.get("icon-image"),D=(S.value.kind!=="constant"||S.value.value instanceof ja&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),R=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,F=y.get("symbol-sort-key");if(this.features=[],!D&&!R)return;const q=s.iconDependencies,X=s.glyphDependencies,K=s.availableImages,W=new fi(this.zoom);for(const{feature:st,id:ut,index:Ct,sourceLayerIndex:gt}of e){const Tt=f._featureFilter.needGeometry,Zt=au(st,Tt);if(!f._featureFilter.filter(W,Zt,u))continue;let ee,ye;if(Tt||(Zt.geometry=nu(st)),D){const le=f.getValueAndResolveTokens("text-field",Zt,u,K),de=ja.factory(le),Ce=this.hasRTLText=this.hasRTLText||Ur(de);(!Ce||pa.getRTLTextPluginStatus()==="unavailable"||Ce&&pa.isParsed())&&(ee=Il(de,f,Zt))}if(R){const le=f.getValueAndResolveTokens("icon-image",Zt,u,K);ye=le instanceof La?le:La.fromString(le)}if(!ee&&!ye)continue;const Be=this.sortFeaturesByKey?F.evaluate(Zt,{},u):void 0;if(this.features.push({id:ut,text:ee,icon:ye,index:Ct,sourceLayerIndex:gt,geometry:Zt.geometry,properties:st.properties,type:qf[st.type],sortKey:Be}),ye&&(q[ye.name]=!0),ee){const le=v.evaluate(Zt,{},u).join(","),de=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(O.ah.vertical)>=0;for(const Ce of ee.sections)if(Ce.image)q[Ce.image.name]=!0;else{const Te=Rr(ee.toString()),be=Ce.fontStack||le,Gt=X[be]=X[be]||{};this.calculateGlyphDependencies(Ce.text,Gt,de,this.allowVerticalPlacement,Te)}}}y.get("symbol-placement")==="line"&&(this.features=(function(st){const ut={},Ct={},gt=[];let Tt=0;function Zt(le){gt.push(st[le]),Tt++}function ee(le,de,Ce){const Te=Ct[le];return delete Ct[le],Ct[de]=Te,gt[Te].geometry[0].pop(),gt[Te].geometry[0]=gt[Te].geometry[0].concat(Ce[0]),Te}function ye(le,de,Ce){const Te=ut[de];return delete ut[de],ut[le]=Te,gt[Te].geometry[0].shift(),gt[Te].geometry[0]=Ce[0].concat(gt[Te].geometry[0]),Te}function Be(le,de,Ce){const Te=Ce?de[0][de[0].length-1]:de[0][0];return`${le}:${Te.x}:${Te.y}`}for(let le=0;le<st.length;le++){const de=st[le],Ce=de.geometry,Te=de.text?de.text.toString():null;if(!Te){Zt(le);continue}const be=Be(Te,Ce),Gt=Be(Te,Ce,!0);if(be in Ct&&Gt in ut&&Ct[be]!==ut[Gt]){const Se=ye(be,Gt,Ce),Me=ee(be,Gt,gt[Se].geometry);delete ut[be],delete Ct[Gt],Ct[Be(Te,gt[Me].geometry,!0)]=Me,gt[Se].geometry=null}else be in Ct?ee(be,Gt,Ce):Gt in ut?ye(be,Gt,Ce):(Zt(le),ut[be]=Tt-1,Ct[Gt]=Tt-1)}return gt.filter((le=>le.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((st,ut)=>st.sortKey-ut.sortKey))}update(e,s,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,s,this.layers,u),this.icon.programConfigurations.updatePaintArrays(e,s,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,s){const u=this.lineVertexArray.length;if(e.segment!==void 0){let f=e.dist(s[e.segment+1]),y=e.dist(s[e.segment]);const v={};for(let S=e.segment+1;S<s.length;S++)v[S]={x:s[S].x,y:s[S].y,tileUnitDistanceFromAnchor:f},S<s.length-1&&(f+=s[S+1].dist(s[S]));for(let S=e.segment||0;S>=0;S--)v[S]={x:s[S].x,y:s[S].y,tileUnitDistanceFromAnchor:y},S>0&&(y+=s[S-1].dist(s[S]));for(let S=0;S<s.length;S++){const E=v[S];this.lineVertexArray.emplaceBack(E.x,E.y,E.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(e,s,u,f,y,v,S,E,D,R,F,q){const X=e.indexArray,K=e.layoutVertexArray,W=e.segments.prepareSegment(4*s.length,K,X,this.canOverlap?v.sortKey:void 0),st=this.glyphOffsetArray.length,ut=W.vertexLength,Ct=this.allowVerticalPlacement&&S===O.ah.vertical?Math.PI/2:0,gt=v.text&&v.text.sections;for(let Tt=0;Tt<s.length;Tt++){const{tl:Zt,tr:ee,bl:ye,br:Be,tex:le,pixelOffsetTL:de,pixelOffsetBR:Ce,minFontScaleX:Te,minFontScaleY:be,glyphOffset:Gt,isSDF:Se,sectionIndex:Me}=s[Tt],Ge=W.vertexLength,Ri=Gt[1];fu(K,E.x,E.y,Zt.x,Ri+Zt.y,le.x,le.y,u,Se,de.x,de.y,Te,be),fu(K,E.x,E.y,ee.x,Ri+ee.y,le.x+le.w,le.y,u,Se,Ce.x,de.y,Te,be),fu(K,E.x,E.y,ye.x,Ri+ye.y,le.x,le.y+le.h,u,Se,de.x,Ce.y,Te,be),fu(K,E.x,E.y,Be.x,Ri+Be.y,le.x+le.w,le.y+le.h,u,Se,Ce.x,Ce.y,Te,be),ch(e.dynamicLayoutVertexArray,E,Ct),X.emplaceBack(Ge,Ge+1,Ge+2),X.emplaceBack(Ge+1,Ge+2,Ge+3),W.vertexLength+=4,W.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Gt[0]),Tt!==s.length-1&&Me===s[Tt+1].sectionIndex||e.programConfigurations.populatePaintArrays(K.length,v,v.index,{},q,gt&&gt[Me])}e.placedSymbolArray.emplaceBack(E.x,E.y,st,this.glyphOffsetArray.length-st,ut,D,R,E.segment,u?u[0]:0,u?u[1]:0,f[0],f[1],S,0,!1,0,F)}_addCollisionDebugVertex(e,s,u,f,y,v){return s.emplaceBack(0,0),e.emplaceBack(u.x,u.y,f,y,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(e,s,u,f,y,v,S){const E=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),D=E.vertexLength,R=y.layoutVertexArray,F=y.collisionVertexArray,q=S.anchorX,X=S.anchorY;this._addCollisionDebugVertex(R,F,v,q,X,new It(e,s)),this._addCollisionDebugVertex(R,F,v,q,X,new It(u,s)),this._addCollisionDebugVertex(R,F,v,q,X,new It(u,f)),this._addCollisionDebugVertex(R,F,v,q,X,new It(e,f)),E.vertexLength+=4;const K=y.indexArray;K.emplaceBack(D,D+1),K.emplaceBack(D+1,D+2),K.emplaceBack(D+2,D+3),K.emplaceBack(D+3,D),E.primitiveLength+=4}addDebugCollisionBoxes(e,s,u,f){for(let y=e;y<s;y++){const v=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,f?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cs(Ti,Nn.members,Xn),this.iconCollisionBox=new Cs(Ti,Nn.members,Xn);for(let e=0;e<this.symbolInstances.length;e++){const s=this.symbolInstances.get(e);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(e,s,u,f,y,v,S,E,D){const R={};for(let F=s;F<u;F++){const q=e.get(F);R.textBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},R.textFeatureIndex=q.featureIndex;break}for(let F=f;F<y;F++){const q=e.get(F);R.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},R.verticalTextFeatureIndex=q.featureIndex;break}for(let F=v;F<S;F++){const q=e.get(F);R.iconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},R.iconFeatureIndex=q.featureIndex;break}for(let F=E;F<D;F++){const q=e.get(F);R.verticalIconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},R.verticalIconFeatureIndex=q.featureIndex;break}return R}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,s){const u=e.placedSymbolArray.get(s),f=u.vertexStartIndex+4*u.numGlyphs;for(let y=u.vertexStartIndex;y<f;y+=4)e.indexArray.emplaceBack(y,y+1,y+2),e.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(e),u=Math.cos(e),f=[],y=[],v=[];for(let S=0;S<this.symbolInstances.length;++S){v.push(S);const E=this.symbolInstances.get(S);f.push(0|Math.round(s*E.anchorX+u*E.anchorY)),y.push(E.featureIndex)}return v.sort(((S,E)=>f[S]-f[E]||y[E]-y[S])),v}addToSortKeyRanges(e,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach(((f,y,v)=>{f>=0&&v.indexOf(f)===y&&this.addIndicesForPlacedSymbol(this.text,f)})),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Gf,np;Qt("SymbolBucket",Fu,{omit:["layers","collisionBoxArray","features","compareText"]}),Fu.MAX_GLYPHS=65535,Fu.addDynamicAttributes=ch;var cl={get paint(){return np=np||new _({"icon-opacity":new Oe(Nt.paint_symbol["icon-opacity"]),"icon-color":new Oe(Nt.paint_symbol["icon-color"]),"icon-halo-color":new Oe(Nt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Oe(Nt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Oe(Nt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ee(Nt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ee(Nt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Oe(Nt.paint_symbol["text-opacity"]),"text-color":new Oe(Nt.paint_symbol["text-color"],{runtimeType:un,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Oe(Nt.paint_symbol["text-halo-color"]),"text-halo-width":new Oe(Nt.paint_symbol["text-halo-width"]),"text-halo-blur":new Oe(Nt.paint_symbol["text-halo-blur"]),"text-translate":new Ee(Nt.paint_symbol["text-translate"]),"text-translate-anchor":new Ee(Nt.paint_symbol["text-translate-anchor"])})},get layout(){return Gf=Gf||new _({"symbol-placement":new Ee(Nt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ee(Nt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ee(Nt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Oe(Nt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ee(Nt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ee(Nt.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ee(Nt.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ee(Nt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ee(Nt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ee(Nt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Oe(Nt.layout_symbol["icon-size"]),"icon-text-fit":new Ee(Nt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ee(Nt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Oe(Nt.layout_symbol["icon-image"]),"icon-rotate":new Oe(Nt.layout_symbol["icon-rotate"]),"icon-padding":new Oe(Nt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ee(Nt.layout_symbol["icon-keep-upright"]),"icon-offset":new Oe(Nt.layout_symbol["icon-offset"]),"icon-anchor":new Oe(Nt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ee(Nt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ee(Nt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ee(Nt.layout_symbol["text-rotation-alignment"]),"text-field":new Oe(Nt.layout_symbol["text-field"]),"text-font":new Oe(Nt.layout_symbol["text-font"]),"text-size":new Oe(Nt.layout_symbol["text-size"]),"text-max-width":new Oe(Nt.layout_symbol["text-max-width"]),"text-line-height":new Ee(Nt.layout_symbol["text-line-height"]),"text-letter-spacing":new Oe(Nt.layout_symbol["text-letter-spacing"]),"text-justify":new Oe(Nt.layout_symbol["text-justify"]),"text-radial-offset":new Oe(Nt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ee(Nt.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Oe(Nt.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Oe(Nt.layout_symbol["text-anchor"]),"text-max-angle":new Ee(Nt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ee(Nt.layout_symbol["text-writing-mode"]),"text-rotate":new Oe(Nt.layout_symbol["text-rotate"]),"text-padding":new Ee(Nt.layout_symbol["text-padding"]),"text-keep-upright":new Ee(Nt.layout_symbol["text-keep-upright"]),"text-transform":new Oe(Nt.layout_symbol["text-transform"]),"text-offset":new Oe(Nt.layout_symbol["text-offset"]),"text-allow-overlap":new Ee(Nt.layout_symbol["text-allow-overlap"]),"text-overlap":new Ee(Nt.layout_symbol["text-overlap"]),"text-ignore-placement":new Ee(Nt.layout_symbol["text-ignore-placement"]),"text-optional":new Ee(Nt.layout_symbol["text-optional"])})}};class hh{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Gr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(e.formattedSection))return s.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Qt("FormatSectionOverride",hh,{omit:["defaultValue"]});class bc extends o{constructor(e){super(e,cl)}recalculate(e,s){if(super.recalculate(e,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const f=[];for(const y of u)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,s,u,f){const y=this.layout.get(e).evaluate(s,{},u,f),v=this._unevaluatedLayout._values[e];return v.isDataDriven()||Dr(v.value)||!y?y:(function(S,E){return E.replace(/{([^{}]+)}/g,((D,R)=>S&&R in S?String(S[R]):""))})(s.properties,y)}createBucket(e){return new Fu(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of cl.paint.overridableProperties){if(!bc.hasPaintOverride(this.layout,e))continue;const s=this.paint.get(e),u=new hh(s),f=new to(u,s.property.specification);let y=null;y=s.value.kind==="constant"||s.value.kind==="source"?new rs("source",f):new js("composite",f,s.value.zoomStops),this.paint._values[e]=new lr(s.property,y,s.parameters)}}_handleOverridablePaintPropertyUpdate(e,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&bc.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,s){const u=e.get("text-field"),f=cl.paint.properties[s];let y=!1;const v=S=>{for(const E of S)if(f.overrides&&f.overrides.hasOverride(E))return void(y=!0)};if(u.value.kind==="constant"&&u.value.value instanceof ja)v(u.value.value.sections);else if(u.value.kind==="source"){const S=D=>{y||(D instanceof In&&Ue(D.value)===ts?v(D.value.sections):D instanceof Kr?v(D.sections):D.eachChild(S))},E=u.value;E._styleExpression&&S(E._styleExpression.expression)}return y}}let Uu;var ap={get paint(){return Uu=Uu||new _({"background-color":new Ee(Nt.paint_background["background-color"]),"background-pattern":new No(Nt.paint_background["background-pattern"]),"background-opacity":new Ee(Nt.paint_background["background-opacity"])})}};class sp extends o{constructor(e){super(e,ap)}}let Hf;var rp={get paint(){return Hf=Hf||new _({"raster-opacity":new Ee(Nt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ee(Nt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ee(Nt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ee(Nt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ee(Nt.paint_raster["raster-saturation"]),"raster-contrast":new Ee(Nt.paint_raster["raster-contrast"]),"raster-resampling":new Ee(Nt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ee(Nt.paint_raster["raster-fade-duration"])})}};class Hh extends o{constructor(e){super(e,rp)}}class Xf extends o{constructor(e){super(e,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Hp{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const $f=63710088e-1;class du{constructor(e,s){if(isNaN(e)||isNaN(s))throw new Error(`Invalid LngLat object: (${e}, ${s})`);if(this.lng=+e,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new du(Xi(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const s=Math.PI/180,u=this.lat*s,f=e.lat*s,y=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos((e.lng-this.lng)*s);return $f*Math.acos(Math.min(y,1))}static convert(e){if(e instanceof du)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new du(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new du(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Yf=2*Math.PI*$f;function Kf(n){return Yf*Math.cos(n*Math.PI/180)}function Zu(n){return(180+n)/360}function fh(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Wf(n,e){return n/Kf(e)}function Xh(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}class wc{constructor(e,s,u=0){this.x=+e,this.y=+s,this.z=+u}static fromLngLat(e,s=0){const u=du.convert(e);return new wc(Zu(u.lng),fh(u.lat),Wf(s,u.lat))}toLngLat(){return new du(360*this.x-180,Xh(this.y))}toAltitude(){return this.z*Kf(Xh(this.y))}meterInMercatorCoordinateUnits(){return 1/Yf*(e=Xh(this.y),1/Math.cos(e*Math.PI/180));var e}}function Jf(n,e,s){var u=2*Math.PI*6378137/256/Math.pow(2,s);return[n*u-2*Math.PI*6378137/2,e*u-2*Math.PI*6378137/2]}class $h{constructor(e,s,u){if(!(function(f,y,v){return!(f<0||f>25||v<0||v>=Math.pow(2,f)||y<0||y>=Math.pow(2,f))})(e,s,u))throw new Error(`x=${s}, y=${u}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=s,this.y=u,this.key=Sc(0,e,e,s,u)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,s,u){const f=(v=this.y,S=this.z,E=Jf(256*(y=this.x),256*(v=Math.pow(2,S)-v-1),S),D=Jf(256*(y+1),256*(v+1),S),E[0]+","+E[1]+","+D[0]+","+D[1]);var y,v,S,E,D;const R=(function(F,q,X){let K,W="";for(let st=F;st>0;st--)K=1<<st-1,W+=(q&K?1:0)+(X&K?2:0);return W})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,R).replace(/{bbox-epsg-3857}/g,f)}isChildOf(e){const s=this.z-e.z;return s>0&&e.x===this.x>>s&&e.y===this.y>>s}getTilePoint(e){const s=Math.pow(2,this.z);return new It((e.x*s-this.x)*Jn,(e.y*s-this.y)*Jn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Qf{constructor(e,s){this.wrap=e,this.canonical=s,this.key=Sc(e,s.z,s.z,s.x,s.y)}}class Ls{constructor(e,s,u,f,y){if(e<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${u}`);this.overscaledZ=e,this.wrap=s,this.canonical=new $h(u,+f,+y),this.key=Sc(s,e,u,f,y)}clone(){return new Ls(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-e;return e>this.canonical.z?new Ls(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ls(e,this.wrap,e,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(e,s){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-e;return e>this.canonical.z?Sc(this.wrap*+s,e,this.canonical.z,this.canonical.x,this.canonical.y):Sc(this.wrap*+s,e,e,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const s=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>s&&e.canonical.y===this.canonical.y>>s}children(e){if(this.overscaledZ>=e)return[new Ls(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,f=2*this.canonical.y;return[new Ls(s,this.wrap,s,u,f),new Ls(s,this.wrap,s,u+1,f),new Ls(s,this.wrap,s,u,f+1),new Ls(s,this.wrap,s,u+1,f+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ls(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ls(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Qf(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new wc(e.x-this.wrap,e.y))}}function Sc(n,e,s,u,f){(n*=2)<0&&(n=-1*n-1);const y=1<<s;return(y*y*n+y*f+u).toString(36)+s.toString(36)+e.toString(36)}Qt("CanonicalTileID",$h),Qt("OverscaledTileID",Ls,{omit:["posMatrix"]});class td{constructor(e,s,u,f=1,y=1,v=1,S=0){if(this.uid=e,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void Sn(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const E=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=y,this.blueFactor=v,this.baseShift=S;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let D=0;D<E;D++)this.data[this._idx(-1,D)]=this.data[this._idx(0,D)],this.data[this._idx(E,D)]=this.data[this._idx(E-1,D)],this.data[this._idx(D,-1)]=this.data[this._idx(D,0)],this.data[this._idx(D,E)]=this.data[this._idx(D,E-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(E,-1)]=this.data[this._idx(E-1,0)],this.data[this._idx(-1,E)]=this.data[this._idx(0,E-1)],this.data[this._idx(E,E)]=this.data[this._idx(E-1,E-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let D=0;D<E;D++)for(let R=0;R<E;R++){const F=this.get(D,R);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(e,s){const u=new Uint8Array(this.data.buffer),f=4*this._idx(e,s);return this.unpack(u[f],u[f+1],u[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,s){if(e<-1||e>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(e+1)}unpack(e,s,u){return e*this.redFactor+s*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new fr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,s,u){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let f=s*this.dim,y=s*this.dim+this.dim,v=u*this.dim,S=u*this.dim+this.dim;switch(s){case-1:f=y-1;break;case 1:y=f+1}switch(u){case-1:v=S-1;break;case 1:S=v+1}const E=-s*this.dim,D=-u*this.dim;for(let R=v;R<S;R++)for(let F=f;F<y;F++)this.data[this._idx(F,R)]=e.data[this._idx(F+E,R+D)]}}Qt("DEMData",td);class fn{constructor(e){this._stringToNumber={},this._numberToString=[];for(let s=0;s<e.length;s++){const u=e[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Yh{constructor(e,s,u,f,y){this.type="Feature",this._vectorTileFeature=e,e._z=s,e._x=u,e._y=f,this.properties=e.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(e[s]=this[s]);return e}}class op{constructor(e,s){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Li(Jn,16,0),this.grid3D=new Li(Jn,16,0),this.featureIndexArray=new gn,this.promoteId=s}insert(e,s,u,f,y,v){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,f,y);const E=v?this.grid3D:this.grid;for(let D=0;D<s.length;D++){const R=s[D],F=[1/0,1/0,-1/0,-1/0];for(let q=0;q<R.length;q++){const X=R[q];F[0]=Math.min(F[0],X.x),F[1]=Math.min(F[1],X.y),F[2]=Math.max(F[2],X.x),F[3]=Math.max(F[3],X.y)}F[0]<Jn&&F[1]<Jn&&F[2]>=0&&F[3]>=0&&E.insert(S,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Cl.VectorTile(new jh(this.rawTileData)).layers,this.sourceLayerCoder=new fn(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,s,u,f){this.loadVTLayers();const y=e.params||{},v=Jn/e.tileSize/e.scale,S=Co(y.filter),E=e.queryGeometry,D=e.queryPadding*v,R=lp(E),F=this.grid.query(R.minX-D,R.minY-D,R.maxX+D,R.maxY+D),q=lp(e.cameraQueryGeometry),X=this.grid3D.query(q.minX-D,q.minY-D,q.maxX+D,q.maxY+D,((st,ut,Ct,gt)=>(function(Tt,Zt,ee,ye,Be){for(const de of Tt)if(Zt<=de.x&&ee<=de.y&&ye>=de.x&&Be>=de.y)return!0;const le=[new It(Zt,ee),new It(Zt,Be),new It(ye,Be),new It(ye,ee)];if(Tt.length>2){for(const de of le)if(Ml(Tt,de))return!0}for(let de=0;de<Tt.length-1;de++)if(zd(Tt[de],Tt[de+1],le))return!0;return!1})(e.cameraQueryGeometry,st-D,ut-D,Ct+D,gt+D)));for(const st of X)F.push(st);F.sort(Xp);const K={};let W;for(let st=0;st<F.length;st++){const ut=F[st];if(ut===W)continue;W=ut;const Ct=this.featureIndexArray.get(ut);let gt=null;this.loadMatchingFeature(K,Ct.bucketIndex,Ct.sourceLayerIndex,Ct.featureIndex,S,y.layers,y.availableImages,s,u,f,((Tt,Zt,ee)=>(gt||(gt=nu(Tt)),Zt.queryIntersectsFeature(E,Tt,ee,gt,this.z,e.transform,v,e.pixelPosMatrix))))}return K}loadMatchingFeature(e,s,u,f,y,v,S,E,D,R,F){const q=this.bucketLayerIDs[s];if(v&&!(function(st,ut){for(let Ct=0;Ct<st.length;Ct++)if(ut.indexOf(st[Ct])>=0)return!0;return!1})(v,q))return;const X=this.sourceLayerCoder.decode(u),K=this.vtLayers[X].feature(f);if(y.needGeometry){const st=au(K,!0);if(!y.filter(new fi(this.tileID.overscaledZ),st,this.tileID.canonical))return}else if(!y.filter(new fi(this.tileID.overscaledZ),K))return;const W=this.getId(K,X);for(let st=0;st<q.length;st++){const ut=q[st];if(v&&v.indexOf(ut)<0)continue;const Ct=E[ut];if(!Ct)continue;let gt={};W&&R&&(gt=R.getState(Ct.sourceLayer||"_geojsonTileLayer",W));const Tt=Xe({},D[ut]);Tt.paint=ed(Tt.paint,Ct.paint,K,gt,S),Tt.layout=ed(Tt.layout,Ct.layout,K,gt,S);const Zt=!F||F(K,Ct,gt);if(!Zt)continue;const ee=new Yh(K,this.z,this.x,this.y,W);ee.layer=Tt;let ye=e[ut];ye===void 0&&(ye=e[ut]=[]),ye.push({featureIndex:f,feature:ee,intersectionZ:Zt})}}lookupSymbolFeatures(e,s,u,f,y,v,S,E){const D={};this.loadVTLayers();const R=Co(y);for(const F of e)this.loadMatchingFeature(D,u,f,F,R,v,S,E,s);return D}hasLayer(e){for(const s of this.bucketLayerIDs)for(const u of s)if(e===u)return!0;return!1}getId(e,s){let u=e.id;return this.promoteId&&(u=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof u=="boolean"&&(u=Number(u))),u}}function ed(n,e,s,u,f){return wn(n,((y,v)=>{const S=e instanceof Oo?e.get(v):null;return S&&S.evaluate?S.evaluate(s,u,f):S}))}function lp(n){let e=1/0,s=1/0,u=-1/0,f=-1/0;for(const y of n)e=Math.min(e,y.x),s=Math.min(s,y.y),u=Math.max(u,y.x),f=Math.max(f,y.y);return{minX:e,minY:s,maxX:u,maxY:f}}function Xp(n,e){return e-n}function up(n,e,s,u,f){const y=[];for(let v=0;v<n.length;v++){const S=n[v];let E;for(let D=0;D<S.length-1;D++){let R=S[D],F=S[D+1];R.x<e&&F.x<e||(R.x<e?R=new It(e,R.y+(e-R.x)/(F.x-R.x)*(F.y-R.y))._round():F.x<e&&(F=new It(e,R.y+(e-R.x)/(F.x-R.x)*(F.y-R.y))._round()),R.y<s&&F.y<s||(R.y<s?R=new It(R.x+(s-R.y)/(F.y-R.y)*(F.x-R.x),s)._round():F.y<s&&(F=new It(R.x+(s-R.y)/(F.y-R.y)*(F.x-R.x),s)._round()),R.x>=u&&F.x>=u||(R.x>=u?R=new It(u,R.y+(u-R.x)/(F.x-R.x)*(F.y-R.y))._round():F.x>=u&&(F=new It(u,R.y+(u-R.x)/(F.x-R.x)*(F.y-R.y))._round()),R.y>=f&&F.y>=f||(R.y>=f?R=new It(R.x+(f-R.y)/(F.y-R.y)*(F.x-R.x),f)._round():F.y>=f&&(F=new It(R.x+(f-R.y)/(F.y-R.y)*(F.x-R.x),f)._round()),E&&R.equals(E[E.length-1])||(E=[R],y.push(E)),E.push(F)))))}}return y}Qt("FeatureIndex",op,{omit:["rawTileData","sourceLayerCoder"]});class Zo extends It{constructor(e,s,u,f){super(e,s),this.angle=u,f!==void 0&&(this.segment=f)}clone(){return new Zo(this.x,this.y,this.angle,this.segment)}}function ju(n,e,s,u,f){if(e.segment===void 0||s===0)return!0;let y=e,v=e.segment+1,S=0;for(;S>-s/2;){if(v--,v<0)return!1;S-=n[v].dist(y),y=n[v]}S+=n[v].dist(n[v+1]),v++;const E=[];let D=0;for(;S<s/2;){const R=n[v],F=n[v+1];if(!F)return!1;let q=n[v-1].angleTo(R)-R.angleTo(F);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:S,angleDelta:q}),D+=q;S-E[0].distance>u;)D-=E.shift().angleDelta;if(D>f)return!1;v++,S+=R.dist(F)}return!0}function Kh(n){let e=0;for(let s=0;s<n.length-1;s++)e+=n[s].dist(n[s+1]);return e}function dh(n,e,s){return n?.6*e*s:0}function Wh(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function pu(n,e,s,u,f,y){const v=dh(s,f,y),S=Wh(s,u)*y;let E=0;const D=Kh(n)/2;for(let R=0;R<n.length-1;R++){const F=n[R],q=n[R+1],X=F.dist(q);if(E+X>D){const K=(D-E)/X,W=aa.number(F.x,q.x,K),st=aa.number(F.y,q.y,K),ut=new Zo(W,st,q.angleTo(F),R);return ut._round(),!v||ju(n,ut,S,v,e)?ut:void 0}E+=X}}function hl(n,e,s,u,f,y,v,S,E){const D=dh(u,y,v),R=Wh(u,f),F=R*v,q=n[0].x===0||n[0].x===E||n[0].y===0||n[0].y===E;return e-F<e/4&&(e=F+e/4),Tc(n,q?e/2*S%e:(R/2+2*y)*v*S%e,e,D,s,F,q,!1,E)}function Tc(n,e,s,u,f,y,v,S,E){const D=y/2,R=Kh(n);let F=0,q=e-s,X=[];for(let K=0;K<n.length-1;K++){const W=n[K],st=n[K+1],ut=W.dist(st),Ct=st.angleTo(W);for(;q+s<F+ut;){q+=s;const gt=(q-F)/ut,Tt=aa.number(W.x,st.x,gt),Zt=aa.number(W.y,st.y,gt);if(Tt>=0&&Tt<E&&Zt>=0&&Zt<E&&q-D>=0&&q+D<=R){const ee=new Zo(Tt,Zt,Ct,K);ee._round(),u&&!ju(n,ee,y,u,f)||X.push(ee)}}F+=ut}return S||X.length||v||(X=Tc(n,F/2,s,u,f,y,v,!0,E)),X}Qt("Anchor",Zo);const Ac=ti;function id(n,e,s,u){const f=[],y=n.image,v=y.pixelRatio,S=y.paddedRect.w-2*Ac,E=y.paddedRect.h-2*Ac;let D={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const R=y.stretchX||[[0,S]],F=y.stretchY||[[0,E]],q=(Gt,Se)=>Gt+Se[1]-Se[0],X=R.reduce(q,0),K=F.reduce(q,0),W=S-X,st=E-K;let ut=0,Ct=X,gt=0,Tt=K,Zt=0,ee=W,ye=0,Be=st;if(y.content&&u){const Gt=y.content,Se=Gt[2]-Gt[0],Me=Gt[3]-Gt[1];(y.textFitWidth||y.textFitHeight)&&(D=lh(n)),ut=ph(R,0,Gt[0]),gt=ph(F,0,Gt[1]),Ct=ph(R,Gt[0],Gt[2]),Tt=ph(F,Gt[1],Gt[3]),Zt=Gt[0]-ut,ye=Gt[1]-gt,ee=Se-Ct,Be=Me-Tt}const le=D.x1,de=D.y1,Ce=D.x2-le,Te=D.y2-de,be=(Gt,Se,Me,Ge)=>{const Ri=mh(Gt.stretch-ut,Ct,Ce,le),rn=Jh(Gt.fixed-Zt,ee,Gt.stretch,X),Ta=mh(Se.stretch-gt,Tt,Te,de),ps=Jh(Se.fixed-ye,Be,Se.stretch,K),Na=mh(Me.stretch-ut,Ct,Ce,le),Aa=Jh(Me.fixed-Zt,ee,Me.stretch,X),Is=mh(Ge.stretch-gt,Tt,Te,de),Ps=Jh(Ge.fixed-ye,Be,Ge.stretch,K),Ds=new It(Ri,Ta),Yn=new It(Na,Ta),Ea=new It(Na,Is),ms=new It(Ri,Is),Fa=new It(rn/v,ps/v),_a=new It(Aa/v,Ps/v),ua=e*Math.PI/180;if(ua){const Ai=Math.sin(ua),Ji=Math.cos(ua),bn=[Ji,-Ai,Ai,Ji];Ds._matMult(bn),Yn._matMult(bn),ms._matMult(bn),Ea._matMult(bn)}const _r=Gt.stretch+Gt.fixed,Xs=Se.stretch+Se.fixed;return{tl:Ds,tr:Yn,bl:ms,br:Ea,tex:{x:y.paddedRect.x+Ac+_r,y:y.paddedRect.y+Ac+Xs,w:Me.stretch+Me.fixed-_r,h:Ge.stretch+Ge.fixed-Xs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Fa,pixelOffsetBR:_a,minFontScaleX:ee/v/Ce,minFontScaleY:Be/v/Te,isSDF:s}};if(u&&(y.stretchX||y.stretchY)){const Gt=nd(R,W,X),Se=nd(F,st,K);for(let Me=0;Me<Gt.length-1;Me++){const Ge=Gt[Me],Ri=Gt[Me+1];for(let rn=0;rn<Se.length-1;rn++)f.push(be(Ge,Se[rn],Ri,Se[rn+1]))}}else f.push(be({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:E+1}));return f}function ph(n,e,s){let u=0;for(const f of n)u+=Math.max(e,Math.min(s,f[1]))-Math.max(e,Math.min(s,f[0]));return u}function nd(n,e,s){const u=[{fixed:-Ac,stretch:0}];for(const[f,y]of n){const v=u[u.length-1];u.push({fixed:f-v.stretch,stretch:v.stretch}),u.push({fixed:f-v.stretch,stretch:v.stretch+(y-f)})}return u.push({fixed:e+Ac,stretch:s}),u}function mh(n,e,s,u){return n/e*s+u}function Jh(n,e,s,u){return n-e*s/u}class Ec{constructor(e,s,u,f,y,v,S,E,D,R){var F;if(this.boxStartIndex=e.length,D){let q=v.top,X=v.bottom;const K=v.collisionPadding;K&&(q-=K[1],X+=K[3]);let W=X-q;W>0&&(W=Math.max(10,W),this.circleDiameter=W)}else{const q=!((F=v.image)===null||F===void 0)&&F.content&&(v.image.textFitWidth||v.image.textFitHeight)?lh(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};q.y1=q.y1*S-E[0],q.y2=q.y2*S+E[2],q.x1=q.x1*S-E[3],q.x2=q.x2*S+E[1];const X=v.collisionPadding;if(X&&(q.x1-=X[0]*S,q.y1-=X[1]*S,q.x2+=X[2]*S,q.y2+=X[3]*S),R){const K=new It(q.x1,q.y1),W=new It(q.x2,q.y1),st=new It(q.x1,q.y2),ut=new It(q.x2,q.y2),Ct=R*Math.PI/180;K._rotate(Ct),W._rotate(Ct),st._rotate(Ct),ut._rotate(Ct),q.x1=Math.min(K.x,W.x,st.x,ut.x),q.x2=Math.max(K.x,W.x,st.x,ut.x),q.y1=Math.min(K.y,W.y,st.y,ut.y),q.y2=Math.max(K.y,W.y,st.y,ut.y)}e.emplaceBack(s.x,s.y,q.x1,q.y1,q.x2,q.y2,u,f,y)}this.boxEndIndex=e.length}}class cp{constructor(e=[],s=((u,f)=>u<f?-1:u>f?1:0)){if(this.data=e,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:s,compare:u}=this,f=s[e];for(;e>0;){const y=e-1>>1,v=s[y];if(u(f,v)>=0)break;s[e]=v,e=y}s[e]=f}_down(e){const{data:s,compare:u}=this,f=this.length>>1,y=s[e];for(;e<f;){let v=1+(e<<1);const S=v+1;if(S<this.length&&u(s[S],s[v])<0&&(v=S),u(s[v],y)>=0)break;s[e]=s[v],e=v}s[e]=y}}function hp(n,e=1,s=!1){let u=1/0,f=1/0,y=-1/0,v=-1/0;const S=n[0];for(let X=0;X<S.length;X++){const K=S[X];(!X||K.x<u)&&(u=K.x),(!X||K.y<f)&&(f=K.y),(!X||K.x>y)&&(y=K.x),(!X||K.y>v)&&(v=K.y)}const E=Math.min(y-u,v-f);let D=E/2;const R=new cp([],$p);if(E===0)return new It(u,f);for(let X=u;X<y;X+=E)for(let K=f;K<v;K+=E)R.push(new mu(X+D,K+D,D,n));let F=(function(X){let K=0,W=0,st=0;const ut=X[0];for(let Ct=0,gt=ut.length,Tt=gt-1;Ct<gt;Tt=Ct++){const Zt=ut[Ct],ee=ut[Tt],ye=Zt.x*ee.y-ee.x*Zt.y;W+=(Zt.x+ee.x)*ye,st+=(Zt.y+ee.y)*ye,K+=3*ye}return new mu(W/K,st/K,0,X)})(n),q=R.length;for(;R.length;){const X=R.pop();(X.d>F.d||!F.d)&&(F=X,s&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,q)),X.max-F.d<=e||(D=X.h/2,R.push(new mu(X.p.x-D,X.p.y-D,D,n)),R.push(new mu(X.p.x+D,X.p.y-D,D,n)),R.push(new mu(X.p.x-D,X.p.y+D,D,n)),R.push(new mu(X.p.x+D,X.p.y+D,D,n)),q+=4)}return s&&(console.log(`num probes: ${q}`),console.log(`best distance: ${F.d}`)),F.p}function $p(n,e){return e.max-n.max}function mu(n,e,s,u){this.p=new It(n,e),this.h=s,this.d=(function(f,y){let v=!1,S=1/0;for(let E=0;E<y.length;E++){const D=y[E];for(let R=0,F=D.length,q=F-1;R<F;q=R++){const X=D[R],K=D[q];X.y>f.y!=K.y>f.y&&f.x<(K.x-X.x)*(f.y-X.y)/(K.y-X.y)+X.x&&(v=!v),S=Math.min(S,_f(f,X,K))}}return(v?1:-1)*Math.sqrt(S)})(this.p,u),this.max=this.d+this.h*Math.SQRT2}var Sa;O.aq=void 0,(Sa=O.aq||(O.aq={}))[Sa.center=1]="center",Sa[Sa.left=2]="left",Sa[Sa.right=3]="right",Sa[Sa.top=4]="top",Sa[Sa.bottom=5]="bottom",Sa[Sa["top-left"]=6]="top-left",Sa[Sa["top-right"]=7]="top-right",Sa[Sa["bottom-left"]=8]="bottom-left",Sa[Sa["bottom-right"]=9]="bottom-right";const _u=7,ad=Number.POSITIVE_INFINITY;function Mc(n,e){return e[1]!==ad?(function(s,u,f){let y=0,v=0;switch(u=Math.abs(u),f=Math.abs(f),s){case"top-right":case"top-left":case"top":v=f-_u;break;case"bottom-right":case"bottom-left":case"bottom":v=-f+_u}switch(s){case"top-right":case"bottom-right":case"right":y=-u;break;case"top-left":case"bottom-left":case"left":y=u}return[y,v]})(n,e[0],e[1]):(function(s,u){let f=0,y=0;u<0&&(u=0);const v=u/Math.SQRT2;switch(s){case"top-right":case"top-left":y=v-_u;break;case"bottom-right":case"bottom-left":y=-v+_u;break;case"bottom":y=-u+_u;break;case"top":y=u-_u}switch(s){case"top-right":case"bottom-right":f=-v;break;case"top-left":case"bottom-left":f=v;break;case"left":f=u;break;case"right":f=-u}return[f,y]})(n,e[0])}function fp(n,e,s){var u;const f=n.layout,y=(u=f.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(e,{},s);if(y){const S=y.values,E=[];for(let D=0;D<S.length;D+=2){const R=E[D]=S[D],F=S[D+1].map((q=>q*la));R.startsWith("top")?F[1]-=_u:R.startsWith("bottom")&&(F[1]+=_u),E[D+1]=F}return new ga(E)}const v=f.get("text-variable-anchor");if(v){let S;S=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(e,{},s)*la,ad]:f.get("text-offset").evaluate(e,{},s).map((D=>D*la));const E=[];for(const D of v)E.push(D,Mc(D,S));return new ga(E)}return null}function Qh(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Oi(n,e,s,u,f,y,v,S,E,D,R){let F=y.textMaxSize.evaluate(e,{});F===void 0&&(F=v);const q=n.layers[0].layout,X=q.get("icon-offset").evaluate(e,{},R),K=_h(s.horizontal),W=v/24,st=n.tilePixelRatio*W,ut=n.tilePixelRatio*F/24,Ct=n.tilePixelRatio*S,gt=n.tilePixelRatio*q.get("symbol-spacing"),Tt=q.get("text-padding")*n.tilePixelRatio,Zt=(function(Gt,Se,Me,Ge=1){const Ri=Gt.get("icon-padding").evaluate(Se,{},Me),rn=Ri&&Ri.values;return[rn[0]*Ge,rn[1]*Ge,rn[2]*Ge,rn[3]*Ge]})(q,e,R,n.tilePixelRatio),ee=q.get("text-max-angle")/180*Math.PI,ye=q.get("text-rotation-alignment")!=="viewport"&&q.get("symbol-placement")!=="point",Be=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",le=q.get("symbol-placement"),de=gt/2,Ce=q.get("icon-text-fit");let Te;u&&Ce!=="none"&&(n.allowVerticalPlacement&&s.vertical&&(Te=Dl(u,s.vertical,Ce,q.get("icon-text-fit-padding"),X,W)),K&&(u=Dl(u,K,Ce,q.get("icon-text-fit-padding"),X,W)));const be=(Gt,Se)=>{Se.x<0||Se.x>=Jn||Se.y<0||Se.y>=Jn||(function(Me,Ge,Ri,rn,Ta,ps,Na,Aa,Is,Ps,Ds,Yn,Ea,ms,Fa,_a,ua,_r,Xs,Ai,Ji,bn,_s,Ln,gu){const Zr=Me.addToLineVertexArray(Ge,Ri);let jo,jr,Vr,Ma,kl=0,qu=0,pp=0,wh=0,Cc=-1,Lc=-1;const Rl={};let Ic=Jl("");if(Me.allowVerticalPlacement&&rn.vertical){const Ka=Aa.layout.get("text-rotate").evaluate(Ji,{},Ln)+90;Vr=new Ec(Is,Ge,Ps,Ds,Yn,rn.vertical,Ea,ms,Fa,Ka),Na&&(Ma=new Ec(Is,Ge,Ps,Ds,Yn,Na,ua,_r,Fa,Ka))}if(Ta){const Ka=Aa.layout.get("icon-rotate").evaluate(Ji,{}),$s=Aa.layout.get("icon-text-fit")!=="none",gr=id(Ta,Ka,_s,$s),Wa=Na?id(Na,Ka,_s,$s):void 0;jr=new Ec(Is,Ge,Ps,Ds,Yn,Ta,ua,_r,!1,Ka),kl=4*gr.length;const yr=Me.iconSizeData;let vr=null;yr.kind==="source"?(vr=[ds*Aa.layout.get("icon-size").evaluate(Ji,{})],vr[0]>Fr&&Sn(`${Me.layerIds[0]}: Value for "icon-size" is >= ${ta}. Reduce your "icon-size".`)):yr.kind==="composite"&&(vr=[ds*bn.compositeIconSizes[0].evaluate(Ji,{},Ln),ds*bn.compositeIconSizes[1].evaluate(Ji,{},Ln)],(vr[0]>Fr||vr[1]>Fr)&&Sn(`${Me.layerIds[0]}: Value for "icon-size" is >= ${ta}. Reduce your "icon-size".`)),Me.addSymbols(Me.icon,gr,vr,Ai,Xs,Ji,O.ah.none,Ge,Zr.lineStartIndex,Zr.lineLength,-1,Ln),Cc=Me.icon.placedSymbolArray.length-1,Wa&&(qu=4*Wa.length,Me.addSymbols(Me.icon,Wa,vr,Ai,Xs,Ji,O.ah.vertical,Ge,Zr.lineStartIndex,Zr.lineLength,-1,Ln),Lc=Me.icon.placedSymbolArray.length-1)}const mp=Object.keys(rn.horizontal);for(const Ka of mp){const $s=rn.horizontal[Ka];if(!jo){Ic=Jl($s.text);const Wa=Aa.layout.get("text-rotate").evaluate(Ji,{},Ln);jo=new Ec(Is,Ge,Ps,Ds,Yn,$s,Ea,ms,Fa,Wa)}const gr=$s.positionedLines.length===1;if(pp+=tf(Me,Ge,$s,ps,Aa,Fa,Ji,_a,Zr,rn.vertical?O.ah.horizontal:O.ah.horizontalOnly,gr?mp:[Ka],Rl,Cc,bn,Ln),gr)break}rn.vertical&&(wh+=tf(Me,Ge,rn.vertical,ps,Aa,Fa,Ji,_a,Zr,O.ah.vertical,["vertical"],Rl,Lc,bn,Ln));const _p=jo?jo.boxStartIndex:Me.collisionBoxArray.length,gp=jo?jo.boxEndIndex:Me.collisionBoxArray.length,yp=Vr?Vr.boxStartIndex:Me.collisionBoxArray.length,vp=Vr?Vr.boxEndIndex:Me.collisionBoxArray.length,ld=jr?jr.boxStartIndex:Me.collisionBoxArray.length,xp=jr?jr.boxEndIndex:Me.collisionBoxArray.length,bp=Ma?Ma.boxStartIndex:Me.collisionBoxArray.length,nf=Ma?Ma.boxEndIndex:Me.collisionBoxArray.length;let Vo=-1;const af=(Ka,$s)=>Ka&&Ka.circleDiameter?Math.max(Ka.circleDiameter,$s):$s;Vo=af(jo,Vo),Vo=af(Vr,Vo),Vo=af(jr,Vo),Vo=af(Ma,Vo);const sf=Vo>-1?1:0;sf&&(Vo*=gu/la),Me.glyphOffsetArray.length>=Fu.MAX_GLYPHS&&Sn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ji.sortKey!==void 0&&Me.addToSortKeyRanges(Me.symbolInstances.length,Ji.sortKey);const ud=fp(Aa,Ji,Ln),[rf,cd]=(function(Ka,$s){const gr=Ka.length,Wa=$s?.values;if(Wa?.length>0)for(let yr=0;yr<Wa.length;yr+=2){const vr=Wa[yr+1];Ka.emplaceBack(O.aq[Wa[yr]],vr[0],vr[1])}return[gr,Ka.length]})(Me.textAnchorOffsets,ud);Me.symbolInstances.emplaceBack(Ge.x,Ge.y,Rl.right>=0?Rl.right:-1,Rl.center>=0?Rl.center:-1,Rl.left>=0?Rl.left:-1,Rl.vertical||-1,Cc,Lc,Ic,_p,gp,yp,vp,ld,xp,bp,nf,Ps,pp,wh,kl,qu,sf,0,Ea,Vo,rf,cd)})(n,Se,Gt,s,u,f,Te,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,st,[Tt,Tt,Tt,Tt],ye,E,Ct,Zt,Be,X,e,y,D,R,v)};if(le==="line")for(const Gt of up(e.geometry,0,0,Jn,Jn)){const Se=hl(Gt,gt,ee,s.vertical||K,u,24,ut,n.overscaling,Jn);for(const Me of Se)K&&sd(n,K.text,de,Me)||be(Gt,Me)}else if(le==="line-center"){for(const Gt of e.geometry)if(Gt.length>1){const Se=pu(Gt,ee,s.vertical||K,u,24,ut);Se&&be(Gt,Se)}}else if(e.type==="Polygon")for(const Gt of dl(e.geometry,0)){const Se=hp(Gt,16);be(Gt[0],new Zo(Se.x,Se.y,0))}else if(e.type==="LineString")for(const Gt of e.geometry)be(Gt,new Zo(Gt[0].x,Gt[0].y,0));else if(e.type==="Point")for(const Gt of e.geometry)for(const Se of Gt)be([Se],new Zo(Se.x,Se.y,0))}function tf(n,e,s,u,f,y,v,S,E,D,R,F,q,X,K){const W=(function(Ct,gt,Tt,Zt,ee,ye,Be,le){const de=Zt.layout.get("text-rotate").evaluate(ye,{})*Math.PI/180,Ce=[];for(const Te of gt.positionedLines)for(const be of Te.positionedGlyphs){if(!be.rect)continue;const Gt=be.rect||{};let Se=en+1,Me=!0,Ge=1,Ri=0;const rn=(ee||le)&&be.vertical,Ta=be.metrics.advance*be.scale/2;if(le&&gt.verticalizable&&(Ri=Te.lineOffset/2-(be.imageName?-(la-be.metrics.width*be.scale)/2:(be.scale-1)*la)),be.imageName){const Ai=Be[be.imageName];Me=Ai.sdf,Ge=Ai.pixelRatio,Se=ti/Ge}const ps=ee?[be.x+Ta,be.y]:[0,0];let Na=ee?[0,0]:[be.x+Ta+Tt[0],be.y+Tt[1]-Ri],Aa=[0,0];rn&&(Aa=Na,Na=[0,0]);const Is=be.metrics.isDoubleResolution?2:1,Ps=(be.metrics.left-Se)*be.scale-Ta+Na[0],Ds=(-be.metrics.top-Se)*be.scale+Na[1],Yn=Ps+Gt.w/Is*be.scale/Ge,Ea=Ds+Gt.h/Is*be.scale/Ge,ms=new It(Ps,Ds),Fa=new It(Yn,Ds),_a=new It(Ps,Ea),ua=new It(Yn,Ea);if(rn){const Ai=new It(-Ta,Ta-lo),Ji=-Math.PI/2,bn=la/2-Ta,_s=new It(5-lo-bn,-(be.imageName?bn:0)),Ln=new It(...Aa);ms._rotateAround(Ji,Ai)._add(_s)._add(Ln),Fa._rotateAround(Ji,Ai)._add(_s)._add(Ln),_a._rotateAround(Ji,Ai)._add(_s)._add(Ln),ua._rotateAround(Ji,Ai)._add(_s)._add(Ln)}if(de){const Ai=Math.sin(de),Ji=Math.cos(de),bn=[Ji,-Ai,Ai,Ji];ms._matMult(bn),Fa._matMult(bn),_a._matMult(bn),ua._matMult(bn)}const _r=new It(0,0),Xs=new It(0,0);Ce.push({tl:ms,tr:Fa,bl:_a,br:ua,tex:Gt,writingMode:gt.writingMode,glyphOffset:ps,sectionIndex:be.sectionIndex,isSDF:Me,pixelOffsetTL:_r,pixelOffsetBR:Xs,minFontScaleX:0,minFontScaleY:0})}return Ce})(0,s,S,f,y,v,u,n.allowVerticalPlacement),st=n.textSizeData;let ut=null;st.kind==="source"?(ut=[ds*f.layout.get("text-size").evaluate(v,{})],ut[0]>Fr&&Sn(`${n.layerIds[0]}: Value for "text-size" is >= ${ta}. Reduce your "text-size".`)):st.kind==="composite"&&(ut=[ds*X.compositeTextSizes[0].evaluate(v,{},K),ds*X.compositeTextSizes[1].evaluate(v,{},K)],(ut[0]>Fr||ut[1]>Fr)&&Sn(`${n.layerIds[0]}: Value for "text-size" is >= ${ta}. Reduce your "text-size".`)),n.addSymbols(n.text,W,ut,S,y,v,D,e,E.lineStartIndex,E.lineLength,q,K);for(const Ct of R)F[Ct]=n.text.placedSymbolArray.length-1;return 4*W.length}function _h(n){for(const e in n)return n[e];return null}function sd(n,e,s,u){const f=n.compareText;if(e in f){const y=f[e];for(let v=y.length-1;v>=0;v--)if(u.dist(y[v])<s)return!0}else f[e]=[];return f[e].push(u),!1}const rd=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class gh{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,u]=new Uint8Array(e,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=u>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const y=rd[15&u];if(!y)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(e,2,1),[S]=new Uint32Array(e,4,1);return new gh(S,v,y,e)}constructor(e,s=64,u=Float64Array,f){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=u,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const y=rd.indexOf(this.ArrayType),v=2*e*this.ArrayType.BYTES_PER_ELEMENT,S=e*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-S%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${u}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+S+E,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+v+S+E),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+S+E,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=e)}add(e,s){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=e,this.coords[this._pos++]=s,u}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Vu(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,s,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:v,nodeSize:S}=this,E=[0,y.length-1,0],D=[];for(;E.length;){const R=E.pop()||0,F=E.pop()||0,q=E.pop()||0;if(F-q<=S){for(let st=q;st<=F;st++){const ut=v[2*st],Ct=v[2*st+1];ut>=e&&ut<=u&&Ct>=s&&Ct<=f&&D.push(y[st])}continue}const X=q+F>>1,K=v[2*X],W=v[2*X+1];K>=e&&K<=u&&W>=s&&W<=f&&D.push(y[X]),(R===0?e<=K:s<=W)&&(E.push(q),E.push(X-1),E.push(1-R)),(R===0?u>=K:f>=W)&&(E.push(X+1),E.push(F),E.push(1-R))}return D}within(e,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:v}=this,S=[0,f.length-1,0],E=[],D=u*u;for(;S.length;){const R=S.pop()||0,F=S.pop()||0,q=S.pop()||0;if(F-q<=v){for(let st=q;st<=F;st++)dp(y[2*st],y[2*st+1],e,s)<=D&&E.push(f[st]);continue}const X=q+F>>1,K=y[2*X],W=y[2*X+1];dp(K,W,e,s)<=D&&E.push(f[X]),(R===0?e-u<=K:s-u<=W)&&(S.push(q),S.push(X-1),S.push(1-R)),(R===0?e+u>=K:s+u>=W)&&(S.push(X+1),S.push(F),S.push(1-R))}return E}}function Vu(n,e,s,u,f,y){if(f-u<=s)return;const v=u+f>>1;yh(n,e,v,u,f,y),Vu(n,e,s,u,v-1,1-y),Vu(n,e,s,v+1,f,1-y)}function yh(n,e,s,u,f,y){for(;f>u;){if(f-u>600){const D=f-u+1,R=s-u+1,F=Math.log(D),q=.5*Math.exp(2*F/3),X=.5*Math.sqrt(F*q*(D-q)/D)*(R-D/2<0?-1:1);yh(n,e,s,Math.max(u,Math.floor(s-R*q/D+X)),Math.min(f,Math.floor(s+(D-R)*q/D+X)),y)}const v=e[2*s+y];let S=u,E=f;for(vh(n,e,u,s),e[2*f+y]>v&&vh(n,e,u,f);S<E;){for(vh(n,e,S,E),S++,E--;e[2*S+y]<v;)S++;for(;e[2*E+y]>v;)E--}e[2*u+y]===v?vh(n,e,u,E):(E++,vh(n,e,E,f)),E<=s&&(u=E+1),s<=E&&(f=E-1)}}function vh(n,e,s,u){ef(n,s,u),ef(e,2*s,2*u),ef(e,2*s+1,2*u+1)}function ef(n,e,s){const u=n[e];n[e]=n[s],n[s]=u}function dp(n,e,s,u){const f=n-s,y=e-u;return f*f+y*y}var od;O.bg=void 0,(od=O.bg||(O.bg={})).create="create",od.load="load",od.fullLoad="fullLoad";let xh=null,zc=[];const dn=1e3/60,bh="loadTime",Ba="fullLoadTime",Yp={mark(n){performance.mark(n)},frame(n){const e=n;xh!=null&&zc.push(e-xh),xh=e},clearMetrics(){xh=null,zc=[],performance.clearMeasures(bh),performance.clearMeasures(Ba);for(const n in O.bg)performance.clearMarks(O.bg[n])},getPerformanceMetrics(){performance.measure(bh,O.bg.create,O.bg.load),performance.measure(Ba,O.bg.create,O.bg.fullLoad);const n=performance.getEntriesByName(bh)[0].duration,e=performance.getEntriesByName(Ba)[0].duration,s=zc.length,u=1/(zc.reduce(((y,v)=>y+v),0)/s/1e3),f=zc.filter((y=>y>dn)).reduce(((y,v)=>y+(v-dn)/dn),0);return{loadTime:n,fullLoadTime:e,fps:u,percentDroppedFrames:f/(s+f)*100,totalFrames:s}}};O.$=class extends Z{},O.A=ru,O.B=_i,O.C=function(n){if(Vt==null){const e=n.navigator?n.navigator.userAgent:null;Vt=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Vt},O.D=Ee,O.E=br,O.F=class{constructor(n,e){this.target=n,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Hp((()=>this.process())),this.subscription=(function(s,u,f,y){return s.addEventListener(u,f,!1),{unsubscribe:()=>{s.removeEventListener(u,f,!1)}}})(this.target,"message",(s=>this.receive(s))),this.globalScope=$i(self)?n:window}registerMessageHandler(n,e){this.messageHandlers[n]=e}sendAsync(n,e){return new Promise(((s,u)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[f]={resolve:s,reject:u},e&&e.signal.addEventListener("abort",(()=>{delete this.resolveRejects[f];const S={id:f,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)}),{once:!0});const y=[],v=Object.assign(Object.assign({},n),{id:f,sourceMapId:this.mapId,origin:location.origin,data:cs(n.data,y)});this.target.postMessage(v,{transfer:y})}))}receive(n){const e=n.data,s=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[s];const u=this.abortControllers[s];return delete this.abortControllers[s],void(u&&u.abort())}if($i(self)||e.mustQueue)return this.tasks[s]=e,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,e)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),e=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(n,e)}processTask(n,e){return g(this,void 0,void 0,(function*(){if(e.type==="<response>"){const f=this.resolveRejects[n];return delete this.resolveRejects[n],f?void(e.error?f.reject(no(e.error)):f.resolve(no(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=no(e.data),u=new AbortController;this.abortControllers[n]=u;try{const f=yield this.messageHandlers[e.type](e.sourceMapId,s,u);this.completeTask(n,null,f)}catch(f){this.completeTask(n,f)}}))}completeTask(n,e,s){const u=[];delete this.abortControllers[n];const f={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?cs(e):null,data:cs(s,u)};this.target.postMessage(f,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},O.G=xe,O.H=function(){var n=new ru(16);return ru!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},O.I=ki,O.J=function(n,e,s){var u,f,y,v,S,E,D,R,F,q,X,K,W=s[0],st=s[1],ut=s[2];return e===n?(n[12]=e[0]*W+e[4]*st+e[8]*ut+e[12],n[13]=e[1]*W+e[5]*st+e[9]*ut+e[13],n[14]=e[2]*W+e[6]*st+e[10]*ut+e[14],n[15]=e[3]*W+e[7]*st+e[11]*ut+e[15]):(f=e[1],y=e[2],v=e[3],S=e[4],E=e[5],D=e[6],R=e[7],F=e[8],q=e[9],X=e[10],K=e[11],n[0]=u=e[0],n[1]=f,n[2]=y,n[3]=v,n[4]=S,n[5]=E,n[6]=D,n[7]=R,n[8]=F,n[9]=q,n[10]=X,n[11]=K,n[12]=u*W+S*st+F*ut+e[12],n[13]=f*W+E*st+q*ut+e[13],n[14]=y*W+D*st+X*ut+e[14],n[15]=v*W+R*st+K*ut+e[15]),n},O.K=function(n,e,s){var u=s[0],f=s[1],y=s[2];return n[0]=e[0]*u,n[1]=e[1]*u,n[2]=e[2]*u,n[3]=e[3]*u,n[4]=e[4]*f,n[5]=e[5]*f,n[6]=e[6]*f,n[7]=e[7]*f,n[8]=e[8]*y,n[9]=e[9]*y,n[10]=e[10]*y,n[11]=e[11]*y,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},O.L=vf,O.M=function(n,e){const s={};for(let u=0;u<e.length;u++){const f=e[u];f in n&&(s[f]=n[f])}return s},O.N=du,O.O=Zu,O.P=It,O.Q=fh,O.R=fr,O.S=Ls,O.T=ec,O.U=on,O.V=ea,O.W=xi,O.X=Jn,O.Y=T,O.Z=wc,O._=g,O.a=ae,O.a$=function(n,e){var s=n[0],u=n[1],f=n[2],y=n[3],v=n[4],S=n[5],E=n[6],D=n[7],R=n[8],F=n[9],q=n[10],X=n[11],K=n[12],W=n[13],st=n[14],ut=n[15],Ct=e[0],gt=e[1],Tt=e[2],Zt=e[3],ee=e[4],ye=e[5],Be=e[6],le=e[7],de=e[8],Ce=e[9],Te=e[10],be=e[11],Gt=e[12],Se=e[13],Me=e[14],Ge=e[15];return Math.abs(s-Ct)<=fs*Math.max(1,Math.abs(s),Math.abs(Ct))&&Math.abs(u-gt)<=fs*Math.max(1,Math.abs(u),Math.abs(gt))&&Math.abs(f-Tt)<=fs*Math.max(1,Math.abs(f),Math.abs(Tt))&&Math.abs(y-Zt)<=fs*Math.max(1,Math.abs(y),Math.abs(Zt))&&Math.abs(v-ee)<=fs*Math.max(1,Math.abs(v),Math.abs(ee))&&Math.abs(S-ye)<=fs*Math.max(1,Math.abs(S),Math.abs(ye))&&Math.abs(E-Be)<=fs*Math.max(1,Math.abs(E),Math.abs(Be))&&Math.abs(D-le)<=fs*Math.max(1,Math.abs(D),Math.abs(le))&&Math.abs(R-de)<=fs*Math.max(1,Math.abs(R),Math.abs(de))&&Math.abs(F-Ce)<=fs*Math.max(1,Math.abs(F),Math.abs(Ce))&&Math.abs(q-Te)<=fs*Math.max(1,Math.abs(q),Math.abs(Te))&&Math.abs(X-be)<=fs*Math.max(1,Math.abs(X),Math.abs(be))&&Math.abs(K-Gt)<=fs*Math.max(1,Math.abs(K),Math.abs(Gt))&&Math.abs(W-Se)<=fs*Math.max(1,Math.abs(W),Math.abs(Se))&&Math.abs(st-Me)<=fs*Math.max(1,Math.abs(st),Math.abs(Me))&&Math.abs(ut-Ge)<=fs*Math.max(1,Math.abs(ut),Math.abs(Ge))},O.a0=di,O.a1=$h,O.a2=ie,O.a3=n=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((s=>{e.onloadstart=()=>{s(e)};for(const u of n){const f=window.document.createElement("source");Qa(u)||(e.crossOrigin="Anonymous"),f.src=u,e.appendChild(f)}}))},O.a4=function(){return Un++},O.a5=_e,O.a6=Fu,O.a7=Co,O.a8=au,O.a9=Yh,O.aA=function(n){if(n.type==="custom")return new Xf(n);switch(n.type){case"background":return new sp(n);case"circle":return new Fp(n);case"fill":return new Ud(n);case"fill-extrusion":return new Qc(n);case"heatmap":return new kh(n);case"hillshade":return new $c(n);case"line":return new Yd(n);case"raster":return new Hh(n);case"symbol":return new bc(n)}},O.aB=Fe,O.aC=function(n,e){if(!n)return[{command:"setStyle",args:[e]}];let s=[];try{if(!zi(n.version,e.version))return[{command:"setStyle",args:[e]}];zi(n.center,e.center)||s.push({command:"setCenter",args:[e.center]}),zi(n.zoom,e.zoom)||s.push({command:"setZoom",args:[e.zoom]}),zi(n.bearing,e.bearing)||s.push({command:"setBearing",args:[e.bearing]}),zi(n.pitch,e.pitch)||s.push({command:"setPitch",args:[e.pitch]}),zi(n.sprite,e.sprite)||s.push({command:"setSprite",args:[e.sprite]}),zi(n.glyphs,e.glyphs)||s.push({command:"setGlyphs",args:[e.glyphs]}),zi(n.transition,e.transition)||s.push({command:"setTransition",args:[e.transition]}),zi(n.light,e.light)||s.push({command:"setLight",args:[e.light]}),zi(n.terrain,e.terrain)||s.push({command:"setTerrain",args:[e.terrain]}),zi(n.sky,e.sky)||s.push({command:"setSky",args:[e.sky]}),zi(n.projection,e.projection)||s.push({command:"setProjection",args:[e.projection]});const u={},f=[];(function(v,S,E,D){let R;for(R in S=S||{},v=v||{})Object.prototype.hasOwnProperty.call(v,R)&&(Object.prototype.hasOwnProperty.call(S,R)||Ar(R,E,D));for(R in S)Object.prototype.hasOwnProperty.call(S,R)&&(Object.prototype.hasOwnProperty.call(v,R)?zi(v[R],S[R])||(v[R].type==="geojson"&&S[R].type==="geojson"&&ia(v,S,R)?ln(E,{command:"setGeoJSONSourceData",args:[R,S[R].data]}):Ks(R,S,E,D)):Tr(R,S,E))})(n.sources,e.sources,f,u);const y=[];n.layers&&n.layers.forEach((v=>{"source"in v&&u[v.source]?s.push({command:"removeLayer",args:[v.id]}):y.push(v)})),s=s.concat(f),(function(v,S,E){S=S||[];const D=(v=v||[]).map(qr),R=S.map(qr),F=v.reduce(co,{}),q=S.reduce(co,{}),X=D.slice(),K=Object.create(null);let W,st,ut,Ct,gt;for(let Tt=0,Zt=0;Tt<D.length;Tt++)W=D[Tt],Object.prototype.hasOwnProperty.call(q,W)?Zt++:(ln(E,{command:"removeLayer",args:[W]}),X.splice(X.indexOf(W,Zt),1));for(let Tt=0,Zt=0;Tt<R.length;Tt++)W=R[R.length-1-Tt],X[X.length-1-Tt]!==W&&(Object.prototype.hasOwnProperty.call(F,W)?(ln(E,{command:"removeLayer",args:[W]}),X.splice(X.lastIndexOf(W,X.length-Zt),1)):Zt++,Ct=X[X.length-Tt],ln(E,{command:"addLayer",args:[q[W],Ct]}),X.splice(X.length-Tt,0,W),K[W]=!0);for(let Tt=0;Tt<R.length;Tt++)if(W=R[Tt],st=F[W],ut=q[W],!K[W]&&!zi(st,ut))if(zi(st.source,ut.source)&&zi(st["source-layer"],ut["source-layer"])&&zi(st.type,ut.type)){for(gt in gs(st.layout,ut.layout,E,W,null,"setLayoutProperty"),gs(st.paint,ut.paint,E,W,null,"setPaintProperty"),zi(st.filter,ut.filter)||ln(E,{command:"setFilter",args:[W,ut.filter]}),zi(st.minzoom,ut.minzoom)&&zi(st.maxzoom,ut.maxzoom)||ln(E,{command:"setLayerZoomRange",args:[W,ut.minzoom,ut.maxzoom]}),st)Object.prototype.hasOwnProperty.call(st,gt)&&gt!=="layout"&&gt!=="paint"&&gt!=="filter"&&gt!=="metadata"&&gt!=="minzoom"&&gt!=="maxzoom"&&(gt.indexOf("paint.")===0?gs(st[gt],ut[gt],E,W,gt.slice(6),"setPaintProperty"):zi(st[gt],ut[gt])||ln(E,{command:"setLayerProperty",args:[W,gt,ut[gt]]}));for(gt in ut)Object.prototype.hasOwnProperty.call(ut,gt)&&!Object.prototype.hasOwnProperty.call(st,gt)&&gt!=="layout"&&gt!=="paint"&&gt!=="filter"&&gt!=="metadata"&&gt!=="minzoom"&&gt!=="maxzoom"&&(gt.indexOf("paint.")===0?gs(st[gt],ut[gt],E,W,gt.slice(6),"setPaintProperty"):zi(st[gt],ut[gt])||ln(E,{command:"setLayerProperty",args:[W,gt,ut[gt]]}))}else ln(E,{command:"removeLayer",args:[W]}),Ct=X[X.lastIndexOf(W)+1],ln(E,{command:"addLayer",args:[ut,Ct]})})(y,e.layers,s)}catch(u){console.warn("Unable to compute style diff:",u),s=[{command:"setStyle",args:[e]}]}return s},O.aD=function(n){const e=[],s=n.id;return s===void 0&&e.push({message:`layers.${s}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${s}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),e},O.aE=function n(e,s){if(Array.isArray(e)){if(!Array.isArray(s)||e.length!==s.length)return!1;for(let u=0;u<e.length;u++)if(!n(e[u],s[u]))return!1;return!0}if(typeof e=="object"&&e!==null&&s!==null){if(typeof s!="object"||Object.keys(e).length!==Object.keys(s).length)return!1;for(const u in e)if(!n(e[u],s[u]))return!1;return!0}return e===s},O.aF=wn,O.aG=ca,O.aH=class extends il{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},O.aI=tu,O.aJ=class extends il{constructor(n,e){super(n,e),this.current=Al}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},O.aK=jc,O.aL=Mh,O.aM=Ci,O.aN=class extends il{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},O.aO=class extends il{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},O.aP=function(n,e,s,u,f,y,v){var S=1/(e-s),E=1/(u-f),D=1/(y-v);return n[0]=-2*S,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*E,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*D,n[11]=0,n[12]=(e+s)*S,n[13]=(f+u)*E,n[14]=(v+y)*D,n[15]=1,n},O.aQ=Ld,O.aR=class extends vt{},O.aS=dr,O.aT=class extends Pt{},O.aU=Xc,O.aV=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},O.aW=sc,O.aX=yn,O.aY=zs,O.aZ=class extends we{},O.a_=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]},O.aa=function(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((s,u,f,y)=>{const v=f||y;return e[u]=!v||v.toLowerCase(),""})),e["max-age"]){const s=parseInt(e["max-age"],10);isNaN(s)?delete e["max-age"]:e["max-age"]=s}return e},O.ab=function(n,e){const s=[];for(const u in n)u in e||s.push(u);return s},O.ac=Ni,O.ad=function(n,e,s){var u=Math.sin(s),f=Math.cos(s),y=e[0],v=e[1],S=e[2],E=e[3],D=e[4],R=e[5],F=e[6],q=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=y*f+D*u,n[1]=v*f+R*u,n[2]=S*f+F*u,n[3]=E*f+q*u,n[4]=D*f-y*u,n[5]=R*f-v*u,n[6]=F*f-S*u,n[7]=q*f-E*u,n},O.ae=function(n){var e=new ru(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},O.af=Gc,O.ag=function(n,e){let s=0,u=0;if(n.kind==="constant")u=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:f,minZoom:y,maxZoom:v}=n,S=f?Ni(Wn.interpolationFactor(f,e,y,v),0,1):0;n.kind==="camera"?u=aa.number(n.minSize,n.maxSize,S):s=S}return{uSizeT:s,uSize:u}},O.ai=function(n,{uSize:e,uSizeT:s},{lowerSize:u,upperSize:f}){return n.kind==="source"?u/ds:n.kind==="composite"?aa.number(u/ds,f/ds,s):e},O.aj=ch,O.ak=function(n,e,s,u){const f=e.y-n.y,y=e.x-n.x,v=u.y-s.y,S=u.x-s.x,E=v*y-S*f;if(E===0)return null;const D=(S*(n.y-s.y)-v*(n.x-s.x))/E;return new It(n.x+D*y,n.y+D*f)},O.al=up,O.am=df,O.an=Ih,O.ao=function(n){let e=1/0,s=1/0,u=-1/0,f=-1/0;for(const y of n)e=Math.min(e,y.x),s=Math.min(s,y.y),u=Math.max(u,y.x),f=Math.max(f,y.y);return[e,s,u,f]},O.ap=la,O.ar=uh,O.as=function(n,e){var s=e[0],u=e[1],f=e[2],y=e[3],v=e[4],S=e[5],E=e[6],D=e[7],R=e[8],F=e[9],q=e[10],X=e[11],K=e[12],W=e[13],st=e[14],ut=e[15],Ct=s*S-u*v,gt=s*E-f*v,Tt=s*D-y*v,Zt=u*E-f*S,ee=u*D-y*S,ye=f*D-y*E,Be=R*W-F*K,le=R*st-q*K,de=R*ut-X*K,Ce=F*st-q*W,Te=F*ut-X*W,be=q*ut-X*st,Gt=Ct*be-gt*Te+Tt*Ce+Zt*de-ee*le+ye*Be;return Gt?(n[0]=(S*be-E*Te+D*Ce)*(Gt=1/Gt),n[1]=(f*Te-u*be-y*Ce)*Gt,n[2]=(W*ye-st*ee+ut*Zt)*Gt,n[3]=(q*ee-F*ye-X*Zt)*Gt,n[4]=(E*de-v*be-D*le)*Gt,n[5]=(s*be-f*de+y*le)*Gt,n[6]=(st*Tt-K*ye-ut*gt)*Gt,n[7]=(R*ye-q*Tt+X*gt)*Gt,n[8]=(v*Te-S*de+D*Be)*Gt,n[9]=(u*de-s*Te-y*Be)*Gt,n[10]=(K*ee-W*Tt+ut*Ct)*Gt,n[11]=(F*Tt-R*ee-X*Ct)*Gt,n[12]=(S*le-v*Ce-E*Be)*Gt,n[13]=(s*Ce-u*le+f*Be)*Gt,n[14]=(W*gt-K*Zt-st*Ct)*Gt,n[15]=(R*Zt-F*gt+q*Ct)*Gt,n):null},O.at=Qh,O.au=xc,O.av=gh,O.aw=function(){const n={},e=Nt.$version;for(const s in Nt.$root){const u=Nt.$root[s];if(u.required){let f=null;f=s==="version"?e:u.type==="array"?[]:{},f!=null&&(n[s]=f)}}return n},O.ax=Cn,O.ay=Mi,O.az=function(n){n=n.slice();const e=Object.create(null);for(let s=0;s<n.length;s++)e[n[s].id]=n[s];for(let s=0;s<n.length;s++)"ref"in n[s]&&(n[s]=Sr(n[s],e[n[s].ref]));return n},O.b=ce,O.b0=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},O.b1=function(n,e,s){return n[0]=e[0]*s[0],n[1]=e[1]*s[1],n[2]=e[2]*s[2],n[3]=e[3]*s[3],n},O.b2=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},O.b3=Xi,O.b4=Qf,O.b5=Wf,O.b6=function(n,e,s,u,f){var y,v=1/Math.tan(e/2);return n[0]=v/s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=v,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,f!=null&&f!==1/0?(n[10]=(f+u)*(y=1/(u-f)),n[14]=2*f*u*y):(n[10]=-1,n[14]=-2*u),n},O.b7=function(n,e,s){var u=Math.sin(s),f=Math.cos(s),y=e[4],v=e[5],S=e[6],E=e[7],D=e[8],R=e[9],F=e[10],q=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=y*f+D*u,n[5]=v*f+R*u,n[6]=S*f+F*u,n[7]=E*f+q*u,n[8]=D*f-y*u,n[9]=R*f-v*u,n[10]=F*f-S*u,n[11]=q*f-E*u,n},O.b8=We,O.b9=Qi,O.bA=Uf,O.bB=function(n){return n.message===St},O.bC=Mo,O.bD=pa,O.ba=function(n){return n*Math.PI/180},O.bb=function(n,e){const{x:s,y:u}=wc.fromLngLat(e);return!(n<0||n>25||u<0||u>=1||s<0||s>=1)},O.bc=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},O.bd=class extends B{},O.be=$f,O.bf=Yp,O.bh=Ve,O.bi=function(n,e){ae.REGISTERED_PROTOCOLS[n]=e},O.bj=function(n){delete ae.REGISTERED_PROTOCOLS[n]},O.bk=function(n,e){const s={};for(let f=0;f<n.length;f++){const y=e&&e[n[f].id]||os(n[f]);e&&(e[n[f].id]=y);let v=s[y];v||(v=s[y]=[]),v.push(n[f])}const u=[];for(const f in s)u.push(s[f]);return u},O.bl=Qt,O.bm=fn,O.bn=op,O.bo=hn,O.bp=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=Jn/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const e=n.bucket.layers[0],s=e.layout,u=e._unevaluatedLayout._values,f={layoutIconSize:u["icon-size"].possiblyEvaluate(new fi(n.bucket.zoom+1),n.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new fi(n.bucket.zoom+1),n.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new fi(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:D,maxZoom:R}=n.bucket.textSizeData;f.compositeTextSizes=[u["text-size"].possiblyEvaluate(new fi(D),n.canonical),u["text-size"].possiblyEvaluate(new fi(R),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:D,maxZoom:R}=n.bucket.iconSizeData;f.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new fi(D),n.canonical),u["icon-size"].possiblyEvaluate(new fi(R),n.canonical)]}const y=s.get("text-line-height")*la,v=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",S=s.get("text-keep-upright"),E=s.get("text-size");for(const D of n.bucket.features){const R=s.get("text-font").evaluate(D,{},n.canonical).join(","),F=E.evaluate(D,{},n.canonical),q=f.layoutTextSize.evaluate(D,{},n.canonical),X=f.layoutIconSize.evaluate(D,{},n.canonical),K={horizontal:{},vertical:void 0},W=D.text;let st,ut=[0,0];if(W){const Tt=W.toString(),Zt=s.get("text-letter-spacing").evaluate(D,{},n.canonical)*la,ee=Mu(Tt)?Zt:0,ye=s.get("text-anchor").evaluate(D,{},n.canonical),Be=fp(e,D,n.canonical);if(!Be){const Te=s.get("text-radial-offset").evaluate(D,{},n.canonical);ut=Te?Mc(ye,[Te*la,ad]):s.get("text-offset").evaluate(D,{},n.canonical).map((be=>be*la))}let le=v?"center":s.get("text-justify").evaluate(D,{},n.canonical);const de=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(D,{},n.canonical)*la:1/0,Ce=()=>{n.bucket.allowVerticalPlacement&&Rr(Tt)&&(K.vertical=uo(W,n.glyphMap,n.glyphPositions,n.imagePositions,R,de,y,ye,"left",ee,ut,O.ah.vertical,!0,q,F))};if(!v&&Be){const Te=new Set;if(le==="auto")for(let Gt=0;Gt<Be.values.length;Gt+=2)Te.add(Qh(Be.values[Gt]));else Te.add(le);let be=!1;for(const Gt of Te)if(!K.horizontal[Gt])if(be)K.horizontal[Gt]=K.horizontal[0];else{const Se=uo(W,n.glyphMap,n.glyphPositions,n.imagePositions,R,de,y,"center",Gt,ee,ut,O.ah.horizontal,!1,q,F);Se&&(K.horizontal[Gt]=Se,be=Se.positionedLines.length===1)}Ce()}else{le==="auto"&&(le=Qh(ye));const Te=uo(W,n.glyphMap,n.glyphPositions,n.imagePositions,R,de,y,ye,le,ee,ut,O.ah.horizontal,!1,q,F);Te&&(K.horizontal[le]=Te),Ce(),Rr(Tt)&&v&&S&&(K.vertical=uo(W,n.glyphMap,n.glyphPositions,n.imagePositions,R,de,y,ye,le,ee,ut,O.ah.vertical,!1,q,F))}}let Ct=!1;if(D.icon&&D.icon.name){const Tt=n.imageMap[D.icon.name];Tt&&(st=qh(n.imagePositions[D.icon.name],s.get("icon-offset").evaluate(D,{},n.canonical),s.get("icon-anchor").evaluate(D,{},n.canonical)),Ct=!!Tt.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=Ct:n.bucket.sdfIcons!==Ct&&Sn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Tt.pixelRatio!==n.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const gt=_h(K.horizontal)||K.vertical;n.bucket.iconsInText=!!gt&&gt.iconsInText,(gt||st)&&Oi(n.bucket,D,K,st,n.imageMap,f,q,X,ut,Ct,n.canonical)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},O.bq=eh,O.br=hc,O.bs=Ou,O.bt=Cl,O.bu=jh,O.bv=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},O.bw=function(n,e,s,u,f){return g(this,void 0,void 0,(function*(){if(ea())try{return yield xi(n,e,s,u,f)}catch{}return(function(y,v,S,E,D){const R=y.width,F=y.height;ge&&dt||(ge=new OffscreenCanvas(R,F),dt=ge.getContext("2d",{willReadFrequently:!0})),ge.width=R,ge.height=F,dt.drawImage(y,0,0,R,F);const q=dt.getImageData(v,S,E,D);return dt.clearRect(0,0,R,F),q.data})(n,e,s,u,f)}))},O.bx=td,O.by=bt,O.bz=Et,O.c=Ht,O.d=n=>g(void 0,void 0,void 0,(function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(e)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),O.e=Xe,O.f=n=>new Promise(((e,s)=>{const u=new Image;u.onload=()=>{e(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame((()=>{u.src=re}))},u.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(n)],{type:"image/png"});u.src=n.byteLength?URL.createObjectURL(f):re})),O.g=me,O.h=(n,e)=>Vi(Xe(n,{type:"json"}),e),O.i=$i,O.j=Ua,O.k=ks,O.l=(n,e)=>Vi(Xe(n,{type:"arrayBuffer"}),e),O.m=Vi,O.n=function(n){return new jh(n).readFields(tp,[])},O.o=Hc,O.p=En,O.q=_,O.r=Re,O.s=Qa,O.t=Ra,O.u=pe,O.v=Nt,O.w=Sn,O.x=function([n,e,s]){return e+=90,e*=Math.PI/180,s*=Math.PI/180,{x:n*Math.cos(e)*Math.sin(s),y:n*Math.sin(e)*Math.sin(s),z:n*Math.cos(s)}},O.y=aa,O.z=fi})),V("worker",["./shared"],(function(O){class g{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,G){for(const at of H){this._layerConfigs[at.id]=at;const _t=this._layers[at.id]=O.aA(at);_t._featureFilter=O.a7(_t.filter),this.keyCache[at.id]&&delete this.keyCache[at.id]}for(const at of G)delete this.keyCache[at],delete this._layerConfigs[at],delete this._layers[at];this.familiesBySource={};const tt=O.bk(Object.values(this._layerConfigs),this.keyCache);for(const at of tt){const _t=at.map((Dt=>this._layers[Dt.id])),yt=_t[0];if(yt.visibility==="none")continue;const zt=yt.source||"";let ft=this.familiesBySource[zt];ft||(ft=this.familiesBySource[zt]={});const jt=yt.sourceLayer||"_geojsonTileLayer";let Kt=ft[jt];Kt||(Kt=ft[jt]=[]),Kt.push(_t)}}}class bt{constructor(H){const G={},tt=[];for(const zt in H){const ft=H[zt],jt=G[zt]={};for(const Kt in ft){const Dt=ft[+Kt];if(!Dt||Dt.bitmap.width===0||Dt.bitmap.height===0)continue;const Ft={x:0,y:0,w:Dt.bitmap.width+2,h:Dt.bitmap.height+2};tt.push(Ft),jt[Kt]={rect:Ft,metrics:Dt.metrics}}}const{w:at,h:_t}=O.p(tt),yt=new O.o({width:at||1,height:_t||1});for(const zt in H){const ft=H[zt];for(const jt in ft){const Kt=ft[+jt];if(!Kt||Kt.bitmap.width===0||Kt.bitmap.height===0)continue;const Dt=G[zt][jt].rect;O.o.copy(Kt.bitmap,yt,{x:0,y:0},{x:Dt.x+1,y:Dt.y+1},Kt.bitmap)}}this.image=yt,this.positions=G}}O.bl("GlyphAtlas",bt);class Et{constructor(H){this.tileID=new O.S(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId,this.inFlightDependencies=[]}parse(H,G,tt,at){return O._(this,void 0,void 0,(function*(){this.status="parsing",this.data=H,this.collisionBoxArray=new O.a5;const _t=new O.bm(Object.keys(H.layers).sort()),yt=new O.bn(this.tileID,this.promoteId);yt.bucketLayerIDs=[];const zt={},ft={featureIndex:yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:tt},jt=G.familiesBySource[this.source];for(const ui in jt){const Zi=H.layers[ui];if(!Zi)continue;Zi.version===1&&O.w(`Vector tile source "${this.source}" layer "${ui}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Yi=_t.encode(ui),Zn=[];for(let Mn=0;Mn<Zi.length;Mn++){const jn=Zi.feature(Mn),es=yt.getId(jn,ui);Zn.push({feature:jn,id:es,index:Mn,sourceLayerIndex:Yi})}for(const Mn of jt[ui]){const jn=Mn[0];jn.source!==this.source&&O.w(`layer.source = ${jn.source} does not equal this.source = ${this.source}`),jn.minzoom&&this.zoom<Math.floor(jn.minzoom)||jn.maxzoom&&this.zoom>=jn.maxzoom||jn.visibility!=="none"&&(Wt(Mn,this.zoom,tt),(zt[jn.id]=jn.createBucket({index:yt.bucketLayerIDs.length,layers:Mn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Yi,sourceID:this.source})).populate(Zn,ft,this.tileID.canonical),yt.bucketLayerIDs.push(Mn.map((es=>es.id))))}}const Kt=O.aF(ft.glyphDependencies,(ui=>Object.keys(ui).map(Number)));this.inFlightDependencies.forEach((ui=>ui?.abort())),this.inFlightDependencies=[];let Dt=Promise.resolve({});if(Object.keys(Kt).length){const ui=new AbortController;this.inFlightDependencies.push(ui),Dt=at.sendAsync({type:"GG",data:{stacks:Kt,source:this.source,tileID:this.tileID,type:"glyphs"}},ui)}const Ft=Object.keys(ft.iconDependencies);let ze=Promise.resolve({});if(Ft.length){const ui=new AbortController;this.inFlightDependencies.push(ui),ze=at.sendAsync({type:"GI",data:{icons:Ft,source:this.source,tileID:this.tileID,type:"icons"}},ui)}const Pe=Object.keys(ft.patternDependencies);let ri=Promise.resolve({});if(Pe.length){const ui=new AbortController;this.inFlightDependencies.push(ui),ri=at.sendAsync({type:"GI",data:{icons:Pe,source:this.source,tileID:this.tileID,type:"patterns"}},ui)}const[Le,Ye,ii]=yield Promise.all([Dt,ze,ri]),nn=new bt(Le),Tn=new O.bo(Ye,ii);for(const ui in zt){const Zi=zt[ui];Zi instanceof O.a6?(Wt(Zi.layers,this.zoom,tt),O.bp({bucket:Zi,glyphMap:Le,glyphPositions:nn.positions,imageMap:Ye,imagePositions:Tn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Zi.hasPattern&&(Zi instanceof O.bq||Zi instanceof O.br||Zi instanceof O.bs)&&(Wt(Zi.layers,this.zoom,tt),Zi.addFeatures(ft,this.tileID.canonical,Tn.patternPositions))}return this.status="done",{buckets:Object.values(zt).filter((ui=>!ui.isEmpty())),featureIndex:yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:nn.image,imageAtlas:Tn,glyphMap:this.returnDependencies?Le:null,iconMap:this.returnDependencies?Ye:null,glyphPositions:this.returnDependencies?nn.positions:null}}))}}function Wt(ot,H,G){const tt=new O.z(H);for(const at of ot)at.recalculate(tt,G)}class It{constructor(H,G,tt){this.actor=H,this.layerIndex=G,this.availableImages=tt,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(H,G){return O._(this,void 0,void 0,(function*(){const tt=yield O.l(H.request,G);try{return{vectorTile:new O.bt.VectorTile(new O.bu(tt.data)),rawData:tt.data,cacheControl:tt.cacheControl,expires:tt.expires}}catch(at){const _t=new Uint8Array(tt.data);let yt=`Unable to parse the tile at ${H.request.url}, `;throw yt+=_t[0]===31&&_t[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${at.message}`,new Error(yt)}}))}loadTile(H){return O._(this,void 0,void 0,(function*(){const G=H.uid,tt=!!(H&&H.request&&H.request.collectResourceTiming)&&new O.bv(H.request),at=new Et(H);this.loading[G]=at;const _t=new AbortController;at.abort=_t;try{const yt=yield this.loadVectorTile(H,_t);if(delete this.loading[G],!yt)return null;const zt=yt.rawData,ft={};yt.expires&&(ft.expires=yt.expires),yt.cacheControl&&(ft.cacheControl=yt.cacheControl);const jt={};if(tt){const Dt=tt.finish();Dt&&(jt.resourceTiming=JSON.parse(JSON.stringify(Dt)))}at.vectorTile=yt.vectorTile;const Kt=at.parse(yt.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[G]=at,this.fetching[G]={rawTileData:zt,cacheControl:ft,resourceTiming:jt};try{const Dt=yield Kt;return O.e({rawTileData:zt.slice(0)},Dt,ft,jt)}finally{delete this.fetching[G]}}catch(yt){throw delete this.loading[G],at.status="done",this.loaded[G]=at,yt}}))}reloadTile(H){return O._(this,void 0,void 0,(function*(){const G=H.uid;if(!this.loaded||!this.loaded[G])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const tt=this.loaded[G];if(tt.showCollisionBoxes=H.showCollisionBoxes,tt.status==="parsing"){const at=yield tt.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor);let _t;if(this.fetching[G]){const{rawTileData:yt,cacheControl:zt,resourceTiming:ft}=this.fetching[G];delete this.fetching[G],_t=O.e({rawTileData:yt.slice(0)},at,zt,ft)}else _t=at;return _t}if(tt.status==="done"&&tt.vectorTile)return tt.parse(tt.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(H){return O._(this,void 0,void 0,(function*(){const G=this.loading,tt=H.uid;G&&G[tt]&&G[tt].abort&&(G[tt].abort.abort(),delete G[tt])}))}removeTile(H){return O._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[H.uid]&&delete this.loaded[H.uid]}))}}class Mt{constructor(){this.loaded={}}loadTile(H){return O._(this,void 0,void 0,(function*(){const{uid:G,encoding:tt,rawImageData:at,redFactor:_t,greenFactor:yt,blueFactor:zt,baseShift:ft}=H,jt=at.width+2,Kt=at.height+2,Dt=O.b(at)?new O.R({width:jt,height:Kt},yield O.bw(at,-1,-1,jt,Kt)):at,Ft=new O.bx(G,Dt,tt,_t,yt,zt,ft);return this.loaded=this.loaded||{},this.loaded[G]=Ft,Ft}))}removeTile(H){const G=this.loaded,tt=H.uid;G&&G[tt]&&delete G[tt]}}function Ui(ot,H){if(ot.length!==0){Bi(ot[0],H);for(var G=1;G<ot.length;G++)Bi(ot[G],!H)}}function Bi(ot,H){for(var G=0,tt=0,at=0,_t=ot.length,yt=_t-1;at<_t;yt=at++){var zt=(ot[at][0]-ot[yt][0])*(ot[yt][1]+ot[at][1]),ft=G+zt;tt+=Math.abs(G)>=Math.abs(zt)?G-ft+zt:zt-ft+G,G=ft}G+tt>=0!=!!H&&ot.reverse()}var je=O.by((function ot(H,G){var tt,at=H&&H.type;if(at==="FeatureCollection")for(tt=0;tt<H.features.length;tt++)ot(H.features[tt],G);else if(at==="GeometryCollection")for(tt=0;tt<H.geometries.length;tt++)ot(H.geometries[tt],G);else if(at==="Feature")ot(H.geometry,G);else if(at==="Polygon")Ui(H.coordinates,G);else if(at==="MultiPolygon")for(tt=0;tt<H.coordinates.length;tt++)Ui(H.coordinates[tt],G);return H}));const gi=O.bt.VectorTileFeature.prototype.toGeoJSON;var on={exports:{}},ea=O.bz,We=O.bt.VectorTileFeature,Qi=Ni;function Ni(ot,H){this.options=H||{},this.features=ot,this.length=ot.length}function Xi(ot,H){this.id=typeof ot.id=="number"?ot.id:void 0,this.type=ot.type,this.rawGeometry=ot.type===1?[ot.geometry]:ot.geometry,this.properties=ot.tags,this.extent=H||4096}Ni.prototype.feature=function(ot){return new Xi(this.features[ot],this.options.extent)},Xi.prototype.loadGeometry=function(){var ot=this.rawGeometry;this.geometry=[];for(var H=0;H<ot.length;H++){for(var G=ot[H],tt=[],at=0;at<G.length;at++)tt.push(new ea(G[at][0],G[at][1]));this.geometry.push(tt)}return this.geometry},Xi.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ot=this.geometry,H=1/0,G=-1/0,tt=1/0,at=-1/0,_t=0;_t<ot.length;_t++)for(var yt=ot[_t],zt=0;zt<yt.length;zt++){var ft=yt[zt];H=Math.min(H,ft.x),G=Math.max(G,ft.x),tt=Math.min(tt,ft.y),at=Math.max(at,ft.y)}return[H,tt,G,at]},Xi.prototype.toGeoJSON=We.prototype.toGeoJSON;var Xe=O.bA,Un=Qi;function wn(ot){var H=new Xe;return(function(G,tt){for(var at in G.layers)tt.writeMessage(3,ca,G.layers[at])})(ot,H),H.finish()}function ca(ot,H){var G;H.writeVarintField(15,ot.version||1),H.writeStringField(1,ot.name||""),H.writeVarintField(5,ot.extent||4096);var tt={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<ot.length;G++)tt.feature=ot.feature(G),H.writeMessage(2,Fe,tt);var at=tt.keys;for(G=0;G<at.length;G++)H.writeStringField(3,at[G]);var _t=tt.values;for(G=0;G<_t.length;G++)H.writeMessage(4,Vt,_t[G])}function Fe(ot,H){var G=ot.feature;G.id!==void 0&&H.writeVarintField(1,G.id),H.writeMessage(2,Ei,ot),H.writeVarintField(3,G.type),H.writeMessage(4,$i,G)}function Ei(ot,H){var G=ot.feature,tt=ot.keys,at=ot.values,_t=ot.keycache,yt=ot.valuecache;for(var zt in G.properties){var ft=G.properties[zt],jt=_t[zt];if(ft!==null){jt===void 0&&(tt.push(zt),_t[zt]=jt=tt.length-1),H.writeVarint(jt);var Kt=typeof ft;Kt!=="string"&&Kt!=="boolean"&&Kt!=="number"&&(ft=JSON.stringify(ft));var Dt=Kt+":"+ft,Ft=yt[Dt];Ft===void 0&&(at.push(ft),yt[Dt]=Ft=at.length-1),H.writeVarint(Ft)}}}function Sn(ot,H){return(H<<3)+(7&ot)}function Pi(ot){return ot<<1^ot>>31}function $i(ot,H){for(var G=ot.loadGeometry(),tt=ot.type,at=0,_t=0,yt=G.length,zt=0;zt<yt;zt++){var ft=G[zt],jt=1;tt===1&&(jt=ft.length),H.writeVarint(Sn(1,jt));for(var Kt=tt===3?ft.length-1:ft.length,Dt=0;Dt<Kt;Dt++){Dt===1&&tt!==1&&H.writeVarint(Sn(2,Kt-1));var Ft=ft[Dt].x-at,ze=ft[Dt].y-_t;H.writeVarint(Pi(Ft)),H.writeVarint(Pi(ze)),at+=Ft,_t+=ze}tt===3&&H.writeVarint(Sn(7,1))}}function Vt(ot,H){var G=typeof ot;G==="string"?H.writeStringField(1,ot):G==="boolean"?H.writeBooleanField(7,ot):G==="number"&&(ot%1!=0?H.writeDoubleField(3,ot):ot<0?H.writeSVarintField(6,ot):H.writeVarintField(5,ot))}on.exports=wn,on.exports.fromVectorTileJs=wn,on.exports.fromGeojsonVt=function(ot,H){H=H||{};var G={};for(var tt in ot)G[tt]=new Un(ot[tt].features,H),G[tt].name=tt,G[tt].version=H.version,G[tt].extent=H.extent;return wn({layers:G})},on.exports.GeoJSONWrapper=Un;var ce=O.by(on.exports);const re={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ot=>ot},xi=Math.fround||(ge=new Float32Array(1),ot=>(ge[0]=+ot,ge[0]));var ge;const dt=3,St=5,Ht=6;class ae{constructor(H){this.options=Object.assign(Object.create(re),H),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(H){const{log:G,minZoom:tt,maxZoom:at}=this.options;G&&console.time("total time");const _t=`prepare ${H.length} points`;G&&console.time(_t),this.points=H;const yt=[];for(let ft=0;ft<H.length;ft++){const jt=H[ft];if(!jt.geometry)continue;const[Kt,Dt]=jt.geometry.coordinates,Ft=xi(Ve(Kt)),ze=xi(Mi(Dt));yt.push(Ft,ze,1/0,ft,-1,1),this.options.reduce&&yt.push(0)}let zt=this.trees[at+1]=this._createTree(yt);G&&console.timeEnd(_t);for(let ft=at;ft>=tt;ft--){const jt=+Date.now();zt=this.trees[ft]=this._createTree(this._cluster(zt,ft)),G&&console.log("z%d: %d clusters in %dms",ft,zt.numItems,+Date.now()-jt)}return G&&console.timeEnd("total time"),this}getClusters(H,G){let tt=((H[0]+180)%360+360)%360-180;const at=Math.max(-90,Math.min(90,H[1]));let _t=H[2]===180?180:((H[2]+180)%360+360)%360-180;const yt=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)tt=-180,_t=180;else if(tt>_t){const Dt=this.getClusters([tt,at,180,yt],G),Ft=this.getClusters([-180,at,_t,yt],G);return Dt.concat(Ft)}const zt=this.trees[this._limitZoom(G)],ft=zt.range(Ve(tt),Mi(yt),Ve(_t),Mi(at)),jt=zt.data,Kt=[];for(const Dt of ft){const Ft=this.stride*Dt;Kt.push(jt[Ft+St]>1?me(jt,Ft,this.clusterProps):this.points[jt[Ft+dt]])}return Kt}getChildren(H){const G=this._getOriginId(H),tt=this._getOriginZoom(H),at="No cluster with the specified id.",_t=this.trees[tt];if(!_t)throw new Error(at);const yt=_t.data;if(G*this.stride>=yt.length)throw new Error(at);const zt=this.options.radius/(this.options.extent*Math.pow(2,tt-1)),ft=_t.within(yt[G*this.stride],yt[G*this.stride+1],zt),jt=[];for(const Kt of ft){const Dt=Kt*this.stride;yt[Dt+4]===H&&jt.push(yt[Dt+St]>1?me(yt,Dt,this.clusterProps):this.points[yt[Dt+dt]])}if(jt.length===0)throw new Error(at);return jt}getLeaves(H,G,tt){const at=[];return this._appendLeaves(at,H,G=G||10,tt=tt||0,0),at}getTile(H,G,tt){const at=this.trees[this._limitZoom(H)],_t=Math.pow(2,H),{extent:yt,radius:zt}=this.options,ft=zt/yt,jt=(tt-ft)/_t,Kt=(tt+1+ft)/_t,Dt={features:[]};return this._addTileFeatures(at.range((G-ft)/_t,jt,(G+1+ft)/_t,Kt),at.data,G,tt,_t,Dt),G===0&&this._addTileFeatures(at.range(1-ft/_t,jt,1,Kt),at.data,_t,tt,_t,Dt),G===_t-1&&this._addTileFeatures(at.range(0,jt,ft/_t,Kt),at.data,-1,tt,_t,Dt),Dt.features.length?Dt:null}getClusterExpansionZoom(H){let G=this._getOriginZoom(H)-1;for(;G<=this.options.maxZoom;){const tt=this.getChildren(H);if(G++,tt.length!==1)break;H=tt[0].properties.cluster_id}return G}_appendLeaves(H,G,tt,at,_t){const yt=this.getChildren(G);for(const zt of yt){const ft=zt.properties;if(ft&&ft.cluster?_t+ft.point_count<=at?_t+=ft.point_count:_t=this._appendLeaves(H,ft.cluster_id,tt,at,_t):_t<at?_t++:H.push(zt),H.length===tt)break}return _t}_createTree(H){const G=new O.av(H.length/this.stride|0,this.options.nodeSize,Float32Array);for(let tt=0;tt<H.length;tt+=this.stride)G.add(H[tt],H[tt+1]);return G.finish(),G.data=H,G}_addTileFeatures(H,G,tt,at,_t,yt){for(const zt of H){const ft=zt*this.stride,jt=G[ft+St]>1;let Kt,Dt,Ft;if(jt)Kt=xe(G,ft,this.clusterProps),Dt=G[ft],Ft=G[ft+1];else{const ri=this.points[G[ft+dt]];Kt=ri.properties;const[Le,Ye]=ri.geometry.coordinates;Dt=Ve(Le),Ft=Mi(Ye)}const ze={type:1,geometry:[[Math.round(this.options.extent*(Dt*_t-tt)),Math.round(this.options.extent*(Ft*_t-at))]],tags:Kt};let Pe;Pe=jt||this.options.generateId?G[ft+dt]:this.points[G[ft+dt]].id,Pe!==void 0&&(ze.id=Pe),yt.features.push(ze)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,G){const{radius:tt,extent:at,reduce:_t,minPoints:yt}=this.options,zt=tt/(at*Math.pow(2,G)),ft=H.data,jt=[],Kt=this.stride;for(let Dt=0;Dt<ft.length;Dt+=Kt){if(ft[Dt+2]<=G)continue;ft[Dt+2]=G;const Ft=ft[Dt],ze=ft[Dt+1],Pe=H.within(ft[Dt],ft[Dt+1],zt),ri=ft[Dt+St];let Le=ri;for(const Ye of Pe){const ii=Ye*Kt;ft[ii+2]>G&&(Le+=ft[ii+St])}if(Le>ri&&Le>=yt){let Ye,ii=Ft*ri,nn=ze*ri,Tn=-1;const ui=((Dt/Kt|0)<<5)+(G+1)+this.points.length;for(const Zi of Pe){const Yi=Zi*Kt;if(ft[Yi+2]<=G)continue;ft[Yi+2]=G;const Zn=ft[Yi+St];ii+=ft[Yi]*Zn,nn+=ft[Yi+1]*Zn,ft[Yi+4]=ui,_t&&(Ye||(Ye=this._map(ft,Dt,!0),Tn=this.clusterProps.length,this.clusterProps.push(Ye)),_t(Ye,this._map(ft,Yi)))}ft[Dt+4]=ui,jt.push(ii/Le,nn/Le,1/0,ui,-1,Le),_t&&jt.push(Tn)}else{for(let Ye=0;Ye<Kt;Ye++)jt.push(ft[Dt+Ye]);if(Le>1)for(const Ye of Pe){const ii=Ye*Kt;if(!(ft[ii+2]<=G)){ft[ii+2]=G;for(let nn=0;nn<Kt;nn++)jt.push(ft[ii+nn])}}}}return jt}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,G,tt){if(H[G+St]>1){const yt=this.clusterProps[H[G+Ht]];return tt?Object.assign({},yt):yt}const at=this.points[H[G+dt]].properties,_t=this.options.map(at);return tt&&_t===at?Object.assign({},_t):_t}}function me(ot,H,G){return{type:"Feature",id:ot[H+dt],properties:xe(ot,H,G),geometry:{type:"Point",coordinates:[(tt=ot[H],360*(tt-.5)),Vi(ot[H+1])]}};var tt}function xe(ot,H,G){const tt=ot[H+St],at=tt>=1e4?`${Math.round(tt/1e3)}k`:tt>=1e3?Math.round(tt/100)/10+"k":tt,_t=ot[H+Ht],yt=_t===-1?{}:Object.assign({},G[_t]);return Object.assign(yt,{cluster:!0,cluster_id:ot[H+dt],point_count:tt,point_count_abbreviated:at})}function Ve(ot){return ot/360+.5}function Mi(ot){const H=Math.sin(ot*Math.PI/180),G=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return G<0?0:G>1?1:G}function Vi(ot){const H=(180-360*ot)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function Qa(ot,H,G,tt){let at=tt;const _t=H+(G-H>>1);let yt,zt=G-H;const ft=ot[H],jt=ot[H+1],Kt=ot[G],Dt=ot[G+1];for(let Ft=H+3;Ft<G;Ft+=3){const ze=Ys(ot[Ft],ot[Ft+1],ft,jt,Kt,Dt);if(ze>at)yt=Ft,at=ze;else if(ze===at){const Pe=Math.abs(Ft-_t);Pe<zt&&(yt=Ft,zt=Pe)}}at>tt&&(yt-H>3&&Qa(ot,H,yt,tt),ot[yt+2]=at,G-yt>3&&Qa(ot,yt,G,tt))}function Ys(ot,H,G,tt,at,_t){let yt=at-G,zt=_t-tt;if(yt!==0||zt!==0){const ft=((ot-G)*yt+(H-tt)*zt)/(yt*yt+zt*zt);ft>1?(G=at,tt=_t):ft>0&&(G+=yt*ft,tt+=zt*ft)}return yt=ot-G,zt=H-tt,yt*yt+zt*zt}function za(ot,H,G,tt){const at={id:ot??null,type:H,geometry:G,tags:tt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(H==="Point"||H==="MultiPoint"||H==="LineString")ks(at,G);else if(H==="Polygon")ks(at,G[0]);else if(H==="MultiLineString")for(const _t of G)ks(at,_t);else if(H==="MultiPolygon")for(const _t of G)ks(at,_t[0]);return at}function ks(ot,H){for(let G=0;G<H.length;G+=3)ot.minX=Math.min(ot.minX,H[G]),ot.minY=Math.min(ot.minY,H[G+1]),ot.maxX=Math.max(ot.maxX,H[G]),ot.maxY=Math.max(ot.maxY,H[G+1])}function Ua(ot,H,G,tt){if(!H.geometry)return;const at=H.geometry.coordinates;if(at&&at.length===0)return;const _t=H.geometry.type,yt=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2);let zt=[],ft=H.id;if(G.promoteId?ft=H.properties[G.promoteId]:G.generateId&&(ft=tt||0),_t==="Point")br(at,zt);else if(_t==="MultiPoint")for(const jt of at)br(jt,zt);else if(_t==="LineString")Nt(at,zt,yt,!1);else if(_t==="MultiLineString"){if(G.lineMetrics){for(const jt of at)zt=[],Nt(jt,zt,yt,!1),ot.push(za(ft,"LineString",zt,H.properties));return}wr(at,zt,yt,!1)}else if(_t==="Polygon")wr(at,zt,yt,!0);else{if(_t!=="MultiPolygon"){if(_t==="GeometryCollection"){for(const jt of H.geometry.geometries)Ua(ot,{id:ft,geometry:jt,properties:H.properties},G,tt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const jt of at){const Kt=[];wr(jt,Kt,yt,!0),zt.push(Kt)}}ot.push(za(ft,_t,zt,H.properties))}function br(ot,H){H.push(Sr(ot[0]),zi(ot[1]),0)}function Nt(ot,H,G,tt){let at,_t,yt=0;for(let ft=0;ft<ot.length;ft++){const jt=Sr(ot[ft][0]),Kt=zi(ot[ft][1]);H.push(jt,Kt,0),ft>0&&(yt+=tt?(at*Kt-jt*_t)/2:Math.sqrt(Math.pow(jt-at,2)+Math.pow(Kt-_t,2))),at=jt,_t=Kt}const zt=H.length-3;H[2]=1,Qa(H,0,zt,G),H[zt+2]=1,H.size=Math.abs(yt),H.start=0,H.end=H.size}function wr(ot,H,G,tt){for(let at=0;at<ot.length;at++){const _t=[];Nt(ot[at],_t,G,tt),H.push(_t)}}function Sr(ot){return ot/360+.5}function zi(ot){const H=Math.sin(ot*Math.PI/180),G=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return G<0?0:G>1?1:G}function ln(ot,H,G,tt,at,_t,yt,zt){if(tt/=H,_t>=(G/=H)&&yt<tt)return ot;if(yt<G||_t>=tt)return null;const ft=[];for(const jt of ot){const Kt=jt.geometry;let Dt=jt.type;const Ft=at===0?jt.minX:jt.minY,ze=at===0?jt.maxX:jt.maxY;if(Ft>=G&&ze<tt){ft.push(jt);continue}if(ze<G||Ft>=tt)continue;let Pe=[];if(Dt==="Point"||Dt==="MultiPoint")Tr(Kt,Pe,G,tt,at);else if(Dt==="LineString")Ar(Kt,Pe,G,tt,at,!1,zt.lineMetrics);else if(Dt==="MultiLineString")ia(Kt,Pe,G,tt,at,!1);else if(Dt==="Polygon")ia(Kt,Pe,G,tt,at,!0);else if(Dt==="MultiPolygon")for(const ri of Kt){const Le=[];ia(ri,Le,G,tt,at,!0),Le.length&&Pe.push(Le)}if(Pe.length){if(zt.lineMetrics&&Dt==="LineString"){for(const ri of Pe)ft.push(za(jt.id,Dt,ri,jt.tags));continue}Dt!=="LineString"&&Dt!=="MultiLineString"||(Pe.length===1?(Dt="LineString",Pe=Pe[0]):Dt="MultiLineString"),Dt!=="Point"&&Dt!=="MultiPoint"||(Dt=Pe.length===3?"Point":"MultiPoint"),ft.push(za(jt.id,Dt,Pe,jt.tags))}}return ft.length?ft:null}function Tr(ot,H,G,tt,at){for(let _t=0;_t<ot.length;_t+=3){const yt=ot[_t+at];yt>=G&&yt<=tt&&gs(H,ot[_t],ot[_t+1],ot[_t+2])}}function Ar(ot,H,G,tt,at,_t,yt){let zt=Ks(ot);const ft=at===0?qr:co;let jt,Kt,Dt=ot.start;for(let Le=0;Le<ot.length-3;Le+=3){const Ye=ot[Le],ii=ot[Le+1],nn=ot[Le+2],Tn=ot[Le+3],ui=ot[Le+4],Zi=at===0?Ye:ii,Yi=at===0?Tn:ui;let Zn=!1;yt&&(jt=Math.sqrt(Math.pow(Ye-Tn,2)+Math.pow(ii-ui,2))),Zi<G?Yi>G&&(Kt=ft(zt,Ye,ii,Tn,ui,G),yt&&(zt.start=Dt+jt*Kt)):Zi>tt?Yi<tt&&(Kt=ft(zt,Ye,ii,Tn,ui,tt),yt&&(zt.start=Dt+jt*Kt)):gs(zt,Ye,ii,nn),Yi<G&&Zi>=G&&(Kt=ft(zt,Ye,ii,Tn,ui,G),Zn=!0),Yi>tt&&Zi<=tt&&(Kt=ft(zt,Ye,ii,Tn,ui,tt),Zn=!0),!_t&&Zn&&(yt&&(zt.end=Dt+jt*Kt),H.push(zt),zt=Ks(ot)),yt&&(Dt+=jt)}let Ft=ot.length-3;const ze=ot[Ft],Pe=ot[Ft+1],ri=at===0?ze:Pe;ri>=G&&ri<=tt&&gs(zt,ze,Pe,ot[Ft+2]),Ft=zt.length-3,_t&&Ft>=3&&(zt[Ft]!==zt[0]||zt[Ft+1]!==zt[1])&&gs(zt,zt[0],zt[1],zt[2]),zt.length&&H.push(zt)}function Ks(ot){const H=[];return H.size=ot.size,H.start=ot.start,H.end=ot.end,H}function ia(ot,H,G,tt,at,_t){for(const yt of ot)Ar(yt,H,G,tt,at,_t,!1)}function gs(ot,H,G,tt){ot.push(H,G,tt)}function qr(ot,H,G,tt,at,_t){const yt=(_t-H)/(tt-H);return gs(ot,_t,G+(at-G)*yt,1),yt}function co(ot,H,G,tt,at,_t){const yt=(_t-G)/(at-G);return gs(ot,H+(tt-H)*yt,_t,1),yt}function ie(ot,H){const G=[];for(let tt=0;tt<ot.length;tt++){const at=ot[tt],_t=at.type;let yt;if(_t==="Point"||_t==="MultiPoint"||_t==="LineString")yt=Ws(at.geometry,H);else if(_t==="MultiLineString"||_t==="Polygon"){yt=[];for(const zt of at.geometry)yt.push(Ws(zt,H))}else if(_t==="MultiPolygon"){yt=[];for(const zt of at.geometry){const ft=[];for(const jt of zt)ft.push(Ws(jt,H));yt.push(ft)}}G.push(za(at.id,_t,yt,at.tags))}return G}function Ws(ot,H){const G=[];G.size=ot.size,ot.start!==void 0&&(G.start=ot.start,G.end=ot.end);for(let tt=0;tt<ot.length;tt+=3)G.push(ot[tt]+H,ot[tt+1],ot[tt+2]);return G}function ha(ot,H){if(ot.transformed)return ot;const G=1<<ot.z,tt=ot.x,at=ot.y;for(const _t of ot.features){const yt=_t.geometry,zt=_t.type;if(_t.geometry=[],zt===1)for(let ft=0;ft<yt.length;ft+=2)_t.geometry.push(Rs(yt[ft],yt[ft+1],H,G,tt,at));else for(let ft=0;ft<yt.length;ft++){const jt=[];for(let Kt=0;Kt<yt[ft].length;Kt+=2)jt.push(Rs(yt[ft][Kt],yt[ft][Kt+1],H,G,tt,at));_t.geometry.push(jt)}}return ot.transformed=!0,ot}function Rs(ot,H,G,tt,at,_t){return[Math.round(G*(ot*tt-at)),Math.round(G*(H*tt-_t))]}function Gr(ot,H,G,tt,at){const _t=H===at.maxZoom?0:at.tolerance/((1<<H)*at.extent),yt={features:[],numPoints:0,numSimplified:0,numFeatures:ot.length,source:null,x:G,y:tt,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const zt of ot)oe(yt,zt,_t,at);return yt}function oe(ot,H,G,tt){const at=H.geometry,_t=H.type,yt=[];if(ot.minX=Math.min(ot.minX,H.minX),ot.minY=Math.min(ot.minY,H.minY),ot.maxX=Math.max(ot.maxX,H.maxX),ot.maxY=Math.max(ot.maxY,H.maxY),_t==="Point"||_t==="MultiPoint")for(let zt=0;zt<at.length;zt+=3)yt.push(at[zt],at[zt+1]),ot.numPoints++,ot.numSimplified++;else if(_t==="LineString")ke(yt,at,ot,G,!1,!1);else if(_t==="MultiLineString"||_t==="Polygon")for(let zt=0;zt<at.length;zt++)ke(yt,at[zt],ot,G,_t==="Polygon",zt===0);else if(_t==="MultiPolygon")for(let zt=0;zt<at.length;zt++){const ft=at[zt];for(let jt=0;jt<ft.length;jt++)ke(yt,ft[jt],ot,G,!0,jt===0)}if(yt.length){let zt=H.tags||null;if(_t==="LineString"&&tt.lineMetrics){zt={};for(const jt in H.tags)zt[jt]=H.tags[jt];zt.mapbox_clip_start=at.start/at.size,zt.mapbox_clip_end=at.end/at.size}const ft={geometry:yt,type:_t==="Polygon"||_t==="MultiPolygon"?3:_t==="LineString"||_t==="MultiLineString"?2:1,tags:zt};H.id!==null&&(ft.id=H.id),ot.features.push(ft)}}function ke(ot,H,G,tt,at,_t){const yt=tt*tt;if(tt>0&&H.size<(at?yt:tt))return void(G.numPoints+=H.length/3);const zt=[];for(let ft=0;ft<H.length;ft+=3)(tt===0||H[ft+2]>yt)&&(G.numSimplified++,zt.push(H[ft],H[ft+1])),G.numPoints++;at&&(function(ft,jt){let Kt=0;for(let Dt=0,Ft=ft.length,ze=Ft-2;Dt<Ft;ze=Dt,Dt+=2)Kt+=(ft[Dt]-ft[ze])*(ft[Dt+1]+ft[ze+1]);if(Kt>0===jt)for(let Dt=0,Ft=ft.length;Dt<Ft/2;Dt+=2){const ze=ft[Dt],Pe=ft[Dt+1];ft[Dt]=ft[Ft-2-Dt],ft[Dt+1]=ft[Ft-1-Dt],ft[Ft-2-Dt]=ze,ft[Ft-1-Dt]=Pe}})(zt,_t),ot.push(zt)}const Ie={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class un{constructor(H,G){const tt=(G=this.options=(function(_t,yt){for(const zt in yt)_t[zt]=yt[zt];return _t})(Object.create(Ie),G)).debug;if(tt&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");let at=(function(_t,yt){const zt=[];if(_t.type==="FeatureCollection")for(let ft=0;ft<_t.features.length;ft++)Ua(zt,_t.features[ft],yt,ft);else Ua(zt,_t.type==="Feature"?_t:{geometry:_t},yt);return zt})(H,G);this.tiles={},this.tileCoords=[],tt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),at=(function(_t,yt){const zt=yt.buffer/yt.extent;let ft=_t;const jt=ln(_t,1,-1-zt,zt,0,-1,2,yt),Kt=ln(_t,1,1-zt,2+zt,0,-1,2,yt);return(jt||Kt)&&(ft=ln(_t,1,-zt,1+zt,0,-1,2,yt)||[],jt&&(ft=ie(jt,1).concat(ft)),Kt&&(ft=ft.concat(ie(Kt,-1)))),ft})(at,G),at.length&&this.splitTile(at,0,0,0),tt&&(at.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(H,G,tt,at,_t,yt,zt){const ft=[H,G,tt,at],jt=this.options,Kt=jt.debug;for(;ft.length;){at=ft.pop(),tt=ft.pop(),G=ft.pop(),H=ft.pop();const Dt=1<<G,Ft=Ca(G,tt,at);let ze=this.tiles[Ft];if(!ze&&(Kt>1&&console.time("creation"),ze=this.tiles[Ft]=Gr(H,G,tt,at,jt),this.tileCoords.push({z:G,x:tt,y:at}),Kt)){Kt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,tt,at,ze.numFeatures,ze.numPoints,ze.numSimplified),console.timeEnd("creation"));const Zn=`z${G}`;this.stats[Zn]=(this.stats[Zn]||0)+1,this.total++}if(ze.source=H,_t==null){if(G===jt.indexMaxZoom||ze.numPoints<=jt.indexMaxPoints)continue}else{if(G===jt.maxZoom||G===_t)continue;if(_t!=null){const Zn=_t-G;if(tt!==yt>>Zn||at!==zt>>Zn)continue}}if(ze.source=null,H.length===0)continue;Kt>1&&console.time("clipping");const Pe=.5*jt.buffer/jt.extent,ri=.5-Pe,Le=.5+Pe,Ye=1+Pe;let ii=null,nn=null,Tn=null,ui=null,Zi=ln(H,Dt,tt-Pe,tt+Le,0,ze.minX,ze.maxX,jt),Yi=ln(H,Dt,tt+ri,tt+Ye,0,ze.minX,ze.maxX,jt);H=null,Zi&&(ii=ln(Zi,Dt,at-Pe,at+Le,1,ze.minY,ze.maxY,jt),nn=ln(Zi,Dt,at+ri,at+Ye,1,ze.minY,ze.maxY,jt),Zi=null),Yi&&(Tn=ln(Yi,Dt,at-Pe,at+Le,1,ze.minY,ze.maxY,jt),ui=ln(Yi,Dt,at+ri,at+Ye,1,ze.minY,ze.maxY,jt),Yi=null),Kt>1&&console.timeEnd("clipping"),ft.push(ii||[],G+1,2*tt,2*at),ft.push(nn||[],G+1,2*tt,2*at+1),ft.push(Tn||[],G+1,2*tt+1,2*at),ft.push(ui||[],G+1,2*tt+1,2*at+1)}}getTile(H,G,tt){H=+H,G=+G,tt=+tt;const at=this.options,{extent:_t,debug:yt}=at;if(H<0||H>24)return null;const zt=1<<H,ft=Ca(H,G=G+zt&zt-1,tt);if(this.tiles[ft])return ha(this.tiles[ft],_t);yt>1&&console.log("drilling down to z%d-%d-%d",H,G,tt);let jt,Kt=H,Dt=G,Ft=tt;for(;!jt&&Kt>0;)Kt--,Dt>>=1,Ft>>=1,jt=this.tiles[Ca(Kt,Dt,Ft)];return jt&&jt.source?(yt>1&&(console.log("found parent tile z%d-%d-%d",Kt,Dt,Ft),console.time("drilling down")),this.splitTile(jt.source,Kt,Dt,Ft,H,G,tt),yt>1&&console.timeEnd("drilling down"),this.tiles[ft]?ha(this.tiles[ft],_t):null):null}}function Ca(ot,H,G){return 32*((1<<ot)*G+H)+ot}function Qe(ot,H){return H?ot.properties[H]:ot.id}function Js(ot,H){if(ot==null)return!0;if(ot.type==="Feature")return Qe(ot,H)!=null;if(ot.type==="FeatureCollection"){const G=new Set;for(const tt of ot.features){const at=Qe(tt,H);if(at==null||G.has(at))return!1;G.add(at)}return!0}return!1}function ts(ot,H){const G=new Map;if(ot!=null)if(ot.type==="Feature")G.set(Qe(ot,H),ot);else for(const tt of ot.features)G.set(Qe(tt,H),tt);return G}class ys extends It{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(H,G){return O._(this,void 0,void 0,(function*(){const tt=H.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const at=this._geoJSONIndex.getTile(tt.z,tt.x,tt.y);if(!at)return null;const _t=new class{constructor(zt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=O.X,this.length=zt.length,this._features=zt}feature(zt){return new class{constructor(ft){this._feature=ft,this.extent=O.X,this.type=ft.type,this.properties=ft.tags,"id"in ft&&!isNaN(ft.id)&&(this.id=parseInt(ft.id,10))}loadGeometry(){if(this._feature.type===1){const ft=[];for(const jt of this._feature.geometry)ft.push([new O.P(jt[0],jt[1])]);return ft}{const ft=[];for(const jt of this._feature.geometry){const Kt=[];for(const Dt of jt)Kt.push(new O.P(Dt[0],Dt[1]));ft.push(Kt)}return ft}}toGeoJSON(ft,jt,Kt){return gi.call(this,ft,jt,Kt)}}(this._features[zt])}}(at.features);let yt=ce(_t);return yt.byteOffset===0&&yt.byteLength===yt.buffer.byteLength||(yt=new Uint8Array(yt)),{vectorTile:_t,rawData:yt.buffer}}))}loadData(H){return O._(this,void 0,void 0,(function*(){var G;(G=this._pendingRequest)===null||G===void 0||G.abort();const tt=!!(H&&H.request&&H.request.collectResourceTiming)&&new O.bv(H.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(H,this._pendingRequest),this._geoJSONIndex=H.cluster?new ae((function({superclusterOptions:yt,clusterProperties:zt}){if(!zt||!yt)return yt;const ft={},jt={},Kt={accumulated:null,zoom:0},Dt={properties:null},Ft=Object.keys(zt);for(const ze of Ft){const[Pe,ri]=zt[ze],Le=O.bC(ri),Ye=O.bC(typeof Pe=="string"?[Pe,["accumulated"],["get",ze]]:Pe);ft[ze]=Le.value,jt[ze]=Ye.value}return yt.map=ze=>{Dt.properties=ze;const Pe={};for(const ri of Ft)Pe[ri]=ft[ri].evaluate(Kt,Dt);return Pe},yt.reduce=(ze,Pe)=>{Dt.properties=Pe;for(const ri of Ft)Kt.accumulated=ze[ri],ze[ri]=jt[ri].evaluate(Kt,Dt)},yt})(H)).load((yield this._pendingData).features):(at=yield this._pendingData,new un(at,H.geojsonVtOptions)),this.loaded={};const _t={};if(tt){const yt=tt.finish();yt&&(_t.resourceTiming={},_t.resourceTiming[H.source]=JSON.parse(JSON.stringify(yt)))}return _t}catch(_t){if(delete this._pendingRequest,O.bB(_t))return{abandoned:!0};throw _t}var at}))}getData(){return O._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(H){const G=this.loaded;return G&&G[H.uid]?super.reloadTile(H):this.loadTile(H)}loadAndProcessGeoJSON(H,G){return O._(this,void 0,void 0,(function*(){let tt=yield this.loadGeoJSON(H,G);if(delete this._pendingRequest,typeof tt!="object")throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`);if(je(tt,!0),H.filter){const at=O.bC(H.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(at.result==="error")throw new Error(at.value.map((yt=>`${yt.key}: ${yt.message}`)).join(", "));tt={type:"FeatureCollection",features:tt.features.filter((yt=>at.value.evaluate({zoom:0},yt)))}}return tt}))}loadGeoJSON(H,G){return O._(this,void 0,void 0,(function*(){const{promoteId:tt}=H;if(H.request){const at=yield O.h(H.request,G);return this._dataUpdateable=Js(at.data,tt)?ts(at.data,tt):void 0,at.data}if(typeof H.data=="string")try{const at=JSON.parse(H.data);return this._dataUpdateable=Js(at,tt)?ts(at,tt):void 0,at}catch{throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`)}if(!H.dataDiff)throw new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${H.source}`);return(function(at,_t,yt){var zt,ft,jt,Kt;if(_t.removeAll&&at.clear(),_t.remove)for(const Dt of _t.remove)at.delete(Dt);if(_t.add)for(const Dt of _t.add){const Ft=Qe(Dt,yt);Ft!=null&&at.set(Ft,Dt)}if(_t.update)for(const Dt of _t.update){let Ft=at.get(Dt.id);if(Ft==null)continue;const ze=!Dt.removeAllProperties&&(((zt=Dt.removeProperties)===null||zt===void 0?void 0:zt.length)>0||((ft=Dt.addOrUpdateProperties)===null||ft===void 0?void 0:ft.length)>0);if((Dt.newGeometry||Dt.removeAllProperties||ze)&&(Ft=Object.assign({},Ft),at.set(Dt.id,Ft),ze&&(Ft.properties=Object.assign({},Ft.properties))),Dt.newGeometry&&(Ft.geometry=Dt.newGeometry),Dt.removeAllProperties)Ft.properties={};else if(((jt=Dt.removeProperties)===null||jt===void 0?void 0:jt.length)>0)for(const Pe of Dt.removeProperties)Object.prototype.hasOwnProperty.call(Ft.properties,Pe)&&delete Ft.properties[Pe];if(((Kt=Dt.addOrUpdateProperties)===null||Kt===void 0?void 0:Kt.length)>0)for(const{key:Pe,value:ri}of Dt.addOrUpdateProperties)Ft.properties[Pe]=ri}})(this._dataUpdateable,H.dataDiff,tt),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(H){return O._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(H){return this._geoJSONIndex.getClusterExpansionZoom(H.clusterId)}getClusterChildren(H){return this._geoJSONIndex.getChildren(H.clusterId)}getClusterLeaves(H){return this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset)}}class Za{constructor(H){this.self=H,this.actor=new O.F(H),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(G,tt)=>{if(this.externalWorkerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.externalWorkerSourceTypes[G]=tt},this.self.addProtocol=O.bi,this.self.removeProtocol=O.bj,this.self.registerRTLTextPlugin=G=>{if(O.bD.isParsed())throw new Error("RTL text plugin already registered.");O.bD.setMethods(G)},this.actor.registerMessageHandler("LDT",((G,tt)=>this._getDEMWorkerSource(G,tt.source).loadTile(tt))),this.actor.registerMessageHandler("RDT",((G,tt)=>O._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(G,tt.source).removeTile(tt)})))),this.actor.registerMessageHandler("GCEZ",((G,tt)=>O._(this,void 0,void 0,(function*(){return this._getWorkerSource(G,tt.type,tt.source).getClusterExpansionZoom(tt)})))),this.actor.registerMessageHandler("GCC",((G,tt)=>O._(this,void 0,void 0,(function*(){return this._getWorkerSource(G,tt.type,tt.source).getClusterChildren(tt)})))),this.actor.registerMessageHandler("GCL",((G,tt)=>O._(this,void 0,void 0,(function*(){return this._getWorkerSource(G,tt.type,tt.source).getClusterLeaves(tt)})))),this.actor.registerMessageHandler("LD",((G,tt)=>this._getWorkerSource(G,tt.type,tt.source).loadData(tt))),this.actor.registerMessageHandler("GD",((G,tt)=>this._getWorkerSource(G,tt.type,tt.source).getData())),this.actor.registerMessageHandler("LT",((G,tt)=>this._getWorkerSource(G,tt.type,tt.source).loadTile(tt))),this.actor.registerMessageHandler("RT",((G,tt)=>this._getWorkerSource(G,tt.type,tt.source).reloadTile(tt))),this.actor.registerMessageHandler("AT",((G,tt)=>this._getWorkerSource(G,tt.type,tt.source).abortTile(tt))),this.actor.registerMessageHandler("RMT",((G,tt)=>this._getWorkerSource(G,tt.type,tt.source).removeTile(tt))),this.actor.registerMessageHandler("RS",((G,tt)=>O._(this,void 0,void 0,(function*(){if(!this.workerSources[G]||!this.workerSources[G][tt.type]||!this.workerSources[G][tt.type][tt.source])return;const at=this.workerSources[G][tt.type][tt.source];delete this.workerSources[G][tt.type][tt.source],at.removeSource!==void 0&&at.removeSource(tt)})))),this.actor.registerMessageHandler("RM",(G=>O._(this,void 0,void 0,(function*(){delete this.layerIndexes[G],delete this.availableImages[G],delete this.workerSources[G],delete this.demWorkerSources[G]})))),this.actor.registerMessageHandler("SR",((G,tt)=>O._(this,void 0,void 0,(function*(){this.referrer=tt})))),this.actor.registerMessageHandler("SRPS",((G,tt)=>this._syncRTLPluginState(G,tt))),this.actor.registerMessageHandler("IS",((G,tt)=>O._(this,void 0,void 0,(function*(){this.self.importScripts(tt)})))),this.actor.registerMessageHandler("SI",((G,tt)=>this._setImages(G,tt))),this.actor.registerMessageHandler("UL",((G,tt)=>O._(this,void 0,void 0,(function*(){this._getLayerIndex(G).update(tt.layers,tt.removedIds)})))),this.actor.registerMessageHandler("SL",((G,tt)=>O._(this,void 0,void 0,(function*(){this._getLayerIndex(G).replace(tt)}))))}_setImages(H,G){return O._(this,void 0,void 0,(function*(){this.availableImages[H]=G;for(const tt in this.workerSources[H]){const at=this.workerSources[H][tt];for(const _t in at)at[_t].availableImages=G}}))}_syncRTLPluginState(H,G){return O._(this,void 0,void 0,(function*(){if(O.bD.isParsed())return O.bD.getState();if(G.pluginStatus!=="loading")return O.bD.setState(G),G;const tt=G.pluginURL;if(this.self.importScripts(tt),O.bD.isParsed()){const at={pluginStatus:"loaded",pluginURL:tt};return O.bD.setState(at),at}throw O.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${tt}`)}))}_getAvailableImages(H){let G=this.availableImages[H];return G||(G=[]),G}_getLayerIndex(H){let G=this.layerIndexes[H];return G||(G=this.layerIndexes[H]=new g),G}_getWorkerSource(H,G,tt){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][G]||(this.workerSources[H][G]={}),!this.workerSources[H][G][tt]){const at={sendAsync:(_t,yt)=>(_t.targetMapId=H,this.actor.sendAsync(_t,yt))};switch(G){case"vector":this.workerSources[H][G][tt]=new It(at,this._getLayerIndex(H),this._getAvailableImages(H));break;case"geojson":this.workerSources[H][G][tt]=new ys(at,this._getLayerIndex(H),this._getAvailableImages(H));break;default:this.workerSources[H][G][tt]=new this.externalWorkerSourceTypes[G](at,this._getLayerIndex(H),this._getAvailableImages(H))}}return this.workerSources[H][G][tt]}_getDEMWorkerSource(H,G){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][G]||(this.demWorkerSources[H][G]=new Mt),this.demWorkerSources[H][G]}}return O.i(self)&&(self.worker=new Za(self)),Za})),V("index",["exports","./shared"],(function(O,g){var bt="4.7.1";let Et,Wt;const It={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:_=>new Promise(((t,o)=>{const c=requestAnimationFrame(t);_.signal.addEventListener("abort",(()=>{cancelAnimationFrame(c),o(g.c())}))})),getImageData(_,t=0){return this.getImageCanvasContext(_).getImageData(-t,-t,_.width+2*t,_.height+2*t)},getImageCanvasContext(_){const t=window.document.createElement("canvas"),o=t.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return t.width=_.width,t.height=_.height,o.drawImage(_,0,0,_.width,_.height),o},resolveURL:_=>(Et||(Et=document.createElement("a")),Et.href=_,Et.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Wt==null&&(Wt=matchMedia("(prefers-reduced-motion: reduce)")),Wt.matches)}};class Mt{static testProp(t){if(!Mt.docStyle)return t[0];for(let o=0;o<t.length;o++)if(t[o]in Mt.docStyle)return t[o];return t[0]}static create(t,o,c){const h=window.document.createElement(t);return o!==void 0&&(h.className=o),c&&c.appendChild(h),h}static createNS(t,o){return window.document.createElementNS(t,o)}static disableDrag(){Mt.docStyle&&Mt.selectProp&&(Mt.userSelect=Mt.docStyle[Mt.selectProp],Mt.docStyle[Mt.selectProp]="none")}static enableDrag(){Mt.docStyle&&Mt.selectProp&&(Mt.docStyle[Mt.selectProp]=Mt.userSelect)}static setTransform(t,o){t.style[Mt.transformProp]=o}static addEventListener(t,o,c,h={}){t.addEventListener(o,c,"passive"in h?h:h.capture)}static removeEventListener(t,o,c,h={}){t.removeEventListener(o,c,"passive"in h?h:h.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",Mt.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Mt.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",Mt.suppressClickInternal,!0)}),0)}static getScale(t){const o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}static getPoint(t,o,c){const h=o.boundingClientRect;return new g.P((c.clientX-h.left)/o.x-t.clientLeft,(c.clientY-h.top)/o.y-t.clientTop)}static mousePos(t,o){const c=Mt.getScale(t);return Mt.getPoint(t,c,o)}static touchPos(t,o){const c=[],h=Mt.getScale(t);for(let m=0;m<o.length;m++)c.push(Mt.getPoint(t,h,o[m]));return c}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}Mt.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,Mt.selectProp=Mt.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Mt.transformProp=Mt.testProp(["transform","WebkitTransform"]);const Ui={supported:!1,testSupport:function(_){!gi&&je&&(on?ea(_):Bi=_)}};let Bi,je,gi=!1,on=!1;function ea(_){const t=_.createTexture();_.bindTexture(_.TEXTURE_2D,t);try{if(_.texImage2D(_.TEXTURE_2D,0,_.RGBA,_.RGBA,_.UNSIGNED_BYTE,je),_.isContextLost())return;Ui.supported=!0}catch{}_.deleteTexture(t),gi=!0}var We;typeof document<"u"&&(je=document.createElement("img"),je.onload=()=>{Bi&&ea(Bi),Bi=null,on=!0},je.onerror=()=>{gi=!0,Bi=null},je.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(_){let t,o,c,h;_.resetRequestQueue=()=>{t=[],o=0,c=0,h={}},_.addThrottleControl=P=>{const B=c++;return h[B]=P,B},_.removeThrottleControl=P=>{delete h[P],T()},_.getImage=(P,B,Z=!0)=>new Promise(((j,$)=>{Ui.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),g.e(P,{type:"image"}),t.push({abortController:B,requestParameters:P,supportImageRefresh:Z,state:"queued",onError:J=>{$(J)},onSuccess:J=>{j(J)}}),T()}));const m=P=>g._(this,void 0,void 0,(function*(){P.state="running";const{requestParameters:B,supportImageRefresh:Z,onError:j,onSuccess:$,abortController:J}=P,et=Z===!1&&!g.i(self)&&!g.g(B.url)&&(!B.headers||Object.keys(B.headers).reduce(((ht,pt)=>ht&&pt==="accept"),!0));o++;const rt=et?z(B,J):g.m(B,J);try{const ht=yield rt;delete P.abortController,P.state="completed",ht.data instanceof HTMLImageElement||g.b(ht.data)?$(ht):ht.data&&$({data:yield(ct=ht.data,typeof createImageBitmap=="function"?g.d(ct):g.f(ct)),cacheControl:ht.cacheControl,expires:ht.expires})}catch(ht){delete P.abortController,j(ht)}finally{o--,T()}var ct})),T=()=>{const P=(()=>{for(const B of Object.keys(h))if(h[B]())return!0;return!1})()?g.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:g.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let B=o;B<P&&t.length>0;B++){const Z=t.shift();Z.abortController.signal.aborted?B--:m(Z)}},z=(P,B)=>new Promise(((Z,j)=>{const $=new Image,J=P.url,et=P.credentials;et&&et==="include"?$.crossOrigin="use-credentials":(et&&et==="same-origin"||!g.s(J))&&($.crossOrigin="anonymous"),B.signal.addEventListener("abort",(()=>{$.src="",j(g.c())})),$.fetchPriority="high",$.onload=()=>{$.onerror=$.onload=null,Z({data:$})},$.onerror=()=>{$.onerror=$.onload=null,B.signal.aborted||j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},$.src=J}))})(We||(We={})),We.resetRequestQueue();class Qi{constructor(t){this._transformRequestFn=t}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function Ni(_){var t=new g.A(3);return t[0]=_[0],t[1]=_[1],t[2]=_[2],t}var Xi,Xe=function(_,t,o){return _[0]=t[0]-o[0],_[1]=t[1]-o[1],_[2]=t[2]-o[2],_};Xi=new g.A(3),g.A!=Float32Array&&(Xi[0]=0,Xi[1]=0,Xi[2]=0);var Un=function(_){var t=_[0],o=_[1];return t*t+o*o};function wn(_){const t=[];if(typeof _=="string")t.push({id:"default",url:_});else if(_&&_.length>0){const o=[];for(const{id:c,url:h}of _){const m=`${c}${h}`;o.indexOf(m)===-1&&(o.push(m),t.push({id:c,url:h}))}}return t}function ca(_,t,o){const c=_.split("?");return c[0]+=`${t}${o}`,c.join("?")}(function(){var _=new g.A(2);g.A!=Float32Array&&(_[0]=0,_[1]=0)})();class Fe{constructor(t,o,c,h){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(o,h)}update(t,o,c){const{width:h,height:m}=t,T=!(this.size&&this.size[0]===h&&this.size[1]===m||c),{context:z}=this,{gl:P}=z;if(this.useMipmap=!!(o&&o.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),z.pixelStoreUnpackFlipY.set(!1),z.pixelStoreUnpack.set(1),z.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!o||o.premultiply!==!1)),T)this.size=[h,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||g.b(t)?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,t):P.texImage2D(P.TEXTURE_2D,0,this.format,h,m,0,this.format,P.UNSIGNED_BYTE,t.data);else{const{x:B,y:Z}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||g.b(t)?P.texSubImage2D(P.TEXTURE_2D,0,B,Z,P.RGBA,P.UNSIGNED_BYTE,t):P.texSubImage2D(P.TEXTURE_2D,0,B,Z,h,m,P.RGBA,P.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)}bind(t,o,c){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),c!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,c||t),this.filter=t),o!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Ei(_){const{userImage:t}=_;return!!(t&&t.render&&t.render())&&(_.data.replace(new Uint8Array(t.data.buffer)),!0)}class Sn extends g.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new g.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:o,promiseResolve:c}of this.requestors)c(this._getImagesForIds(o));this.requestors=[]}}getImage(t){const o=this.images[t];if(o&&!o.data&&o.spriteData){const c=o.spriteData;o.data=new g.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),o.spriteData=null}return o}addImage(t,o){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,o)&&(this.images[t]=o)}_validate(t,o){let c=!0;const h=o.data||o.spriteData;return this._validateStretch(o.stretchX,h&&h.width)||(this.fire(new g.j(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(o.stretchY,h&&h.height)||(this.fire(new g.j(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(o.content,o)||(this.fire(new g.j(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,o){if(!t)return!0;let c=0;for(const h of t){if(h[0]<c||h[1]<h[0]||o<h[1])return!1;c=h[1]}return!0}_validateContent(t,o){if(!t)return!0;if(t.length!==4)return!1;const c=o.spriteData,h=c&&c.width||o.data.width,m=c&&c.height||o.data.height;return!(t[0]<0||h<t[0]||t[1]<0||m<t[1]||t[2]<0||h<t[2]||t[3]<0||m<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,o,c=!0){const h=this.getImage(t);if(c&&(h.data.width!==o.data.width||h.data.height!==o.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=h.version+1,this.images[t]=o,this.updatedImages[t]=!0}removeImage(t){const o=this.images[t];delete this.images[t],delete this.patterns[t],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((o,c)=>{let h=!0;if(!this.isLoaded())for(const m of t)this.images[m]||(h=!1);this.isLoaded()||h?o(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:o})}))}_getImagesForIds(t){const o={};for(const c of t){let h=this.getImage(c);h||(this.fire(new g.k("styleimagemissing",{id:c})),h=this.getImage(c)),h?o[c]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:g.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:t,height:o}=this.atlasImage;return{width:t,height:o}}getPattern(t){const o=this.patterns[t],c=this.getImage(t);if(!c)return null;if(o&&o.position.version===c.version)return o.position;if(o)o.position.version=c.version;else{const h={w:c.data.width+2,h:c.data.height+2,x:0,y:0},m=new g.I(h,c);this.patterns[t]={bin:h,position:m}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const o=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Fe(t,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const m in this.patterns)t.push(this.patterns[m].bin);const{w:o,h:c}=g.p(t),h=this.atlasImage;h.resize({width:o||1,height:c||1});for(const m in this.patterns){const{bin:T}=this.patterns[m],z=T.x+1,P=T.y+1,B=this.getImage(m).data,Z=B.width,j=B.height;g.R.copy(B,h,{x:0,y:0},{x:z,y:P},{width:Z,height:j}),g.R.copy(B,h,{x:0,y:j-1},{x:z,y:P-1},{width:Z,height:1}),g.R.copy(B,h,{x:0,y:0},{x:z,y:P+j},{width:Z,height:1}),g.R.copy(B,h,{x:Z-1,y:0},{x:z-1,y:P},{width:1,height:j}),g.R.copy(B,h,{x:0,y:0},{x:z+Z,y:P},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const o of t){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const c=this.getImage(o);c||g.w(`Image with ID: "${o}" was not found`),Ei(c)&&this.updateImage(o,c)}}}const Pi=1e20;function $i(_,t,o,c,h,m,T,z,P){for(let B=t;B<t+c;B++)Vt(_,o*m+B,m,h,T,z,P);for(let B=o;B<o+h;B++)Vt(_,B*m+t,1,c,T,z,P)}function Vt(_,t,o,c,h,m,T){m[0]=0,T[0]=-Pi,T[1]=Pi,h[0]=_[t];for(let z=1,P=0,B=0;z<c;z++){h[z]=_[t+z*o];const Z=z*z;do{const j=m[P];B=(h[z]-h[j]+Z-j*j)/(z-j)/2}while(B<=T[P]&&--P>-1);P++,m[P]=z,T[P]=B,T[P+1]=Pi}for(let z=0,P=0;z<c;z++){for(;T[P+1]<z;)P++;const B=m[P],Z=z-B;_[t+z*o]=h[B]+Z*Z}}class ce{constructor(t,o){this.requestManager=t,this.localIdeographFontFamily=o,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return g._(this,void 0,void 0,(function*(){const o=[];for(const m in t)for(const T of t[m])o.push(this._getAndCacheGlyphsPromise(m,T));const c=yield Promise.all(o),h={};for(const{stack:m,id:T,glyph:z}of c)h[m]||(h[m]={}),h[m][T]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return h}))}_getAndCacheGlyphsPromise(t,o){return g._(this,void 0,void 0,(function*(){let c=this.entries[t];c||(c=this.entries[t]={glyphs:{},requests:{},ranges:{}});let h=c.glyphs[o];if(h!==void 0)return{stack:t,id:o,glyph:h};if(h=this._tinySDF(c,t,o),h)return c.glyphs[o]=h,{stack:t,id:o,glyph:h};const m=Math.floor(o/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[m])return{stack:t,id:o,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[m]){const z=ce.loadGlyphRange(t,m,this.url,this.requestManager);c.requests[m]=z}const T=yield c.requests[m];for(const z in T)this._doesCharSupportLocalGlyph(+z)||(c.glyphs[+z]=T[+z]);return c.ranges[m]=!0,{stack:t,id:o,glyph:T[o]||null}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))}_tinySDF(t,o,c){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(c))return;let m=t.tinySDF;if(!m){let z="400";/bold/i.test(o)?z="900":/medium/i.test(o)?z="500":/light/i.test(o)&&(z="200"),m=t.tinySDF=new ce.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:z})}const T=m.draw(String.fromCharCode(c));return{id:c,bitmap:new g.o({width:T.width||60,height:T.height||60},T.data),metrics:{width:T.glyphWidth/2||24,height:T.glyphHeight/2||24,left:T.glyphLeft/2+.5||0,top:T.glyphTop/2-27.5||-8,advance:T.glyphAdvance/2||24,isDoubleResolution:!0}}}}ce.loadGlyphRange=function(_,t,o,c){return g._(this,void 0,void 0,(function*(){const h=256*t,m=h+255,T=c.transformRequest(o.replace("{fontstack}",_).replace("{range}",`${h}-${m}`),"Glyphs"),z=yield g.l(T,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${t}, ${h}-${m}`);const P={};for(const B of g.n(z.data))P[B.id]=B;return P}))},ce.TinySDF=class{constructor({fontSize:_=24,buffer:t=3,radius:o=8,cutoff:c=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:T="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=o;const z=this.size=_+4*t,P=this._createCanvas(z),B=this.ctx=P.getContext("2d",{willReadFrequently:!0});B.font=`${T} ${m} ${_}px ${h}`,B.textBaseline="alphabetic",B.textAlign="left",B.fillStyle="black",this.gridOuter=new Float64Array(z*z),this.gridInner=new Float64Array(z*z),this.f=new Float64Array(z),this.z=new Float64Array(z+1),this.v=new Uint16Array(z)}_createCanvas(_){const t=document.createElement("canvas");return t.width=t.height=_,t}draw(_){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(_),T=Math.ceil(o),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),P=Math.min(this.size-this.buffer,T+Math.ceil(c)),B=z+2*this.buffer,Z=P+2*this.buffer,j=Math.max(B*Z,0),$=new Uint8ClampedArray(j),J={data:$,width:B,height:Z,glyphWidth:z,glyphHeight:P,glyphTop:T,glyphLeft:0,glyphAdvance:t};if(z===0||P===0)return J;const{ctx:et,buffer:rt,gridInner:ct,gridOuter:ht}=this;et.clearRect(rt,rt,z,P),et.fillText(_,rt,rt+T);const pt=et.getImageData(rt,rt,z,P);ht.fill(Pi,0,j),ct.fill(0,0,j);for(let nt=0;nt<P;nt++)for(let vt=0;vt<z;vt++){const wt=pt.data[4*(nt*z+vt)+3]/255;if(wt===0)continue;const Pt=(nt+rt)*B+vt+rt;if(wt===1)ht[Pt]=0,ct[Pt]=Pi;else{const Xt=.5-wt;ht[Pt]=Xt>0?Xt*Xt:0,ct[Pt]=Xt<0?Xt*Xt:0}}$i(ht,0,0,B,Z,B,this.f,this.v,this.z),$i(ct,rt,rt,z,P,B,this.f,this.v,this.z);for(let nt=0;nt<j;nt++){const vt=Math.sqrt(ht[nt])-Math.sqrt(ct[nt]);$[nt]=Math.round(255-255*(vt/this.radius+this.cutoff))}return J}};class re{constructor(){this.specification=g.v.light.position}possiblyEvaluate(t,o){return g.x(t.expression.evaluate(o))}interpolate(t,o,c){return{x:g.y.number(t.x,o.x,c),y:g.y.number(t.y,o.y,c),z:g.y.number(t.z,o.z,c)}}}let xi;class ge extends g.E{constructor(t){super(),xi=xi||new g.q({anchor:new g.D(g.v.light.anchor),position:new re,color:new g.D(g.v.light.color),intensity:new g.D(g.v.light.intensity)}),this._transitionable=new g.T(xi),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o={}){if(!this._validate(g.r,t,o))for(const c in t){const h=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),h):this._transitionable.setValue(c,h)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,c){return(!c||c.validate!==!1)&&g.t(this,t.call(g.u,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:g.v}))}}const dt=new g.q({"sky-color":new g.D(g.v.sky["sky-color"]),"horizon-color":new g.D(g.v.sky["horizon-color"]),"fog-color":new g.D(g.v.sky["fog-color"]),"fog-ground-blend":new g.D(g.v.sky["fog-ground-blend"]),"horizon-fog-blend":new g.D(g.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new g.D(g.v.sky["sky-horizon-blend"]),"atmosphere-blend":new g.D(g.v.sky["atmosphere-blend"])});class St extends g.E{constructor(t){super(),this._transitionable=new g.T(dt),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new g.z(0))}setSky(t,o={}){if(!this._validate(g.B,t,o)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in t){const h=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),h):this._transitionable.setValue(c,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,c={}){return c?.validate!==!1&&g.t(this,t.call(g.u,g.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:g.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class Ht{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,o){const c=t.join(",")+String(o);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,o)),this.dashEntry[c]}getDashRanges(t,o,c){const h=[];let m=t.length%2==1?-t[t.length-1]*c:0,T=t[0]*c,z=!0;h.push({left:m,right:T,isDash:z,zeroLength:t[0]===0});let P=t[0];for(let B=1;B<t.length;B++){z=!z;const Z=t[B];m=P*c,P+=Z,T=P*c,h.push({left:m,right:T,isDash:z,zeroLength:Z===0})}return h}addRoundDash(t,o,c){const h=o/2;for(let m=-c;m<=c;m++){const T=this.width*(this.nextRow+c+m);let z=0,P=t[z];for(let B=0;B<this.width;B++){B/P.right>1&&(P=t[++z]);const Z=Math.abs(B-P.left),j=Math.abs(B-P.right),$=Math.min(Z,j);let J;const et=m/c*(h+1);if(P.isDash){const rt=h-Math.abs(et);J=Math.sqrt($*$+rt*rt)}else J=h-Math.sqrt($*$+et*et);this.data[T+B]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(t){for(let z=t.length-1;z>=0;--z){const P=t[z],B=t[z+1];P.zeroLength?t.splice(z,1):B&&B.isDash===P.isDash&&(B.left=P.left,t.splice(z,1))}const o=t[0],c=t[t.length-1];o.isDash===c.isDash&&(o.left=c.left-this.width,c.right=o.right+this.width);const h=this.width*this.nextRow;let m=0,T=t[m];for(let z=0;z<this.width;z++){z/T.right>1&&(T=t[++m]);const P=Math.abs(z-T.left),B=Math.abs(z-T.right),Z=Math.min(P,B);this.data[h+z]=Math.max(0,Math.min(255,(T.isDash?Z:-Z)+128))}}addDash(t,o){const c=o?7:0,h=2*c+1;if(this.nextRow+h>this.height)return g.w("LineAtlas out of space"),null;let m=0;for(let z=0;z<t.length;z++)m+=t[z];if(m!==0){const z=this.width/m,P=this.getDashRanges(t,this.width,z);o?this.addRoundDash(P,z,c):this.addRegularDash(P)}const T={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:m};return this.nextRow+=h,this.dirty=!0,T}bind(t){const o=t.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const ae="maplibre_preloaded_worker_pool";class me{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<me.workerCount;)this.workers.push(new Worker(g.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((o=>{o.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[ae]}numActive(){return Object.keys(this.active).length}}const xe=Math.floor(It.hardwareConcurrency/2);let Ve,Mi;function Vi(){return Ve||(Ve=new me),Ve}me.workerCount=g.C(globalThis)?Math.max(Math.min(xe,3),1):1;class Qa{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=o;const c=this.workerPool.acquire(o);for(let h=0;h<c.length;h++){const m=new g.F(c[h],o);m.name=`Worker ${h}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,o){const c=[];for(const h of this.actors)c.push(h.sendAsync({type:t,data:o}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((o=>{o.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,o){for(const c of this.actors)c.registerMessageHandler(t,o)}}function Ys(){return Mi||(Mi=new Qa(Vi(),g.G),Mi.registerMessageHandler("GR",((_,t,o)=>g.m(t,o)))),Mi}function za(_,t){const o=g.H();return g.J(o,o,[1,1,0]),g.K(o,o,[.5*_.width,.5*_.height,1]),g.L(o,o,_.calculatePosMatrix(t.toUnwrapped()))}function ks(_,t,o,c,h,m){const T=(function(j,$,J){if(j)for(const et of j){const rt=$[et];if(rt&&rt.source===J&&rt.type==="fill-extrusion")return!0}else for(const et in $){const rt=$[et];if(rt.source===J&&rt.type==="fill-extrusion")return!0}return!1})(h&&h.layers,t,_.id),z=m.maxPitchScaleFactor(),P=_.tilesIn(c,z,T);P.sort(Ua);const B=[];for(const j of P)B.push({wrappedTileID:j.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(t,o,_._state,j.queryGeometry,j.cameraQueryGeometry,j.scale,h,m,z,za(_.transform,j.tileID))});const Z=(function(j){const $={},J={};for(const et of j){const rt=et.queryResults,ct=et.wrappedTileID,ht=J[ct]=J[ct]||{};for(const pt in rt){const nt=rt[pt],vt=ht[pt]=ht[pt]||{},wt=$[pt]=$[pt]||[];for(const Pt of nt)vt[Pt.featureIndex]||(vt[Pt.featureIndex]=!0,wt.push(Pt))}}return $})(B);for(const j in Z)Z[j].forEach(($=>{const J=$.feature,et=_.getFeatureState(J.layer["source-layer"],J.id);J.source=J.layer.source,J.layer["source-layer"]&&(J.sourceLayer=J.layer["source-layer"]),J.state=et}));return Z}function Ua(_,t){const o=_.tileID,c=t.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}function br(_,t,o){return g._(this,void 0,void 0,(function*(){let c=_;if(_.url?c=(yield g.h(t.transformRequest(_.url,"Source"),o)).data:yield It.frameAsync(o),!c)return null;const h=g.M(g.e(c,_),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(h.vectorLayerIds=c.vector_layers.map((m=>m.id))),h}))}class Nt{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof g.N?new g.N(t.lng,t.lat):g.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof g.N?new g.N(t.lng,t.lat):g.N.convert(t),this}extend(t){const o=this._sw,c=this._ne;let h,m;if(t instanceof g.N)h=t,m=t;else{if(!(t instanceof Nt))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Nt.convert(t)):this.extend(g.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(g.N.convert(t)):this;if(h=t._sw,m=t._ne,!h||!m)return this}return o||c?(o.lng=Math.min(h.lng,o.lng),o.lat=Math.min(h.lat,o.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new g.N(h.lng,h.lat),this._ne=new g.N(m.lng,m.lat)),this}getCenter(){return new g.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new g.N(this.getWest(),this.getNorth())}getSouthEast(){return new g.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:c}=g.N.convert(t);let h=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&h}static convert(t){return t instanceof Nt?t:t&&new Nt(t)}static fromLngLat(t,o=0){const c=360*o/40075017,h=c/Math.cos(Math.PI/180*t.lat);return new Nt(new g.N(t.lng-h,t.lat-c),new g.N(t.lng+h,t.lat+c))}adjustAntiMeridian(){const t=new g.N(this._sw.lng,this._sw.lat),o=new g.N(this._ne.lng,this._ne.lat);return new Nt(t,t.lng>o.lng?new g.N(o.lng+360,o.lat):o)}}class wr{constructor(t,o,c){this.bounds=Nt.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),c=Math.floor(g.O(this.bounds.getWest())*o),h=Math.floor(g.Q(this.bounds.getNorth())*o),m=Math.ceil(g.O(this.bounds.getEast())*o),T=Math.ceil(g.Q(this.bounds.getSouth())*o);return t.x>=c&&t.x<m&&t.y>=h&&t.y<T}}class Sr extends g.E{constructor(t,o,c,h){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,g.e(this,g.M(o,["url","scheme","tileSize","promoteId"])),this._options=g.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return g._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new g.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield br(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(g.e(this,t),t.bounds&&(this.tileBounds=new wr(t.bounds,this.minzoom,this.maxzoom)),this.fire(new g.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new g.j(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return g.e({},this._options)}loadTile(t){return g._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(o,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((m,T)=>{t.reloadPromise={resolve:m,reject:T}}))}else t.actor=this.dispatcher.getActor(),h="LT";t.abortController=new AbortController;try{const m=yield t.actor.sendAsync({type:h,data:c},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,m)}catch(m){if(delete t.abortController,t.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(t,null)}}))}_afterTileLoadWorkerResponse(t,o){if(o&&o.resourceTiming&&(t.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&t.setExpiryData(o),t.loadVectorData(o,this.map.painter),t.reloadPromise){const c=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(c.resolve).catch(c.reject)}}abortTile(t){return g._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return g._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class zi extends g.E{constructor(t,o,c,h){super(),this.id=t,this.dispatcher=c,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=g.e({type:"raster"},o),g.e(this,g.M(o,["url","scheme","tileSize"]))}load(){return g._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new g.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield br(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(g.e(this,t),t.bounds&&(this.tileBounds=new wr(t.bounds,this.minzoom,this.maxzoom)),this.fire(new g.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new g.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new g.j(t))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return g.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return g._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const c=yield We.getImage(this.map._requestManager.transformRequest(o,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&t.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const h=this.map.painter.context,m=h.gl,T=c.data;t.texture=this.map.painter.getTileTexture(T.width),t.texture?t.texture.update(T,{useMipmap:!0}):(t.texture=new Fe(h,T,m.RGBA,{useMipmap:!0}),t.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(c){if(delete t.abortController,t.aborted)t.state="unloaded";else if(c)throw t.state="errored",c}}))}abortTile(t){return g._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return g._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class ln extends zi{constructor(t,o,c,h){super(t,o,c,h),this.type="raster-dem",this.maxzoom=22,this._options=g.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(t){return g._(this,void 0,void 0,(function*(){const o=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(o,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const h=yield We.getImage(c,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(h&&h.data){const m=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&t.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const T=g.b(m)&&g.U()?m:yield this.readImageNow(m),z={type:this.type,uid:t.uid,source:this.id,rawImageData:T,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const P=yield t.actor.sendAsync({type:"LDT",data:z});t.dem=P,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(h){if(delete t.abortController,t.aborted)t.state="unloaded";else if(h)throw t.state="errored",h}}))}readImageNow(t){return g._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&g.V()){const o=t.width+2,c=t.height+2;try{return new g.R({width:o,height:c},yield g.W(t,-1,-1,o,c))}catch{}}return It.getImageData(t,1)}))}_getNeighboringTiles(t){const o=t.canonical,c=Math.pow(2,o.z),h=(o.x-1+c)%c,m=o.x===0?t.wrap-1:t.wrap,T=(o.x+1+c)%c,z=o.x+1===c?t.wrap+1:t.wrap,P={};return P[new g.S(t.overscaledZ,m,o.z,h,o.y).key]={backfilled:!1},P[new g.S(t.overscaledZ,z,o.z,T,o.y).key]={backfilled:!1},o.y>0&&(P[new g.S(t.overscaledZ,m,o.z,h,o.y-1).key]={backfilled:!1},P[new g.S(t.overscaledZ,t.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},P[new g.S(t.overscaledZ,z,o.z,T,o.y-1).key]={backfilled:!1}),o.y+1<c&&(P[new g.S(t.overscaledZ,m,o.z,h,o.y+1).key]={backfilled:!1},P[new g.S(t.overscaledZ,t.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},P[new g.S(t.overscaledZ,z,o.z,T,o.y+1).key]={backfilled:!1}),P}unloadTile(t){return g._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}class Tr extends g.E{constructor(t,o,c,h){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(h),this._data=o.data,this._options=g.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const m=g.X/this.tileSize;o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&g.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=g.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*m,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*m,extent:g.X,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:g.X,radius:(o.clusterRadius||50)*m,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return g._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return g._(this,void 0,void 0,(function*(){const t=g.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,o,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:o,offset:c}})}_updateWorkerData(t){return g._(this,void 0,void 0,(function*(){const o=g.e({type:this.type},this.workerOptions);t?o.dataDiff=t:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(It.resolveURL(this._data),"Source"),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new g.k("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:o});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new g.k("dataabort",{dataType:"source"}));let h=null;c.resourceTiming&&c.resourceTiming[this.id]&&(h=c.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&g.e(m,{resourceTiming:h}),this.fire(new g.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new g.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new g.k("dataabort",{dataType:"source"}));this.fire(new g.j(c))}}))}loaded(){return this._pendingLoads===0}loadTile(t){return g._(this,void 0,void 0,(function*(){const o=t.actor?"RT":"LT";t.actor=this.actor;const c={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const h=yield this.actor.sendAsync({type:o,data:c},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(h,this.map.painter,o==="RT")}))}abortTile(t){return g._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return g._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return g.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ar=g.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ks extends g.E{constructor(t,o,c,h){super(),this.id=t,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=o}load(t){return g._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new g.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield We.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,t&&(this.coordinates=t),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new g.j(o))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new g.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const o=t.map(g.Z.fromLngLat);this.tileID=(function(h){let m=1/0,T=1/0,z=-1/0,P=-1/0;for(const $ of h)m=Math.min(m,$.x),T=Math.min(T,$.y),z=Math.max(z,$.x),P=Math.max(P,$.y);const B=Math.max(z-m,P-T),Z=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),j=Math.pow(2,Z);return new g.a1(Z,Math.floor((m+z)/2*j),Math.floor((T+P)/2*j))})(o),this.minzoom=this.maxzoom=this.tileID.z;const c=o.map((h=>this.tileID.getTilePoint(h)._round()));return this._boundsArray=new g.$,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,g.X,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,g.X),this._boundsArray.emplaceBack(c[2].x,c[2].y,g.X,g.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new g.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,o=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Ar.members)),this.boundsSegments||(this.boundsSegments=g.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Fe(t,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let c=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new g.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return g._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ia extends Ks{constructor(t,o,c,h){super(t,o,c,h),this.roundZoom=!0,this.type="video",this.options=o}load(){return g._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const o of t.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield g.a3(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new g.j(o))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const o=this.video.seekable;t<o.start(0)||t>o.end(0)?this.fire(new g.j(new g.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,o=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Ar.members)),this.boundsSegments||(this.boundsSegments=g.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new Fe(t,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let c=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new g.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class gs extends Ks{constructor(t,o,c,h){super(t,o,c,h),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((m=>!Array.isArray(m)||m.length!==2||m.some((T=>typeof T!="number"))))||this.fire(new g.j(new g.a2(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new g.j(new g.a2(`sources.${t}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new g.j(new g.a2(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new g.j(new g.a2(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new g.j(new g.a2(`sources.${t}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return g._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new g.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,c=o.gl;this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,Ar.members)),this.boundsSegments||(this.boundsSegments=g.a0.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Fe(o,this.canvas,c.RGBA,{premultiply:!0});let h=!1;for(const m in this.tiles){const T=this.tiles[m];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,h=!0)}h&&this.fire(new g.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const qr={},co=_=>{switch(_){case"geojson":return Tr;case"image":return Ks;case"raster":return zi;case"raster-dem":return ln;case"vector":return Sr;case"video":return ia;case"canvas":return gs}return qr[_]},ie="RTLPluginLoaded";class Ws extends g.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ys()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((o=>{throw this.status="error",o}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return g._(this,arguments,void 0,(function*(o,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=It.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return g._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new g.k(ie))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let ha=null;function Rs(){return ha||(ha=new Ws),ha}class Gr{constructor(t,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=g.a4(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const o=t+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,o,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(h,m){const T={};if(!m)return T;for(const z of h){const P=z.layerIds.map((B=>m.getLayer(B))).filter(Boolean);if(P.length!==0){z.layers=P,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map((B=>P.filter((Z=>Z.id===B))[0])));for(const B of P)T[B.id]=z}}return T})(t.buckets,o.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof g.a6){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof g.a6&&m.hasRTLText){this.hasRTLText=!0,Rs().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(h).queryRadius(m))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new g.a5}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const h=this.buckets[c];h.uploadPending()&&h.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Fe(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Fe(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,o,c,h,m,T,z,P,B,Z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:m,scale:T,tileSize:this.tileSize,pixelPosMatrix:Z,transform:P,params:z,queryPadding:this.queryPadding*B},t,o,c):{}}querySourceFeatures(t,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const h=c.loadVTLayers(),m=o&&o.sourceLayer?o.sourceLayer:"",T=h._geojsonTileLayer||h[m];if(!T)return;const z=g.a7(o&&o.filter),{z:P,x:B,y:Z}=this.tileID.canonical,j={z:P,x:B,y:Z};for(let $=0;$<T.length;$++){const J=T.feature($);if(z.needGeometry){const ct=g.a8(J,!0);if(!z.filter(new g.z(this.tileID.overscaledZ),ct,this.tileID.canonical))continue}else if(!z.filter(new g.z(this.tileID.overscaledZ),J))continue;const et=c.getId(J,m),rt=new g.a9(J,P,B,Z,et);rt.tile=j,t.push(rt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const c=g.aa(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let h=!1;if(this.expirationTime>c)h=!1;else if(o)if(this.expirationTime<o)h=!0;else{const m=this.expirationTime-o;m?this.expirationTime=c+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!o.style.hasLayer(h))continue;const m=this.buckets[h],T=m.layers[0].sourceLayer||"_geojsonTileLayer",z=c[T],P=t[T];if(!z||!P||Object.keys(P).length===0)continue;m.update(P,z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const B=o&&o.style&&o.style.getLayer(h);B&&(this.queryPadding=Math.max(this.queryPadding,B.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<It.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=It.now()+t}setDependencies(t,o){const c={};for(const h of o)c[h]=!0;this.dependencies[t]=c}hasDependency(t,o){for(const c of t){const h=this.dependencies[c];if(h){for(const m of o)if(h[m])return!0}}return!1}}class oe{constructor(t,o){this.max=t,this.onRemove=o,this.reset()}reset(){for(const t in this.data)for(const o of this.data[t])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(t,o,c){const h=t.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:o,timeout:void 0};if(c!==void 0&&(m.timeout=setTimeout((()=>{this.remove(t,m)}),c)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const o=this.data[t].shift();return o.timeout&&clearTimeout(o.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),o.value}getByKey(t){const o=this.data[t];return o?o[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,o){if(!this.has(t))return this;const c=t.wrapped().key,h=o===void 0?0:this.data[c].indexOf(o),m=this.data[c][h];return this.data[c].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(t){const o=[];for(const c in this.data)for(const h of this.data[c])t(h.value)||o.push(h);for(const c of o)this.remove(c.value.tileID,c)}}class ke{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,c){const h=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][h]=this.stateChanges[t][h]||{},g.e(this.stateChanges[t][h],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const m in this.state[t])m!==h&&(this.deletedStates[t][m]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][h]===null){this.deletedStates[t][h]={};for(const m in this.state[t][h])c[m]||(this.deletedStates[t][h][m]=null)}else for(const m in c)this.deletedStates[t]&&this.deletedStates[t][h]&&this.deletedStates[t][h][m]===null&&delete this.deletedStates[t][h][m]}removeFeatureState(t,o,c){if(this.deletedStates[t]===null)return;const h=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&o!==void 0)this.deletedStates[t][h]!==null&&(this.deletedStates[t][h]=this.deletedStates[t][h]||{},this.deletedStates[t][h][c]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][h])for(c in this.deletedStates[t][h]={},this.stateChanges[t][h])this.deletedStates[t][h][c]=null;else this.deletedStates[t][h]=null;else this.deletedStates[t]=null}getState(t,o){const c=String(o),h=g.e({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const m=this.deletedStates[t][o];if(m===null)return{};for(const T in m)delete h[T]}return h}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const c={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const T in this.stateChanges[h])this.state[h][T]||(this.state[h][T]={}),g.e(this.state[h][T],this.stateChanges[h][T]),m[T]=this.state[h][T];c[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const T in this.state[h])m[T]={},this.state[h][T]={};else for(const T in this.deletedStates[h]){if(this.deletedStates[h][T]===null)this.state[h][T]={};else for(const z of Object.keys(this.deletedStates[h][T]))delete this.state[h][T][z];m[T]=this.state[h][T]}c[h]=c[h]||{},g.e(c[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const h in t)t[h].setFeatureState(c,o)}}class Ie extends g.E{constructor(t,o,c){super(),this.id=t,this.dispatcher=c,this.on("data",(h=>this._dataHandler(h))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((h,m,T,z)=>{const P=new(co(m.type))(h,m,T,z);if(P.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${P.id}`);return P})(t,o,c,this),this._tiles={},this._cache=new oe(0,(h=>this._unloadTile(h))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ke,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const o=this._tiles[t];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,o,c){return g._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,o,c)}catch(h){t.state="errored",h.status!==404?this._source.fire(new g.j(h,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new g.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(un).map((t=>t.key))}getRenderableIds(t){const o=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&o.push(this._tiles[c]);return t?o.sort(((c,h)=>{const m=c.tileID,T=h.tileID,z=new g.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),P=new g.P(T.canonical.x,T.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-T.overscaledZ||P.y-z.y||P.x-z.x})).map((c=>c.tileID.key)):o.map((c=>c.tileID)).sort(un).map((c=>c.key))}hasRenderableParent(t){const o=this.findLoadedParent(t,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(t,o){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(o||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,o){return g._(this,void 0,void 0,(function*(){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=o),yield this._loadTile(c,t,o))}))}_tileLoaded(t,o,c){t.timeAdded=It.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new g.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const o=this.getRenderableIds();for(let h=0;h<o.length;h++){const m=o[h];if(t.neighboringTiles&&t.neighboringTiles[m]){const T=this.getTileByID(m);c(t,T),c(T,t)}}function c(h,m){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let T=m.tileID.canonical.x-h.tileID.canonical.x;const z=m.tileID.canonical.y-h.tileID.canonical.y,P=Math.pow(2,h.tileID.canonical.z),B=m.tileID.key;T===0&&z===0||Math.abs(z)>1||(Math.abs(T)>1&&(Math.abs(T+P)===1?T+=P:Math.abs(T-P)===1&&(T-=P)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,T,z),h.neighboringTiles&&h.neighboringTiles[B]&&(h.neighboringTiles[B].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,o,c,h){for(const m in this._tiles){let T=this._tiles[m];if(h[m]||!T.hasData()||T.tileID.overscaledZ<=o||T.tileID.overscaledZ>c)continue;let z=T.tileID;for(;T&&T.tileID.overscaledZ>o+1;){const B=T.tileID.scaledTo(T.tileID.overscaledZ-1);T=this._tiles[B.key],T&&T.hasData()&&(z=B)}let P=z;for(;P.overscaledZ>o;)if(P=P.scaledTo(P.overscaledZ-1),t[P.key]){h[z.key]=z;break}}}findLoadedParent(t,o){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=t.overscaledZ-1;c>=o;c--){const h=t.scaledTo(c),m=this._getLoadedTile(h);if(m)return m}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const o=this._tiles[t.key];return o&&o.hasData()?o:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const o=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,h=Math.floor(o*c*(this._maxTileCacheZoomLevels===null?g.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(m)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,o){const c={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+o),c[m.tileID.key]=m}this._tiles=c;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(t,o,c,h,m,T){const z={},P={},B=Object.keys(t),Z=It.now();for(const j of B){const $=t[j],J=this._tiles[j];if(!J||J.fadeEndTime!==0&&J.fadeEndTime<=Z)continue;const et=this.findLoadedParent($,o),rt=this.findLoadedSibling($),ct=et||rt||null;ct&&(this._addTile(ct.tileID),z[ct.tileID.key]=ct.tileID),P[j]=$}this._retainLoadedChildren(P,h,c,t);for(const j in z)t[j]||(this._coveredTiles[j]=!0,t[j]=z[j]);if(T){const j={},$={};for(const J of m)this._tiles[J.key].hasData()?j[J.key]=J:$[J.key]=J;for(const J in $){const et=$[J].children(this._source.maxzoom);this._tiles[et[0].key]&&this._tiles[et[1].key]&&this._tiles[et[2].key]&&this._tiles[et[3].key]&&(j[et[0].key]=t[et[0].key]=et[0],j[et[1].key]=t[et[1].key]=et[1],j[et[2].key]=t[et[2].key]=et[2],j[et[3].key]=t[et[3].key]=et[3],delete $[J])}for(const J in $){const et=$[J],rt=this.findLoadedParent(et,this._source.minzoom),ct=this.findLoadedSibling(et),ht=rt||ct||null;if(ht){j[ht.tileID.key]=t[ht.tileID.key]=ht.tileID;for(const pt in j)j[pt].isChildOf(ht.tileID)&&delete j[pt]}}for(const J in this._tiles)j[J]||(this._coveredTiles[J]=!0)}}update(t,o){if(!this._sourceLoaded||this._paused)return;let c;this.transform=t,this.terrain=o,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((Z=>new g.S(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y))):(c=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(c=c.filter((Z=>this._source.hasTile(Z))))):c=[];const h=t.coveringZoomLevel(this._source),m=Math.max(h-Ie.maxOverzooming,this._source.minzoom),T=Math.max(h+Ie.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Z={};for(const j of c)if(j.canonical.z>this._source.minzoom){const $=j.scaledTo(j.canonical.z-1);Z[$.key]=$;const J=j.scaledTo(Math.max(this._source.minzoom,Math.min(j.canonical.z,5)));Z[J.key]=J}c=c.concat(Object.values(Z))}const z=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,z&&this.fire(new g.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=this._updateRetainedTiles(c,h);Ca(this._source.type)&&this._updateCoveredAndRetainedTiles(P,m,T,h,c,o);for(const Z in P)this._tiles[Z].clearFadeHold();const B=g.ab(this._tiles,P);for(const Z of B){const j=this._tiles[Z];j.hasSymbolBuckets&&!j.holdingForFade()?j.setHoldDuration(this.map._fadeDuration):j.hasSymbolBuckets&&!j.symbolFadeFinished()||this._removeTile(Z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,o){var c;const h={},m={},T=Math.max(o-Ie.maxOverzooming,this._source.minzoom),z=Math.max(o+Ie.maxUnderzooming,this._source.minzoom),P={};for(const B of t){const Z=this._addTile(B);h[B.key]=B,Z.hasData()||o<this._source.maxzoom&&(P[B.key]=B)}this._retainLoadedChildren(P,o,z,h);for(const B of t){let Z=this._tiles[B.key];if(Z.hasData())continue;if(o+1>this._source.maxzoom){const $=B.children(this._source.maxzoom)[0],J=this.getTile($);if(J&&J.hasData()){h[$.key]=$;continue}}else{const $=B.children(this._source.maxzoom);if(h[$[0].key]&&h[$[1].key]&&h[$[2].key]&&h[$[3].key])continue}let j=Z.wasRequested();for(let $=B.overscaledZ-1;$>=T;--$){const J=B.scaledTo($);if(m[J.key])break;if(m[J.key]=!0,Z=this.getTile(J),!Z&&j&&(Z=this._addTile(J)),Z){const et=Z.hasData();if((et||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||j)&&(h[J.key]=J),j=Z.wasRequested(),et)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const o=[];let c,h=this._tiles[t].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){c=this._loadedParentTiles[h.key];break}o.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;h=m}for(const m of o)this._loadedParentTiles[m]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const o=this._tiles[t].tileID,c=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=c}}_addTile(t){let o=this._tiles[t.key];if(o)return o;o=this._cache.getAndRemove(t),o&&(this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,o)));const c=o;return o||(o=new Gr(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(o,t.key,o.state)),o.uses++,this._tiles[t.key]=o,c||this._source.fire(new g.k("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(t,o){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=o.getExpiryTimeout();c&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),c))}_removeTile(t){const o=this._tiles[t];o&&(o.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(t){const o=t.sourceDataType;t.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&o==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,o,c){const h=[],m=this.transform;if(!m)return h;const T=c?m.getCameraQueryGeometry(t):t,z=t.map((et=>m.pointCoordinate(et,this.terrain))),P=T.map((et=>m.pointCoordinate(et,this.terrain))),B=this.getIds();let Z=1/0,j=1/0,$=-1/0,J=-1/0;for(const et of P)Z=Math.min(Z,et.x),j=Math.min(j,et.y),$=Math.max($,et.x),J=Math.max(J,et.y);for(let et=0;et<B.length;et++){const rt=this._tiles[B[et]];if(rt.holdingForFade())continue;const ct=rt.tileID,ht=Math.pow(2,m.zoom-rt.tileID.overscaledZ),pt=o*rt.queryPadding*g.X/rt.tileSize/ht,nt=[ct.getTilePoint(new g.Z(Z,j)),ct.getTilePoint(new g.Z($,J))];if(nt[0].x-pt<g.X&&nt[0].y-pt<g.X&&nt[1].x+pt>=0&&nt[1].y+pt>=0){const vt=z.map((Pt=>ct.getTilePoint(Pt))),wt=P.map((Pt=>ct.getTilePoint(Pt)));h.push({tile:rt,tileID:ct,queryGeometry:vt,cameraQueryGeometry:wt,scale:ht})}}return h}getVisibleCoordinates(t){const o=this.getRenderableIds(t).map((c=>this._tiles[c].tileID));for(const c of o)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(Ca(this._source.type)){const t=It.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=t)return!0}return!1}setFeatureState(t,o,c){this._state.updateState(t=t||"_geojsonTileLayer",o,c)}removeFeatureState(t,o,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",o,c)}getFeatureState(t,o){return this._state.getState(t=t||"_geojsonTileLayer",o)}setDependencies(t,o,c){const h=this._tiles[t];h&&h.setDependencies(o,c)}reloadTilesForDependencies(t,o){for(const c in this._tiles)this._tiles[c].hasDependency(t,o)&&this._reloadTile(c,"reloading");this._cache.filter((c=>!c.hasDependency(t,o)))}}function un(_,t){const o=Math.abs(2*_.wrap)-+(_.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return _.overscaledZ-t.overscaledZ||c-o||t.canonical.y-_.canonical.y||t.canonical.x-_.canonical.x}function Ca(_){return _==="raster"||_==="image"||_==="video"}Ie.maxOverzooming=10,Ie.maxUnderzooming=3;class Qe{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=g.ac(t,0,1);let o=1,c=this._distances[o];const h=t*this.paddedLength+this.padding;for(;c<h&&o<this._distances.length;)c=this._distances[++o];const m=o-1,T=this._distances[m],z=c-T,P=z>0?(h-T)/z:0;return this.points[m].mult(1-P).add(this.points[o].mult(P))}}function Js(_,t){let o=!0;return _==="always"||_!=="never"&&t!=="never"||(o=!1),o}class ts{constructor(t,o,c){const h=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(o/c);for(let T=0;T<this.xCellCount*this.yCellCount;T++)h.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,c,h,m){this._forEachCell(o,c,h,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(h),this.bboxes.push(m)}insertCircle(t,o,c,h){this._forEachCell(o-h,c-h,o+h,c+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(c),this.circles.push(h)}_insertBoxCell(t,o,c,h,m,T){this.boxCells[m].push(T)}_insertCircleCell(t,o,c,h,m,T){this.circleCells[m].push(T)}_query(t,o,c,h,m,T,z){if(c<0||t>this.width||h<0||o>this.height)return[];const P=[];if(t<=0&&o<=0&&this.width<=c&&this.height<=h){if(m)return[{key:null,x1:t,y1:o,x2:c,y2:h}];for(let B=0;B<this.boxKeys.length;B++)P.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const Z=this.circles[3*B],j=this.circles[3*B+1],$=this.circles[3*B+2];P.push({key:this.circleKeys[B],x1:Z-$,y1:j-$,x2:Z+$,y2:j+$})}}else this._forEachCell(t,o,c,h,this._queryCell,P,{hitTest:m,overlapMode:T,seenUids:{box:{},circle:{}}},z);return P}query(t,o,c,h){return this._query(t,o,c,h,!1,null)}hitTest(t,o,c,h,m,T){return this._query(t,o,c,h,!0,m,T).length>0}hitTestCircle(t,o,c,h,m){const T=t-c,z=t+c,P=o-c,B=o+c;if(z<0||T>this.width||B<0||P>this.height)return!1;const Z=[];return this._forEachCell(T,P,z,B,this._queryCellCircle,Z,{hitTest:!0,overlapMode:h,circle:{x:t,y:o,radius:c},seenUids:{box:{},circle:{}}},m),Z.length>0}_queryCell(t,o,c,h,m,T,z,P){const{seenUids:B,hitTest:Z,overlapMode:j}=z,$=this.boxCells[m];if($!==null){const et=this.bboxes;for(const rt of $)if(!B.box[rt]){B.box[rt]=!0;const ct=4*rt,ht=this.boxKeys[rt];if(t<=et[ct+2]&&o<=et[ct+3]&&c>=et[ct+0]&&h>=et[ct+1]&&(!P||P(ht))&&(!Z||!Js(j,ht.overlapMode))&&(T.push({key:ht,x1:et[ct],y1:et[ct+1],x2:et[ct+2],y2:et[ct+3]}),Z))return!0}}const J=this.circleCells[m];if(J!==null){const et=this.circles;for(const rt of J)if(!B.circle[rt]){B.circle[rt]=!0;const ct=3*rt,ht=this.circleKeys[rt];if(this._circleAndRectCollide(et[ct],et[ct+1],et[ct+2],t,o,c,h)&&(!P||P(ht))&&(!Z||!Js(j,ht.overlapMode))){const pt=et[ct],nt=et[ct+1],vt=et[ct+2];if(T.push({key:ht,x1:pt-vt,y1:nt-vt,x2:pt+vt,y2:nt+vt}),Z)return!0}}}return!1}_queryCellCircle(t,o,c,h,m,T,z,P){const{circle:B,seenUids:Z,overlapMode:j}=z,$=this.boxCells[m];if($!==null){const et=this.bboxes;for(const rt of $)if(!Z.box[rt]){Z.box[rt]=!0;const ct=4*rt,ht=this.boxKeys[rt];if(this._circleAndRectCollide(B.x,B.y,B.radius,et[ct+0],et[ct+1],et[ct+2],et[ct+3])&&(!P||P(ht))&&!Js(j,ht.overlapMode))return T.push(!0),!0}}const J=this.circleCells[m];if(J!==null){const et=this.circles;for(const rt of J)if(!Z.circle[rt]){Z.circle[rt]=!0;const ct=3*rt,ht=this.circleKeys[rt];if(this._circlesCollide(et[ct],et[ct+1],et[ct+2],B.x,B.y,B.radius)&&(!P||P(ht))&&!Js(j,ht.overlapMode))return T.push(!0),!0}}}_forEachCell(t,o,c,h,m,T,z,P){const B=this._convertToXCellCoord(t),Z=this._convertToYCellCoord(o),j=this._convertToXCellCoord(c),$=this._convertToYCellCoord(h);for(let J=B;J<=j;J++)for(let et=Z;et<=$;et++)if(m.call(this,t,o,c,h,this.xCellCount*et+J,T,z,P))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,c,h,m,T){const z=h-t,P=m-o,B=c+T;return B*B>z*z+P*P}_circleAndRectCollide(t,o,c,h,m,T,z){const P=(T-h)/2,B=Math.abs(t-(h+P));if(B>P+c)return!1;const Z=(z-m)/2,j=Math.abs(o-(m+Z));if(j>Z+c)return!1;if(B<=P||j<=Z)return!0;const $=B-P,J=j-Z;return $*$+J*J<=c*c}}function ys(_,t,o,c,h){const m=g.H();return t?(g.K(m,m,[1/h,1/h,1]),o||g.ad(m,m,c.angle)):g.L(m,c.labelPlaneMatrix,_),m}function Za(_,t,o,c,h){if(t){const m=g.ae(_);return g.K(m,m,[h,h,1]),o||g.ad(m,m,-c.angle),m}return c.glCoordMatrix}function ot(_,t,o,c){let h;c?(h=[_,t,c(_,t),1],g.af(h,h,o)):(h=[_,t,0,1],ri(h,h,o));const m=h[3];return{point:new g.P(h[0]/m,h[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function H(_,t){return .5+_/t*.5}function G(_,t){return _.x>=-t[0]&&_.x<=t[0]&&_.y>=-t[1]&&_.y<=t[1]}function tt(_,t,o,c,h,m,T,z,P,B,Z,j,$,J,et){const rt=c?_.textSizeData:_.iconSizeData,ct=g.ag(rt,o.transform.zoom),ht=[256/o.width*2+1,256/o.height*2+1],pt=c?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;pt.clear();const nt=_.lineVertexArray,vt=c?_.text.placedSymbolArray:_.icon.placedSymbolArray,wt=o.transform.width/o.transform.height;let Pt=!1;for(let Xt=0;Xt<vt.length;Xt++){const ne=vt.get(Xt);if(ne.hidden||ne.writingMode===g.ah.vertical&&!Pt){Pe(ne.numGlyphs,pt);continue}Pt=!1;const ue=ot(ne.anchorX,ne.anchorY,t,et);if(!G(ue.point,ht)){Pe(ne.numGlyphs,pt);continue}const ve=H(o.transform.cameraToCenterDistance,ue.signedDistanceFromCamera),he=g.ai(rt,ct,ne),se=T?he/ve:he*ve,we={getElevation:et,labelPlaneMatrix:h,lineVertexArray:nt,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:B,tileAnchorPoint:new g.P(ne.anchorX,ne.anchorY),unwrappedTileID:Z,width:j,height:$,translation:J},qe=yt(we,ne,se,!1,z,t,m,_.glyphOffsetArray,pt,wt,P);Pt=qe.useVertical,(qe.notEnoughRoom||Pt||qe.needsFlipping&&yt(we,ne,se,!0,z,t,m,_.glyphOffsetArray,pt,wt,P).notEnoughRoom)&&Pe(ne.numGlyphs,pt)}c?_.text.dynamicLayoutVertexBuffer.updateData(pt):_.icon.dynamicLayoutVertexBuffer.updateData(pt)}function at(_,t,o,c,h,m,T,z){const P=m.glyphStartIndex+m.numGlyphs,B=m.lineStartIndex,Z=m.lineStartIndex+m.lineLength,j=t.getoffsetX(m.glyphStartIndex),$=t.getoffsetX(P-1),J=Ft(_*j,o,c,h,m.segment,B,Z,z,T);if(!J)return null;const et=Ft(_*$,o,c,h,m.segment,B,Z,z,T);return et?z.projectionCache.anyProjectionOccluded?null:{first:J,last:et}:null}function _t(_,t,o,c){return _===g.ah.horizontal&&Math.abs(o.y-t.y)>Math.abs(o.x-t.x)*c?{useVertical:!0}:(_===g.ah.vertical?t.y<o.y:t.x>o.x)?{needsFlipping:!0}:null}function yt(_,t,o,c,h,m,T,z,P,B,Z){const j=o/24,$=t.lineOffsetX*j,J=t.lineOffsetY*j;let et;if(t.numGlyphs>1){const rt=t.glyphStartIndex+t.numGlyphs,ct=t.lineStartIndex,ht=t.lineStartIndex+t.lineLength,pt=at(j,z,$,J,c,t,Z,_);if(!pt)return{notEnoughRoom:!0};const nt=ot(pt.first.point.x,pt.first.point.y,T,_.getElevation).point,vt=ot(pt.last.point.x,pt.last.point.y,T,_.getElevation).point;if(h&&!c){const wt=_t(t.writingMode,nt,vt,B);if(wt)return wt}et=[pt.first];for(let wt=t.glyphStartIndex+1;wt<rt-1;wt++)et.push(Ft(j*z.getoffsetX(wt),$,J,c,t.segment,ct,ht,_,Z));et.push(pt.last)}else{if(h&&!c){const ct=ot(_.tileAnchorPoint.x,_.tileAnchorPoint.y,m,_.getElevation).point,ht=t.lineStartIndex+t.segment+1,pt=new g.P(_.lineVertexArray.getx(ht),_.lineVertexArray.gety(ht)),nt=ot(pt.x,pt.y,m,_.getElevation),vt=nt.signedDistanceFromCamera>0?nt.point:(function(Pt,Xt,ne,ue,ve,he){return zt(Pt,Xt,ne,1,ve,he)})(_.tileAnchorPoint,pt,ct,0,m,_),wt=_t(t.writingMode,ct,vt,B);if(wt)return wt}const rt=Ft(j*z.getoffsetX(t.glyphStartIndex),$,J,c,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,_,Z);if(!rt||_.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};et=[rt]}for(const rt of et)g.aj(P,rt.point,rt.angle);return{}}function zt(_,t,o,c,h,m){const T=_.add(_.sub(t)._unit()),z=h!==void 0?ot(T.x,T.y,h,m.getElevation).point:jt(T.x,T.y,m).point,P=o.sub(z);return o.add(P._mult(c/P.mag()))}function ft(_,t,o){const c=t.projectionCache;if(c.projections[_])return c.projections[_];const h=new g.P(t.lineVertexArray.getx(_),t.lineVertexArray.gety(_)),m=jt(h.x,h.y,t);if(m.signedDistanceFromCamera>0)return c.projections[_]=m.point,c.anyProjectionOccluded=c.anyProjectionOccluded||m.isOccluded,m.point;const T=_-o.direction;return(function(z,P,B,Z,j){return zt(z,P,B,Z,void 0,j)})(o.distanceFromAnchor===0?t.tileAnchorPoint:new g.P(t.lineVertexArray.getx(T),t.lineVertexArray.gety(T)),h,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,t)}function jt(_,t,o){const c=_+o.translation[0],h=t+o.translation[1];let m;return!o.pitchWithMap&&o.projection.useSpecialProjectionForSymbols?(m=o.projection.projectTileCoordinates(c,h,o.unwrappedTileID,o.getElevation),m.point.x=(.5*m.point.x+.5)*o.width,m.point.y=(.5*-m.point.y+.5)*o.height):(m=ot(c,h,o.labelPlaneMatrix,o.getElevation),m.isOccluded=!1),m}function Kt(_,t,o){return _._unit()._perp()._mult(t*o)}function Dt(_,t,o,c,h,m,T,z,P){if(z.projectionCache.offsets[_])return z.projectionCache.offsets[_];const B=o.add(t);if(_+P.direction<c||_+P.direction>=h)return z.projectionCache.offsets[_]=B,B;const Z=ft(_+P.direction,z,P),j=Kt(Z.sub(o),T,P.direction),$=o.add(j),J=Z.add(j);return z.projectionCache.offsets[_]=g.ak(m,B,$,J)||B,z.projectionCache.offsets[_]}function Ft(_,t,o,c,h,m,T,z,P){const B=c?_-t:_+t;let Z=B>0?1:-1,j=0;c&&(Z*=-1,j=Math.PI),Z<0&&(j+=Math.PI);let $,J=Z>0?m+h:m+h+1;z.projectionCache.cachedAnchorPoint?$=z.projectionCache.cachedAnchorPoint:($=jt(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=$);let et,rt,ct=$,ht=$,pt=0,nt=0;const vt=Math.abs(B),wt=[];let Pt;for(;pt+nt<=vt;){if(J+=Z,J<m||J>=T)return null;pt+=nt,ht=ct,rt=et;const ue={absOffsetX:vt,direction:Z,distanceFromAnchor:pt,previousVertex:ht};if(ct=ft(J,z,ue),o===0)wt.push(ht),Pt=ct.sub(ht);else{let ve;const he=ct.sub(ht);ve=he.mag()===0?Kt(ft(J+Z,z,ue).sub(ct),o,Z):Kt(he,o,Z),rt||(rt=ht.add(ve)),et=Dt(J,ve,ct,m,T,rt,o,z,ue),wt.push(rt),Pt=et.sub(rt)}nt=Pt.mag()}const Xt=Pt._mult((vt-pt)/nt)._add(rt||ht),ne=j+Math.atan2(ct.y-ht.y,ct.x-ht.x);return wt.push(Xt),{point:Xt,angle:P?ne:0,path:wt}}const ze=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Pe(_,t){for(let o=0;o<_;o++){const c=t.length;t.resize(c+4),t.float32.set(ze,3*c)}}function ri(_,t,o){const c=t[0],h=t[1];return _[0]=o[0]*c+o[4]*h+o[12],_[1]=o[1]*c+o[5]*h+o[13],_[3]=o[3]*c+o[7]*h+o[15],_}const Le=100;class Ye{constructor(t,o,c=new ts(t.width+200,t.height+200,25),h=new ts(t.width+200,t.height+200,25)){this.transform=t,this.mapProjection=o,this.grid=c,this.ignoredGrid=h,this.pitchFactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Le,this.screenBottomBoundary=t.height+Le,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,o,c,h,m,T,z,P,B,Z,j){const $=t.anchorPointX+P[0],J=t.anchorPointY+P[1],et=this.projectAndGetPerspectiveRatio(h,$,J,m,Z),rt=c*et.perspectiveRatio;let ct;if(T||z)ct=this._projectCollisionBox(t,rt,h,m,T,z,P,et,Z,j);else{const wt=et.point.x+(j?j.x*rt:0),Pt=et.point.y+(j?j.y*rt:0);ct={allPointsOccluded:!1,box:[wt+t.x1*rt,Pt+t.y1*rt,wt+t.x2*rt,Pt+t.y2*rt]}}const[ht,pt,nt,vt]=ct.box;return this.mapProjection.useSpecialProjectionForSymbols&&(T?ct.allPointsOccluded:this.mapProjection.isOccluded($,J,m))||et.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(ht,pt,nt,vt)||o!=="always"&&this.grid.hitTest(ht,pt,nt,vt,o,B)?{box:[ht,pt,nt,vt],placeable:!1,offscreen:!1}:{box:[ht,pt,nt,vt],placeable:!0,offscreen:this.isOffscreen(ht,pt,nt,vt)}}placeCollisionCircles(t,o,c,h,m,T,z,P,B,Z,j,$,J,et,rt,ct){const ht=[],pt=new g.P(o.anchorX,o.anchorY),nt=this.getPerspectiveRatio(T,pt.x,pt.y,z,ct),vt=(j?m/nt:m*nt)/g.ap,wt={getElevation:ct,labelPlaneMatrix:P,lineVertexArray:c,pitchWithMap:j,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:pt,unwrappedTileID:z,width:this.transform.width,height:this.transform.height,translation:rt},Pt=at(vt,h,o.lineOffsetX*vt,o.lineOffsetY*vt,!1,o,!1,wt);let Xt=!1,ne=!1,ue=!0;if(Pt){const ve=.5*J*nt+et,he=new g.P(-100,-100),se=new g.P(this.screenRightBoundary,this.screenBottomBoundary),we=new Qe,qe=Pt.first,fe=Pt.last;let _e=[];for(let li=qe.path.length-1;li>=1;li--)_e.push(qe.path[li]);for(let li=1;li<fe.path.length;li++)_e.push(fe.path[li]);const Ze=2.5*ve;if(B){const li=this.projectPathToScreenSpace(_e,wt,B);_e=li.some((yi=>yi.signedDistanceFromCamera<=0))?[]:li.map((yi=>yi.point))}let tn=[];if(_e.length>0){const li=_e[0].clone(),yi=_e[0].clone();for(let Wi=1;Wi<_e.length;Wi++)li.x=Math.min(li.x,_e[Wi].x),li.y=Math.min(li.y,_e[Wi].y),yi.x=Math.max(yi.x,_e[Wi].x),yi.y=Math.max(yi.y,_e[Wi].y);tn=li.x>=he.x&&yi.x<=se.x&&li.y>=he.y&&yi.y<=se.y?[_e]:yi.x<he.x||li.x>se.x||yi.y<he.y||li.y>se.y?[]:g.al([_e],he.x,he.y,se.x,se.y)}for(const li of tn){we.reset(li,.25*ve);let yi=0;yi=we.length<=.5*ve?1:Math.ceil(we.paddedLength/Ze)+1;for(let Wi=0;Wi<yi;Wi++){const ma=Wi/Math.max(yi-1,1),ur=we.lerp(ma),cn=ur.x+Le,Xa=ur.y+Le;ht.push(cn,Xa,ve,0);const gn=cn-ve,yn=Xa-ve,Hn=cn+ve,cr=Xa+ve;if(ue=ue&&this.isOffscreen(gn,yn,Hn,cr),ne=ne||this.isInsideGrid(gn,yn,Hn,cr),t!=="always"&&this.grid.hitTestCircle(cn,Xa,ve,t,$)&&(Xt=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:Xt}}}}return{circles:!Z&&Xt||!ne||nt<this.perspectiveRatioCutoff?[]:ht,offscreen:ue,collisionDetected:Xt}}projectPathToScreenSpace(t,o,c){return t.map((h=>ot(h.x,h.y,c,o.getElevation)))}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let c=1/0,h=1/0,m=-1/0,T=-1/0;for(const Z of t){const j=new g.P(Z.x+Le,Z.y+Le);c=Math.min(c,j.x),h=Math.min(h,j.y),m=Math.max(m,j.x),T=Math.max(T,j.y),o.push(j)}const z=this.grid.query(c,h,m,T).concat(this.ignoredGrid.query(c,h,m,T)),P={},B={};for(const Z of z){const j=Z.key;if(P[j.bucketInstanceId]===void 0&&(P[j.bucketInstanceId]={}),P[j.bucketInstanceId][j.featureIndex])continue;const $=[new g.P(Z.x1,Z.y1),new g.P(Z.x2,Z.y1),new g.P(Z.x2,Z.y2),new g.P(Z.x1,Z.y2)];g.am(o,$)&&(P[j.bucketInstanceId][j.featureIndex]=!0,B[j.bucketInstanceId]===void 0&&(B[j.bucketInstanceId]=[]),B[j.bucketInstanceId].push(j.featureIndex))}return B}insertCollisionBox(t,o,c,h,m,T){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:T,overlapMode:o},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,c,h,m,T){const z=c?this.ignoredGrid:this.grid,P={bucketInstanceId:h,featureIndex:m,collisionGroupID:T,overlapMode:o};for(let B=0;B<t.length;B+=4)z.insertCircle(P,t[B],t[B+1],t[B+2])}projectAndGetPerspectiveRatio(t,o,c,h,m){let T;m?(T=[o,c,m(o,c),1],g.af(T,T,t)):(T=[o,c,0,1],ri(T,T,t));const z=T[3];return{point:new g.P((T[0]/z+1)/2*this.transform.width+Le,(-T[1]/z+1)/2*this.transform.height+Le),perspectiveRatio:.5+this.transform.cameraToCenterDistance/z*.5,isOccluded:!1,signedDistanceFromCamera:z}}getPerspectiveRatio(t,o,c,h,m){const T=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(o,c,h,m):ot(o,c,t,m);return .5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5}isOffscreen(t,o,c,h){return c<Le||t>=this.screenRightBoundary||h<Le||o>this.screenBottomBoundary}isInsideGrid(t,o,c,h){return c>=0&&t<this.gridRightBoundary&&h>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=g.an([]);return g.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,o,c,h,m,T,z,P,B,Z){let j=new g.P(1,0),$=new g.P(0,1);const J=new g.P(t.anchorPointX+z[0],t.anchorPointY+z[1]);if(T&&!m){const ue=this.projectAndGetPerspectiveRatio(c,J.x+1,J.y,h,B).point.sub(P.point).unit(),ve=Math.atan(ue.y/ue.x)+(ue.x<0?Math.PI:0),he=Math.sin(ve),se=Math.cos(ve);j=new g.P(se,he),$=new g.P(-he,se)}else if(!T&&m){const ue=-this.transform.angle,ve=Math.sin(ue),he=Math.cos(ue);j=new g.P(he,ve),$=new g.P(-ve,he)}let et=P.point,rt=o;if(m){et=J;const ue=this.transform.zoom-Math.floor(this.transform.zoom);rt=Math.pow(2,-ue),rt*=this.mapProjection.getPitchedTextCorrection(this.transform,J,h),Z||(rt*=g.ac(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}Z&&(et=et.add(j.mult(Z.x*rt)).add($.mult(Z.y*rt)));const ct=t.x1*rt,ht=t.x2*rt,pt=(ct+ht)/2,nt=t.y1*rt,vt=t.y2*rt,wt=(nt+vt)/2,Pt=[{offsetX:ct,offsetY:nt},{offsetX:pt,offsetY:nt},{offsetX:ht,offsetY:nt},{offsetX:ht,offsetY:wt},{offsetX:ht,offsetY:vt},{offsetX:pt,offsetY:vt},{offsetX:ct,offsetY:vt},{offsetX:ct,offsetY:wt}];let Xt=[];for(const{offsetX:ue,offsetY:ve}of Pt)Xt.push(new g.P(et.x+j.x*ue+$.x*ve,et.y+j.y*ue+$.y*ve));let ne=!1;if(m){const ue=Xt.map((ve=>this.projectAndGetPerspectiveRatio(c,ve.x,ve.y,h,B)));ne=ue.some((ve=>!ve.isOccluded)),Xt=ue.map((ve=>ve.point))}else ne=!0;return{box:g.ao(Xt),allPointsOccluded:!ne}}}function ii(_,t,o){return t*(g.X/(_.tileSize*Math.pow(2,o-_.tileID.overscaledZ)))}class nn{constructor(t,o,c,h){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):h&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class Tn{constructor(t,o,c,h,m){this.text=new nn(t?t.text:null,o,c,m),this.icon=new nn(t?t.icon:null,o,h,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ui{constructor(t,o,c){this.text=t,this.icon=o,this.skipFade=c}}class Zi{constructor(){this.invProjMatrix=g.H(),this.viewportMatrix=g.H(),this.circles=[]}}class Yi{constructor(t,o,c,h,m){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=c,this.bucketIndex=h,this.tileID=m}}class Zn{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:c=>c.collisionGroupID===o}}return this.collisionGroups[t]}}function Mn(_,t,o,c,h){const{horizontalAlign:m,verticalAlign:T}=g.au(_);return new g.P(-(m-.5)*t+c[0]*h,-(T-.5)*o+c[1]*h)}class jn{constructor(t,o,c,h,m,T){this.transform=t.clone(),this.terrain=c,this.collisionIndex=new Ye(this.transform,o),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new Zn(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const o=this.terrain;return o?(c,h)=>o.getElevation(t,c,h):null}getBucketParts(t,o,c,h){const m=c.getBucket(o),T=c.latestFeatureIndex;if(!m||!T||o.id!==m.layerIds[0])return;const z=c.collisionBoxArray,P=m.layers[0].layout,B=m.layers[0].paint,Z=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),j=c.tileSize/g.X,$=c.tileID.toUnwrapped(),J=this.transform.calculatePosMatrix($),et=P.get("text-pitch-alignment")==="map",rt=P.get("text-rotation-alignment")==="map",ct=ii(c,1,this.transform.zoom),ht=this.collisionIndex.mapProjection.translatePosition(this.transform,c,B.get("text-translate"),B.get("text-translate-anchor")),pt=this.collisionIndex.mapProjection.translatePosition(this.transform,c,B.get("icon-translate"),B.get("icon-translate-anchor")),nt=ys(J,et,rt,this.transform,ct);let vt=null;if(et){const Pt=Za(J,et,rt,this.transform,ct);vt=g.L([],this.transform.labelPlaneMatrix,Pt)}this.retainedQueryData[m.bucketInstanceId]=new Yi(m.bucketInstanceId,T,m.sourceLayerIndex,m.index,c.tileID);const wt={bucket:m,layout:P,translationText:ht,translationIcon:pt,posMatrix:J,unwrappedTileID:$,textLabelPlaneMatrix:nt,labelToScreenMatrix:vt,scale:Z,textPixelRatio:j,holdingForFade:c.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:g.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(h)for(const Pt of m.sortKeyRanges){const{sortKey:Xt,symbolInstanceStart:ne,symbolInstanceEnd:ue}=Pt;t.push({sortKey:Xt,symbolInstanceStart:ne,symbolInstanceEnd:ue,parameters:wt})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:wt})}attemptAnchorPlacement(t,o,c,h,m,T,z,P,B,Z,j,$,J,et,rt,ct,ht,pt,nt){const vt=g.aq[t.textAnchor],wt=[t.textOffset0,t.textOffset1],Pt=Mn(vt,c,h,wt,m),Xt=this.collisionIndex.placeCollisionBox(o,$,P,B,Z,z,T,ct,j.predicate,nt,Pt);if((!pt||this.collisionIndex.placeCollisionBox(pt,$,P,B,Z,z,T,ht,j.predicate,nt,Pt).placeable)&&Xt.placeable){let ne;if(this.prevPlacement&&this.prevPlacement.variableOffsets[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID].text&&(ne=this.prevPlacement.variableOffsets[J.crossTileID].anchor),J.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[J.crossTileID]={textOffset:wt,width:c,height:h,anchor:vt,textBoxScale:m,prevAnchor:ne},this.markUsedJustification(et,vt,J,rt),et.allowVerticalPlacement&&(this.markUsedOrientation(et,rt,J),this.placedOrientations[J.crossTileID]=rt),{shift:Pt,placedGlyphBoxes:Xt}}}placeLayerBucketPart(t,o,c){const{bucket:h,layout:m,translationText:T,translationIcon:z,posMatrix:P,unwrappedTileID:B,textLabelPlaneMatrix:Z,labelToScreenMatrix:j,textPixelRatio:$,holdingForFade:J,collisionBoxArray:et,partiallyEvaluatedTextSize:rt,collisionGroup:ct}=t.parameters,ht=m.get("text-optional"),pt=m.get("icon-optional"),nt=g.ar(m,"text-overlap","text-allow-overlap"),vt=nt==="always",wt=g.ar(m,"icon-overlap","icon-allow-overlap"),Pt=wt==="always",Xt=m.get("text-rotation-alignment")==="map",ne=m.get("text-pitch-alignment")==="map",ue=m.get("icon-text-fit")!=="none",ve=m.get("symbol-z-order")==="viewport-y",he=vt&&(Pt||!h.hasIconData()||pt),se=Pt&&(vt||!h.hasTextData()||ht);!h.collisionArrays&&et&&h.deserializeCollisionBoxes(et);const we=this._getTerrainElevationFunc(this.retainedQueryData[h.bucketInstanceId].tileID),qe=(fe,_e,Ze)=>{var tn,li;if(o[fe.crossTileID])return;if(J)return void(this.placements[fe.crossTileID]=new ui(!1,!1,!1));let yi=!1,Wi=!1,ma=!0,ur=null,cn={box:null,placeable:!1,offscreen:null},Xa={placeable:!1},gn=null,yn=null,Hn=null,cr=0,wl=0,Or=0;_e.textFeatureIndex?cr=_e.textFeatureIndex:fe.useRuntimeCollisionCircles&&(cr=fe.featureIndex),_e.verticalTextFeatureIndex&&(wl=_e.verticalTextFeatureIndex);const va=_e.textBox;if(va){const $e=Xn=>{let $n=g.ah.horizontal;if(h.allowVerticalPlacement&&!Xn&&this.prevPlacement){const $a=this.prevPlacement.placedOrientations[fe.crossTileID];$a&&(this.placedOrientations[fe.crossTileID]=$a,$n=$a,this.markUsedOrientation(h,$n,fe))}return $n},Ti=(Xn,$n)=>{if(h.allowVerticalPlacement&&fe.numVerticalGlyphVertices>0&&_e.verticalTextBox){for(const $a of h.writingModes)if($a===g.ah.vertical?(cn=$n(),Xa=cn):cn=Xn(),cn&&cn.placeable)break}else cn=Xn()},vn=fe.textAnchorOffsetStartIndex,zs=fe.textAnchorOffsetEndIndex;if(zs===vn){const Xn=($n,$a)=>{const di=this.collisionIndex.placeCollisionBox($n,nt,$,P,B,ne,Xt,T,ct.predicate,we);return di&&di.placeable&&(this.markUsedOrientation(h,$a,fe),this.placedOrientations[fe.crossTileID]=$a),di};Ti((()=>Xn(va,g.ah.horizontal)),(()=>{const $n=_e.verticalTextBox;return h.allowVerticalPlacement&&fe.numVerticalGlyphVertices>0&&$n?Xn($n,g.ah.vertical):{box:null,offscreen:null}})),$e(cn&&cn.placeable)}else{let Xn=g.aq[(li=(tn=this.prevPlacement)===null||tn===void 0?void 0:tn.variableOffsets[fe.crossTileID])===null||li===void 0?void 0:li.anchor];const $n=(di,hr,Wl)=>{const xn=di.x2-di.x1,ic=di.y2-di.y1,Uc=fe.textBoxScale,Zc=ue&&wt==="never"?hr:null;let Fo=null,Eh=nt==="never"?1:2,Jl="never";Xn&&Eh++;for(let Tl=0;Tl<Eh;Tl++){for(let Ql=vn;Ql<zs;Ql++){const xa=h.textAnchorOffsets.get(Ql);if(Xn&&xa.textAnchor!==Xn)continue;const An=this.attemptAnchorPlacement(xa,di,xn,ic,Uc,Xt,ne,$,P,B,ct,Jl,fe,h,Wl,T,z,Zc,we);if(An&&(Fo=An.placedGlyphBoxes,Fo&&Fo.placeable))return yi=!0,ur=An.shift,Fo}Xn?Xn=null:Jl=nt}return c&&!Fo&&(Fo={box:this.collisionIndex.placeCollisionBox(va,"always",$,P,B,ne,Xt,T,ct.predicate,we,new g.P(0,0)).box,offscreen:!1,placeable:!1}),Fo};Ti((()=>$n(va,_e.iconBox,g.ah.horizontal)),(()=>{const di=_e.verticalTextBox;return h.allowVerticalPlacement&&(!cn||!cn.placeable)&&fe.numVerticalGlyphVertices>0&&di?$n(di,_e.verticalIconBox,g.ah.vertical):{box:null,occluded:!0,offscreen:null}})),cn&&(yi=cn.placeable,ma=cn.offscreen);const $a=$e(cn&&cn.placeable);if(!yi&&this.prevPlacement){const di=this.prevPlacement.variableOffsets[fe.crossTileID];di&&(this.variableOffsets[fe.crossTileID]=di,this.markUsedJustification(h,di.anchor,fe,$a))}}}if(gn=cn,yi=gn&&gn.placeable,ma=gn&&gn.offscreen,fe.useRuntimeCollisionCircles){const $e=h.text.placedSymbolArray.get(fe.centerJustifiedTextSymbolIndex),Ti=g.ai(h.textSizeData,rt,$e),vn=m.get("text-padding");yn=this.collisionIndex.placeCollisionCircles(nt,$e,h.lineVertexArray,h.glyphOffsetArray,Ti,P,B,Z,j,c,ne,ct.predicate,fe.collisionCircleDiameter,vn,T,we),yn.circles.length&&yn.collisionDetected&&!c&&g.w("Collisions detected, but collision boxes are not shown"),yi=vt||yn.circles.length>0&&!yn.collisionDetected,ma=ma&&yn.offscreen}if(_e.iconFeatureIndex&&(Or=_e.iconFeatureIndex),_e.iconBox){const $e=Ti=>this.collisionIndex.placeCollisionBox(Ti,wt,$,P,B,ne,Xt,z,ct.predicate,we,ue&&ur?ur:void 0);Xa&&Xa.placeable&&_e.verticalIconBox?(Hn=$e(_e.verticalIconBox),Wi=Hn.placeable):(Hn=$e(_e.iconBox),Wi=Hn.placeable),ma=ma&&Hn.offscreen}const Gi=ht||fe.numHorizontalGlyphVertices===0&&fe.numVerticalGlyphVertices===0,Sl=pt||fe.numIconVertices===0;Gi||Sl?Sl?Gi||(Wi=Wi&&yi):yi=Wi&&yi:Wi=yi=Wi&&yi;const Br=Wi&&Hn.placeable;if(yi&&gn.placeable&&this.collisionIndex.insertCollisionBox(gn.box,nt,m.get("text-ignore-placement"),h.bucketInstanceId,Xa&&Xa.placeable&&wl?wl:cr,ct.ID),Br&&this.collisionIndex.insertCollisionBox(Hn.box,wt,m.get("icon-ignore-placement"),h.bucketInstanceId,Or,ct.ID),yn&&yi&&this.collisionIndex.insertCollisionCircles(yn.circles,nt,m.get("text-ignore-placement"),h.bucketInstanceId,cr,ct.ID),c&&this.storeCollisionData(h.bucketInstanceId,Ze,_e,gn,Hn,yn),fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[fe.crossTileID]=new ui(yi||he,Wi||se,ma||h.justReloaded),o[fe.crossTileID]=!0};if(ve){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const fe=h.getSortedSymbolIndexes(this.transform.angle);for(let _e=fe.length-1;_e>=0;--_e){const Ze=fe[_e];qe(h.symbolInstances.get(Ze),h.collisionArrays[Ze],Ze)}}else for(let fe=t.symbolInstanceStart;fe<t.symbolInstanceEnd;fe++)qe(h.symbolInstances.get(fe),h.collisionArrays[fe],fe);if(c&&h.bucketInstanceId in this.collisionCircleArrays){const fe=this.collisionCircleArrays[h.bucketInstanceId];g.as(fe.invProjMatrix,P),fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}storeCollisionData(t,o,c,h,m,T){if(c.textBox||c.iconBox){let z,P;this.collisionBoxArrays.has(t)?z=this.collisionBoxArrays.get(t):(z=new Map,this.collisionBoxArrays.set(t,z)),z.has(o)?P=z.get(o):(P={text:null,icon:null},z.set(o,P)),c.textBox&&(P.text=h.box),c.iconBox&&(P.icon=m.box)}if(T){let z=this.collisionCircleArrays[t];z===void 0&&(z=this.collisionCircleArrays[t]=new Zi);for(let P=0;P<T.circles.length;P+=4)z.circles.push(T.circles[P+0]),z.circles.push(T.circles[P+1]),z.circles.push(T.circles[P+2]),z.circles.push(T.collisionDetected?1:0)}}markUsedJustification(t,o,c,h){let m;m=h===g.ah.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[g.at(o)];const T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const z of T)z>=0&&(t.text.placedSymbolArray.get(z).crossTileID=m>=0&&z!==m?0:c.crossTileID)}markUsedOrientation(t,o,c){const h=o===g.ah.horizontal||o===g.ah.horizontalOnly?o:0,m=o===g.ah.vertical?o:0,T=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const z of T)t.text.placedSymbolArray.get(z).placedOrientation=h;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let c=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const h=o?o.symbolFadeChange(t):1,m=o?o.opacities:{},T=o?o.variableOffsets:{},z=o?o.placedOrientations:{};for(const P in this.placements){const B=this.placements[P],Z=m[P];Z?(this.opacities[P]=new Tn(Z,h,B.text,B.icon),c=c||B.text!==Z.text.placed||B.icon!==Z.icon.placed):(this.opacities[P]=new Tn(null,h,B.text,B.icon,B.skipFade),c=c||B.text||B.icon)}for(const P in m){const B=m[P];if(!this.opacities[P]){const Z=new Tn(B,h,!1,!1);Z.isHidden()||(this.opacities[P]=Z,c=c||B.text.placed||B.icon.placed)}}for(const P in T)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=T[P]);for(const P in z)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=z[P]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const c={};for(const h of o){const m=h.getBucket(t);m&&h.latestFeatureIndex&&t.id===m.layerIds[0]&&this.updateBucketOpacities(m,h.tileID,c,h.collisionBoxArray)}}updateBucketOpacities(t,o,c,h){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const m=t.layers[0],T=m.layout,z=new Tn(null,0,!1,!1,!0),P=T.get("text-allow-overlap"),B=T.get("icon-allow-overlap"),Z=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=T.get("text-rotation-alignment")==="map",$=T.get("text-pitch-alignment")==="map",J=T.get("icon-text-fit")!=="none",et=new Tn(null,0,P&&(B||!t.hasIconData()||T.get("icon-optional")),B&&(P||!t.hasTextData()||T.get("text-optional")),!0);!t.collisionArrays&&h&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(h);const rt=(ht,pt,nt)=>{for(let vt=0;vt<pt/4;vt++)ht.opacityVertexArray.emplaceBack(nt);ht.hasVisibleVertices=ht.hasVisibleVertices||nt!==Xr},ct=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ht=0;ht<t.symbolInstances.length;ht++){const pt=t.symbolInstances.get(ht),{numHorizontalGlyphVertices:nt,numVerticalGlyphVertices:vt,crossTileID:wt}=pt;let Pt=this.opacities[wt];c[wt]?Pt=z:Pt||(Pt=et,this.opacities[wt]=Pt),c[wt]=!0;const Xt=pt.numIconVertices>0,ne=this.placedOrientations[pt.crossTileID],ue=ne===g.ah.vertical,ve=ne===g.ah.horizontal||ne===g.ah.horizontalOnly;if(nt>0||vt>0){const se=La(Pt.text);rt(t.text,nt,ue?Xr:se),rt(t.text,vt,ve?Xr:se);const we=Pt.text.isHidden();[pt.rightJustifiedTextSymbolIndex,pt.centerJustifiedTextSymbolIndex,pt.leftJustifiedTextSymbolIndex].forEach((_e=>{_e>=0&&(t.text.placedSymbolArray.get(_e).hidden=we||ue?1:0)})),pt.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(pt.verticalPlacedTextSymbolIndex).hidden=we||ve?1:0);const qe=this.variableOffsets[pt.crossTileID];qe&&this.markUsedJustification(t,qe.anchor,pt,ne);const fe=this.placedOrientations[pt.crossTileID];fe&&(this.markUsedJustification(t,"left",pt,fe),this.markUsedOrientation(t,fe,pt))}if(Xt){const se=La(Pt.icon),we=!(J&&pt.verticalPlacedIconSymbolIndex&&ue);pt.placedIconSymbolIndex>=0&&(rt(t.icon,pt.numIconVertices,we?se:Xr),t.icon.placedSymbolArray.get(pt.placedIconSymbolIndex).hidden=Pt.icon.isHidden()),pt.verticalPlacedIconSymbolIndex>=0&&(rt(t.icon,pt.numVerticalIconVertices,we?Xr:se),t.icon.placedSymbolArray.get(pt.verticalPlacedIconSymbolIndex).hidden=Pt.icon.isHidden())}const he=ct&&ct.has(ht)?ct.get(ht):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const se=t.collisionArrays[ht];if(se){let we=new g.P(0,0);if(se.textBox||se.verticalTextBox){let qe=!0;if(Z){const fe=this.variableOffsets[wt];fe?(we=Mn(fe.anchor,fe.width,fe.height,fe.textOffset,fe.textBoxScale),j&&we._rotate($?this.transform.angle:-this.transform.angle)):qe=!1}if(se.textBox||se.verticalTextBox){let fe;se.textBox&&(fe=ue),se.verticalTextBox&&(fe=ve),es(t.textCollisionBox.collisionVertexArray,Pt.text.placed,!qe||fe,he.text,we.x,we.y)}}if(se.iconBox||se.verticalIconBox){const qe=!!(!ve&&se.verticalIconBox);let fe;se.iconBox&&(fe=qe),se.verticalIconBox&&(fe=!qe),es(t.iconCollisionBox.collisionVertexArray,Pt.icon.placed,fe,he.icon,J?we.x:0,J?we.y:0)}}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const ht=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=ht.invProjMatrix,t.placementViewportMatrix=ht.viewportMatrix,t.collisionCircleArray=ht.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const c=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function es(_,t,o,c,h,m){c&&c.length!==0||(c=[0,0,0,0]);const T=c[0]-Le,z=c[1]-Le,P=c[2]-Le,B=c[3]-Le;_.emplaceBack(t?1:0,o?1:0,h||0,m||0,T,z),_.emplaceBack(t?1:0,o?1:0,h||0,m||0,P,z),_.emplaceBack(t?1:0,o?1:0,h||0,m||0,P,B),_.emplaceBack(t?1:0,o?1:0,h||0,m||0,T,B)}const Ci=Math.pow(2,25),Vn=Math.pow(2,24),Ol=Math.pow(2,17),ja=Math.pow(2,16),Kn=Math.pow(2,9),Hr=Math.pow(2,8),ga=Math.pow(2,1);function La(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const t=_.placed?1:0,o=Math.floor(127*_.opacity);return o*Ci+t*Vn+o*Ol+t*ja+o*Kn+t*Hr+o*ga+t}const Xr=0;function Os(){return{isOccluded:(_,t,o)=>!1,getPitchedTextCorrection:(_,t,o)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(_,t,o,c){throw new Error("Not implemented.")},translatePosition:(_,t,o,c)=>(function(h,m,T,z,P=!1){if(!T[0]&&!T[1])return[0,0];const B=P?z==="map"?h.angle:0:z==="viewport"?-h.angle:0;if(B){const Z=Math.sin(B),j=Math.cos(B);T=[T[0]*j-T[1]*Z,T[0]*Z+T[1]*j]}return[P?T[0]:ii(m,T[0],h.zoom),P?T[1]:ii(m,T[1],h.zoom)]})(_,t,o,c),getCircleRadiusCorrection:_=>1}}class Ue{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,o,c,h,m){const T=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(T,h,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort(((z,P)=>z.sortKey-P.sortKey)));this._currentPartIndex<T.length;)if(o.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,m())return!0;return!1}}class qi{constructor(t,o,c,h,m,T,z,P){this.placement=new jn(t,Os(),o,T,z,P),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(t,o,c){const h=It.now(),m=()=>!this._forceFullPlacement&&It.now()-h>2;for(;this._currentPlacementIndex>=0;){const T=o[t[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=z)&&(!T.maxzoom||T.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new Ue(T)),this._inProgressLayer.continuePlacement(c[T.source],this.placement,this._showCollisionBoxes,T,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const In=512/g.X/2;class bi{constructor(t,o,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const h=new Map;for(let m=0;m<o.length;m++){const T=o.get(m),z=T.key,P=h.get(z);P?P.push(T):h.set(z,[T])}for(const[m,T]of h){const z={positions:T.map((P=>({x:Math.floor(P.anchorX*In),y:Math.floor(P.anchorY*In)}))),crossTileIDs:T.map((P=>P.crossTileID))};if(z.positions.length>128){const P=new g.av(z.positions.length,16,Uint16Array);for(const{x:B,y:Z}of z.positions)P.add(B,Z);P.finish(),delete z.positions,z.index=P}this._symbolsByKey[m]=z}}getScaledCoordinates(t,o){const{x:c,y:h,z:m}=this.tileID.canonical,{x:T,y:z,z:P}=o.canonical,B=In/Math.pow(2,P-m),Z=(z*g.X+t.anchorY)*B,j=h*g.X*In;return{x:Math.floor((T*g.X+t.anchorX)*B-c*g.X*In),y:Math.floor(Z-j)}}findMatches(t,o,c){const h=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let m=0;m<t.length;m++){const T=t.get(m);if(T.crossTileID)continue;const z=this._symbolsByKey[T.key];if(!z)continue;const P=this.getScaledCoordinates(T,o);if(z.index){const B=z.index.range(P.x-h,P.y-h,P.x+h,P.y+h).sort();for(const Z of B){const j=z.crossTileIDs[Z];if(!c[j]){c[j]=!0,T.crossTileID=j;break}}}else if(z.positions)for(let B=0;B<z.positions.length;B++){const Z=z.positions[B],j=z.crossTileIDs[B];if(Math.abs(Z.x-P.x)<=h&&Math.abs(Z.y-P.y)<=h&&!c[j]){c[j]=!0,T.crossTileID=j;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class Qs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class is{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const c in this.indexes){const h=this.indexes[c],m={};for(const T in h){const z=h[T];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+o),m[z.tileID.key]=z}this.indexes[c]=m}this.lng=t}addBucket(t,o,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let m=0;m<o.symbolInstances.length;m++)o.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const h=this.usedCrossTileIDs[t.overscaledZ];for(const m in this.indexes){const T=this.indexes[m];if(Number(m)>t.overscaledZ)for(const z in T){const P=T[z];P.tileID.isChildOf(t)&&P.findMatches(o.symbolInstances,t,h)}else{const z=T[t.scaledTo(Number(m)).key];z&&z.findMatches(o.symbolInstances,t,h)}}for(let m=0;m<o.symbolInstances.length;m++){const T=o.symbolInstances.get(m);T.crossTileID||(T.crossTileID=c.generate(),h[T.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new bi(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const c of o.getCrossTileIDsLists())for(const h of c)delete this.usedCrossTileIDs[t][h]}removeStaleBuckets(t){let o=!1;for(const c in this.indexes){const h=this.indexes[c];for(const m in h)t[h[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,h[m]),delete h[m],o=!0)}return o}}class ai{constructor(){this.layerIndexes={},this.crossTileIDs=new Qs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,c){let h=this.layerIndexes[t.id];h===void 0&&(h=this.layerIndexes[t.id]=new is);let m=!1;const T={};h.handleWrapJump(c);for(const z of o){const P=z.getBucket(t);P&&t.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(z.tileID,P,this.crossTileIDs)&&(m=!0),T[P.bucketInstanceId]=!0)}return h.removeStaleBuckets(T)&&(m=!0),m}pruneUnusedLayers(t){const o={};t.forEach((c=>{o[c]=!0}));for(const c in this.layerIndexes)o[c]||delete this.layerIndexes[c]}}const Fi=(_,t)=>g.t(_,t&&t.filter((o=>o.identifier!=="source.canvas"))),Go=g.aw();class ho extends g.E{constructor(t,o={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const h=this.sourceCaches[c].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[c].reload()}},this.map=t,this.dispatcher=new Qa(Vi(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((c,h)=>this.getGlyphs(c,h))),this.dispatcher.registerMessageHandler("GI",((c,h)=>this.getImages(c,h))),this.imageManager=new Sn,this.imageManager.setEventedParent(this),this.glyphManager=new ce(t._requestManager,o.localIdeographFontFamily),this.lineAtlas=new Ht(256,512),this.crossTileSymbolIndex=new ai,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new g.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",g.ay()),Rs().on(ie,this._rtlPluginLoaded),this.on("data",(c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const h=this.sourceCaches[c.sourceId];if(!h)return;const m=h.getSource();if(m&&m.vectorLayerIds)for(const T in this._layers){const z=this._layers[T];z.source===m.id&&this._validateLayer(z)}}))}loadURL(t,o={},c){this.fire(new g.k("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const h=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;g.h(h,this._loadStyleRequest).then((T=>{this._loadStyleRequest=null,this._load(T.data,o,c)})).catch((T=>{this._loadStyleRequest=null,T&&!m.signal.aborted&&this.fire(new g.j(T))}))}loadJSON(t,o={},c){this.fire(new g.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,It.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(t,o,c)})).catch((()=>{}))}loadEmpty(){this.fire(new g.k("dataloading",{dataType:"style"})),this._load(Go,{validate:!1})}_load(t,o,c){var h;const m=o.transformStyle?o.transformStyle(c,t):t;if(!o.validate||!Fi(this,g.u(m))){this._loaded=!0,this.stylesheet=m;for(const T in m.sources)this.addSource(T,m.sources[T],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new ge(this.stylesheet.light),this.sky=new St(this.stylesheet.sky),this.map.setTerrain((h=this.stylesheet.terrain)!==null&&h!==void 0?h:null),this.fire(new g.k("data",{dataType:"style"})),this.fire(new g.k("style.load"))}}_createLayers(){const t=g.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map((o=>o.id)),this._layers={},this._serializedLayers=null;for(const o of t){const c=g.aA(o);c.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=c}}_loadSprite(t,o=!1,c=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(m,T,z,P){return g._(this,void 0,void 0,(function*(){const B=wn(m),Z=z>1?"@2x":"",j={},$={};for(const{id:J,url:et}of B){const rt=T.transformRequest(ca(et,Z,".json"),"SpriteJSON");j[J]=g.h(rt,P);const ct=T.transformRequest(ca(et,Z,".png"),"SpriteImage");$[J]=We.getImage(ct,P)}return yield Promise.all([...Object.values(j),...Object.values($)]),(function(J,et){return g._(this,void 0,void 0,(function*(){const rt={};for(const ct in J){rt[ct]={};const ht=It.getImageCanvasContext((yield et[ct]).data),pt=(yield J[ct]).data;for(const nt in pt){const{width:vt,height:wt,x:Pt,y:Xt,sdf:ne,pixelRatio:ue,stretchX:ve,stretchY:he,content:se,textFitWidth:we,textFitHeight:qe}=pt[nt];rt[ct][nt]={data:null,pixelRatio:ue,sdf:ne,stretchX:ve,stretchY:he,content:se,textFitWidth:we,textFitHeight:qe,spriteData:{width:vt,height:wt,x:Pt,y:Xt,context:ht}}}}return rt}))})(j,$)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((m=>{if(this._spriteRequest=null,m)for(const T in m){this._spritesImagesIds[T]=[];const z=this._spritesImagesIds[T]?this._spritesImagesIds[T].filter((P=>!(P in m))):[];for(const P of z)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in m[T]){const B=T==="default"?P:`${T}:${P}`;this._spritesImagesIds[T].push(B),B in this.imageManager.images?this.imageManager.updateImage(B,m[T][P],!1):this.imageManager.addImage(B,m[T][P]),o&&(this._changedImages[B]=!0)}}})).catch((m=>{this._spriteRequest=null,h=m,this.fire(new g.j(h))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new g.k("data",{dataType:"style"})),c&&c(h)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new g.k("data",{dataType:"style"}))}_validateLayer(t){const o=this.sourceCaches[t.source];if(!o)return;const c=t.sourceLayer;if(!c)return;const h=o.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(c)===-1)&&this.fire(new g.j(new Error(`Source layer "${c}" does not exist on source "${h.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,o=!1){const c=this._serializedAllLayers();if(!t||t.length===0)return Object.values(o?g.aB(c):c);const h=[];for(const m of t)if(c[m]){const T=o?g.aB(c[m]):c[m];h.push(T)}return h}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const o=Object.keys(this._layers);for(const c of o){const h=this._layers[c];h.type!=="custom"&&(t[c]=h.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const o=this._changed;if(o){const h=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(h.length||m.length)&&this._updateWorkerLayers(h,m);for(const T in this._updatedSources){const z=this._updatedSources[T];if(z==="reload")this._reloadSource(T);else{if(z!=="clear")throw new Error(`Invalid action ${z}`);this._clearSource(T)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const c={};for(const h in this.sourceCaches){const m=this.sourceCaches[h];c[h]=m.used,m.used=!1}for(const h of this._order){const m=this._layers[h];m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const h in c){const m=this.sourceCaches[h];!!c[h]!=!!m.used&&m.fire(new g.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(t),this.sky.recalculate(t),this.z=t.zoom,o&&this.fire(new g.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,o={}){var c;this._checkLoaded();const h=this.serialize();if(t=o.transformStyle?o.transformStyle(h,t):t,((c=o.validate)===null||c===void 0||c)&&Fi(this,g.u(t)))return!1;(t=g.aB(t)).layers=g.az(t.layers);const m=g.aC(h,t),T=this._getOperationsToPerform(m);if(T.unimplemented.length>0)throw new Error(`Unimplemented: ${T.unimplemented.join(", ")}.`);if(T.operations.length===0)return!1;for(const z of T.operations)z();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const o=[],c=[];for(const h of t)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":o.push((()=>this.addLayer.apply(this,h.args)));break;case"removeLayer":o.push((()=>this.removeLayer.apply(this,h.args)));break;case"setPaintProperty":o.push((()=>this.setPaintProperty.apply(this,h.args)));break;case"setLayoutProperty":o.push((()=>this.setLayoutProperty.apply(this,h.args)));break;case"setFilter":o.push((()=>this.setFilter.apply(this,h.args)));break;case"addSource":o.push((()=>this.addSource.apply(this,h.args)));break;case"removeSource":o.push((()=>this.removeSource.apply(this,h.args)));break;case"setLayerZoomRange":o.push((()=>this.setLayerZoomRange.apply(this,h.args)));break;case"setLight":o.push((()=>this.setLight.apply(this,h.args)));break;case"setGeoJSONSourceData":o.push((()=>this.setGeoJSONSourceData.apply(this,h.args)));break;case"setGlyphs":o.push((()=>this.setGlyphs.apply(this,h.args)));break;case"setSprite":o.push((()=>this.setSprite.apply(this,h.args)));break;case"setSky":o.push((()=>this.setSky.apply(this,h.args)));break;case"setTerrain":o.push((()=>this.map.setTerrain.apply(this,h.args)));break;case"setTransition":o.push((()=>{}));break;default:c.push(h.command)}return{operations:o,unimplemented:c}}addImage(t,o){if(this.getImage(t))return this.fire(new g.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,o),this._afterImageUpdated(t)}updateImage(t,o){this.imageManager.updateImage(t,o)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new g.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new g.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,o,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(g.u.source,`sources.${t}`,o,null,c))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const h=this.sourceCaches[t]=new Ie(t,o,this.dispatcher);h.style=this,h.setEventedParent(this,(()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:t}))),h.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new g.j(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const o=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],o.fire(new g.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,o){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(o),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,o,c={}){this._checkLoaded();const h=t.id;if(this.getLayer(h))return void this.fire(new g.j(new Error(`Layer "${h}" already exists on this map.`)));let m;if(t.type==="custom"){if(Fi(this,g.aD(t)))return;m=g.aA(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(h,t.source),t=g.aB(t),t=g.e(t,{source:h})),this._validate(g.u.layer,`layers.${h}`,t,{arrayIndex:-1},c))return;m=g.aA(t),this._validateLayer(m),m.setEventedParent(this,{layer:{id:h}})}const T=o?this._order.indexOf(o):this._order.length;if(o&&T===-1)this.fire(new g.j(new Error(`Cannot add layer "${h}" before non-existing layer "${o}".`)));else{if(this._order.splice(T,0,h),this._layerOrderChanged=!0,this._layers[h]=m,this._removedLayers[h]&&m.source&&m.type!=="custom"){const z=this._removedLayers[h];delete this._removedLayers[h],z.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(t,o){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new g.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const c=this._order.indexOf(t);this._order.splice(c,1);const h=o?this._order.indexOf(o):this._order.length;o&&h===-1?this.fire(new g.j(new Error(`Cannot move layer "${t}" before non-existing layer "${o}".`))):(this._order.splice(h,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new g.j(new Error(`Cannot remove non-existing layer "${t}".`)));o.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=o,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],o.onRemove&&o.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,o,c){this._checkLoaded();const h=this.getLayer(t);h?h.minzoom===o&&h.maxzoom===c||(o!=null&&(h.minzoom=o),c!=null&&(h.maxzoom=c),this._updateLayer(h)):this.fire(new g.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,o,c={}){this._checkLoaded();const h=this.getLayer(t);if(h){if(!g.aE(h.filter,o))return o==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(g.u.filter,`layers.${h.id}.filter`,o,null,c)||(h.filter=g.aB(o),this._updateLayer(h)))}else this.fire(new g.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return g.aB(this.getLayer(t).filter)}setLayoutProperty(t,o,c,h={}){this._checkLoaded();const m=this.getLayer(t);m?g.aE(m.getLayoutProperty(o),c)||(m.setLayoutProperty(o,c,h),this._updateLayer(m)):this.fire(new g.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,o){const c=this.getLayer(t);if(c)return c.getLayoutProperty(o);this.fire(new g.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,o,c,h={}){this._checkLoaded();const m=this.getLayer(t);m?g.aE(m.getPaintProperty(o),c)||(m.setPaintProperty(o,c,h)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new g.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,o){return this.getLayer(t).getPaintProperty(o)}setFeatureState(t,o){this._checkLoaded();const c=t.source,h=t.sourceLayer,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new g.j(new Error(`The source '${c}' does not exist in the map's style.`)));const T=m.getSource().type;T==="geojson"&&h?this.fire(new g.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||h?(t.id===void 0&&this.fire(new g.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(h,t.id,o)):this.fire(new g.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,o){this._checkLoaded();const c=t.source,h=this.sourceCaches[c];if(h===void 0)return void this.fire(new g.j(new Error(`The source '${c}' does not exist in the map's style.`)));const m=h.getSource().type,T=m==="vector"?t.sourceLayer:void 0;m!=="vector"||T?o&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new g.j(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(T,t.id,o):this.fire(new g.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const o=t.source,c=t.sourceLayer,h=this.sourceCaches[o];if(h!==void 0)return h.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new g.j(new Error("The feature id parameter must be provided."))),h.getFeatureState(c,t.id)):void this.fire(new g.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new g.j(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return g.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=g.aF(this.sourceCaches,(m=>m.serialize())),o=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,h=this.stylesheet;return g.aG({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,sources:t,layers:o,terrain:c},(m=>m!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const o=T=>this._layers[T].type==="fill-extrusion",c={},h=[];for(let T=this._order.length-1;T>=0;T--){const z=this._order[T];if(o(z)){c[z]=T;for(const P of t){const B=P[z];if(B)for(const Z of B)h.push(Z)}}}h.sort(((T,z)=>z.intersectionZ-T.intersectionZ));const m=[];for(let T=this._order.length-1;T>=0;T--){const z=this._order[T];if(o(z))for(let P=h.length-1;P>=0;P--){const B=h[P].feature;if(c[B.layer.id]<T)break;m.push(B),h.pop()}else for(const P of t){const B=P[z];if(B)for(const Z of B)m.push(Z.feature)}}return m}queryRenderedFeatures(t,o,c){o&&o.filter&&this._validate(g.u.filter,"queryRenderedFeatures.filter",o.filter,null,o);const h={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new g.j(new Error("parameters.layers must be an Array."))),[];for(const z of o.layers){const P=this._layers[z];if(!P)return this.fire(new g.j(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];h[P.source]=!0}}const m=[];o.availableImages=this._availableImages;const T=this._serializedAllLayers();for(const z in this.sourceCaches)o.layers&&!h[z]||m.push(ks(this.sourceCaches[z],this._layers,T,t,o,c));return this.placement&&m.push((function(z,P,B,Z,j,$,J){const et={},rt=$.queryRenderedSymbols(Z),ct=[];for(const ht of Object.keys(rt).map(Number))ct.push(J[ht]);ct.sort(Ua);for(const ht of ct){const pt=ht.featureIndex.lookupSymbolFeatures(rt[ht.bucketInstanceId],P,ht.bucketIndex,ht.sourceLayerIndex,j.filter,j.layers,j.availableImages,z);for(const nt in pt){const vt=et[nt]=et[nt]||[],wt=pt[nt];wt.sort(((Pt,Xt)=>{const ne=ht.featureSortOrder;if(ne){const ue=ne.indexOf(Pt.featureIndex);return ne.indexOf(Xt.featureIndex)-ue}return Xt.featureIndex-Pt.featureIndex}));for(const Pt of wt)vt.push(Pt)}}for(const ht in et)et[ht].forEach((pt=>{const nt=pt.feature,vt=B[z[ht].source].getFeatureState(nt.layer["source-layer"],nt.id);nt.source=nt.layer.source,nt.layer["source-layer"]&&(nt.sourceLayer=nt.layer["source-layer"]),nt.state=vt}));return et})(this._layers,T,this.sourceCaches,t,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(t,o){o&&o.filter&&this._validate(g.u.filter,"querySourceFeatures.filter",o.filter,null,o);const c=this.sourceCaches[t];return c?(function(h,m){const T=h.getRenderableIds().map((B=>h.getTileByID(B))),z=[],P={};for(let B=0;B<T.length;B++){const Z=T[B],j=Z.tileID.canonical.key;P[j]||(P[j]=!0,Z.querySourceFeatures(z,m))}return z})(c,o):[]}getLight(){return this.light.getLight()}setLight(t,o={}){this._checkLoaded();const c=this.light.getLight();let h=!1;for(const T in t)if(!g.aE(t[T],c[T])){h=!0;break}if(!h)return;const m={now:It.now(),transition:g.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,o),this.light.updateTransitions(m)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,o={}){const c=this.getSky();let h=!1;if(!t&&!c)return;if(t&&!c)h=!0;else if(!t&&c)h=!0;else for(const T in t)if(!g.aE(t[T],c[T])){h=!0;break}if(!h)return;const m={now:It.now(),transition:g.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,o),this.sky.updateTransitions(m)}_validate(t,o,c,h,m={}){return(!m||m.validate!==!1)&&Fi(this,t.call(g.u,g.e({key:o,style:this.serialize(),value:c,styleSpec:g.v},h)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Rs().off(ie,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const c=this.sourceCaches[o];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const o in this.sourceCaches)this.sourceCaches[o].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,o,c,h,m=!1){let T=!1,z=!1;const P={};for(const B of this._order){const Z=this._layers[B];if(Z.type!=="symbol")continue;if(!P[Z.source]){const $=this.sourceCaches[Z.source];P[Z.source]=$.getRenderableIds(!0).map((J=>$.getTileByID(J))).sort(((J,et)=>et.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(et.tileID)?-1:1)))}const j=this.crossTileSymbolIndex.addLayer(Z,P[Z.source],t.center.lng);T=T||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(It.now(),t.zoom))&&(this.pauseablePlacement=new qi(t,this.map.terrain,this._order,m,o,c,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(It.now()),z=!0),T&&this.pauseablePlacement.placement.setStale()),z||T)for(const B of this._order){const Z=this._layers[B];Z.type==="symbol"&&this.placement.updateLayerOpacities(Z,P[Z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(It.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,o){return g._(this,void 0,void 0,(function*(){const c=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[o.source];return h&&h.setDependencies(o.tileID.key,o.type,o.icons),c}))}getGlyphs(t,o){return g._(this,void 0,void 0,(function*(){const c=yield this.glyphManager.getGlyphs(o.stacks),h=this.sourceCaches[o.source];return h&&h.setDependencies(o.tileID.key,o.type,[""]),c}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,o={}){this._checkLoaded(),t&&this._validate(g.u.glyphs,"glyphs",t,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,o,c={},h){this._checkLoaded();const m=[{id:t,url:o}],T=[...wn(this.stylesheet.sprite),...m];this._validate(g.u.sprite,"sprite",T,null,c)||(this.stylesheet.sprite=T,this._loadSprite(m,!0,h))}removeSprite(t){this._checkLoaded();const o=wn(this.stylesheet.sprite);if(o.find((c=>c.id===t))){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;o.splice(o.findIndex((c=>c.id===t)),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new g.k("data",{dataType:"style"}))}else this.fire(new g.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return wn(this.stylesheet.sprite)}setSprite(t,o={},c){this._checkLoaded(),t&&this._validate(g.u.sprite,"sprite",t,null,o)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}}var Ki=g.Y([{name:"a_pos",type:"Int16",components:2}]);const tr={prelude:wi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:wi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:wi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:wi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:wi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:wi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:wi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:wi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:wi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:wi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:wi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:wi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:wi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:wi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:wi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:wi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:wi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:wi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:wi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:wi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:wi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:wi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:wi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:wi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:wi("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:wi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:wi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:wi("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function wi(_,t){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/attribute ([\w]+) ([\w]+)/g),h=_.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=m?m.concat(h):h,z={};return{fragmentSource:_=_.replace(o,((P,B,Z,j,$)=>(z[$]=!0,B==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${Z} ${j} ${$};
#else
uniform ${Z} ${j} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${Z} ${j} ${$} = u_${$};
#endif
`))),vertexSource:t=t.replace(o,((P,B,Z,j,$)=>{const J=j==="float"?"vec2":"vec4",et=$.match(/color/)?"color":J;return z[$]?B==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${Z} ${J} a_${$};
varying ${Z} ${j} ${$};
#else
uniform ${Z} ${j} u_${$};
#endif
`:et==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${Z} ${j} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${et}(a_${$}, u_${$}_t);
#else
    ${Z} ${j} ${$} = u_${$};
#endif
`:B==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${Z} ${J} a_${$};
#else
uniform ${Z} ${j} u_${$};
#endif
`:et==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${Z} ${j} ${$} = a_${$};
#else
    ${Z} ${j} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${Z} ${j} ${$} = unpack_mix_${et}(a_${$}, u_${$}_t);
#else
    ${Z} ${j} ${$} = u_${$};
#endif
`})),staticAttributes:c,staticUniforms:T}}class Bs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,o,c,h,m,T,z,P,B){this.context=t;let Z=this.boundPaintVertexBuffers.length!==h.length;for(let j=0;!Z&&j<h.length;j++)this.boundPaintVertexBuffers[j]!==h[j]&&(Z=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==c||Z||this.boundIndexBuffer!==m||this.boundVertexOffset!==T||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==B?this.freshBind(o,c,h,m,T,z,P,B):(t.bindVertexArray.set(this.vao),z&&z.bind(),m&&m.dynamicDraw&&m.bind(),P&&P.bind(),B&&B.bind())}freshBind(t,o,c,h,m,T,z,P){const B=t.numAttributes,Z=this.context,j=Z.gl;this.vao&&this.destroy(),this.vao=Z.createVertexArray(),Z.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=h,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=P,o.enableAttributes(j,t);for(const $ of c)$.enableAttributes(j,t);T&&T.enableAttributes(j,t),z&&z.enableAttributes(j,t),P&&P.enableAttributes(j,t),o.bind(),o.setVertexAttribPointers(j,t,m);for(const $ of c)$.bind(),$.setVertexAttribPointers(j,t,m);T&&(T.bind(),T.setVertexAttribPointers(j,t,m)),h&&h.bind(),z&&(z.bind(),z.setVertexAttribPointers(j,t,m)),P&&(P.bind(),P.setVertexAttribPointers(j,t,m)),Z.currentNumAttributes=B}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const an=(_,t,o,c,h)=>({u_matrix:_,u_texture:0,u_ele_delta:t,u_fog_matrix:o,u_fog_color:c?c.properties.get("fog-color"):g.aM.white,u_fog_ground_blend:c?c.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:c?c.calculateFogBlendOpacity(h):0,u_horizon_color:c?c.properties.get("horizon-color"):g.aM.white,u_horizon_fog_blend:c?c.properties.get("horizon-fog-blend"):1});function ns(_){const t=[];for(let o=0;o<_.length;o++){if(_[o]===null)continue;const c=_[o].split(" ");t.push(c.pop())}return t}class $r{constructor(t,o,c,h,m,T){const z=t.gl;this.program=z.createProgram();const P=ns(o.staticAttributes),B=c?c.getBinderAttributes():[],Z=P.concat(B),j=tr.prelude.staticUniforms?ns(tr.prelude.staticUniforms):[],$=o.staticUniforms?ns(o.staticUniforms):[],J=c?c.getBinderUniforms():[],et=j.concat($).concat(J),rt=[];for(const Pt of et)rt.indexOf(Pt)<0&&rt.push(Pt);const ct=c?c.defines():[];m&&ct.push("#define OVERDRAW_INSPECTOR;"),T&&ct.push("#define TERRAIN3D;");const ht=ct.concat(tr.prelude.fragmentSource,o.fragmentSource).join(`
`),pt=ct.concat(tr.prelude.vertexSource,o.vertexSource).join(`
`),nt=z.createShader(z.FRAGMENT_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(nt,ht),z.compileShader(nt),!z.getShaderParameter(nt,z.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${z.getShaderInfoLog(nt)}`);z.attachShader(this.program,nt);const vt=z.createShader(z.VERTEX_SHADER);if(z.isContextLost())return void(this.failedToCreate=!0);if(z.shaderSource(vt,pt),z.compileShader(vt),!z.getShaderParameter(vt,z.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${z.getShaderInfoLog(vt)}`);z.attachShader(this.program,vt),this.attributes={};const wt={};this.numAttributes=Z.length;for(let Pt=0;Pt<this.numAttributes;Pt++)Z[Pt]&&(z.bindAttribLocation(this.program,Pt,Z[Pt]),this.attributes[Z[Pt]]=Pt);if(z.linkProgram(this.program),!z.getProgramParameter(this.program,z.LINK_STATUS))throw new Error(`Program failed to link: ${z.getProgramInfoLog(this.program)}`);z.deleteShader(vt),z.deleteShader(nt);for(let Pt=0;Pt<rt.length;Pt++){const Xt=rt[Pt];if(Xt&&!wt[Xt]){const ne=z.getUniformLocation(this.program,Xt);ne&&(wt[Xt]=ne)}}this.fixedUniforms=h(t,wt),this.terrainUniforms=((Pt,Xt)=>({u_depth:new g.aH(Pt,Xt.u_depth),u_terrain:new g.aH(Pt,Xt.u_terrain),u_terrain_dim:new g.aI(Pt,Xt.u_terrain_dim),u_terrain_matrix:new g.aJ(Pt,Xt.u_terrain_matrix),u_terrain_unpack:new g.aK(Pt,Xt.u_terrain_unpack),u_terrain_exaggeration:new g.aI(Pt,Xt.u_terrain_exaggeration)}))(t,wt),this.binderUniforms=c?c.getUniforms(t,wt):[]}draw(t,o,c,h,m,T,z,P,B,Z,j,$,J,et,rt,ct,ht,pt){const nt=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(h),t.setColorMode(m),t.setCullFace(T),P){t.activeTexture.set(nt.TEXTURE2),nt.bindTexture(nt.TEXTURE_2D,P.depthTexture),t.activeTexture.set(nt.TEXTURE3),nt.bindTexture(nt.TEXTURE_2D,P.texture);for(const wt in this.terrainUniforms)this.terrainUniforms[wt].set(P[wt])}for(const wt in this.fixedUniforms)this.fixedUniforms[wt].set(z[wt]);rt&&rt.setUniforms(t,this.binderUniforms,J,{zoom:et});let vt=0;switch(o){case nt.LINES:vt=2;break;case nt.TRIANGLES:vt=3;break;case nt.LINE_STRIP:vt=1}for(const wt of $.get()){const Pt=wt.vaos||(wt.vaos={});(Pt[B]||(Pt[B]=new Bs)).bind(t,this,Z,rt?rt.getPaintVertexBuffers():[],j,wt.vertexOffset,ct,ht,pt),nt.drawElements(o,wt.primitiveLength*vt,nt.UNSIGNED_SHORT,wt.primitiveOffset*vt*2)}}}function as(_,t,o){const c=1/ii(o,1,t.transform.tileZoom),h=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,t.transform.tileZoom)/h,T=m*(o.tileID.canonical.x+o.tileID.wrap*h),z=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,_.fromScale,_.toScale],u_fade:_.t,u_pixel_coord_upper:[T>>16,z>>16],u_pixel_coord_lower:[65535&T,65535&z]}}const fo=(_,t,o,c)=>{const h=t.style.light,m=h.properties.get("position"),T=[m.x,m.y,m.z],z=(function(){var B=new g.A(9);return g.A!=Float32Array&&(B[1]=0,B[2]=0,B[3]=0,B[5]=0,B[6]=0,B[7]=0),B[0]=1,B[4]=1,B[8]=1,B})();h.properties.get("anchor")==="viewport"&&(function(B,Z){var j=Math.sin(Z),$=Math.cos(Z);B[0]=$,B[1]=j,B[2]=0,B[3]=-j,B[4]=$,B[5]=0,B[6]=0,B[7]=0,B[8]=1})(z,-t.transform.angle),(function(B,Z,j){var $=Z[0],J=Z[1],et=Z[2];B[0]=$*j[0]+J*j[3]+et*j[6],B[1]=$*j[1]+J*j[4]+et*j[7],B[2]=$*j[2]+J*j[5]+et*j[8]})(T,T,z);const P=h.properties.get("color");return{u_matrix:_,u_lightpos:T,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+o,u_opacity:c}},Er=(_,t,o,c,h,m,T)=>g.e(fo(_,t,o,c),as(m,t,T),{u_height_factor:-Math.pow(2,h.overscaledZ)/T.tileSize/8}),Mr=_=>({u_matrix:_}),Ho=(_,t,o,c)=>g.e(Mr(_),as(o,t,c)),Bl=(_,t)=>({u_matrix:_,u_world:t}),Nl=(_,t,o,c,h)=>g.e(Ho(_,t,o,c),{u_world:h}),Xo=(_,t,o,c)=>{const h=_.transform;let m,T;if(c.paint.get("circle-pitch-alignment")==="map"){const z=ii(o,1,h.zoom);m=!0,T=[z,z]}else m=!1,T=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:_.translatePosMatrix(t.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:_.pixelRatio,u_extrude_scale:T}},na=(_,t,o)=>({u_matrix:_,u_inv_matrix:t,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}),Yr=(_,t,o=1)=>({u_matrix:_,u_color:t,u_overlay:0,u_overlay_scale:o}),aa=_=>({u_matrix:_}),Wn=(_,t,o,c)=>({u_matrix:_,u_extrude_scale:ii(t,1,o),u_intensity:c}),Ke=(_,t,o,c)=>{const h=g.H();g.aP(h,0,_.width,_.height,0,0,1);const m=_.context.gl;return{u_matrix:h,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:o,u_color_ramp:c,u_opacity:t.paint.get("heatmap-opacity")}};function Va(_,t){const o=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new g.Z(0,c/o).toLngLat().lat,new g.Z(0,(c+1)/o).toLngLat().lat]}const ji=(_,t,o,c)=>{const h=_.transform;return{u_matrix:xs(_,t,o,c),u_ratio:1/ii(t,1,h.zoom),u_device_pixel_ratio:_.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},Fl=(_,t,o,c,h)=>g.e(ji(_,t,o,h),{u_image:0,u_image_height:c}),vs=(_,t,o,c,h)=>{const m=_.transform,T=$o(t,m);return{u_matrix:xs(_,t,o,h),u_texsize:t.imageAtlasTexture.size,u_ratio:1/ii(t,1,m.zoom),u_device_pixel_ratio:_.pixelRatio,u_image:0,u_scale:[T,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Ns=(_,t,o,c,h,m)=>{const T=_.lineAtlas,z=$o(t,_.transform),P=o.layout.get("line-cap")==="round",B=T.getDash(c.from,P),Z=T.getDash(c.to,P),j=B.width*h.fromScale,$=Z.width*h.toScale;return g.e(ji(_,t,o,m),{u_patternscale_a:[z/j,-B.height/2],u_patternscale_b:[z/$,-Z.height/2],u_sdfgamma:T.width/(256*Math.min(j,$)*_.pixelRatio)/2,u_image:0,u_tex_y_a:B.y,u_tex_y_b:Z.y,u_mix:h.t})};function $o(_,t){return 1/ii(_,1,t.tileZoom)}function xs(_,t,o,c){return _.translatePosMatrix(c?c.posMatrix:t.tileID.posMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const er=(_,t,o,c,h)=>{return{u_matrix:_,u_tl_parent:t,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(T=h.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(m=h.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:po(h.paint.get("raster-hue-rotate"))};var m,T};function po(_){_*=Math.PI/180;const t=Math.sin(_),o=Math.cos(_);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}const kn=(_,t,o,c,h,m,T,z,P,B,Z,j,$,J)=>{const et=T.transform;return{u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:et.cameraToCenterDistance,u_pitch:et.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:et.width/et.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:z,u_label_plane_matrix:P,u_coord_matrix:B,u_is_text:+j,u_pitch_with_map:+c,u_is_along_line:h,u_is_variable_anchor:m,u_texsize:$,u_texture:0,u_translation:Z,u_pitched_scale:J}},bs=(_,t,o,c,h,m,T,z,P,B,Z,j,$,J,et)=>{const rt=T.transform;return g.e(kn(_,t,o,c,h,m,T,z,P,B,Z,j,$,et),{u_gamma_scale:c?Math.cos(rt._pitch)*rt.cameraToCenterDistance:1,u_device_pixel_ratio:T.pixelRatio,u_is_halo:1})},mo=(_,t,o,c,h,m,T,z,P,B,Z,j,$,J)=>g.e(bs(_,t,o,c,h,m,T,z,P,B,Z,!0,j,!0,J),{u_texsize_icon:$,u_texture_icon:1}),Kr=(_,t,o)=>({u_matrix:_,u_opacity:t,u_color:o}),Ul=(_,t,o,c,h,m)=>g.e((function(T,z,P,B){const Z=P.imageManager.getPattern(T.from.toString()),j=P.imageManager.getPattern(T.to.toString()),{width:$,height:J}=P.imageManager.getPixelSize(),et=Math.pow(2,B.tileID.overscaledZ),rt=B.tileSize*Math.pow(2,P.transform.tileZoom)/et,ct=rt*(B.tileID.canonical.x+B.tileID.wrap*et),ht=rt*B.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:j.tl,u_pattern_br_b:j.br,u_texsize:[$,J],u_mix:z.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:j.displaySize,u_scale_a:z.fromScale,u_scale_b:z.toScale,u_tile_units_to_pixels:1/ii(B,1,P.transform.tileZoom),u_pixel_coord_upper:[ct>>16,ht>>16],u_pixel_coord_lower:[65535&ct,65535&ht]}})(c,m,o,h),{u_matrix:_,u_opacity:t}),fa={fillExtrusion:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_lightpos:new g.aN(_,t.u_lightpos),u_lightintensity:new g.aI(_,t.u_lightintensity),u_lightcolor:new g.aN(_,t.u_lightcolor),u_vertical_gradient:new g.aI(_,t.u_vertical_gradient),u_opacity:new g.aI(_,t.u_opacity)}),fillExtrusionPattern:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_lightpos:new g.aN(_,t.u_lightpos),u_lightintensity:new g.aI(_,t.u_lightintensity),u_lightcolor:new g.aN(_,t.u_lightcolor),u_vertical_gradient:new g.aI(_,t.u_vertical_gradient),u_height_factor:new g.aI(_,t.u_height_factor),u_image:new g.aH(_,t.u_image),u_texsize:new g.aO(_,t.u_texsize),u_pixel_coord_upper:new g.aO(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new g.aO(_,t.u_pixel_coord_lower),u_scale:new g.aN(_,t.u_scale),u_fade:new g.aI(_,t.u_fade),u_opacity:new g.aI(_,t.u_opacity)}),fill:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix)}),fillPattern:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_image:new g.aH(_,t.u_image),u_texsize:new g.aO(_,t.u_texsize),u_pixel_coord_upper:new g.aO(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new g.aO(_,t.u_pixel_coord_lower),u_scale:new g.aN(_,t.u_scale),u_fade:new g.aI(_,t.u_fade)}),fillOutline:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_world:new g.aO(_,t.u_world)}),fillOutlinePattern:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_world:new g.aO(_,t.u_world),u_image:new g.aH(_,t.u_image),u_texsize:new g.aO(_,t.u_texsize),u_pixel_coord_upper:new g.aO(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new g.aO(_,t.u_pixel_coord_lower),u_scale:new g.aN(_,t.u_scale),u_fade:new g.aI(_,t.u_fade)}),circle:(_,t)=>({u_camera_to_center_distance:new g.aI(_,t.u_camera_to_center_distance),u_scale_with_map:new g.aH(_,t.u_scale_with_map),u_pitch_with_map:new g.aH(_,t.u_pitch_with_map),u_extrude_scale:new g.aO(_,t.u_extrude_scale),u_device_pixel_ratio:new g.aI(_,t.u_device_pixel_ratio),u_matrix:new g.aJ(_,t.u_matrix)}),collisionBox:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_pixel_extrude_scale:new g.aO(_,t.u_pixel_extrude_scale)}),collisionCircle:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_inv_matrix:new g.aJ(_,t.u_inv_matrix),u_camera_to_center_distance:new g.aI(_,t.u_camera_to_center_distance),u_viewport_size:new g.aO(_,t.u_viewport_size)}),debug:(_,t)=>({u_color:new g.aL(_,t.u_color),u_matrix:new g.aJ(_,t.u_matrix),u_overlay:new g.aH(_,t.u_overlay),u_overlay_scale:new g.aI(_,t.u_overlay_scale)}),clippingMask:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix)}),heatmap:(_,t)=>({u_extrude_scale:new g.aI(_,t.u_extrude_scale),u_intensity:new g.aI(_,t.u_intensity),u_matrix:new g.aJ(_,t.u_matrix)}),heatmapTexture:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_world:new g.aO(_,t.u_world),u_image:new g.aH(_,t.u_image),u_color_ramp:new g.aH(_,t.u_color_ramp),u_opacity:new g.aI(_,t.u_opacity)}),hillshade:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_image:new g.aH(_,t.u_image),u_latrange:new g.aO(_,t.u_latrange),u_light:new g.aO(_,t.u_light),u_shadow:new g.aL(_,t.u_shadow),u_highlight:new g.aL(_,t.u_highlight),u_accent:new g.aL(_,t.u_accent)}),hillshadePrepare:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_image:new g.aH(_,t.u_image),u_dimension:new g.aO(_,t.u_dimension),u_zoom:new g.aI(_,t.u_zoom),u_unpack:new g.aK(_,t.u_unpack)}),line:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_ratio:new g.aI(_,t.u_ratio),u_device_pixel_ratio:new g.aI(_,t.u_device_pixel_ratio),u_units_to_pixels:new g.aO(_,t.u_units_to_pixels)}),lineGradient:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_ratio:new g.aI(_,t.u_ratio),u_device_pixel_ratio:new g.aI(_,t.u_device_pixel_ratio),u_units_to_pixels:new g.aO(_,t.u_units_to_pixels),u_image:new g.aH(_,t.u_image),u_image_height:new g.aI(_,t.u_image_height)}),linePattern:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_texsize:new g.aO(_,t.u_texsize),u_ratio:new g.aI(_,t.u_ratio),u_device_pixel_ratio:new g.aI(_,t.u_device_pixel_ratio),u_image:new g.aH(_,t.u_image),u_units_to_pixels:new g.aO(_,t.u_units_to_pixels),u_scale:new g.aN(_,t.u_scale),u_fade:new g.aI(_,t.u_fade)}),lineSDF:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_ratio:new g.aI(_,t.u_ratio),u_device_pixel_ratio:new g.aI(_,t.u_device_pixel_ratio),u_units_to_pixels:new g.aO(_,t.u_units_to_pixels),u_patternscale_a:new g.aO(_,t.u_patternscale_a),u_patternscale_b:new g.aO(_,t.u_patternscale_b),u_sdfgamma:new g.aI(_,t.u_sdfgamma),u_image:new g.aH(_,t.u_image),u_tex_y_a:new g.aI(_,t.u_tex_y_a),u_tex_y_b:new g.aI(_,t.u_tex_y_b),u_mix:new g.aI(_,t.u_mix)}),raster:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_tl_parent:new g.aO(_,t.u_tl_parent),u_scale_parent:new g.aI(_,t.u_scale_parent),u_buffer_scale:new g.aI(_,t.u_buffer_scale),u_fade_t:new g.aI(_,t.u_fade_t),u_opacity:new g.aI(_,t.u_opacity),u_image0:new g.aH(_,t.u_image0),u_image1:new g.aH(_,t.u_image1),u_brightness_low:new g.aI(_,t.u_brightness_low),u_brightness_high:new g.aI(_,t.u_brightness_high),u_saturation_factor:new g.aI(_,t.u_saturation_factor),u_contrast_factor:new g.aI(_,t.u_contrast_factor),u_spin_weights:new g.aN(_,t.u_spin_weights)}),symbolIcon:(_,t)=>({u_is_size_zoom_constant:new g.aH(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new g.aH(_,t.u_is_size_feature_constant),u_size_t:new g.aI(_,t.u_size_t),u_size:new g.aI(_,t.u_size),u_camera_to_center_distance:new g.aI(_,t.u_camera_to_center_distance),u_pitch:new g.aI(_,t.u_pitch),u_rotate_symbol:new g.aH(_,t.u_rotate_symbol),u_aspect_ratio:new g.aI(_,t.u_aspect_ratio),u_fade_change:new g.aI(_,t.u_fade_change),u_matrix:new g.aJ(_,t.u_matrix),u_label_plane_matrix:new g.aJ(_,t.u_label_plane_matrix),u_coord_matrix:new g.aJ(_,t.u_coord_matrix),u_is_text:new g.aH(_,t.u_is_text),u_pitch_with_map:new g.aH(_,t.u_pitch_with_map),u_is_along_line:new g.aH(_,t.u_is_along_line),u_is_variable_anchor:new g.aH(_,t.u_is_variable_anchor),u_texsize:new g.aO(_,t.u_texsize),u_texture:new g.aH(_,t.u_texture),u_translation:new g.aO(_,t.u_translation),u_pitched_scale:new g.aI(_,t.u_pitched_scale)}),symbolSDF:(_,t)=>({u_is_size_zoom_constant:new g.aH(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new g.aH(_,t.u_is_size_feature_constant),u_size_t:new g.aI(_,t.u_size_t),u_size:new g.aI(_,t.u_size),u_camera_to_center_distance:new g.aI(_,t.u_camera_to_center_distance),u_pitch:new g.aI(_,t.u_pitch),u_rotate_symbol:new g.aH(_,t.u_rotate_symbol),u_aspect_ratio:new g.aI(_,t.u_aspect_ratio),u_fade_change:new g.aI(_,t.u_fade_change),u_matrix:new g.aJ(_,t.u_matrix),u_label_plane_matrix:new g.aJ(_,t.u_label_plane_matrix),u_coord_matrix:new g.aJ(_,t.u_coord_matrix),u_is_text:new g.aH(_,t.u_is_text),u_pitch_with_map:new g.aH(_,t.u_pitch_with_map),u_is_along_line:new g.aH(_,t.u_is_along_line),u_is_variable_anchor:new g.aH(_,t.u_is_variable_anchor),u_texsize:new g.aO(_,t.u_texsize),u_texture:new g.aH(_,t.u_texture),u_gamma_scale:new g.aI(_,t.u_gamma_scale),u_device_pixel_ratio:new g.aI(_,t.u_device_pixel_ratio),u_is_halo:new g.aH(_,t.u_is_halo),u_translation:new g.aO(_,t.u_translation),u_pitched_scale:new g.aI(_,t.u_pitched_scale)}),symbolTextAndIcon:(_,t)=>({u_is_size_zoom_constant:new g.aH(_,t.u_is_size_zoom_constant),u_is_size_feature_constant:new g.aH(_,t.u_is_size_feature_constant),u_size_t:new g.aI(_,t.u_size_t),u_size:new g.aI(_,t.u_size),u_camera_to_center_distance:new g.aI(_,t.u_camera_to_center_distance),u_pitch:new g.aI(_,t.u_pitch),u_rotate_symbol:new g.aH(_,t.u_rotate_symbol),u_aspect_ratio:new g.aI(_,t.u_aspect_ratio),u_fade_change:new g.aI(_,t.u_fade_change),u_matrix:new g.aJ(_,t.u_matrix),u_label_plane_matrix:new g.aJ(_,t.u_label_plane_matrix),u_coord_matrix:new g.aJ(_,t.u_coord_matrix),u_is_text:new g.aH(_,t.u_is_text),u_pitch_with_map:new g.aH(_,t.u_pitch_with_map),u_is_along_line:new g.aH(_,t.u_is_along_line),u_is_variable_anchor:new g.aH(_,t.u_is_variable_anchor),u_texsize:new g.aO(_,t.u_texsize),u_texsize_icon:new g.aO(_,t.u_texsize_icon),u_texture:new g.aH(_,t.u_texture),u_texture_icon:new g.aH(_,t.u_texture_icon),u_gamma_scale:new g.aI(_,t.u_gamma_scale),u_device_pixel_ratio:new g.aI(_,t.u_device_pixel_ratio),u_is_halo:new g.aH(_,t.u_is_halo),u_translation:new g.aO(_,t.u_translation),u_pitched_scale:new g.aI(_,t.u_pitched_scale)}),background:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_opacity:new g.aI(_,t.u_opacity),u_color:new g.aL(_,t.u_color)}),backgroundPattern:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_opacity:new g.aI(_,t.u_opacity),u_image:new g.aH(_,t.u_image),u_pattern_tl_a:new g.aO(_,t.u_pattern_tl_a),u_pattern_br_a:new g.aO(_,t.u_pattern_br_a),u_pattern_tl_b:new g.aO(_,t.u_pattern_tl_b),u_pattern_br_b:new g.aO(_,t.u_pattern_br_b),u_texsize:new g.aO(_,t.u_texsize),u_mix:new g.aI(_,t.u_mix),u_pattern_size_a:new g.aO(_,t.u_pattern_size_a),u_pattern_size_b:new g.aO(_,t.u_pattern_size_b),u_scale_a:new g.aI(_,t.u_scale_a),u_scale_b:new g.aI(_,t.u_scale_b),u_pixel_coord_upper:new g.aO(_,t.u_pixel_coord_upper),u_pixel_coord_lower:new g.aO(_,t.u_pixel_coord_lower),u_tile_units_to_pixels:new g.aI(_,t.u_tile_units_to_pixels)}),terrain:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_texture:new g.aH(_,t.u_texture),u_ele_delta:new g.aI(_,t.u_ele_delta),u_fog_matrix:new g.aJ(_,t.u_fog_matrix),u_fog_color:new g.aL(_,t.u_fog_color),u_fog_ground_blend:new g.aI(_,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new g.aI(_,t.u_fog_ground_blend_opacity),u_horizon_color:new g.aL(_,t.u_horizon_color),u_horizon_fog_blend:new g.aI(_,t.u_horizon_fog_blend)}),terrainDepth:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_ele_delta:new g.aI(_,t.u_ele_delta)}),terrainCoords:(_,t)=>({u_matrix:new g.aJ(_,t.u_matrix),u_texture:new g.aH(_,t.u_texture),u_terrain_coords_id:new g.aI(_,t.u_terrain_coords_id),u_ele_delta:new g.aI(_,t.u_ele_delta)}),sky:(_,t)=>({u_sky_color:new g.aL(_,t.u_sky_color),u_horizon_color:new g.aL(_,t.u_horizon_color),u_horizon:new g.aI(_,t.u_horizon),u_sky_horizon_blend:new g.aI(_,t.u_sky_horizon_blend)})};class sa{constructor(t,o,c){this.context=t;const h=t.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Zl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wr{constructor(t,o,c,h){this.length=o.length,this.attributes=c,this.itemSize=o.bytesPerElement,this.dynamicDraw=h,this.context=t;const m=t.gl;this.buffer=m.createBuffer(),t.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let c=0;c<this.attributes.length;c++){const h=o.attributes[this.attributes[c].name];h!==void 0&&t.enableVertexAttribArray(h)}}setVertexAttribPointers(t,o,c){for(let h=0;h<this.attributes.length;h++){const m=this.attributes[h],T=o.attributes[m.name];T!==void 0&&t.vertexAttribPointer(T,m.components,t[Zl[m.type]],!1,this.itemSize,m.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const hi=new WeakMap;function ir(_){var t;if(hi.has(_))return hi.get(_);{const o=(t=_.getParameter(_.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return hi.set(_,o),o}}class si{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ws extends si{getDefault(){return g.aM.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class fl extends si{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class _o extends si{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class yu extends si{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Hu extends si{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Xu extends si{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class jl extends si{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class vu extends si{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Vl extends si{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class $u extends si{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Fs extends si{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class Yu extends si{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class zr extends si{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class Cr extends si{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ku extends si{getDefault(){return g.aM.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class xu extends si{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class go extends si{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class bu extends si{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class dl extends si{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Wu extends si{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Oc extends si{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class wu extends si{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ql extends si{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Ju extends si{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Gl extends si{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Su extends si{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class yo extends si{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ia extends si{getDefault(){return null}set(t){var o;if(t===this.current&&!this.dirty)return;const c=this.gl;ir(c)?c.bindVertexArray(t):(o=c.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Tu extends si{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class vo extends si{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class qa extends si{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class xo extends si{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class Jr extends xo{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class bo extends xo{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Yo extends xo{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Hl{constructor(t,o,c,h,m){this.context=t,this.width=o,this.height=c;const T=t.gl,z=this.framebuffer=T.createFramebuffer();if(this.colorAttachment=new Jr(t,z),h)this.depthAttachment=m?new Yo(t,z):new bo(t,z);else if(m)throw new Error("Stencil cannot be set without depth");if(T.checkFramebufferStatus(T.FRAMEBUFFER)!==T.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,o=this.colorAttachment.get();if(o&&t.deleteTexture(o),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class zn{constructor(t,o,c){this.blendFunction=t,this.blendColor=o,this.mask=c}}zn.Replace=[1,0],zn.disabled=new zn(zn.Replace,g.aM.transparent,[!1,!1,!1,!1]),zn.unblended=new zn(zn.Replace,g.aM.transparent,[!0,!0,!0,!0]),zn.alphaBlended=new zn([1,771],g.aM.transparent,[!0,!0,!0,!0]);class Qu{constructor(t){var o,c;if(this.gl=t,this.clearColor=new ws(this),this.clearDepth=new fl(this),this.clearStencil=new _o(this),this.colorMask=new yu(this),this.depthMask=new Hu(this),this.stencilMask=new Xu(this),this.stencilFunc=new jl(this),this.stencilOp=new vu(this),this.stencilTest=new Vl(this),this.depthRange=new $u(this),this.depthTest=new Fs(this),this.depthFunc=new Yu(this),this.blend=new zr(this),this.blendFunc=new Cr(this),this.blendColor=new Ku(this),this.blendEquation=new xu(this),this.cullFace=new go(this),this.cullFaceSide=new bu(this),this.frontFace=new dl(this),this.program=new Wu(this),this.activeTexture=new Oc(this),this.viewport=new wu(this),this.bindFramebuffer=new ql(this),this.bindRenderbuffer=new Ju(this),this.bindTexture=new Gl(this),this.bindVertexBuffer=new Su(this),this.bindElementBuffer=new yo(this),this.bindVertexArray=new Ia(this),this.pixelStoreUnpack=new Tu(this),this.pixelStoreUnpackPremultiplyAlpha=new vo(this),this.pixelStoreUnpackFlipY=new qa(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),ir(t)){this.HALF_FLOAT=t.HALF_FLOAT;const h=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=t.RGBA16F)!==null&&o!==void 0?o:h?.RGBA16F_EXT,this.RGB16F=(c=t.RGB16F)!==null&&c!==void 0?c:h?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const h=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=h?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o){return new sa(this,t,o)}createVertexBuffer(t,o,c){return new Wr(this,t,o,c)}createRenderbuffer(t,o,c){const h=this.gl,m=h.createRenderbuffer();return this.bindRenderbuffer.set(m),h.renderbufferStorage(h.RENDERBUFFER,t,o,c),this.bindRenderbuffer.set(null),m}createFramebuffer(t,o,c,h){return new Hl(this,t,o,c,h)}clear({color:t,depth:o,stencil:c}){const h=this.gl;let m=0;t&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),h.clear(m)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){g.aE(t.blendFunction,zn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return ir(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var o;return ir(this.gl)?this.gl.deleteVertexArray(t):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class oi{constructor(t,o,c){this.func=t,this.mask=o,this.range=c}}oi.ReadOnly=!1,oi.ReadWrite=!0,oi.disabled=new oi(519,oi.ReadOnly,[0,1]);const Lr=7680;class Si{constructor(t,o,c,h,m,T){this.test=t,this.ref=o,this.mask=c,this.fail=h,this.depthFail=m,this.pass=T}}Si.disabled=new Si({func:519,mask:0},0,0,Lr,Lr,Lr);class Di{constructor(t,o,c){this.enable=t,this.mode=o,this.frontFace=c}}let wo;function Ga(_,t,o,c,h){const m=_.context,T=m.gl,z=_.useProgram("collisionBox"),P=[];let B=0,Z=0;for(let ht=0;ht<c.length;ht++){const pt=c[ht],nt=t.getTile(pt).getBucket(o);if(!nt)continue;const vt=h?nt.textCollisionBox:nt.iconCollisionBox,wt=nt.collisionCircleArray;if(wt.length>0){const Pt=g.H();g.aQ(Pt,nt.placementInvProjMatrix,_.transform.glCoordMatrix),g.aQ(Pt,Pt,nt.placementViewportMatrix),P.push({circleArray:wt,circleOffset:Z,transform:pt.posMatrix,invTransform:Pt,coord:pt}),B+=wt.length/4,Z=B}vt&&z.draw(m,T.LINES,oi.disabled,Si.disabled,_.colorModeForRenderPass(),Di.disabled,{u_matrix:pt.posMatrix,u_pixel_extrude_scale:[1/(j=_.transform).width,1/j.height]},_.style.map.terrain&&_.style.map.terrain.getTerrainData(pt),o.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,null,_.transform.zoom,null,null,vt.collisionVertexBuffer)}var j;if(!h||!P.length)return;const $=_.useProgram("collisionCircle"),J=new g.aR;J.resize(4*B),J._trim();let et=0;for(const ht of P)for(let pt=0;pt<ht.circleArray.length/4;pt++){const nt=4*pt,vt=ht.circleArray[nt+0],wt=ht.circleArray[nt+1],Pt=ht.circleArray[nt+2],Xt=ht.circleArray[nt+3];J.emplace(et++,vt,wt,Pt,Xt,0),J.emplace(et++,vt,wt,Pt,Xt,1),J.emplace(et++,vt,wt,Pt,Xt,2),J.emplace(et++,vt,wt,Pt,Xt,3)}(!wo||wo.length<2*B)&&(wo=(function(ht){const pt=2*ht,nt=new g.aT;nt.resize(pt),nt._trim();for(let vt=0;vt<pt;vt++){const wt=6*vt;nt.uint16[wt+0]=4*vt+0,nt.uint16[wt+1]=4*vt+1,nt.uint16[wt+2]=4*vt+2,nt.uint16[wt+3]=4*vt+2,nt.uint16[wt+4]=4*vt+3,nt.uint16[wt+5]=4*vt+0}return nt})(B));const rt=m.createIndexBuffer(wo,!0),ct=m.createVertexBuffer(J,g.aS.members,!0);for(const ht of P){const pt=na(ht.transform,ht.invTransform,_.transform);$.draw(m,T.TRIANGLES,oi.disabled,Si.disabled,_.colorModeForRenderPass(),Di.disabled,pt,_.style.map.terrain&&_.style.map.terrain.getTerrainData(ht.coord),o.id,ct,rt,g.a0.simpleSegment(0,2*ht.circleOffset,ht.circleArray.length,ht.circleArray.length/2),null,_.transform.zoom,null,null,null)}ct.destroy(),rt.destroy()}Di.disabled=new Di(!1,1029,2305),Di.backCCW=new Di(!0,1029,2305);const Ko=g.an(new Float32Array(16));function Ss(_,t,o,c,h,m){const{horizontalAlign:T,verticalAlign:z}=g.au(_);return new g.P((-(T-.5)*t/h+c[0])*m,(-(z-.5)*o/h+c[1])*m)}function Us(_,t,o,c,h,m){const T=t.tileAnchorPoint.add(new g.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let z=c.mult(m);o||(z=z.rotate(-h));const P=T.add(z);return ot(P.x,P.y,t.labelPlaneMatrix,t.getElevation).point}if(o){const z=jt(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(_),P=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return _.add(c.rotate(P))}return _.add(c)}function nr(_,t,o,c,h,m,T,z,P,B,Z,j,$,J){const et=_.text.placedSymbolArray,rt=_.text.dynamicLayoutVertexArray,ct=_.icon.dynamicLayoutVertexArray,ht={};rt.clear();for(let pt=0;pt<et.length;pt++){const nt=et.get(pt),vt=nt.hidden||!nt.crossTileID||_.allowVerticalPlacement&&!nt.placedOrientation?null:c[nt.crossTileID];if(vt){const wt=new g.P(nt.anchorX,nt.anchorY),Pt={getElevation:J,width:h.width,height:h.height,labelPlaneMatrix:m,pitchWithMap:o,projection:Z,tileAnchorPoint:wt,translation:j,unwrappedTileID:$},Xt=o?ot(wt.x,wt.y,T,J):jt(wt.x,wt.y,Pt),ne=H(h.cameraToCenterDistance,Xt.signedDistanceFromCamera);let ue=g.ai(_.textSizeData,P,nt)*ne/g.ap;o&&(ue*=_.tilePixelRatio/z);const{width:ve,height:he,anchor:se,textOffset:we,textBoxScale:qe}=vt,fe=Ss(se,ve,he,we,qe,ue),_e=Z.getPitchedTextCorrection(h,wt.add(new g.P(j[0],j[1])),$),Ze=Us(Xt.point,Pt,t,fe,h.angle,_e),tn=_.allowVerticalPlacement&&nt.placedOrientation===g.ah.vertical?Math.PI/2:0;for(let li=0;li<nt.numGlyphs;li++)g.aj(rt,Ze,tn);B&&nt.associatedIconIndex>=0&&(ht[nt.associatedIconIndex]={shiftedAnchor:Ze,angle:tn})}else Pe(nt.numGlyphs,rt)}if(B){ct.clear();const pt=_.icon.placedSymbolArray;for(let nt=0;nt<pt.length;nt++){const vt=pt.get(nt);if(vt.hidden)Pe(vt.numGlyphs,ct);else{const wt=ht[nt];if(wt)for(let Pt=0;Pt<vt.numGlyphs;Pt++)g.aj(ct,wt.shiftedAnchor,wt.angle);else Pe(vt.numGlyphs,ct)}}_.icon.dynamicLayoutVertexBuffer.updateData(ct)}_.text.dynamicLayoutVertexBuffer.updateData(rt)}function ya(_,t,o){return o.iconsInText&&t?"symbolTextAndIcon":_?"symbolSDF":"symbolIcon"}function So(_,t,o,c,h,m,T,z,P,B,Z,j){const $=_.context,J=$.gl,et=_.transform,rt=Os(),ct=z==="map",ht=P==="map",pt=z!=="viewport"&&o.layout.get("symbol-placement")!=="point",nt=ct&&!ht&&!pt,vt=!ht&&pt,wt=!o.layout.get("symbol-sort-key").isConstant();let Pt=!1;const Xt=_.depthModeForSublayer(0,oi.ReadOnly),ne=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ue=[],ve=rt.getCircleRadiusCorrection(et);for(const he of c){const se=t.getTile(he),we=se.getBucket(o);if(!we)continue;const qe=h?we.text:we.icon;if(!qe||!qe.segments.get().length||!qe.hasVisibleVertices)continue;const fe=qe.programConfigurations.get(o.id),_e=h||we.sdfIcons,Ze=h?we.textSizeData:we.iconSizeData,tn=ht||et.pitch!==0,li=_.useProgram(ya(_e,h,we),fe),yi=g.ag(Ze,et.zoom),Wi=_.style.map.terrain&&_.style.map.terrain.getTerrainData(he);let ma,ur,cn,Xa,gn=[0,0],yn=null;if(h)ur=se.glyphAtlasTexture,cn=J.LINEAR,ma=se.glyphAtlasTexture.size,we.iconsInText&&(gn=se.imageAtlasTexture.size,yn=se.imageAtlasTexture,Xa=tn||_.options.rotating||_.options.zooming||Ze.kind==="composite"||Ze.kind==="camera"?J.LINEAR:J.NEAREST);else{const di=o.layout.get("icon-size").constantOr(0)!==1||we.iconsNeedLinear;ur=se.imageAtlasTexture,cn=_e||_.options.rotating||_.options.zooming||di||tn?J.LINEAR:J.NEAREST,ma=se.imageAtlasTexture.size}const Hn=ii(se,1,_.transform.zoom),cr=vt?he.posMatrix:Ko,wl=ys(cr,ht,ct,_.transform,Hn),Or=Za(cr,ht,ct,_.transform,Hn),va=Za(he.posMatrix,ht,ct,_.transform,Hn),Gi=rt.translatePosition(_.transform,se,m,T),Sl=ne&&we.hasTextData(),Br=o.layout.get("icon-text-fit")!=="none"&&Sl&&we.hasIconData();if(pt){const di=_.style.map.terrain?(Wl,xn)=>_.style.map.terrain.getElevation(he,Wl,xn):null,hr=o.layout.get("text-rotation-alignment")==="map";tt(we,he.posMatrix,_,h,wl,va,ht,B,hr,rt,he.toUnwrapped(),et.width,et.height,Gi,di)}const $e=he.posMatrix,Ti=h&&ne||Br,vn=pt||Ti?Ko:wl,zs=Or,Xn=_e&&o.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let $n;$n=_e?we.iconsInText?mo(Ze.kind,yi,nt,ht,pt,Ti,_,$e,vn,zs,Gi,ma,gn,ve):bs(Ze.kind,yi,nt,ht,pt,Ti,_,$e,vn,zs,Gi,h,ma,!0,ve):kn(Ze.kind,yi,nt,ht,pt,Ti,_,$e,vn,zs,Gi,h,ma,ve);const $a={program:li,buffers:qe,uniformValues:$n,atlasTexture:ur,atlasTextureIcon:yn,atlasInterpolation:cn,atlasInterpolationIcon:Xa,isSDF:_e,hasHalo:Xn};if(wt&&we.canOverlap){Pt=!0;const di=qe.segments.get();for(const hr of di)ue.push({segments:new g.a0([hr]),sortKey:hr.sortKey,state:$a,terrainData:Wi})}else ue.push({segments:qe.segments,sortKey:0,state:$a,terrainData:Wi})}Pt&&ue.sort(((he,se)=>he.sortKey-se.sortKey));for(const he of ue){const se=he.state;if($.activeTexture.set(J.TEXTURE0),se.atlasTexture.bind(se.atlasInterpolation,J.CLAMP_TO_EDGE),se.atlasTextureIcon&&($.activeTexture.set(J.TEXTURE1),se.atlasTextureIcon&&se.atlasTextureIcon.bind(se.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),se.isSDF){const we=se.uniformValues;se.hasHalo&&(we.u_is_halo=1,Xl(se.buffers,he.segments,o,_,se.program,Xt,Z,j,we,he.terrainData)),we.u_is_halo=0}Xl(se.buffers,he.segments,o,_,se.program,Xt,Z,j,se.uniformValues,he.terrainData)}}function Xl(_,t,o,c,h,m,T,z,P,B){const Z=c.context;h.draw(Z,Z.gl.TRIANGLES,m,T,z,Di.disabled,P,B,o.id,_.layoutVertexBuffer,_.indexBuffer,t,o.paint,c.transform.zoom,_.programConfigurations.get(o.id),_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer)}function Ts(_,t,o,c){const h=_.context,m=h.gl,T=Si.disabled,z=new zn([m.ONE,m.ONE],g.aM.transparent,[!0,!0,!0,!0]),P=t.getBucket(o);if(!P)return;const B=c.key;let Z=o.heatmapFbos.get(B);Z||(Z=Wo(h,t.tileSize,t.tileSize),o.heatmapFbos.set(B,Z)),h.bindFramebuffer.set(Z.framebuffer),h.viewport.set([0,0,t.tileSize,t.tileSize]),h.clear({color:g.aM.transparent});const j=P.programConfigurations.get(o.id),$=_.useProgram("heatmap",j),J=_.style.map.terrain.getTerrainData(c);$.draw(h,m.TRIANGLES,oi.disabled,T,z,Di.disabled,Wn(c.posMatrix,t,_.transform.zoom,o.paint.get("heatmap-intensity")),J,o.id,P.layoutVertexBuffer,P.indexBuffer,P.segments,o.paint,_.transform.zoom,j)}function As(_,t,o){const c=_.context,h=c.gl;c.setColorMode(_.colorModeForRenderPass());const m=Qr(c,t),T=o.key,z=t.heatmapFbos.get(T);z&&(c.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,z.colorAttachment.get()),c.activeTexture.set(h.TEXTURE1),m.bind(h.LINEAR,h.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(c,h.TRIANGLES,oi.disabled,Si.disabled,_.colorModeForRenderPass(),Di.disabled,Ke(_,t,0,1),null,t.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments,t.paint,_.transform.zoom),z.destroy(),t.heatmapFbos.delete(T))}function Wo(_,t,o){var c,h;const m=_.gl,T=m.createTexture();m.bindTexture(m.TEXTURE_2D,T),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const z=(c=_.HALF_FLOAT)!==null&&c!==void 0?c:m.UNSIGNED_BYTE,P=(h=_.RGBA16F)!==null&&h!==void 0?h:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,P,t,o,0,m.RGBA,z,null);const B=_.createFramebuffer(t,o,!1,!1);return B.colorAttachment.set(T),B}function Qr(_,t){return t.colorRampTexture||(t.colorRampTexture=new Fe(_,t.colorRamp,_.gl.RGBA)),t.colorRampTexture}function To(_,t,o,c,h){if(!o||!c||!c.imageAtlas)return;const m=c.imageAtlas.patternPositions;let T=m[o.to.toString()],z=m[o.from.toString()];if(!T&&z&&(T=z),!z&&T&&(z=T),!T||!z){const P=h.getPaintProperty(t);T=m[P],z=m[P]}T&&z&&_.setConstantPatternPositions(T,z)}function ss(_,t,o,c,h,m,T){const z=_.context.gl,P="fill-pattern",B=o.paint.get(P),Z=B&&B.constantOr(1),j=o.getCrossfadeParameters();let $,J,et,rt,ct;T?(J=Z&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=z.LINES):(J=Z?"fillPattern":"fill",$=z.TRIANGLES);const ht=B.constantOr(null);for(const pt of c){const nt=t.getTile(pt);if(Z&&!nt.patternsLoaded())continue;const vt=nt.getBucket(o);if(!vt)continue;const wt=vt.programConfigurations.get(o.id),Pt=_.useProgram(J,wt),Xt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(pt);Z&&(_.context.activeTexture.set(z.TEXTURE0),nt.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),wt.updatePaintBuffers(j)),To(wt,P,ht,nt,o);const ne=Xt?pt:null,ue=_.translatePosMatrix(ne?ne.posMatrix:pt.posMatrix,nt,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(T){rt=vt.indexBuffer2,ct=vt.segments2;const ve=[z.drawingBufferWidth,z.drawingBufferHeight];et=J==="fillOutlinePattern"&&Z?Nl(ue,_,j,nt,ve):Bl(ue,ve)}else rt=vt.indexBuffer,ct=vt.segments,et=Z?Ho(ue,_,j,nt):Mr(ue);Pt.draw(_.context,$,h,_.stencilModeForClipping(pt),m,Di.disabled,et,Xt,o.id,vt.layoutVertexBuffer,rt,ct,o.paint,_.transform.zoom,wt)}}function $l(_,t,o,c,h,m,T){const z=_.context,P=z.gl,B="fill-extrusion-pattern",Z=o.paint.get(B),j=Z.constantOr(1),$=o.getCrossfadeParameters(),J=o.paint.get("fill-extrusion-opacity"),et=Z.constantOr(null);for(const rt of c){const ct=t.getTile(rt),ht=ct.getBucket(o);if(!ht)continue;const pt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(rt),nt=ht.programConfigurations.get(o.id),vt=_.useProgram(j?"fillExtrusionPattern":"fillExtrusion",nt);j&&(_.context.activeTexture.set(P.TEXTURE0),ct.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),nt.updatePaintBuffers($)),To(nt,B,et,ct,o);const wt=_.translatePosMatrix(rt.posMatrix,ct,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Pt=o.paint.get("fill-extrusion-vertical-gradient"),Xt=j?Er(wt,_,Pt,J,rt,$,ct):fo(wt,_,Pt,J);vt.draw(z,z.gl.TRIANGLES,h,m,T,Di.backCCW,Xt,pt,o.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,o.paint,_.transform.zoom,nt,_.style.map.terrain&&ht.centroidVertexBuffer)}}function Zs(_,t,o,c,h,m,T){const z=_.context,P=z.gl,B=o.fbo;if(!B)return;const Z=_.useProgram("hillshade"),j=_.style.map.terrain&&_.style.map.terrain.getTerrainData(t);z.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,B.colorAttachment.get()),Z.draw(z,P.TRIANGLES,h,m,T,Di.disabled,(($,J,et,rt)=>{const ct=et.paint.get("hillshade-shadow-color"),ht=et.paint.get("hillshade-highlight-color"),pt=et.paint.get("hillshade-accent-color");let nt=et.paint.get("hillshade-illumination-direction")*(Math.PI/180);et.paint.get("hillshade-illumination-anchor")==="viewport"&&(nt-=$.transform.angle);const vt=!$.options.moving;return{u_matrix:rt?rt.posMatrix:$.transform.calculatePosMatrix(J.tileID.toUnwrapped(),vt),u_image:0,u_latrange:Va(0,J.tileID),u_light:[et.paint.get("hillshade-exaggeration"),nt],u_shadow:ct,u_highlight:ht,u_accent:pt}})(_,o,c,j?t:null),j,c.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments)}function Jo(_,t,o,c,h,m){const T=_.context,z=T.gl,P=t.dem;if(P&&P.data){const B=P.dim,Z=P.stride,j=P.getPixels();if(T.activeTexture.set(z.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||_.getTileTexture(Z),t.demTexture){const J=t.demTexture;J.update(j,{premultiply:!1}),J.bind(z.NEAREST,z.CLAMP_TO_EDGE)}else t.demTexture=new Fe(T,j,z.RGBA,{premultiply:!1}),t.demTexture.bind(z.NEAREST,z.CLAMP_TO_EDGE);T.activeTexture.set(z.TEXTURE0);let $=t.fbo;if(!$){const J=new Fe(T,{width:B,height:B,data:null},z.RGBA);J.bind(z.LINEAR,z.CLAMP_TO_EDGE),$=t.fbo=T.createFramebuffer(B,B,!0,!1),$.colorAttachment.set(J.texture)}T.bindFramebuffer.set($.framebuffer),T.viewport.set([0,0,B,B]),_.useProgram("hillshadePrepare").draw(T,z.TRIANGLES,c,h,m,Di.disabled,((J,et)=>{const rt=et.stride,ct=g.H();return g.aP(ct,0,g.X,-g.X,0,0,1),g.J(ct,ct,[0,-g.X,0]),{u_matrix:ct,u_image:1,u_dimension:[rt,rt],u_zoom:J.overscaledZ,u_unpack:et.getUnpackVector()}})(t.tileID,P),null,o.id,_.rasterBoundsBuffer,_.quadTriangleIndexBuffer,_.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function ar(_,t,o,c,h,m){const T=c.paint.get("raster-fade-duration");if(!m&&T>0){const z=It.now(),P=(z-_.timeAdded)/T,B=t?(z-t.timeAdded)/T:-1,Z=o.getSource(),j=h.coveringZoomLevel({tileSize:Z.tileSize,roundZoom:Z.roundZoom}),$=!t||Math.abs(t.tileID.overscaledZ-j)>Math.abs(_.tileID.overscaledZ-j),J=$&&_.refreshedUponExpiration?1:g.ac($?P:1-B,0,1);return _.refreshedUponExpiration&&P>=1&&(_.refreshedUponExpiration=!1),t?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}const ra=new g.aM(1,0,0,1),mi=new g.aM(0,1,0,1),Ao=new g.aM(0,0,1,1),pl=new g.aM(1,0,1,1),ml=new g.aM(0,1,1,1);function sr(_,t,o,c){Eo(_,0,t+o/2,_.transform.width,o,c)}function Ir(_,t,o,c){Eo(_,t-o/2,0,o,_.transform.height,c)}function Eo(_,t,o,c,h,m){const T=_.context,z=T.gl;z.enable(z.SCISSOR_TEST),z.scissor(t*_.pixelRatio,o*_.pixelRatio,c*_.pixelRatio,h*_.pixelRatio),T.clear({color:m}),z.disable(z.SCISSOR_TEST)}function Pr(_,t,o){const c=_.context,h=c.gl,m=o.posMatrix,T=_.useProgram("debug"),z=oi.disabled,P=Si.disabled,B=_.colorModeForRenderPass(),Z="$debug",j=_.style.map.terrain&&_.style.map.terrain.getTerrainData(o);c.activeTexture.set(h.TEXTURE0);const $=t.getTileByID(o.key).latestRawTileData,J=Math.floor(($&&$.byteLength||0)/1024),et=t.getTile(o).tileSize,rt=512/Math.min(et,512)*(o.overscaledZ/_.transform.zoom)*.5;let ct=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(ct+=` => ${o.overscaledZ}`),(function(ht,pt){ht.initDebugOverlayCanvas();const nt=ht.debugOverlayCanvas,vt=ht.context.gl,wt=ht.debugOverlayCanvas.getContext("2d");wt.clearRect(0,0,nt.width,nt.height),wt.shadowColor="white",wt.shadowBlur=2,wt.lineWidth=1.5,wt.strokeStyle="white",wt.textBaseline="top",wt.font="bold 36px Open Sans, sans-serif",wt.fillText(pt,5,5),wt.strokeText(pt,5,5),ht.debugOverlayTexture.update(nt),ht.debugOverlayTexture.bind(vt.LINEAR,vt.CLAMP_TO_EDGE)})(_,`${ct} ${J}kB`),T.draw(c,h.TRIANGLES,z,P,zn.alphaBlended,Di.disabled,Yr(m,g.aM.transparent,rt),null,Z,_.debugBuffer,_.quadTriangleIndexBuffer,_.debugSegments),T.draw(c,h.LINE_STRIP,z,P,B,Di.disabled,Yr(m,g.aM.red),j,Z,_.debugBuffer,_.tileBorderIndexBuffer,_.debugSegments)}function _l(_,t,o){const c=_.context,h=c.gl,m=_.colorModeForRenderPass(),T=new oi(h.LEQUAL,oi.ReadWrite,_.depthRangeFor3D),z=_.useProgram("terrain"),P=t.getTerrainMesh();c.bindFramebuffer.set(null),c.viewport.set([0,0,_.width,_.height]);for(const B of o){const Z=_.renderToTexture.getTexture(B),j=t.getTerrainData(B.tileID);c.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,Z.texture);const $=_.transform.calculatePosMatrix(B.tileID.toUnwrapped()),J=t.getMeshFrameDelta(_.transform.zoom),et=_.transform.calculateFogMatrix(B.tileID.toUnwrapped()),rt=an($,J,et,_.style.sky,_.transform.pitch);z.draw(c,h.TRIANGLES,T,Si.disabled,m,Di.backCCW,rt,j,"terrain",P.vertexBuffer,P.indexBuffer,P.segments)}}class to{constructor(t,o,c){this.vertexBuffer=t,this.indexBuffer=o,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Dr{constructor(t,o){this.context=new Qu(t),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:g.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ie.maxUnderzooming+Ie.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ai}resize(t,o,c){if(this.width=Math.floor(t*c),this.height=Math.floor(o*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const t=this.context,o=new g.aX;o.emplaceBack(0,0),o.emplaceBack(g.X,0),o.emplaceBack(0,g.X),o.emplaceBack(g.X,g.X),this.tileExtentBuffer=t.createVertexBuffer(o,Ki.members),this.tileExtentSegments=g.a0.simpleSegment(0,0,4,2);const c=new g.aX;c.emplaceBack(0,0),c.emplaceBack(g.X,0),c.emplaceBack(0,g.X),c.emplaceBack(g.X,g.X),this.debugBuffer=t.createVertexBuffer(c,Ki.members),this.debugSegments=g.a0.simpleSegment(0,0,4,5);const h=new g.$;h.emplaceBack(0,0,0,0),h.emplaceBack(g.X,0,g.X,0),h.emplaceBack(0,g.X,0,g.X),h.emplaceBack(g.X,g.X,g.X,g.X),this.rasterBoundsBuffer=t.createVertexBuffer(h,Ar.members),this.rasterBoundsSegments=g.a0.simpleSegment(0,0,4,2);const m=new g.aX;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(m,Ki.members),this.viewportSegments=g.a0.simpleSegment(0,0,4,2);const T=new g.aZ;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(T);const z=new g.aY;z.emplaceBack(0,1,2),z.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(z);const P=this.context.gl;this.stencilClearMode=new Si({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO)}clearStencil(){const t=this.context,o=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=g.H();g.aP(c,0,this.width,this.height,0,0,1),g.K(c,c,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,o.TRIANGLES,oi.disabled,this.stencilClearMode,zn.disabled,Di.disabled,aa(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,o){if(this.currentStencilSource===t.source||!t.isTileClipped()||!o||!o.length)return;this.currentStencilSource=t.source;const c=this.context,h=c.gl;this.nextStencilID+o.length>256&&this.clearStencil(),c.setColorMode(zn.disabled),c.setDepthMode(oi.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const T of o){const z=this._tileClippingMaskIDs[T.key]=this.nextStencilID++,P=this.style.map.terrain&&this.style.map.terrain.getTerrainData(T);m.draw(c,h.TRIANGLES,oi.disabled,new Si({func:h.ALWAYS,mask:0},z,255,h.KEEP,h.KEEP,h.REPLACE),zn.disabled,Di.disabled,aa(T.posMatrix),P,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new Si({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){const o=this.context.gl;return new Si({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(t){const o=this.context.gl,c=t.sort(((T,z)=>z.overscaledZ-T.overscaledZ)),h=c[c.length-1].overscaledZ,m=c[0].overscaledZ-h+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const T={};for(let z=0;z<m;z++)T[z+h]=new Si({func:o.GEQUAL,mask:255},z+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=m,[T,c]}return[{[h]:Si.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new zn([t.CONSTANT_COLOR,t.ONE],new g.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?zn.unblended:zn.alphaBlended}depthModeForSublayer(t,o,c){if(!this.opaquePassEnabledForLayer())return oi.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new oi(c||this.context.gl.LEQUAL,o,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){this.style=t,this.options=o,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(It.now()),this.imageManager.beginFrame();const c=this.style._order,h=this.style.sourceCaches,m={},T={},z={};for(const P in h){const B=h[P];B.used&&B.prepare(this.context),m[P]=B.getVisibleCoordinates(),T[P]=m[P].slice().reverse(),z[P]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let P=0;P<c.length;P++)if(this.style._layers[c[P]].is3D()){this.opaquePassCutoff=P;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const P of c){const B=this.style._layers[P];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const Z=T[B.source];(B.type==="custom"||Z.length)&&this.renderLayer(this,h[B.source],B,Z)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?g.aM.black:g.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(P,B){const Z=P.context,j=Z.gl,$=((ht,pt,nt)=>({u_sky_color:ht.properties.get("sky-color"),u_horizon_color:ht.properties.get("horizon-color"),u_horizon:(pt.height/2+pt.getHorizon())*nt,u_sky_horizon_blend:ht.properties.get("sky-horizon-blend")*pt.height/2*nt}))(B,P.style.map.transform,P.pixelRatio),J=new oi(j.LEQUAL,oi.ReadWrite,[0,1]),et=Si.disabled,rt=P.colorModeForRenderPass(),ct=P.useProgram("sky");if(!B.mesh){const ht=new g.aX;ht.emplaceBack(-1,-1),ht.emplaceBack(1,-1),ht.emplaceBack(1,1),ht.emplaceBack(-1,1);const pt=new g.aY;pt.emplaceBack(0,1,2),pt.emplaceBack(0,2,3),B.mesh=new to(Z.createVertexBuffer(ht,Ki.members),Z.createIndexBuffer(pt),g.a0.simpleSegment(0,0,ht.length,pt.length))}ct.draw(Z,j.TRIANGLES,J,et,rt,Di.disabled,$,void 0,"sky",B.mesh.vertexBuffer,B.mesh.indexBuffer,B.mesh.segments)})(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const P=this.style._layers[c[this.currentLayer]],B=h[P.source],Z=m[P.source];this._renderTileClippingMasks(P,Z),this.renderLayer(this,B,P,Z)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const P=this.style._layers[c[this.currentLayer]],B=h[P.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(P))continue;const Z=(P.type==="symbol"?z:T)[P.source];this._renderTileClippingMasks(P,m[P.source]),this.renderLayer(this,B,P,Z)}if(this.options.showTileBoundaries){const P=(function(B,Z){let j=null;const $=Object.values(B._layers).flatMap((ct=>ct.source&&!ct.isHidden(Z)?[B.sourceCaches[ct.source]]:[])),J=$.filter((ct=>ct.getSource().type==="vector")),et=$.filter((ct=>ct.getSource().type!=="vector")),rt=ct=>{(!j||j.getSource().maxzoom<ct.getSource().maxzoom)&&(j=ct)};return J.forEach((ct=>rt(ct))),j||et.forEach((ct=>rt(ct))),j})(this.style,this.transform.zoom);P&&(function(B,Z,j){for(let $=0;$<j.length;$++)Pr(B,Z,j[$])})(this,P,P.getVisibleCoordinates())}this.options.showPadding&&(function(P){const B=P.transform.padding;sr(P,P.transform.height-(B.top||0),3,ra),sr(P,B.bottom||0,3,mi),Ir(P,B.left||0,3,Ao),Ir(P,P.transform.width-(B.right||0),3,pl);const Z=P.transform.centerPoint;(function(j,$,J,et){Eo(j,$-1,J-10,2,20,et),Eo(j,$-10,J-1,20,2,et)})(P,Z.x,P.transform.height-Z.y,ml)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=t?!g.a_(o,c):!g.a$(o,c)),h||(h=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),h&&(g.b0(o,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(m,T){const z=m.context,P=z.gl,B=zn.unblended,Z=new oi(P.LEQUAL,oi.ReadWrite,[0,1]),j=T.getTerrainMesh(),$=T.sourceCache.getRenderableTiles(),J=m.useProgram("terrainDepth");z.bindFramebuffer.set(T.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),z.clear({color:g.aM.transparent,depth:1});for(const et of $){const rt=T.getTerrainData(et.tileID),ct={u_matrix:m.transform.calculatePosMatrix(et.tileID.toUnwrapped()),u_ele_delta:T.getMeshFrameDelta(m.transform.zoom)};J.draw(z,P.TRIANGLES,Z,Si.disabled,B,Di.backCCW,ct,rt,"terrain",j.vertexBuffer,j.indexBuffer,j.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,m.width,m.height])})(this,this.style.map.terrain),(function(m,T){const z=m.context,P=z.gl,B=zn.unblended,Z=new oi(P.LEQUAL,oi.ReadWrite,[0,1]),j=T.getTerrainMesh(),$=T.getCoordsTexture(),J=T.sourceCache.getRenderableTiles(),et=m.useProgram("terrainCoords");z.bindFramebuffer.set(T.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),z.clear({color:g.aM.transparent,depth:1}),T.coordsIndex=[];for(const rt of J){const ct=T.getTerrainData(rt.tileID);z.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,$.texture);const ht={u_matrix:m.transform.calculatePosMatrix(rt.tileID.toUnwrapped()),u_terrain_coords_id:(255-T.coordsIndex.length)/255,u_texture:0,u_ele_delta:T.getMeshFrameDelta(m.transform.zoom)};et.draw(z,P.TRIANGLES,Z,Si.disabled,B,Di.backCCW,ht,ct,"terrain",j.vertexBuffer,j.indexBuffer,j.segments),T.coordsIndex.push(rt.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,m.width,m.height])})(this,this.style.map.terrain))}renderLayer(t,o,c,h){if(!c.isHidden(this.transform.zoom)&&(c.type==="background"||c.type==="custom"||(h||[]).length))switch(this.id=c.id,c.type){case"symbol":(function(m,T,z,P,B){if(m.renderPass!=="translucent")return;const Z=Si.disabled,j=m.colorModeForRenderPass();(z._unevaluatedLayout.hasValue("text-variable-anchor")||z._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function($,J,et,rt,ct,ht,pt,nt,vt){const wt=J.transform,Pt=Os(),Xt=ct==="map",ne=ht==="map";for(const ue of $){const ve=rt.getTile(ue),he=ve.getBucket(et);if(!he||!he.text||!he.text.segments.get().length)continue;const se=g.ag(he.textSizeData,wt.zoom),we=ii(ve,1,J.transform.zoom),qe=ys(ue.posMatrix,ne,Xt,J.transform,we),fe=et.layout.get("icon-text-fit")!=="none"&&he.hasIconData();if(se){const _e=Math.pow(2,wt.zoom-ve.tileID.overscaledZ),Ze=J.style.map.terrain?(li,yi)=>J.style.map.terrain.getElevation(ue,li,yi):null,tn=Pt.translatePosition(wt,ve,pt,nt);nr(he,Xt,ne,vt,wt,qe,ue.posMatrix,_e,se,fe,Pt,tn,ue.toUnwrapped(),Ze)}}})(P,m,z,T,z.layout.get("text-rotation-alignment"),z.layout.get("text-pitch-alignment"),z.paint.get("text-translate"),z.paint.get("text-translate-anchor"),B),z.paint.get("icon-opacity").constantOr(1)!==0&&So(m,T,z,P,!1,z.paint.get("icon-translate"),z.paint.get("icon-translate-anchor"),z.layout.get("icon-rotation-alignment"),z.layout.get("icon-pitch-alignment"),z.layout.get("icon-keep-upright"),Z,j),z.paint.get("text-opacity").constantOr(1)!==0&&So(m,T,z,P,!0,z.paint.get("text-translate"),z.paint.get("text-translate-anchor"),z.layout.get("text-rotation-alignment"),z.layout.get("text-pitch-alignment"),z.layout.get("text-keep-upright"),Z,j),T.map.showCollisionBoxes&&(Ga(m,T,z,P,!0),Ga(m,T,z,P,!1))})(t,o,c,h,this.style.placement.variableOffsets);break;case"circle":(function(m,T,z,P){if(m.renderPass!=="translucent")return;const B=z.paint.get("circle-opacity"),Z=z.paint.get("circle-stroke-width"),j=z.paint.get("circle-stroke-opacity"),$=!z.layout.get("circle-sort-key").isConstant();if(B.constantOr(1)===0&&(Z.constantOr(1)===0||j.constantOr(1)===0))return;const J=m.context,et=J.gl,rt=m.depthModeForSublayer(0,oi.ReadOnly),ct=Si.disabled,ht=m.colorModeForRenderPass(),pt=[];for(let nt=0;nt<P.length;nt++){const vt=P[nt],wt=T.getTile(vt),Pt=wt.getBucket(z);if(!Pt)continue;const Xt=Pt.programConfigurations.get(z.id),ne=m.useProgram("circle",Xt),ue=Pt.layoutVertexBuffer,ve=Pt.indexBuffer,he=m.style.map.terrain&&m.style.map.terrain.getTerrainData(vt),se={programConfiguration:Xt,program:ne,layoutVertexBuffer:ue,indexBuffer:ve,uniformValues:Xo(m,vt,wt,z),terrainData:he};if($){const we=Pt.segments.get();for(const qe of we)pt.push({segments:new g.a0([qe]),sortKey:qe.sortKey,state:se})}else pt.push({segments:Pt.segments,sortKey:0,state:se})}$&&pt.sort(((nt,vt)=>nt.sortKey-vt.sortKey));for(const nt of pt){const{programConfiguration:vt,program:wt,layoutVertexBuffer:Pt,indexBuffer:Xt,uniformValues:ne,terrainData:ue}=nt.state;wt.draw(J,et.TRIANGLES,rt,ct,ht,Di.disabled,ne,ue,z.id,Pt,Xt,nt.segments,z.paint,m.transform.zoom,vt)}})(t,o,c,h);break;case"heatmap":(function(m,T,z,P){if(z.paint.get("heatmap-opacity")===0)return;const B=m.context;if(m.style.map.terrain){for(const Z of P){const j=T.getTile(Z);T.hasRenderableParent(Z)||(m.renderPass==="offscreen"?Ts(m,j,z,Z):m.renderPass==="translucent"&&As(m,z,Z))}B.viewport.set([0,0,m.width,m.height])}else m.renderPass==="offscreen"?(function(Z,j,$,J){const et=Z.context,rt=et.gl,ct=Si.disabled,ht=new zn([rt.ONE,rt.ONE],g.aM.transparent,[!0,!0,!0,!0]);(function(pt,nt,vt){const wt=pt.gl;pt.activeTexture.set(wt.TEXTURE1),pt.viewport.set([0,0,nt.width/4,nt.height/4]);let Pt=vt.heatmapFbos.get(g.aU);Pt?(wt.bindTexture(wt.TEXTURE_2D,Pt.colorAttachment.get()),pt.bindFramebuffer.set(Pt.framebuffer)):(Pt=Wo(pt,nt.width/4,nt.height/4),vt.heatmapFbos.set(g.aU,Pt))})(et,Z,$),et.clear({color:g.aM.transparent});for(let pt=0;pt<J.length;pt++){const nt=J[pt];if(j.hasRenderableParent(nt))continue;const vt=j.getTile(nt),wt=vt.getBucket($);if(!wt)continue;const Pt=wt.programConfigurations.get($.id),Xt=Z.useProgram("heatmap",Pt),{zoom:ne}=Z.transform;Xt.draw(et,rt.TRIANGLES,oi.disabled,ct,ht,Di.disabled,Wn(nt.posMatrix,vt,ne,$.paint.get("heatmap-intensity")),null,$.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,$.paint,Z.transform.zoom,Pt)}et.viewport.set([0,0,Z.width,Z.height])})(m,T,z,P):m.renderPass==="translucent"&&(function(Z,j){const $=Z.context,J=$.gl;$.setColorMode(Z.colorModeForRenderPass());const et=j.heatmapFbos.get(g.aU);et&&($.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,et.colorAttachment.get()),$.activeTexture.set(J.TEXTURE1),Qr($,j).bind(J.LINEAR,J.CLAMP_TO_EDGE),Z.useProgram("heatmapTexture").draw($,J.TRIANGLES,oi.disabled,Si.disabled,Z.colorModeForRenderPass(),Di.disabled,Ke(Z,j,0,1),null,j.id,Z.viewportBuffer,Z.quadTriangleIndexBuffer,Z.viewportSegments,j.paint,Z.transform.zoom))})(m,z)})(t,o,c,h);break;case"line":(function(m,T,z,P){if(m.renderPass!=="translucent")return;const B=z.paint.get("line-opacity"),Z=z.paint.get("line-width");if(B.constantOr(1)===0||Z.constantOr(1)===0)return;const j=m.depthModeForSublayer(0,oi.ReadOnly),$=m.colorModeForRenderPass(),J=z.paint.get("line-dasharray"),et=z.paint.get("line-pattern"),rt=et.constantOr(1),ct=z.paint.get("line-gradient"),ht=z.getCrossfadeParameters(),pt=rt?"linePattern":J?"lineSDF":ct?"lineGradient":"line",nt=m.context,vt=nt.gl;let wt=!0;for(const Pt of P){const Xt=T.getTile(Pt);if(rt&&!Xt.patternsLoaded())continue;const ne=Xt.getBucket(z);if(!ne)continue;const ue=ne.programConfigurations.get(z.id),ve=m.context.program.get(),he=m.useProgram(pt,ue),se=wt||he.program!==ve,we=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Pt),qe=et.constantOr(null);if(qe&&Xt.imageAtlas){const Ze=Xt.imageAtlas,tn=Ze.patternPositions[qe.to.toString()],li=Ze.patternPositions[qe.from.toString()];tn&&li&&ue.setConstantPatternPositions(tn,li)}const fe=we?Pt:null,_e=rt?vs(m,Xt,z,ht,fe):J?Ns(m,Xt,z,J,ht,fe):ct?Fl(m,Xt,z,ne.lineClipsArray.length,fe):ji(m,Xt,z,fe);if(rt)nt.activeTexture.set(vt.TEXTURE0),Xt.imageAtlasTexture.bind(vt.LINEAR,vt.CLAMP_TO_EDGE),ue.updatePaintBuffers(ht);else if(J&&(se||m.lineAtlas.dirty))nt.activeTexture.set(vt.TEXTURE0),m.lineAtlas.bind(nt);else if(ct){const Ze=ne.gradients[z.id];let tn=Ze.texture;if(z.gradientVersion!==Ze.version){let li=256;if(z.stepInterpolant){const yi=T.getSource().maxzoom,Wi=Pt.canonical.z===yi?Math.ceil(1<<m.transform.maxZoom-Pt.canonical.z):1;li=g.ac(g.aV(ne.maxLineLength/g.X*1024*Wi),256,nt.maxTextureSize)}Ze.gradient=g.aW({expression:z.gradientExpression(),evaluationKey:"lineProgress",resolution:li,image:Ze.gradient||void 0,clips:ne.lineClipsArray}),Ze.texture?Ze.texture.update(Ze.gradient):Ze.texture=new Fe(nt,Ze.gradient,vt.RGBA),Ze.version=z.gradientVersion,tn=Ze.texture}nt.activeTexture.set(vt.TEXTURE0),tn.bind(z.stepInterpolant?vt.NEAREST:vt.LINEAR,vt.CLAMP_TO_EDGE)}he.draw(nt,vt.TRIANGLES,j,m.stencilModeForClipping(Pt),$,Di.disabled,_e,we,z.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,z.paint,m.transform.zoom,ue,ne.layoutVertexBuffer2),wt=!1}})(t,o,c,h);break;case"fill":(function(m,T,z,P){const B=z.paint.get("fill-color"),Z=z.paint.get("fill-opacity");if(Z.constantOr(1)===0)return;const j=m.colorModeForRenderPass(),$=z.paint.get("fill-pattern"),J=m.opaquePassEnabledForLayer()&&!$.constantOr(1)&&B.constantOr(g.aM.transparent).a===1&&Z.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===J){const et=m.depthModeForSublayer(1,m.renderPass==="opaque"?oi.ReadWrite:oi.ReadOnly);ss(m,T,z,P,et,j,!1)}if(m.renderPass==="translucent"&&z.paint.get("fill-antialias")){const et=m.depthModeForSublayer(z.getPaintProperty("fill-outline-color")?2:0,oi.ReadOnly);ss(m,T,z,P,et,j,!0)}})(t,o,c,h);break;case"fill-extrusion":(function(m,T,z,P){const B=z.paint.get("fill-extrusion-opacity");if(B!==0&&m.renderPass==="translucent"){const Z=new oi(m.context.gl.LEQUAL,oi.ReadWrite,m.depthRangeFor3D);if(B!==1||z.paint.get("fill-extrusion-pattern").constantOr(1))$l(m,T,z,P,Z,Si.disabled,zn.disabled),$l(m,T,z,P,Z,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const j=m.colorModeForRenderPass();$l(m,T,z,P,Z,Si.disabled,j)}}})(t,o,c,h);break;case"hillshade":(function(m,T,z,P){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const B=m.context,Z=m.depthModeForSublayer(0,oi.ReadOnly),j=m.colorModeForRenderPass(),[$,J]=m.renderPass==="translucent"?m.stencilConfigForOverlap(P):[{},P];for(const et of J){const rt=T.getTile(et);rt.needsHillshadePrepare!==void 0&&rt.needsHillshadePrepare&&m.renderPass==="offscreen"?Jo(m,rt,z,Z,Si.disabled,j):m.renderPass==="translucent"&&Zs(m,et,rt,z,Z,$[et.overscaledZ],j)}B.viewport.set([0,0,m.width,m.height])})(t,o,c,h);break;case"raster":(function(m,T,z,P){if(m.renderPass!=="translucent"||z.paint.get("raster-opacity")===0||!P.length)return;const B=m.context,Z=B.gl,j=T.getSource(),$=m.useProgram("raster"),J=m.colorModeForRenderPass(),[et,rt]=j instanceof Ks?[{},P]:m.stencilConfigForOverlap(P),ct=rt[rt.length-1].overscaledZ,ht=!m.options.moving;for(const pt of rt){const nt=m.depthModeForSublayer(pt.overscaledZ-ct,z.paint.get("raster-opacity")===1?oi.ReadWrite:oi.ReadOnly,Z.LESS),vt=T.getTile(pt);vt.registerFadeDuration(z.paint.get("raster-fade-duration"));const wt=T.findLoadedParent(pt,0),Pt=T.findLoadedSibling(pt),Xt=ar(vt,wt||Pt||null,T,z,m.transform,m.style.map.terrain);let ne,ue;const ve=z.paint.get("raster-resampling")==="nearest"?Z.NEAREST:Z.LINEAR;B.activeTexture.set(Z.TEXTURE0),vt.texture.bind(ve,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),B.activeTexture.set(Z.TEXTURE1),wt?(wt.texture.bind(ve,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),ne=Math.pow(2,wt.tileID.overscaledZ-vt.tileID.overscaledZ),ue=[vt.tileID.canonical.x*ne%1,vt.tileID.canonical.y*ne%1]):vt.texture.bind(ve,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),vt.texture.useMipmap&&B.extTextureFilterAnisotropic&&m.transform.pitch>20&&Z.texParameterf(Z.TEXTURE_2D,B.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,B.extTextureFilterAnisotropicMax);const he=m.style.map.terrain&&m.style.map.terrain.getTerrainData(pt),se=he?pt:null,we=se?se.posMatrix:m.transform.calculatePosMatrix(pt.toUnwrapped(),ht),qe=er(we,ue||[0,0],ne||1,Xt,z);j instanceof Ks?$.draw(B,Z.TRIANGLES,nt,Si.disabled,J,Di.disabled,qe,he,z.id,j.boundsBuffer,m.quadTriangleIndexBuffer,j.boundsSegments):$.draw(B,Z.TRIANGLES,nt,et[pt.overscaledZ],J,Di.disabled,qe,he,z.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(t,o,c,h);break;case"background":(function(m,T,z,P){const B=z.paint.get("background-color"),Z=z.paint.get("background-opacity");if(Z===0)return;const j=m.context,$=j.gl,J=m.transform,et=J.tileSize,rt=z.paint.get("background-pattern");if(m.isPatternMissing(rt))return;const ct=!rt&&B.a===1&&Z===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ct)return;const ht=Si.disabled,pt=m.depthModeForSublayer(0,ct==="opaque"?oi.ReadWrite:oi.ReadOnly),nt=m.colorModeForRenderPass(),vt=m.useProgram(rt?"backgroundPattern":"background"),wt=P||J.coveringTiles({tileSize:et,terrain:m.style.map.terrain});rt&&(j.activeTexture.set($.TEXTURE0),m.imageManager.bind(m.context));const Pt=z.getCrossfadeParameters();for(const Xt of wt){const ne=P?Xt.posMatrix:m.transform.calculatePosMatrix(Xt.toUnwrapped()),ue=rt?Ul(ne,Z,m,rt,{tileID:Xt,tileSize:et},Pt):Kr(ne,Z,B),ve=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Xt);vt.draw(j,$.TRIANGLES,pt,ht,nt,Di.disabled,ue,ve,z.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(t,0,c,h);break;case"custom":(function(m,T,z){const P=m.context,B=z.implementation;if(m.renderPass==="offscreen"){const Z=B.prerender;Z&&(m.setCustomLayerDefaults(),P.setColorMode(m.colorModeForRenderPass()),Z.call(B,P.gl,m.transform.customLayerMatrix()),P.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),P.setColorMode(m.colorModeForRenderPass()),P.setStencilMode(Si.disabled);const Z=B.renderingMode==="3d"?new oi(m.context.gl.LEQUAL,oi.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,oi.ReadOnly);P.setDepthMode(Z),B.render(P.gl,m.transform.customLayerMatrix(),{farZ:m.transform.farZ,nearZ:m.transform.nearZ,fov:m.transform._fov,modelViewProjectionMatrix:m.transform.modelViewProjectionMatrix,projectionMatrix:m.transform.projectionMatrix}),P.setDirty(),m.setBaseState(),P.bindFramebuffer.set(null)}})(t,0,c)}}translatePosMatrix(t,o,c,h,m){if(!c[0]&&!c[1])return t;const T=m?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(T){const B=Math.sin(T),Z=Math.cos(T);c=[c[0]*Z-c[1]*B,c[0]*B+c[1]*Z]}const z=[m?c[0]:ii(o,c[0],this.transform.zoom),m?c[1]:ii(o,c[1],this.transform.zoom),0],P=new Float32Array(16);return g.J(P,t,z),P}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const o=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!o||!c}useProgram(t,o){this.cache=this.cache||{};const c=t+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new $r(this.context,tr[t],o,fa[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Fe(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:o}=this.context.gl;return this.width!==t||this.height!==o}}class Mo{constructor(t,o){this.points=t,this.planes=o}static fromInvProjectionMatrix(t,o,c){const h=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((z=>{const P=1/(z=g.af([],z,t))[3]/o*h;return g.b1(z,z,[P,P,1/z[3],P])})),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((z=>{const P=(function($,J){var et=J[0],rt=J[1],ct=J[2],ht=et*et+rt*rt+ct*ct;return ht>0&&(ht=1/Math.sqrt(ht)),$[0]=J[0]*ht,$[1]=J[1]*ht,$[2]=J[2]*ht,$})([],(function($,J,et){var rt=J[0],ct=J[1],ht=J[2],pt=et[0],nt=et[1],vt=et[2];return $[0]=ct*vt-ht*nt,$[1]=ht*pt-rt*vt,$[2]=rt*nt-ct*pt,$})([],Xe([],m[z[0]],m[z[1]]),Xe([],m[z[2]],m[z[1]]))),B=-((Z=P)[0]*(j=m[z[1]])[0]+Z[1]*j[1]+Z[2]*j[2]);var Z,j;return P.concat(B)}));return new Mo(m,T)}}class rs{constructor(t,o){this.min=t,this.max=o,this.center=(function(c,h,m){return c[0]=.5*h[0],c[1]=.5*h[1],c[2]=.5*h[2],c})([],(function(c,h,m){return c[0]=h[0]+m[0],c[1]=h[1]+m[1],c[2]=h[2]+m[2],c})([],this.min,this.max))}quadrant(t){const o=[t%2==0,t<2],c=Ni(this.min),h=Ni(this.max);for(let m=0;m<o.length;m++)c[m]=o[m]?this.min[m]:this.center[m],h[m]=o[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new rs(c,h)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let h=0;h<t.planes.length;h++){const m=t.planes[h];let T=0;for(let z=0;z<o.length;z++)g.b2(m,o[z])>=0&&T++;if(T===0)return 0;T!==o.length&&(c=!1)}if(c)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,T=-Number.MAX_VALUE;for(let z=0;z<t.points.length;z++){const P=t.points[z][h]-this.min[h];m=Math.min(m,P),T=Math.max(T,P)}if(T<0||m>this.max[h]-this.min[h])return 0}return 1}}class js{constructor(t=0,o=0,c=0,h=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(c)||c<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=c,this.right=h}interpolate(t,o,c){return o.top!=null&&t.top!=null&&(this.top=g.y.number(t.top,o.top,c)),o.bottom!=null&&t.bottom!=null&&(this.bottom=g.y.number(t.bottom,o.bottom,c)),o.left!=null&&t.left!=null&&(this.left=g.y.number(t.left,o.left,c)),o.right!=null&&t.right!=null&&(this.right=g.y.number(t.right,o.right,c)),this}getCenter(t,o){const c=g.ac((this.left+t-this.right)/2,0,t),h=g.ac((this.top+o-this.bottom)/2,0,o);return new g.P(c,h)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new js(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Qo=85.051129;class zo{constructor(t,o,c,h,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=t||0,this._maxZoom=o||22,this._minPitch=c??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new g.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new js,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new zo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.lngRange=t.lngRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new g.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const o=-g.b3(t,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=(function(){var c=new g.A(4);return g.A!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c})(),(function(c,h,m){var T=h[0],z=h[1],P=h[2],B=h[3],Z=Math.sin(m),j=Math.cos(m);c[0]=T*j+P*Z,c[1]=z*j+B*Z,c[2]=T*-Z+P*j,c[3]=z*-Z+B*j})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const o=g.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const o=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,c){this._unmodified=!1,this._edgeInsets.interpolate(t,o,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const o=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(t){const o=[new g.b4(0,t)];if(this._renderWorldCopies){const c=this.pointCoordinate(new g.P(0,0)),h=this.pointCoordinate(new g.P(this.width,0)),m=this.pointCoordinate(new g.P(this.width,this.height)),T=this.pointCoordinate(new g.P(0,this.height)),z=Math.floor(Math.min(c.x,h.x,m.x,T.x)),P=Math.floor(Math.max(c.x,h.x,m.x,T.x)),B=1;for(let Z=z-B;Z<=P+B;Z++)Z!==0&&o.push(new g.b4(Z,t))}return o}coveringTiles(t){var o,c;let h=this.coveringZoomLevel(t);const m=h;if(t.minzoom!==void 0&&h<t.minzoom)return[];t.maxzoom!==void 0&&h>t.maxzoom&&(h=t.maxzoom);const T=this.pointCoordinate(this.getCameraPoint()),z=g.Z.fromLngLat(this.center),P=Math.pow(2,h),B=[P*T.x,P*T.y,0],Z=[P*z.x,P*z.y,0],j=Mo.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,h);let $=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=h);const J=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,et=nt=>({aabb:new rs([nt*P,0,0],[(nt+1)*P,P,0]),zoom:0,x:0,y:0,wrap:nt,fullyVisible:!1}),rt=[],ct=[],ht=h,pt=t.reparseOverscaled?m:h;if(this._renderWorldCopies)for(let nt=1;nt<=3;nt++)rt.push(et(-nt)),rt.push(et(nt));for(rt.push(et(0));rt.length>0;){const nt=rt.pop(),vt=nt.x,wt=nt.y;let Pt=nt.fullyVisible;if(!Pt){const he=nt.aabb.intersects(j);if(he===0)continue;Pt=he===2}const Xt=t.terrain?B:Z,ne=nt.aabb.distanceX(Xt),ue=nt.aabb.distanceY(Xt),ve=Math.max(Math.abs(ne),Math.abs(ue));if(nt.zoom===ht||ve>J+(1<<ht-nt.zoom)-2&&nt.zoom>=$){const he=ht-nt.zoom,se=B[0]-.5-(vt<<he),we=B[1]-.5-(wt<<he);ct.push({tileID:new g.S(nt.zoom===ht?pt:nt.zoom,nt.wrap,nt.zoom,vt,wt),distanceSq:Un([Z[0]-.5-vt,Z[1]-.5-wt]),tileDistanceToCamera:Math.sqrt(se*se+we*we)})}else for(let he=0;he<4;he++){const se=(vt<<1)+he%2,we=(wt<<1)+(he>>1),qe=nt.zoom+1;let fe=nt.aabb.quadrant(he);if(t.terrain){const _e=new g.S(qe,nt.wrap,qe,se,we),Ze=t.terrain.getMinMaxElevation(_e),tn=(o=Ze.minElevation)!==null&&o!==void 0?o:this.elevation,li=(c=Ze.maxElevation)!==null&&c!==void 0?c:this.elevation;fe=new rs([fe.min[0],fe.min[1],tn],[fe.max[0],fe.max[1],li])}rt.push({aabb:fe,zoom:qe,x:se,y:we,wrap:nt.wrap,fullyVisible:Pt})}}return ct.sort(((nt,vt)=>nt.distanceSq-vt.distanceSq)).map((nt=>nt.tileID))}resize(t,o){this.width=t,this.height=o,this.pixelsToGLUnits=[2/t,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const o=g.ac(t.lat,-85.051129,Qo);return new g.P(g.O(t.lng)*this.worldSize,g.Q(o)*this.worldSize)}unproject(t){return new g.Z(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const o=this.elevation,c=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,h=this.pointLocation(this.centerPoint,t),m=t.getElevationForLngLatZoom(h,this.tileZoom);if(!(this.elevation-m))return;const T=c+o-m,z=Math.cos(this._pitch)*this.cameraToCenterDistance/T/g.b5(1,h.lat),P=this.scaleZoom(z/this.tileSize);this._elevation=m,this._center=h,this.zoom=P}setLocationAtPoint(t,o){const c=this.pointCoordinate(o),h=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(t),T=new g.Z(m.x-(c.x-h.x),m.y-(c.y-h.y));this.center=this.coordinateLocation(T),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,o){return o?this.coordinatePoint(this.locationCoordinate(t),o.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,o){return this.coordinateLocation(this.pointCoordinate(t,o))}locationCoordinate(t){return g.Z.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,o){if(o){const $=o.pointCoordinate(t);if($!=null)return $}const c=[t.x,t.y,0,1],h=[t.x,t.y,1,1];g.af(c,c,this.pixelMatrixInverse),g.af(h,h,this.pixelMatrixInverse);const m=c[3],T=h[3],z=c[1]/m,P=h[1]/T,B=c[2]/m,Z=h[2]/T,j=B===Z?0:(0-B)/(Z-B);return new g.Z(g.y.number(c[0]/m,h[0]/T,j)/this.worldSize,g.y.number(z,P,j)/this.worldSize)}coordinatePoint(t,o=0,c=this.pixelMatrix){const h=[t.x*this.worldSize,t.y*this.worldSize,o,1];return g.af(h,h,c),new g.P(h[0]/h[3],h[1]/h[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Nt().extend(this.pointLocation(new g.P(0,t))).extend(this.pointLocation(new g.P(this.width,t))).extend(this.pointLocation(new g.P(this.width,this.height))).extend(this.pointLocation(new g.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Nt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Qo])}calculateTileMatrix(t){const o=t.canonical,c=this.worldSize/this.zoomScale(o.z),h=o.x+Math.pow(2,o.z)*t.wrap,m=g.an(new Float64Array(16));return g.J(m,m,[h*c,o.y*c,0]),g.K(m,m,[c/g.X,c/g.X,1]),m}calculatePosMatrix(t,o=!1){const c=t.key,h=o?this._alignedPosMatrixCache:this._posMatrixCache;if(h[c])return h[c];const m=this.calculateTileMatrix(t);return g.L(m,o?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,m),h[c]=new Float32Array(m),h[c]}calculateFogMatrix(t){const o=t.key,c=this._fogMatrixCache;if(c[o])return c[o];const h=this.calculateTileMatrix(t);return g.L(h,this.fogMatrix,h),c[o]=new Float32Array(h),c[o]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,o){o=g.ac(+o,this.minZoom,this.maxZoom);const c={center:new g.N(t.lng,t.lat),zoom:o};let h=this.lngRange;if(!this._renderWorldCopies&&h===null){const nt=179.9999999999;h=[-nt,nt]}const m=this.tileSize*this.zoomScale(c.zoom);let T=0,z=m,P=0,B=m,Z=0,j=0;const{x:$,y:J}=this.size;if(this.latRange){const nt=this.latRange;T=g.Q(nt[1])*m,z=g.Q(nt[0])*m,z-T<J&&(Z=J/(z-T))}h&&(P=g.b3(g.O(h[0])*m,0,m),B=g.b3(g.O(h[1])*m,0,m),B<P&&(B+=m),B-P<$&&(j=$/(B-P)));const{x:et,y:rt}=this.project.call({worldSize:m},t);let ct,ht;const pt=Math.max(j||0,Z||0);if(pt){const nt=new g.P(j?(B+P)/2:et,Z?(z+T)/2:rt);return c.center=this.unproject.call({worldSize:m},nt).wrap(),c.zoom+=this.scaleZoom(pt),c}if(this.latRange){const nt=J/2;rt-nt<T&&(ht=T+nt),rt+nt>z&&(ht=z-nt)}if(h){const nt=(P+B)/2;let vt=et;this._renderWorldCopies&&(vt=g.b3(et,nt-m/2,nt+m/2));const wt=$/2;vt-wt<P&&(ct=P+wt),vt+wt>B&&(ct=B-wt)}if(ct!==void 0||ht!==void 0){const nt=new g.P(ct??et,ht??rt);c.center=this.unproject.call({worldSize:m},nt).wrap()}return c}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:o,zoom:c}=this.getConstrained(this.center,this.zoom);this.center=o,this.zoom=c,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,o=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=g.b5(1,this.center.lat)*this.worldSize;let h=g.an(new Float64Array(16));g.K(h,h,[this.width/2,-this.height/2,1]),g.J(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=g.an(new Float64Array(16)),g.K(h,h,[1,-1,1]),g.J(h,h,[-1,-1,0]),g.K(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),T=Math.min(this.elevation,this.minElevationForCurrentTile),z=m-T*this._pixelPerMeter/Math.cos(this._pitch),P=T<0?z:m,B=Math.PI/2+this._pitch,Z=this._fov*(.5+t.y/this.height),j=Math.sin(Z)*P/Math.sin(g.ac(Math.PI-B-Z,.01,Math.PI-.01)),$=this.getHorizon(),J=2*Math.atan($/this.cameraToCenterDistance)*(.5+t.y/(2*$)),et=Math.sin(J)*P/Math.sin(g.ac(Math.PI-B-J,.01,Math.PI-.01)),rt=Math.min(j,et);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*rt+P),this.nearZ=this.height/50,h=new Float64Array(16),g.b6(h,this._fov,this.width/this.height,this.nearZ,this.farZ),h[8]=2*-t.x/this.width,h[9]=2*t.y/this.height,this.projectionMatrix=g.ae(h),g.K(h,h,[1,-1,1]),g.J(h,h,[0,0,-this.cameraToCenterDistance]),g.b7(h,h,this._pitch),g.ad(h,h,this.angle),g.J(h,h,[-o,-c,0]),this.mercatorMatrix=g.K([],h,[this.worldSize,this.worldSize,this.worldSize]),g.K(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=g.L(new Float64Array(16),this.labelPlaneMatrix,h),g.J(h,h,[0,0,-this.elevation]),this.modelViewProjectionMatrix=h,this.invModelViewProjectionMatrix=g.as([],h),this.fogMatrix=new Float64Array(16),g.b6(this.fogMatrix,this._fov,this.width/this.height,m,this.farZ),this.fogMatrix[8]=2*-t.x/this.width,this.fogMatrix[9]=2*t.y/this.height,g.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),g.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),g.b7(this.fogMatrix,this.fogMatrix,this._pitch),g.ad(this.fogMatrix,this.fogMatrix,this.angle),g.J(this.fogMatrix,this.fogMatrix,[-o,-c,0]),g.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),g.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=g.L(new Float64Array(16),this.labelPlaneMatrix,h);const ct=this.width%2/2,ht=this.height%2/2,pt=Math.cos(this.angle),nt=Math.sin(this.angle),vt=o-Math.round(o)+pt*ct+nt*ht,wt=c-Math.round(c)+pt*ht+nt*ct,Pt=new Float64Array(h);if(g.J(Pt,Pt,[vt>.5?vt-1:vt,wt>.5?wt-1:wt,0]),this.alignedModelViewProjectionMatrix=Pt,h=g.as(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new g.P(0,0)),o=[t.x*this.worldSize,t.y*this.worldSize,0,1];return g.af(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new g.P(0,t))}getCameraQueryGeometry(t){const o=this.getCameraPoint();if(t.length===1)return[t[0],o];{let c=o.x,h=o.y,m=o.x,T=o.y;for(const z of t)c=Math.min(c,z.x),h=Math.min(h,z.y),m=Math.max(m,z.x),T=Math.max(T,z.y);return[new g.P(c,h),new g.P(m,h),new g.P(m,T),new g.P(c,T),new g.P(c,h)]}}lngLatToCameraDepth(t,o){const c=this.locationCoordinate(t),h=[c.x*this.worldSize,c.y*this.worldSize,o,1];return g.af(h,h,this.modelViewProjectionMatrix),h[2]/h[3]}}function qn(_,t){let o,c=!1,h=null,m=null;const T=()=>{h=null,c&&(_.apply(m,o),h=setTimeout(T,t),c=!1)};return(...z)=>(c=!0,m=this,o=z,h||T(),h)}class eo{constructor(t){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map((h=>h.split("="))).forEach((h=>{h[0]===this._hashName&&(c=h)})),(c&&c[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(o.length>=3&&!o.some((c=>isNaN(c)))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:c,pitch:+(o[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const c=o.join("/");let h=c;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${c}`);let m=window.location.hash.replace(h,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let T=window.location.href.replace(/(#.+)?$/,m);T=T.replace("&&","&"),window.history.replaceState(window.history.state,null,T)},this._updateHash=qn(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const o=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,h=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,h),T=Math.round(o.lng*m)/m,z=Math.round(o.lat*m)/m,P=this._map.getBearing(),B=this._map.getPitch();let Z="";if(Z+=t?`/${T}/${z}/${c}`:`${c}/${z}/${T}`,(P||B)&&(Z+="/"+Math.round(10*P)/10),B&&(Z+=`/${Math.round(B)}`),this._hashName){const j=this._hashName;let $=!1;const J=window.location.hash.slice(1).split("&").map((et=>{const rt=et.split("=")[0];return rt===j?($=!0,`${rt}=${Z}`):et})).filter((et=>et));return $||J.push(`${j}=${Z}`),`#${J.join("&")}`}return`#${Z}`}}const gl={linearity:.3,easing:g.b8(0,0,.3,1)},Co=g.e({deceleration:2500,maxSpeed:1400},gl),Bc=g.e({deceleration:20,maxSpeed:1400},gl),Au=g.e({deceleration:1e3,maxSpeed:360},gl),Yl=g.e({deceleration:1e3,maxSpeed:90},gl);class io{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:It.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=It.now();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new g.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)o.zoom+=m.zoomDelta||0,o.bearing+=m.bearingDelta||0,o.pitch+=m.pitchDelta||0,m.panDelta&&o.pan._add(m.panDelta),m.around&&(o.around=m.around),m.pinchAround&&(o.pinchAround=m.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(o.pan.mag()){const m=Es(o.pan.mag(),c,g.e({},Co,t||{}));h.offset=o.pan.mult(m.amount/o.pan.mag()),h.center=this._map.transform.center,tl(h,m)}if(o.zoom){const m=Es(o.zoom,c,Bc);h.zoom=this._map.transform.zoom+m.amount,tl(h,m)}if(o.bearing){const m=Es(o.bearing,c,Au);h.bearing=this._map.transform.bearing+g.ac(m.amount,-179,179),tl(h,m)}if(o.pitch){const m=Es(o.pitch,c,Yl);h.pitch=this._map.transform.pitch+m.amount,tl(h,m)}if(h.zoom||h.bearing){const m=o.pinchAround===void 0?o.around:o.pinchAround;h.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),g.e(h,{noMoveStart:!0})}}function tl(_,t){(!_.duration||_.duration<t.duration)&&(_.duration=t.duration,_.easing=t.easing)}function Es(_,t,o){const{maxSpeed:c,linearity:h,deceleration:m}=o,T=g.ac(_*h/(t/1e3),-c,c),z=Math.abs(T)/(m*h);return{easing:o.easing,duration:1e3*z,amount:T*(z/2)}}class sn extends g.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c,h={}){const m=Mt.mousePos(o.getCanvas(),c),T=o.unproject(m);super(t,g.e({point:m,lngLat:T,originalEvent:c},h)),this._defaultPrevented=!1,this.target=o}}class Vs extends g.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c){const h=t==="touchend"?c.changedTouches:c.touches,m=Mt.touchPos(o.getCanvasContainer(),h),T=m.map((P=>o.unproject(P))),z=m.reduce(((P,B,Z,j)=>P.add(B.div(j.length))),new g.P(0,0));super(t,{points:m,point:z,lngLats:T,lngLat:o.unproject(z),originalEvent:c}),this._defaultPrevented=!1}}class os extends g.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class Pa{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new os(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new sn(t.type,this._map,t))}mouseup(t){this._map.fire(new sn(t.type,this._map,t))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new sn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new sn(t.type,this._map,t))}mouseover(t){this._map.fire(new sn(t.type,this._map,t))}mouseout(t){this._map.fire(new sn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Vs(t.type,this._map,t))}touchmove(t){this._map.fire(new Vs(t.type,this._map,t))}touchend(t){this._map.fire(new Vs(t.type,this._map,t))}touchcancel(t){this._map.fire(new Vs(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _n{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new sn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new sn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new sn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Da{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(g.P.convert(t),this._map.terrain)}}class Gn{constructor(t,o){this._map=t,this._tr=new Da(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(Mt.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const c=o;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=c,this._box||(this._box=Mt.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const m=Math.min(h.x,c.x),T=Math.max(h.x,c.x),z=Math.min(h.y,c.y),P=Math.max(h.y,c.y);Mt.setTransform(this._box,`translate(${m}px,${z}px)`),this._box.style.width=T-m+"px",this._box.style.height=P-z+"px"}mouseupWindow(t,o){if(!this._active||t.button!==0)return;const c=this._startPos,h=o;if(this.reset(),Mt.suppressClick(),c.x!==h.x||c.y!==h.y)return this._map.fire(new g.k("boxzoomend",{originalEvent:t})),{cameraAnimation:m=>m.fitScreenCoordinates(c,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(Mt.remove(this._box),this._box=null),Mt.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new g.k(t,{originalEvent:o}))}}function Lo(_,t){if(_.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${_.length}, points ${t.length}`);const o={};for(let c=0;c<_.length;c++)o[_[c].identifier]=t[c];return o}class Ms{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,o,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=(function(h){const m=new g.P(0,0);for(const T of h)m._add(T);return m.div(h.length)})(o),this.touches=Lo(c,o)))}touchmove(t,o,c){if(this.aborted||!this.centroid)return;const h=Lo(c,o);for(const m in this.touches){const T=h[m];(!T||T.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(t,o,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class kr{constructor(t){this.singleTap=new Ms(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,o,c){this.singleTap.touchstart(t,o,c)}touchmove(t,o,c){this.singleTap.touchmove(t,o,c)}touchend(t,o,c){const h=this.singleTap.touchend(t,o,c);if(h){const m=t.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(h)<30;if(m&&T||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class rr{constructor(t){this._tr=new Da(t),this._zoomIn=new kr({numTouches:1,numTaps:2}),this._zoomOut=new kr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,c){this._zoomIn.touchstart(t,o,c),this._zoomOut.touchstart(t,o,c)}touchmove(t,o,c){this._zoomIn.touchmove(t,o,c),this._zoomOut.touchmove(t,o,c)}touchend(t,o,c){const h=this._zoomIn.touchend(t,o,c),m=this._zoomOut.touchend(t,o,c),T=this._tr;return h?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:T.zoom+1,around:T.unproject(h)},{originalEvent:t})}):m?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:T.zoom-1,around:T.unproject(m)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ka{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const o=this._moveFunction(...t);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(t,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,o){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const h=o.length?o[0]:o;return!this._moved&&h.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(c,h))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&Mt.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Eu={0:1,2:2};class da{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const o=Mt.mouseButton(t);this._eventButton=o}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(o,c){const h=Eu[c];return o.buttons===void 0||(o.buttons&h)!==h})(t,this._eventButton)}isValidEndEvent(t){return Mt.mouseButton(t)===this._eventButton}}class el{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const ls=_=>{_.mousedown=_.dragStart,_.mousemoveWindow=_.dragMove,_.mouseup=_.dragEnd,_.contextmenu=t=>{t.preventDefault()}},yl=({enable:_,clickTolerance:t,bearingDegreesPerPixelMoved:o=.8})=>{const c=new da({checkCorrectEvent:h=>Mt.mouseButton(h)===0&&h.ctrlKey||Mt.mouseButton(h)===2});return new ka({clickTolerance:t,move:(h,m)=>({bearingDelta:(m.x-h.x)*o}),moveStateManager:c,enable:_,assignEvents:ls})},Io=({enable:_,clickTolerance:t,pitchDegreesPerPixelMoved:o=-.5})=>{const c=new da({checkCorrectEvent:h=>Mt.mouseButton(h)===0&&h.ctrlKey||Mt.mouseButton(h)===2});return new ka({clickTolerance:t,move:(h,m)=>({pitchDelta:(m.y-h.y)*o}),moveStateManager:c,enable:_,assignEvents:ls})};class us{constructor(t,o){this._clickTolerance=t.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new g.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,o,c){return this._calculateTransform(t,o,c)}touchmove(t,o,c){if(this._active){if(!this._shouldBePrevented(c.length))return t.preventDefault(),this._calculateTransform(t,o,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,o,c){this._calculateTransform(t,o,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,c){c.length>0&&(this._active=!0);const h=Lo(c,o),m=new g.P(0,0),T=new g.P(0,0);let z=0;for(const B in h){const Z=h[B],j=this._touches[B];j&&(m._add(Z),T._add(Z.sub(j)),z++,h[B]=Z)}if(this._touches=h,this._shouldBePrevented(z)||!T.mag())return;const P=T.div(z);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(z),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Po{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,o,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,c){if(!this._firstTwoTouches)return;t.preventDefault();const[h,m]=this._firstTwoTouches,T=Do(c,o,h),z=Do(c,o,m);if(!T||!z)return;const P=this._aroundCenter?null:T.add(z).div(2);return this._move([T,z],P,t)}touchend(t,o,c){if(!this._firstTwoTouches)return;const[h,m]=this._firstTwoTouches,T=Do(c,o,h),z=Do(c,o,m);T&&z||(this._active&&Mt.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Do(_,t,o){for(let c=0;c<_.length;c++)if(_[c].identifier===o)return t[c]}function vl(_,t){return Math.log(_/t)/Math.LN2}class r extends Po{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(vl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vl(this._distance,c),pinchAround:o}}}function d(_,t){return 180*_.angleWith(t)/Math.PI}class b extends Po{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o,c){const h=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:d(this._vector,h),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,c=d(t,this._startVector);return Math.abs(c)<o}}function I(_){return Math.abs(_.y)>Math.abs(_.x)}class N extends Po{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,o,c){super.touchstart(t,o,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,I(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=t[0].sub(this._lastPoints[0]),m=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,m,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(t,o,c){if(this._valid!==void 0)return this._valid;const h=t.mag()>=2,m=o.mag()>=2;if(!h&&!m)return;if(!h||!m)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const T=t.y>0==o.y>0;return I(t)&&I(o)&&T}}const Y={panStep:100,bearingStep:15,pitchStep:10};class lt{constructor(t){this._tr=new Da(t);const o=Y;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,c=0,h=0,m=0,T=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),m=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),m=1);break;case 38:t.shiftKey?h=1:(t.preventDefault(),T=-1);break;case 40:t.shiftKey?h=-1:(t.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(c=0,h=0),{cameraAnimation:z=>{const P=this._tr;z.easeTo({duration:300,easeId:"keyboardHandler",easing:At,zoom:o?Math.round(P.zoom)+o*(t.shiftKey?2:1):P.zoom,bearing:P.bearing+c*this._bearingStep,pitch:P.pitch+h*this._pitchStep,offset:[-m*this._panStep,-T*this._panStep],center:P.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function At(_){return _*(2-_)}const Ot=4.000244140625;class $t{constructor(t,o){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=t,this._tr=new Da(t),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let o=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=It.now(),h=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,o!==0&&o%Ot==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(h*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=Mt.mousePos(this._map.getCanvas(),t),c=this._tr;this._around=o.y>c.transform.height/2-c.transform.getHorizon()?g.N.convert(this._aroundCenter?c.center:c.unproject(o)):g.N.convert(c.center),this._aroundPoint=c.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>Ot?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&B!==0&&(B=1/B);const Z=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(Z*B))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,c=this._startZoom,h=this._easing;let m,T=!1;const z=It.now()-this._lastWheelEventTime;if(this._type==="wheel"&&c&&h&&z){const P=Math.min(z/200,1),B=h(P);m=g.y.number(c,o,B),P<1?this._frameId||(this._frameId=!0):T=!0}else m=o,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!T,zoomDelta:m-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=g.b9;if(this._prevEase){const c=this._prevEase,h=(It.now()-c.start)/c.duration,m=c.easing(h+.01)-c.easing(h),T=.27/Math.sqrt(m*m+1e-4)*.01,z=Math.sqrt(.0729-T*T);o=g.b8(T,z,.25,1)}return this._prevEase={start:It.now(),duration:t,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class pe{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Re{constructor(t){this._tr=new Da(t),this.reset()}reset(){this._active=!1}dblclick(t,o){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _i{constructor(){this._tap=new kr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,o,c){if(!this._swipePoint)if(this._tapTime){const h=o[0],m=t.timeStamp-this._tapTime<500,T=this._tapPoint.dist(h)<30;m&&T?c.length>0&&(this._swipePoint=h,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(t,o,c)}touchmove(t,o,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const h=o[0],m=h.y-this._swipePoint.y;return this._swipePoint=h,t.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(t,o,c)}touchend(t,o,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const h=this._tap.touchend(t,o,c);h&&(this._tapTime=t.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oa{constructor(t,o,c){this._el=t,this._mousePan=o,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Rn{constructor(t,o,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=o,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ra{constructor(t,o,c,h){this._el=t,this._touchZoom=o,this._touchRotate=c,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Li{constructor(t,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=Mt.create("div","maplibregl-cooperative-gesture-screen",t);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=o,this._container.appendChild(h);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=c,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(Mt.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,o){this._enabled&&(this._map.fire(new g.k("cooperativegestureprevented",{gestureType:t,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const ci=_=>_.zoom||_.drag||_.pitch||_.rotate;class Qt extends g.k{}function qs(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Ha{constructor(t,o){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,m)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const T=h.type==="renderFrame"?void 0:h,z={needsRenderFrame:!1},P={},B={},Z=h.touches,j=Z?this._getMapTouches(Z):void 0,$=j?Mt.touchPos(this._map.getCanvas(),j):Mt.mousePos(this._map.getCanvas(),h);for(const{handlerName:rt,handler:ct,allowed:ht}of this._handlers){if(!ct.isEnabled())continue;let pt;this._blockedByActive(B,ht,rt)?ct.reset():ct[m||h.type]&&(pt=ct[m||h.type](h,$,j),this.mergeHandlerResult(z,P,pt,rt,T),pt&&pt.needsRenderFrame&&this._triggerRenderFrame()),(pt||ct.isActive())&&(B[rt]=ct)}const J={};for(const rt in this._previousActiveHandlers)B[rt]||(J[rt]=T);this._previousActiveHandlers=B,(Object.keys(J).length||qs(z))&&(this._changes.push([z,P,J]),this._triggerRenderFrame()),(Object.keys(B).length||qs(z))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:et}=z;et&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],et(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new io(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,m,T]of this._listeners)Mt.addEventListener(h,m,h===document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[t,o,c]of this._listeners)Mt.removeEventListener(t,o,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const o=this._map,c=o.getCanvasContainer();this._add("mapEvent",new Pa(o,t));const h=o.boxZoom=new Gn(o,t);this._add("boxZoom",h),t.interactive&&t.boxZoom&&h.enable();const m=o.cooperativeGestures=new Li(o,t.cooperativeGestures);this._add("cooperativeGestures",m),t.cooperativeGestures&&m.enable();const T=new rr(o),z=new Re(o);o.doubleClickZoom=new pe(z,T),this._add("tapZoom",T),this._add("clickZoom",z),t.interactive&&t.doubleClickZoom&&o.doubleClickZoom.enable();const P=new _i;this._add("tapDragZoom",P);const B=o.touchPitch=new N(o);this._add("touchPitch",B),t.interactive&&t.touchPitch&&o.touchPitch.enable(t.touchPitch);const Z=yl(t),j=Io(t);o.dragRotate=new Rn(t,Z,j),this._add("mouseRotate",Z,["mousePitch"]),this._add("mousePitch",j,["mouseRotate"]),t.interactive&&t.dragRotate&&o.dragRotate.enable();const $=(({enable:pt,clickTolerance:nt})=>{const vt=new da({checkCorrectEvent:wt=>Mt.mouseButton(wt)===0&&!wt.ctrlKey});return new ka({clickTolerance:nt,move:(wt,Pt)=>({around:Pt,panDelta:Pt.sub(wt)}),activateOnStart:!0,moveStateManager:vt,enable:pt,assignEvents:ls})})(t),J=new us(t,o);o.dragPan=new oa(c,$,J),this._add("mousePan",$),this._add("touchPan",J,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&o.dragPan.enable(t.dragPan);const et=new b,rt=new r;o.touchZoomRotate=new Ra(c,rt,et,P),this._add("touchRotate",et,["touchPan","touchZoom"]),this._add("touchZoom",rt,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&o.touchZoomRotate.enable(t.touchZoomRotate);const ct=o.scrollZoom=new $t(o,(()=>this._triggerRenderFrame()));this._add("scrollZoom",ct,["mousePan"]),t.interactive&&t.scrollZoom&&o.scrollZoom.enable(t.scrollZoom);const ht=o.keyboard=new lt(o);this._add("keyboard",ht),t.interactive&&t.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new _n(o))}_add(t,o,c){this._handlers.push({handlerName:t,handler:o,allowed:c}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ci(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,o,c){for(const h in t)if(h!==c&&(!o||o.indexOf(h)<0))return!0;return!1}_getMapTouches(t){const o=[];for(const c of t)this._el.contains(c.target)&&o.push(c);return o}mergeHandlerResult(t,o,c,h,m){if(!c)return;g.e(t,c);const T={handlerName:h,originalEvent:c.originalEvent||m};c.zoomDelta!==void 0&&(o.zoom=T),c.panDelta!==void 0&&(o.drag=T),c.pitchDelta!==void 0&&(o.pitch=T),c.bearingDelta!==void 0&&(o.rotate=T)}_applyChanges(){const t={},o={},c={};for(const[h,m,T]of this._changes)h.panDelta&&(t.panDelta=(t.panDelta||new g.P(0,0))._add(h.panDelta)),h.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(t.around=h.around),h.pinchAround!==void 0&&(t.pinchAround=h.pinchAround),h.noInertia&&(t.noInertia=h.noInertia),g.e(o,m),g.e(c,T);this._updateMapTransform(t,o,c),this._changes=[]}_updateMapTransform(t,o,c){const h=this._map,m=h._getTransformForUpdate(),T=h.terrain;if(!(qs(t)||T&&this._terrainMovement))return this._fireEvents(o,c,!0);let{panDelta:z,zoomDelta:P,bearingDelta:B,pitchDelta:Z,around:j,pinchAround:$}=t;$!==void 0&&(j=$),h._stop(!0),j=j||h.transform.centerPoint;const J=m.pointLocation(z?j.sub(z):j);B&&(m.bearing+=B),Z&&(m.pitch+=Z),P&&(m.zoom+=P),T?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(z)):m.setLocationAtPoint(J,j):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(J,j)):m.setLocationAtPoint(J,j),h._applyUpdatedTransform(m),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,c,!0)}_fireEvents(t,o,c){const h=ci(this._eventsInProgress),m=ci(t),T={};for(const j in t){const{originalEvent:$}=t[j];this._eventsInProgress[j]||(T[`${j}start`]=$),this._eventsInProgress[j]=t[j]}!h&&m&&this._fireEvent("movestart",m.originalEvent);for(const j in T)this._fireEvent(j,T[j]);m&&this._fireEvent("move",m.originalEvent);for(const j in t){const{originalEvent:$}=t[j];this._fireEvent(j,$)}const z={};let P;for(const j in this._eventsInProgress){const{handlerName:$,originalEvent:J}=this._eventsInProgress[j];this._handlersById[$].isActive()||(delete this._eventsInProgress[j],P=o[$]||J,z[`${j}end`]=P)}for(const j in z)this._fireEvent(j,z[j]);const B=ci(this._eventsInProgress),Z=(h||m)&&!B;if(Z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const j=this._map._getTransformForUpdate();j.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(j)}if(c&&Z){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=J=>J!==0&&-this._bearingSnap<J&&J<this._bearingSnap;!j||!j.essential&&It.prefersReducedMotion?(this._map.fire(new g.k("moveend",{originalEvent:P})),$(this._map.getBearing())&&this._map.resetNorth()):($(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new g.k(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Qt("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class xl extends g.E{constructor(t,o){super(),this._renderFrameCallback=()=>{const c=Math.min((It.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=o.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new g.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}panBy(t,o,c){return t=g.P.convert(t).mult(-1),this.panTo(this.transform.center,g.e({offset:t},o),c)}panTo(t,o,c){return this.easeTo(g.e({center:t},o),c)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,c){return this.easeTo(g.e({zoom:t},o),c)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,c){return this.easeTo(g.e({bearing:t},o),c)}resetNorth(t,o){return this.rotateTo(0,g.e({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(g.e({bearing:0,pitch:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}cameraForBounds(t,o){t=Nt.convert(t).adjustAntiMeridian();const c=o&&o.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,o)}_cameraForBoxAndBearing(t,o,c,h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=g.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const he=h.padding;h.padding={top:he,bottom:he,right:he,left:he}}h.padding=g.e(m,h.padding);const T=this.transform,z=T.padding,P=new Nt(t,o),B=T.project(P.getNorthWest()),Z=T.project(P.getNorthEast()),j=T.project(P.getSouthEast()),$=T.project(P.getSouthWest()),J=g.ba(-c),et=B.rotate(J),rt=Z.rotate(J),ct=j.rotate(J),ht=$.rotate(J),pt=new g.P(Math.max(et.x,rt.x,ht.x,ct.x),Math.max(et.y,rt.y,ht.y,ct.y)),nt=new g.P(Math.min(et.x,rt.x,ht.x,ct.x),Math.min(et.y,rt.y,ht.y,ct.y)),vt=pt.sub(nt),wt=(T.width-(z.left+z.right+h.padding.left+h.padding.right))/vt.x,Pt=(T.height-(z.top+z.bottom+h.padding.top+h.padding.bottom))/vt.y;if(Pt<0||wt<0)return void g.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Xt=Math.min(T.scaleZoom(T.scale*Math.min(wt,Pt)),h.maxZoom),ne=g.P.convert(h.offset),ue=new g.P((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(g.ba(c)),ve=ne.add(ue).mult(T.scale/T.zoomScale(Xt));return{center:T.unproject(B.add(j).div(2).sub(ve)),zoom:Xt,bearing:c}}fitBounds(t,o,c){return this._fitInternal(this.cameraForBounds(t,o),o,c)}fitScreenCoordinates(t,o,c,h,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(g.P.convert(t)),this.transform.pointLocation(g.P.convert(o)),c,h),h,m)}_fitInternal(t,o,c){return t?(delete(o=g.e(t,o)).padding,o.linear?this.easeTo(o,c):this.flyTo(o,c)):this}jumpTo(t,o){this.stop();const c=this._getTransformForUpdate();let h=!1,m=!1,T=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(h=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=g.N.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(m=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(T=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),this._applyUpdatedTransform(c),this.fire(new g.k("movestart",o)).fire(new g.k("move",o)),h&&this.fire(new g.k("zoomstart",o)).fire(new g.k("zoom",o)).fire(new g.k("zoomend",o)),m&&this.fire(new g.k("rotatestart",o)).fire(new g.k("rotate",o)).fire(new g.k("rotateend",o)),T&&this.fire(new g.k("pitchstart",o)).fire(new g.k("pitch",o)).fire(new g.k("pitchend",o)),this.fire(new g.k("moveend",o))}calculateCameraOptionsFromTo(t,o,c,h=0){const m=g.Z.fromLngLat(t,o),T=g.Z.fromLngLat(c,h),z=T.x-m.x,P=T.y-m.y,B=T.z-m.z,Z=Math.hypot(z,P,B);if(Z===0)throw new Error("Can't calculate camera options with same From and To");const j=Math.hypot(z,P),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Z/this.transform.tileSize),J=180*Math.atan2(z,-P)/Math.PI;let et=180*Math.acos(j/Z)/Math.PI;return et=B<0?90-et:90+et,{center:T.toLngLat(),zoom:$,pitch:et,bearing:J}}easeTo(t,o){var c;this._stop(!1,t.easeId),((t=g.e({offset:[0,0],duration:500,easing:g.b9},t)).animate===!1||!t.essential&&It.prefersReducedMotion)&&(t.duration=0);const h=this._getTransformForUpdate(),m=h.zoom,T=h.bearing,z=h.pitch,P=h.padding,B="bearing"in t?this._normalizeBearing(t.bearing,T):T,Z="pitch"in t?+t.pitch:z,j="padding"in t?t.padding:h.padding,$=g.P.convert(t.offset);let J=h.centerPoint.add($);const et=h.pointLocation(J),{center:rt,zoom:ct}=h.getConstrained(g.N.convert(t.center||et),(c=t.zoom)!==null&&c!==void 0?c:m);this._normalizeCenter(rt,h);const ht=h.project(et),pt=h.project(rt).sub(ht),nt=h.zoomScale(ct-m);let vt,wt;t.around&&(vt=g.N.convert(t.around),wt=h.locationPoint(vt));const Pt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ct!==m,this._rotating=this._rotating||T!==B,this._pitching=this._pitching||Z!==z,this._padding=!h.isPaddingEqual(j),this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,Pt),this.terrain&&this._prepareElevation(rt),this._ease((Xt=>{if(this._zooming&&(h.zoom=g.y.number(m,ct,Xt)),this._rotating&&(h.bearing=g.y.number(T,B,Xt)),this._pitching&&(h.pitch=g.y.number(z,Z,Xt)),this._padding&&(h.interpolatePadding(P,j,Xt),J=h.centerPoint.add($)),this.terrain&&!t.freezeElevation&&this._updateElevation(Xt),vt)h.setLocationAtPoint(vt,wt);else{const ne=h.zoomScale(h.zoom-m),ue=ct>m?Math.min(2,nt):Math.max(.5,nt),ve=Math.pow(ue,1-Xt),he=h.unproject(ht.add(pt.mult(Xt*ve)).mult(ne));h.setLocationAtPoint(h.renderWorldCopies?he.wrap():he,J)}this._applyUpdatedTransform(h),this._fireMoveEvents(o)}),(Xt=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o,Xt)}),t),this}_prepareEase(t,o,c={}){this._moving=!0,o||c.moving||this.fire(new g.k("movestart",t)),this._zooming&&!c.zooming&&this.fire(new g.k("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new g.k("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new g.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&o!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(o-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=o}this.transform.elevation=g.y.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){const o=t.getCameraPosition(),c=this.terrain.getElevationForLngLatZoom(o.lngLat,t.zoom);if(o.altitude<c){const h=this.calculateCameraOptionsFromTo(o.lngLat,c,t.center,t.elevation);return{pitch:h.pitch,zoom:h.zoom}}return{}}_applyUpdatedTransform(t){const o=[];if(this.terrain&&o.push((h=>this._elevateCameraIfInsideTerrain(h))),this.transformCameraUpdate&&o.push((h=>this.transformCameraUpdate(h))),!o.length)return;const c=t.clone();for(const h of o){const m=c.clone(),{center:T,zoom:z,pitch:P,bearing:B,elevation:Z}=h(m);T&&(m.center=T),z!==void 0&&(m.zoom=z),P!==void 0&&(m.pitch=P),B!==void 0&&(m.bearing=B),Z!==void 0&&(m.elevation=Z),c.apply(m)}this.transform.apply(c)}_fireMoveEvents(t){this.fire(new g.k("move",t)),this._zooming&&this.fire(new g.k("zoom",t)),this._rotating&&this.fire(new g.k("rotate",t)),this._pitching&&this.fire(new g.k("pitch",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const c=this._zooming,h=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new g.k("zoomend",t)),h&&this.fire(new g.k("rotateend",t)),m&&this.fire(new g.k("pitchend",t)),this.fire(new g.k("moveend",t))}flyTo(t,o){var c;if(!t.essential&&It.prefersReducedMotion){const _e=g.M(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_e,o)}this.stop(),t=g.e({offset:[0,0],speed:1.2,curve:1.42,easing:g.b9},t);const h=this._getTransformForUpdate(),m=h.zoom,T=h.bearing,z=h.pitch,P=h.padding,B="bearing"in t?this._normalizeBearing(t.bearing,T):T,Z="pitch"in t?+t.pitch:z,j="padding"in t?t.padding:h.padding,$=g.P.convert(t.offset);let J=h.centerPoint.add($);const et=h.pointLocation(J),{center:rt,zoom:ct}=h.getConstrained(g.N.convert(t.center||et),(c=t.zoom)!==null&&c!==void 0?c:m);this._normalizeCenter(rt,h);const ht=h.zoomScale(ct-m),pt=h.project(et),nt=h.project(rt).sub(pt);let vt=t.curve;const wt=Math.max(h.width,h.height),Pt=wt/ht,Xt=nt.mag();if("minZoom"in t){const _e=g.ac(Math.min(t.minZoom,m,ct),h.minZoom,h.maxZoom),Ze=wt/h.zoomScale(_e-m);vt=Math.sqrt(Ze/Xt*2)}const ne=vt*vt;function ue(_e){const Ze=(Pt*Pt-wt*wt+(_e?-1:1)*ne*ne*Xt*Xt)/(2*(_e?Pt:wt)*ne*Xt);return Math.log(Math.sqrt(Ze*Ze+1)-Ze)}function ve(_e){return(Math.exp(_e)-Math.exp(-_e))/2}function he(_e){return(Math.exp(_e)+Math.exp(-_e))/2}const se=ue(!1);let we=function(_e){return he(se)/he(se+vt*_e)},qe=function(_e){return wt*((he(se)*(ve(Ze=se+vt*_e)/he(Ze))-ve(se))/ne)/Xt;var Ze},fe=(ue(!0)-se)/vt;if(Math.abs(Xt)<1e-6||!isFinite(fe)){if(Math.abs(wt-Pt)<1e-6)return this.easeTo(t,o);const _e=Pt<wt?-1:1;fe=Math.abs(Math.log(Pt/wt))/vt,qe=()=>0,we=Ze=>Math.exp(_e*vt*Ze)}return t.duration="duration"in t?+t.duration:1e3*fe/("screenSpeed"in t?+t.screenSpeed/vt:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=T!==B,this._pitching=Z!==z,this._padding=!h.isPaddingEqual(j),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(rt),this._ease((_e=>{const Ze=_e*fe,tn=1/we(Ze);h.zoom=_e===1?ct:m+h.scaleZoom(tn),this._rotating&&(h.bearing=g.y.number(T,B,_e)),this._pitching&&(h.pitch=g.y.number(z,Z,_e)),this._padding&&(h.interpolatePadding(P,j,_e),J=h.centerPoint.add($)),this.terrain&&!t.freezeElevation&&this._updateElevation(_e);const li=_e===1?rt:h.unproject(pt.add(nt.mult(qe(Ze))).mult(tn));h.setLocationAtPoint(h.renderWorldCopies?li.wrap():li,J),this._applyUpdatedTransform(h),this._fireMoveEvents(o)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(o)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,o)}return t||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(t,o,c){c.animate===!1||c.duration===0?(t(1),o()):(this._easeStart=It.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,o){t=g.b3(t,-180,180);const c=Math.abs(t-o);return Math.abs(t-360-o)<c&&(t-=360),Math.abs(t+360-o)<c&&(t+=360),t}_normalizeCenter(t,o){if(!o.renderWorldCopies||o.lngRange)return;const c=t.lng-o.center.lng;t.lng+=c>180?-360:c<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(g.N.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const cs={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class no{constructor(t=cs){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=Mt.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=Mt.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Mt.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Mt.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const c=this._map._getUIString(`AttributionControl.${o}`);t.title=c,t.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((h=>typeof h!="string"?"":h))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const o=this._map.style.sourceCaches;for(const h in o){const m=o[h];if(m.used||m.usedForTerrain){const T=m.getSource();T.attribution&&t.indexOf(T.attribution)<0&&t.push(T.attribution)}}t=t.filter((h=>String(h).trim())),t.sort(((h,m)=>h.length-m.length)),t=t.filter(((h,m)=>{for(let T=m+1;T<t.length;T++)if(t[T].indexOf(h)>=0)return!1;return!0}));const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Cn{constructor(t={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=Mt.create("div","maplibregl-ctrl");const o=Mt.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Mt.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ei{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,c=o?this._queue.concat(o):this._queue;for(const h of c)if(h.id===t)return void(h.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const c of o)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Rr=g.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Mu extends g.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,o){this.sourceCache.update(t,o),this._renderableTilesKeys=[];const c={};for(const h of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))c[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.posMatrix=new Float64Array(16),g.aP(h.posMatrix,0,g.X,0,g.X,0,1),this._tiles[h.key]=new Gr(h,this.tileSize));for(const h in this._tiles)c[h]||delete this._tiles[h]}freeRtt(t){for(const o in this._tiles){const c=this._tiles[o];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const o={};for(const c of this._renderableTilesKeys){const h=this._tiles[c].tileID;if(h.canonical.equals(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16),g.aP(m.posMatrix,0,g.X,0,g.X,0,1),o[c]=m}else if(h.canonical.isChildOf(t.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const T=h.canonical.z-t.canonical.z,z=h.canonical.x-(h.canonical.x>>T<<T),P=h.canonical.y-(h.canonical.y>>T<<T),B=g.X>>T;g.aP(m.posMatrix,0,B,0,B,0,1),g.J(m.posMatrix,m.posMatrix,[-z*B,-P*B,0]),o[c]=m}else if(t.canonical.isChildOf(h.canonical)){const m=t.clone();m.posMatrix=new Float64Array(16);const T=t.canonical.z-h.canonical.z,z=t.canonical.x-(t.canonical.x>>T<<T),P=t.canonical.y-(t.canonical.y>>T<<T),B=g.X>>T;g.aP(m.posMatrix,0,g.X,0,g.X,0,1),g.J(m.posMatrix,m.posMatrix,[z*B,P*B,0]),g.K(m.posMatrix,m.posMatrix,[1/2**T,1/2**T,0]),o[c]=m}}return o}getSourceTile(t,o){const c=this.sourceCache._source;let h=t.overscaledZ-this.deltaZoom;if(h>c.maxzoom&&(h=c.maxzoom),h<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(h).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!m||!m.dem)&&o)for(;h>=c.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(t.scaledTo(h--).key);return m}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter((o=>o.timeAdded>=t))}}class ko{constructor(t,o,c){this.painter=t,this.sourceCache=new Mu(o),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,o,c,h=g.X){var m;if(!(o>=0&&o<h&&c>=0&&c<h))return 0;const T=this.getTerrainData(t),z=(m=T.tile)===null||m===void 0?void 0:m.dem;if(!z)return 0;const P=(function(et,rt,ct){var ht=rt[0],pt=rt[1];return et[0]=ct[0]*ht+ct[4]*pt+ct[12],et[1]=ct[1]*ht+ct[5]*pt+ct[13],et})([],[o/h*g.X,c/h*g.X],T.u_terrain_matrix),B=[P[0]*z.dim,P[1]*z.dim],Z=Math.floor(B[0]),j=Math.floor(B[1]),$=B[0]-Z,J=B[1]-j;return z.get(Z,j)*(1-$)*(1-J)+z.get(Z+1,j)*$*(1-J)+z.get(Z,j+1)*(1-$)*J+z.get(Z+1,j+1)*$*J}getElevationForLngLatZoom(t,o){if(!g.bb(o,t.wrap()))return 0;const{tileID:c,mercatorX:h,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(t,o);return this.getElevation(c,h%g.X,m%g.X,g.X)}getElevation(t,o,c,h=g.X){return this.getDEMElevation(t,o,c,h)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const h=this.painter.context,m=new g.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Fe(h,m,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Fe(h,new g.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=g.an([])}const o=this.sourceCache.getSourceTile(t,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const h=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new Fe(h,o.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),o.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const c=o&&o+o.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const h=this.sourceCache.sourceCache._source.maxzoom;let m=t.canonical.z-o.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=h?m=t.canonical.z-h:g.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const T=t.canonical.x-(t.canonical.x>>m<<m),z=t.canonical.y-(t.canonical.y>>m<<m),P=g.bc(new Float64Array(16),[1/(g.X<<m),1/(g.X<<m),0]);g.J(P,P,[T*g.X,z*g.X,0]),this._demMatrixCache[t.key]={matrix:P,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(t){const o=this.painter,c=o.width/devicePixelRatio,h=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Fe(o.context,{width:c,height:h,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Fe(o.context,{width:c,height:h,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(c,h,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,c,h))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,T=0;m<this._coordsTextureSize;m++)for(let z=0;z<this._coordsTextureSize;z++,T+=4)o[T+0]=255&z,o[T+1]=255&m,o[T+2]=z>>8<<4|m>>8,o[T+3]=0;const c=new g.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),h=new Fe(t,c,t.gl.RGBA,{premultiply:!1});return h.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),c=this.painter.context,h=c.gl,m=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),T=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(m,z-T-1,1,1,h.RGBA,h.UNSIGNED_BYTE,o),c.bindFramebuffer.set(null);const P=o[0]+(o[2]>>4<<8),B=o[1]+((15&o[2])<<8),Z=this.coordsIndex[255-o[3]],j=Z&&this.sourceCache.getTileByID(Z);if(!j)return null;const $=this._coordsTextureSize,J=(1<<j.tileID.canonical.z)*$;return new g.Z((j.tileID.canonical.x*$+P)/J+j.tileID.wrap,(j.tileID.canonical.y*$+B)/J,this.getElevation(j.tileID,P,B,$))}depthAtPoint(t){const o=new Uint8Array(4),c=this.painter.context,h=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,o),c.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,o=new g.bd,c=new g.aY,h=this.meshSize,m=g.X/h,T=h*h;for(let j=0;j<=h;j++)for(let $=0;$<=h;$++)o.emplaceBack($*m,j*m,0);for(let j=0;j<T;j+=h+1)for(let $=0;$<h;$++)c.emplaceBack($+j,h+$+j+1,h+$+j+2),c.emplaceBack($+j,h+$+j+2,$+j+1);const z=o.length,P=z+2*(h+1);for(const j of[0,1])for(let $=0;$<=h;$++)for(const J of[0,1])o.emplaceBack($*m,j*g.X,J);for(let j=0;j<2*h;j+=2)c.emplaceBack(P+j,P+j+1,P+j+3),c.emplaceBack(P+j,P+j+3,P+j+2),c.emplaceBack(z+j,z+j+3,z+j+1),c.emplaceBack(z+j,z+j+2,z+j+3);const B=o.length,Z=B+2*(h+1);for(const j of[0,1])for(let $=0;$<=h;$++)for(const J of[0,1])o.emplaceBack(j*g.X,$*m,J);for(let j=0;j<2*h;j+=2)c.emplaceBack(B+j,B+j+1,B+j+3),c.emplaceBack(B+j,B+j+3,B+j+2),c.emplaceBack(Z+j,Z+j+3,Z+j+1),c.emplaceBack(Z+j,Z+j+2,Z+j+3);return this._mesh=new to(t.createVertexBuffer(o,Rr.members),t.createIndexBuffer(c),g.a0.simpleSegment(0,0,o.length,c.length)),this._mesh}getMeshFrameDelta(t){return 2*Math.PI*g.be/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,o){var c;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(t,o);return(c=this.getMinMaxElevation(h).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(t){const o=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return o&&o.dem&&(c.minElevation=o.dem.min*this.exaggeration,c.maxElevation=o.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(t,o){const c=g.Z.fromLngLat(t.wrap()),h=(1<<o)*g.X,m=c.x*h,T=c.y*h,z=Math.floor(m/g.X),P=Math.floor(T/g.X);return{tileID:new g.S(o,0,o,z,P),mercatorX:m,mercatorY:T}}}class bl{constructor(t,o,c){this._context=t,this._size=o,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new Fe(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(c.texture),{id:t,fbo:o,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((o=>t.id!==o)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const hs={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class or{constructor(t,o){this.painter=t,this.terrain=o,this.pool=new bl(t.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((c=>!t._layers[c].isHidden(o))),this._coordsDescendingInv={};for(const c in t.sourceCaches){this._coordsDescendingInv[c]={};const h=t.sourceCaches[c].getVisibleCoordinates();for(const m of h){const T=this.terrain.sourceCache.getTerrainCoords(m);for(const z in T)this._coordsDescendingInv[c][z]||(this._coordsDescendingInv[c][z]=[]),this._coordsDescendingInv[c][z].push(T[z])}}this._coordsDescendingInvStr={};for(const c of t._order){const h=t._layers[c],m=h.source;if(hs[h.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const T in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][T]=this._coordsDescendingInv[m][T].map((z=>z.key)).sort().join()}}for(const c of this._renderableTiles)for(const h in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[h][c.tileID.key];m&&m!==c.rttCoords[h]&&(c.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const o=t.type,c=this.painter,h=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(hs[o]&&(this._prevType&&hs[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(t.id),!h))return!0;if(hs[this._prevType]||hs[o]&&h){this._prevType=o;const m=this._stacks.length-1,T=this._stacks[m]||[];for(const z of this._renderableTiles){if(this.pool.isFull()&&(_l(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(z),z.rtt[m]){const B=this.pool.getObjectForId(z.rtt[m].id);if(B.stamp===z.rtt[m].stamp){this.pool.useObject(B);continue}}const P=this.pool.getOrCreateFreeObject();this.pool.useObject(P),this.pool.stampObject(P),z.rtt[m]={id:P.id,stamp:P.stamp},c.context.bindFramebuffer.set(P.fbo.framebuffer),c.context.clear({color:g.aM.transparent,stencil:0}),c.currentStencilSource=void 0;for(let B=0;B<T.length;B++){const Z=c.style._layers[T[B]],j=Z.source?this._coordsDescendingInv[Z.source][z.tileID.key]:[z.tileID];c.context.viewport.set([0,0,P.fbo.width,P.fbo.height]),c._renderTileClippingMasks(Z,j),c.renderLayer(c,c.style.sourceCaches[Z.source],Z,j),Z.source&&(z.rttCoords[Z.source]=this._coordsDescendingInvStr[Z.source][z.tileID.key])}}return _l(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),hs[o]}return!1}}const ao={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},so=bt,Nc={hash:!1,interactive:!0,bearingSnap:7,attributionControl:cs,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:g.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},zu=_=>{_.touchstart=_.dragStart,_.touchmoveWindow=_.dragMove,_.touchend=_.dragEnd},Kl={showCompass:!0,showZoom:!0,visualizePitch:!1};class tc{constructor(t,o,c=!1){this.mousedown=T=>{this.startMouse(g.e({},T,{ctrlKey:!0,preventDefault:()=>T.preventDefault()}),Mt.mousePos(this.element,T)),Mt.addEventListener(window,"mousemove",this.mousemove),Mt.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=T=>{this.moveMouse(T,Mt.mousePos(this.element,T))},this.mouseup=T=>{this.mouseRotate.dragEnd(T),this.mousePitch&&this.mousePitch.dragEnd(T),this.offTemp()},this.touchstart=T=>{T.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Mt.touchPos(this.element,T.targetTouches)[0],this.startTouch(T,this._startPos),Mt.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),Mt.addEventListener(window,"touchend",this.touchend))},this.touchmove=T=>{T.targetTouches.length!==1?this.reset():(this._lastPos=Mt.touchPos(this.element,T.targetTouches)[0],this.moveTouch(T,this._lastPos))},this.touchend=T=>{T.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const h=t.dragRotate._mouseRotate.getClickTolerance(),m=t.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=yl({clickTolerance:h,enable:!0}),this.touchRotate=(({enable:T,clickTolerance:z,bearingDegreesPerPixelMoved:P=.8})=>{const B=new el;return new ka({clickTolerance:z,move:(Z,j)=>({bearingDelta:(j.x-Z.x)*P}),moveStateManager:B,enable:T,assignEvents:zu})})({clickTolerance:h,enable:!0}),this.map=t,c&&(this.mousePitch=Io({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:T,clickTolerance:z,pitchDegreesPerPixelMoved:P=-.5})=>{const B=new el;return new ka({clickTolerance:z,move:(Z,j)=>({pitchDelta:(j.y-Z.y)*P}),moveStateManager:B,enable:T,assignEvents:zu})})({clickTolerance:m,enable:!0})),Mt.addEventListener(o,"mousedown",this.mousedown),Mt.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),Mt.addEventListener(o,"touchcancel",this.reset)}startMouse(t,o){this.mouseRotate.dragStart(t,o),this.mousePitch&&this.mousePitch.dragStart(t,o),Mt.disableDrag()}startTouch(t,o){this.touchRotate.dragStart(t,o),this.touchPitch&&this.touchPitch.dragStart(t,o),Mt.disableDrag()}moveMouse(t,o){const c=this.map,{bearingDelta:h}=this.mouseRotate.dragMove(t,o)||{};if(h&&c.setBearing(c.getBearing()+h),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(t,o)||{};m&&c.setPitch(c.getPitch()+m)}}moveTouch(t,o){const c=this.map,{bearingDelta:h}=this.touchRotate.dragMove(t,o)||{};if(h&&c.setBearing(c.getBearing()+h),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(t,o)||{};m&&c.setPitch(c.getPitch()+m)}}off(){const t=this.element;Mt.removeEventListener(t,"mousedown",this.mousedown),Mt.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),Mt.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Mt.removeEventListener(window,"touchend",this.touchend),Mt.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){Mt.enableDrag(),Mt.removeEventListener(window,"mousemove",this.mousemove),Mt.removeEventListener(window,"mouseup",this.mouseup),Mt.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Mt.removeEventListener(window,"touchend",this.touchend)}}let pa;function fi(_,t,o){const c=new g.N(_.lng,_.lat);if(_=new g.N(_.lng,_.lat),t){const h=new g.N(_.lng-360,_.lat),m=new g.N(_.lng+360,_.lat),T=o.locationPoint(_).distSqr(t);o.locationPoint(h).distSqr(t)<T?_=h:o.locationPoint(m).distSqr(t)<T&&(_=m)}for(;Math.abs(_.lng-o.center.lng)>180;){const h=o.locationPoint(_);if(h.x>=0&&h.y>=0&&h.x<=o.width&&h.y<=o.height)break;_.lng>o.center.lng?_.lng-=360:_.lng+=360}return _.lng!==c.lng&&o.locationPoint(_).y>o.height/2-o.getHorizon()?_:c}const Ro={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Cu(_,t,o){const c=_.classList;for(const h in Ro)c.remove(`maplibregl-${o}-anchor-${h}`);c.add(`maplibregl-${o}-anchor-${t}`)}class ec extends g.E{constructor(t){if(super(),this._onKeyPress=o=>{const c=o.code,h=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=o=>{const c=o.originalEvent.target,h=this._element;this._popup&&(c===h||h.contains(c))&&this.togglePopup()},this._update=o=>{var c;if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();(o?.type==="terrain"||o?.type==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?fi(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),Mt.setTransform(this._element,`${Ro[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${m}`),It.frameAsync(new AbortController).then((()=>{this._updateOpacity(o&&o.type==="moveend")})).catch((()=>{}))},this._onMove=o=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new g.k("dragstart"))),this.fire(new g.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new g.k("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=g.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Mt.create("div");const o=Mt.createNS("http://www.w3.org/2000/svg","svg"),c=41,h=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${c}px`),o.setAttributeNS(null,"width",`${h}px`),o.setAttributeNS(null,"viewBox",`0 0 ${h} ${c}`);const m=Mt.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const T=Mt.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");const z=Mt.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ht of P){const pt=Mt.createNS("http://www.w3.org/2000/svg","ellipse");pt.setAttributeNS(null,"opacity","0.04"),pt.setAttributeNS(null,"cx","10.5"),pt.setAttributeNS(null,"cy","5.80029008"),pt.setAttributeNS(null,"rx",ht.rx),pt.setAttributeNS(null,"ry",ht.ry),z.appendChild(pt)}const B=Mt.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const Z=Mt.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(Z);const j=Mt.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const $=Mt.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild($);const J=Mt.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const et=Mt.createNS("http://www.w3.org/2000/svg","g");et.setAttributeNS(null,"transform","translate(8.0, 8.0)");const rt=Mt.createNS("http://www.w3.org/2000/svg","circle");rt.setAttributeNS(null,"fill","#000000"),rt.setAttributeNS(null,"opacity","0.25"),rt.setAttributeNS(null,"cx","5.5"),rt.setAttributeNS(null,"cy","5.5"),rt.setAttributeNS(null,"r","5.4999962");const ct=Mt.createNS("http://www.w3.org/2000/svg","circle");ct.setAttributeNS(null,"fill","#FFFFFF"),ct.setAttributeNS(null,"cx","5.5"),ct.setAttributeNS(null,"cy","5.5"),ct.setAttributeNS(null,"r","5.4999962"),et.appendChild(rt),et.appendChild(ct),T.appendChild(z),T.appendChild(B),T.appendChild(j),T.appendChild(J),T.appendChild(et),o.appendChild(T),o.setAttributeNS(null,"height",c*this._scale+"px"),o.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(o),this._offset=g.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(o=>{o.preventDefault()})),this._element.addEventListener("mousedown",(o=>{o.preventDefault()})),Cu(this._element,this._anchor,"marker"),t&&t.className)for(const o of t.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Mt.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=g.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const h=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var o,c;if(!(!((o=this._map)===null||o===void 0)&&o.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const h=this._map,m=h.terrain.depthAtPoint(this._pos),T=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,T)-m<.006)return void(this._element.style.opacity=this._opacity);const z=-this._offset.y/h.transform._pixelPerMeter,P=Math.sin(h.getPitch()*Math.PI/180)*z,B=h.terrain.depthAtPoint(new g.P(this._pos.x,this._pos.y-this._offset.y)),Z=h.transform.lngLatToCameraDepth(this._lngLat,T+P)-B>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&Z&&this._popup.remove(),this._element.style.opacity=Z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=g.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,o){return t===void 0&&o===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const Ah={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Lu=0,Pn=!1;const lr={maxWidth:100,unit:"metric"};function Oo(_,t,o){const c=o&&o.maxWidth||100,h=_._container.clientHeight/2,m=_.unproject([0,h]),T=_.unproject([c,h]),z=m.distanceTo(T);if(o&&o.unit==="imperial"){const P=3.2808*z;P>5280?Ee(t,c,P/5280,_._getUIString("ScaleControl.Miles")):Ee(t,c,P,_._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Ee(t,c,z/1852,_._getUIString("ScaleControl.NauticalMiles")):z>=1e3?Ee(t,c,z/1e3,_._getUIString("ScaleControl.Kilometers")):Ee(t,c,z,_._getUIString("ScaleControl.Meters"))}function Ee(_,t,o,c){const h=(function(m){const T=Math.pow(10,`${Math.floor(m)}`.length-1);let z=m/T;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:(function(P){const B=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*B)/B})(z),T*z})(o);_.style.width=t*(h/o)+"px",_.innerHTML=`${h}&nbsp;${c}`}const Oe={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Bo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function No(_){if(_){if(typeof _=="number"){const t=Math.round(Math.abs(_)/Math.SQRT2);return{center:new g.P(0,0),top:new g.P(0,_),"top-left":new g.P(t,t),"top-right":new g.P(-t,t),bottom:new g.P(0,-_),"bottom-left":new g.P(t,-t),"bottom-right":new g.P(-t,-t),left:new g.P(_,0),right:new g.P(-_,0)}}if(_ instanceof g.P||Array.isArray(_)){const t=g.P.convert(_);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:g.P.convert(_.center||[0,0]),top:g.P.convert(_.top||[0,0]),"top-left":g.P.convert(_["top-left"]||[0,0]),"top-right":g.P.convert(_["top-right"]||[0,0]),bottom:g.P.convert(_.bottom||[0,0]),"bottom-left":g.P.convert(_["bottom-left"]||[0,0]),"bottom-right":g.P.convert(_["bottom-right"]||[0,0]),left:g.P.convert(_.left||[0,0]),right:g.P.convert(_.right||[0,0])}}return No(new g.P(0,0))}const Fc=bt;O.AJAXError=g.bh,O.Evented=g.E,O.LngLat=g.N,O.MercatorCoordinate=g.Z,O.Point=g.P,O.addProtocol=g.bi,O.config=g.a,O.removeProtocol=g.bj,O.AttributionControl=no,O.BoxZoomHandler=Gn,O.CanvasSource=gs,O.CooperativeGesturesHandler=Li,O.DoubleClickZoomHandler=pe,O.DragPanHandler=oa,O.DragRotateHandler=Rn,O.EdgeInsets=js,O.FullscreenControl=class extends g.E{constructor(_={}){super(),this._onFullscreenChange=()=>{var t;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=o?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:g.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=Mt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){Mt.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const _=this._fullscreenButton=Mt.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);Mt.create("span","maplibregl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.title=_}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new g.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new g.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},O.GeoJSONSource=Tr,O.GeolocateControl=class extends g.E{constructor(_){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new g.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new g.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const o=new g.N(t.coords.longitude,t.coords.latitude),c=t.coords.accuracy,h=this._map.getBearing(),m=g.e({bearing:h},this.options.fitBoundsOptions),T=Nt.fromLngLat(o,c);this._map.fitBounds(T,m,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const o=new g.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Pn)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new g.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=Mt.create("button","maplibregl-ctrl-geolocate",this._container),Mt.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){g.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Mt.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new ec({element:this._dotElement}),this._circleElement=Mt.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ec({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new g.k("trackuserlocationend")),this.fire(new g.k("userlocationlostfocus")))}))}},this.options=g.e({},Ah,_)}onAdd(_){return this._map=_,this._container=Mt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return g._(this,arguments,void 0,(function*(t=!1){if(pa!==void 0&&!t)return pa;if(window.navigator.permissions===void 0)return pa=!!window.navigator.geolocation,pa;try{pa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{pa=!!window.navigator.geolocation}return pa}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Mt.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Lu=0,Pn=!1}_isOutOfMapMaxBounds(_){const t=this._map.getMaxBounds(),o=_.coords;return t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const _=this._map.getBounds(),t=_.getSouthEast(),o=_.getNorthEast(),c=t.distanceTo(o),h=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return g.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new g.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Lu--,Pn=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new g.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new g.k("trackuserlocationstart")),this.fire(new g.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Lu++,Lu>1?(_={maximumAge:6e5,timeout:0},Pn=!0):(_=this.options.positionOptions,Pn=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,_)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},O.Hash=eo,O.ImageSource=Ks,O.KeyboardHandler=lt,O.LngLatBounds=Nt,O.LogoControl=Cn,O.Map=class extends xl{constructor(_){g.bf.mark(g.bg.create);const t=Object.assign(Object.assign({},Nc),_);if(t.minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(t.minPitch!=null&&t.maxPitch!=null&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(t.minPitch!=null&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(t.maxPitch!=null&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new zo(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),{bearingSnap:t.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ei,this._controls=[],this._mapId=g.a4(),this._contextLost=o=>{o.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new g.k("webglcontextlost",{originalEvent:o}))},this._contextRestored=o=>{this._setupPainter(),this.resize(),this._update(),this.fire(new g.k("webglcontextrestored",{originalEvent:o}))},this._onMapScroll=o=>{if(o.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._maxTileCacheZoomLevels=t.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=t.preserveDrawingBuffer===!0,this._antialias=t.antialias===!0,this._trackResize=t.trackResize===!0,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles===!0,this._fadeDuration=t.fadeDuration,this._crossSourceCollisions=t.crossSourceCollisions===!0,this._collectResourceTiming=t.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},ao),t.locale),this._clickTolerance=t.clickTolerance,this._overridePixelRatio=t.pixelRatio,this._maxCanvasSize=t.maxCanvasSize,this.transformCameraUpdate=t.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=t.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=We.addThrottleControl((()=>this.isMoving())),this._requestManager=new Qi(t.transformRequest),typeof t.container=="string"){if(this._container=document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(t.maxBounds&&this.setMaxBounds(t.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let o=!1;const c=qn((h=>{this._trackResize&&!this._removed&&(this.resize(h),this.redraw())}),50);this._resizeObserver=new ResizeObserver((h=>{o?c(h):o=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Ha(this,t),this._hash=t.hash&&new eo(typeof t.hash=="string"&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,g.e({},t.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=t.localIdeographFontFamily,this._validateStyle=t.validateStyle,t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new no(typeof t.attributionControl=="boolean"?void 0:t.attributionControl)),t.maplibreLogo&&this.addControl(new Cn,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(o=>{this._update(o.dataType==="style"),this.fire(new g.k(`${o.dataType}data`,o))})),this.on("dataloading",(o=>{this.fire(new g.k(`${o.dataType}dataloading`,o))})),this.on("dataabort",(o=>{this.fire(new g.k("sourcedataabort",o))}))}_getMapId(){return this._mapId}addControl(_,t){if(t===void 0&&(t=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new g.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=_.onAdd(this);this._controls.push(_);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new g.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(_);return t>-1&&this._controls.splice(t,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}calculateCameraOptionsFromTo(_,t,o,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(_,t,o,c)}resize(_){var t;const o=this._containerDimensions(),c=o[0],h=o[1],m=this._getClampedPixelRatio(c,h);if(this._resizeCanvas(c,h,m),this.painter.resize(c,h,m),this.painter.overLimit()){const z=this.painter.context.gl;this._maxCanvasSize=[z.drawingBufferWidth,z.drawingBufferHeight];const P=this._getClampedPixelRatio(c,h);this._resizeCanvas(c,h,P),this.painter.resize(c,h,P)}this.transform.resize(c,h),(t=this._requestedCameraState)===null||t===void 0||t.resize(c,h);const T=!this._moving;return T&&(this.stop(),this.fire(new g.k("movestart",_)).fire(new g.k("move",_))),this.fire(new g.k("resize",_)),T&&this.fire(new g.k("moveend",_)),this}_getClampedPixelRatio(_,t){const{0:o,1:c}=this._maxCanvasSize,h=this.getPixelRatio(),m=_*h,T=t*h;return Math.min(m>o?o/m:1,T>c?c/T:1)*h}getPixelRatio(){var _;return(_=this._overridePixelRatio)!==null&&_!==void 0?_:devicePixelRatio}setPixelRatio(_){this._overridePixelRatio=_,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(_){return this.transform.setMaxBounds(Nt.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_&&this.setZoom(_),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_&&this.setZoom(_),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_&&this.setPitch(_),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_&&this.setPitch(_),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this._update()}project(_){return this.transform.locationPoint(g.N.convert(_),this.style&&this.terrain)}unproject(_){return this.transform.pointLocation(g.P.convert(_),this.terrain)}isMoving(){var _;return this._moving||((_=this.handlers)===null||_===void 0?void 0:_.isMoving())}isZooming(){var _;return this._zooming||((_=this.handlers)===null||_===void 0?void 0:_.isZooming())}isRotating(){var _;return this._rotating||((_=this.handlers)===null||_===void 0?void 0:_.isRotating())}_createDelegatedListener(_,t,o){if(_==="mouseenter"||_==="mouseover"){let c=!1;return{layers:t,listener:o,delegates:{mousemove:m=>{const T=t.filter((P=>this.getLayer(P))),z=T.length!==0?this.queryRenderedFeatures(m.point,{layers:T}):[];z.length?c||(c=!0,o.call(this,new sn(_,this,m.originalEvent,{features:z}))):c=!1},mouseout:()=>{c=!1}}}}if(_==="mouseleave"||_==="mouseout"){let c=!1;return{layers:t,listener:o,delegates:{mousemove:T=>{const z=t.filter((P=>this.getLayer(P)));(z.length!==0?this.queryRenderedFeatures(T.point,{layers:z}):[]).length?c=!0:c&&(c=!1,o.call(this,new sn(_,this,T.originalEvent)))},mouseout:T=>{c&&(c=!1,o.call(this,new sn(_,this,T.originalEvent)))}}}}{const c=h=>{const m=t.filter((z=>this.getLayer(z))),T=m.length!==0?this.queryRenderedFeatures(h.point,{layers:m}):[];T.length&&(h.features=T,o.call(this,h),delete h.features)};return{layers:t,listener:o,delegates:{[_]:c}}}}_saveDelegatedListener(_,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(t)}_removeDelegatedListener(_,t,o){if(!this._delegatedListeners||!this._delegatedListeners[_])return;const c=this._delegatedListeners[_];for(let h=0;h<c.length;h++){const m=c[h];if(m.listener===o&&m.layers.length===t.length&&m.layers.every((T=>t.includes(T)))){for(const T in m.delegates)this.off(T,m.delegates[T]);return void c.splice(h,1)}}}on(_,t,o){if(o===void 0)return super.on(_,t);const c=this._createDelegatedListener(_,typeof t=="string"?[t]:t,o);this._saveDelegatedListener(_,c);for(const h in c.delegates)this.on(h,c.delegates[h]);return this}once(_,t,o){if(o===void 0)return super.once(_,t);const c=typeof t=="string"?[t]:t,h=this._createDelegatedListener(_,c,o);for(const m in h.delegates){const T=h.delegates[m];h.delegates[m]=(...z)=>{this._removeDelegatedListener(_,c,o),T(...z)}}this._saveDelegatedListener(_,h);for(const m in h.delegates)this.once(m,h.delegates[m]);return this}off(_,t,o){return o===void 0?super.off(_,t):(this._removeDelegatedListener(_,typeof t=="string"?[t]:t,o),this)}queryRenderedFeatures(_,t){if(!this.style)return[];let o;const c=_ instanceof g.P||Array.isArray(_),h=c?_:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:_)||{},h instanceof g.P||typeof h[0]=="number")o=[g.P.convert(h)];else{const m=g.P.convert(h[0]),T=g.P.convert(h[1]);o=[m,new g.P(T.x,m.y),T,new g.P(m.x,T.y),m]}return this.style.queryRenderedFeatures(o,t,this.transform)}querySourceFeatures(_,t){return this.style.querySourceFeatures(_,t)}setStyle(_,t){return(t=g.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&_?(this._diffStyle(_,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(_,t))}setTransformRequest(_){return this._requestManager.setTransformRequest(_),this}_getUIString(_){const t=this._locale[_];if(t==null)throw new Error(`Missing UI string '${_}'`);return t}_updateStyle(_,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(_,t)));const o=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!_)),_?(this.style=new ho(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof _=="string"?this.style.loadURL(_,t,o):this.style.loadJSON(_,t,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ho(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(_,t){if(typeof _=="string"){const o=this._requestManager.transformRequest(_,"Style");g.h(o,new AbortController).then((c=>{this._updateDiff(c.data,t)})).catch((c=>{c&&this.fire(new g.j(c))}))}else typeof _=="object"&&this._updateDiff(_,t)}_updateDiff(_,t){try{this.style.setState(_,t)&&this._update(!0)}catch(o){g.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(_,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():g.w("There is no style added to the map.")}addSource(_,t){return this._lazyInitEmptyStyle(),this.style.addSource(_,t),this._update(!0)}isSourceLoaded(_){const t=this.style&&this.style.sourceCaches[_];if(t!==void 0)return t.loaded();this.fire(new g.j(new Error(`There is no source with ID '${_}'`)))}setTerrain(_){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),_){const t=this.style.sourceCaches[_.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${_.source}`);this.terrain===null&&t.reload();for(const o in this.style._layers){const c=this.style._layers[o];c.type==="hillshade"&&c.source===_.source&&g.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ko(this.painter,t,_),this.painter.renderToTexture=new or(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==_.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new g.k("terrain",{terrain:_})),this}getTerrain(){var _,t;return(t=(_=this.terrain)===null||_===void 0?void 0:_.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const _=this.style&&this.style.sourceCaches;for(const t in _){const o=_[t]._tiles;for(const c in o){const h=o[c];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(_){return this.style.removeSource(_),this._update(!0)}getSource(_){return this.style.getSource(_)}addImage(_,t,o={}){const{pixelRatio:c=1,sdf:h=!1,stretchX:m,stretchY:T,content:z,textFitWidth:P,textFitHeight:B}=o;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||g.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new g.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Z,height:j,data:$}=t,J=t;return this.style.addImage(_,{data:new g.R({width:Z,height:j},new Uint8Array($)),pixelRatio:c,stretchX:m,stretchY:T,content:z,textFitWidth:P,textFitHeight:B,sdf:h,version:0,userImage:J}),J.onAdd&&J.onAdd(this,_),this}}{const{width:Z,height:j,data:$}=It.getImageData(t);this.style.addImage(_,{data:new g.R({width:Z,height:j},$),pixelRatio:c,stretchX:m,stretchY:T,content:z,textFitWidth:P,textFitHeight:B,sdf:h,version:0})}}updateImage(_,t){const o=this.style.getImage(_);if(!o)return this.fire(new g.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||g.b(t)?It.getImageData(t):t,{width:h,height:m,data:T}=c;if(h===void 0||m===void 0)return this.fire(new g.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==o.data.width||m!==o.data.height)return this.fire(new g.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const z=!(t instanceof HTMLImageElement||g.b(t));return o.data.replace(T,z),this.style.updateImage(_,o),this}getImage(_){return this.style.getImage(_)}hasImage(_){return _?!!this.style.getImage(_):(this.fire(new g.j(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(_)}loadImage(_){return We.getImage(this._requestManager.transformRequest(_,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(_,t){return this._lazyInitEmptyStyle(),this.style.addLayer(_,t),this._update(!0)}moveLayer(_,t){return this.style.moveLayer(_,t),this._update(!0)}removeLayer(_){return this.style.removeLayer(_),this._update(!0)}getLayer(_){return this.style.getLayer(_)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(_,t,o){return this.style.setLayerZoomRange(_,t,o),this._update(!0)}setFilter(_,t,o={}){return this.style.setFilter(_,t,o),this._update(!0)}getFilter(_){return this.style.getFilter(_)}setPaintProperty(_,t,o,c={}){return this.style.setPaintProperty(_,t,o,c),this._update(!0)}getPaintProperty(_,t){return this.style.getPaintProperty(_,t)}setLayoutProperty(_,t,o,c={}){return this.style.setLayoutProperty(_,t,o,c),this._update(!0)}getLayoutProperty(_,t){return this.style.getLayoutProperty(_,t)}setGlyphs(_,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(_,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(_,t,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(_,t,o,(c=>{c||this._update(!0)})),this}removeSprite(_){return this._lazyInitEmptyStyle(),this.style.removeSprite(_),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(_,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(_,t,(o=>{o||this._update(!0)})),this}setLight(_,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(_,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(_){return this._lazyInitEmptyStyle(),this.style.setSky(_),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(_,t){return this.style.setFeatureState(_,t),this._update()}removeFeatureState(_,t){return this.style.removeFeatureState(_,t),this._update()}getFeatureState(_){return this.style.getFeatureState(_)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let _=0,t=0;return this._container&&(_=this._container.clientWidth||400,t=this._container.clientHeight||300),[_,t]}_setupContainer(){const _=this._container;_.classList.add("maplibregl-map");const t=this._canvasContainer=Mt.create("div","maplibregl-canvas-container",_);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=Mt.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),c=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],c);const h=this._controlContainer=Mt.create("div","maplibregl-control-container",_),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((T=>{m[T]=Mt.create("div",`maplibregl-ctrl-${T} `,h)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,t,o){this._canvas.width=Math.floor(o*_),this._canvas.height=Math.floor(o*t),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const _={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",(c=>{t={requestedAttributes:_},c&&(t.statusMessage=c.statusMessage,t.type=c.type)}),{once:!0});const o=this._canvas.getContext("webgl2",_)||this._canvas.getContext("webgl",_);if(!o){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new Dr(o,this.transform),Ui.testSupport(o)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(_){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_render(_){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(_),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const h=this.transform.zoom,m=It.now();this.style.zoomHistory.update(h,m);const T=new g.z(h,{now:m,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),z=T.crossFadingFactor();z===1&&z===this._crossFadingFactor||(o=!0,this._crossFadingFactor=z),this.style.update(T)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new g.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,g.bf.mark(g.bg.load),this.fire(new g.k("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const c=this._sourcesDirty||this._styleDirty||this._placementDirty;return c||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new g.k("idle")),!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,g.bf.mark(g.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var _;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),We.removeThrottleControl(this._imageQueueHandle),(_=this._resizeObserver)===null||_===void 0||_.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Mt.remove(this._canvasContainer),Mt.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),g.bf.clearMetrics(),this._removed=!0,this.fire(new g.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,It.frameAsync(this._frameRequest).then((_=>{g.bf.frame(_),this._frameRequest=null,this._render(_)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get version(){return so}getCameraTargetElevation(){return this.transform.elevation}},O.MapMouseEvent=sn,O.MapTouchEvent=Vs,O.MapWheelEvent=os,O.Marker=ec,O.NavigationControl=class{constructor(_){this._updateZoomButtons=()=>{const t=this._map.getZoom(),o=t===this._map.getMaxZoom(),c=t===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,o)=>{const c=this._map._getUIString(`NavigationControl.${o}`);t.title=c,t.setAttribute("aria-label",c)},this.options=g.e({},Kl,_),this._container=Mt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),Mt.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),Mt.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=Mt.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new tc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Mt.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(_,t){const o=Mt.create("button",_,this._container);return o.type="button",o.addEventListener("click",t),o}},O.Popup=class extends g.E{constructor(_){super(),this.remove=()=>(this._content&&Mt.remove(this._content),this._container&&(Mt.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new g.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var o;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=Mt.create("div","maplibregl-popup",this._map.getContainer()),this._tip=Mt.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const z of this.options.className.split(" "))this._container.classList.add(z);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?fi(this._lngLat,this._flatPos,this._map.transform):(o=this._lngLat)===null||o===void 0?void 0:o.wrap(),this._trackPointer&&!t)return;const c=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let h=this.options.anchor;const m=No(this.options.offset);if(!h){const z=this._container.offsetWidth,P=this._container.offsetHeight;let B;B=c.y+m.bottom.y<P?["top"]:c.y>this._map.transform.height-P?["bottom"]:[],c.x<z/2?B.push("left"):c.x>this._map.transform.width-z/2&&B.push("right"),h=B.length===0?"bottom":B.join("-")}let T=c.add(m[h]);this.options.subpixelPositioning||(T=T.round()),Mt.setTransform(this._container,`${Ro[h]} translate(${T.x}px,${T.y}px)`),Cu(this._container,h,"popup")},this._onClose=()=>{this.remove()},this.options=g.e(Object.create(Oe),_)}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new g.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(_){return this._lngLat=g.N.convert(_),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const t=document.createDocumentFragment(),o=document.createElement("body");let c;for(o.innerHTML=_;c=o.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){var _;return(_=this._container)===null||_===void 0?void 0:_.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Mt.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(_),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(_){return this._container&&this._container.classList.add(_),this}removeClassName(_){return this._container&&this._container.classList.remove(_),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){if(this._container)return this._container.classList.toggle(_)}setSubpixelPositioning(_){this.options.subpixelPositioning=_}_createCloseButton(){this.options.closeButton&&(this._closeButton=Mt.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(Bo);_&&_.focus()}},O.RasterDEMTileSource=ln,O.RasterTileSource=zi,O.ScaleControl=class{constructor(_){this._onMove=()=>{Oo(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Oo(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},lr),_)}getDefaultPosition(){return"bottom-left"}onAdd(_){return this._map=_,this._container=Mt.create("div","maplibregl-ctrl maplibregl-ctrl-scale",_.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Mt.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},O.ScrollZoomHandler=$t,O.Style=ho,O.TerrainControl=class{constructor(_){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=_}onAdd(_){return this._map=_,this._container=Mt.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Mt.create("button","maplibregl-ctrl-terrain",this._container),Mt.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Mt.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},O.TwoFingersTouchPitchHandler=N,O.TwoFingersTouchRotateHandler=b,O.TwoFingersTouchZoomHandler=r,O.TwoFingersTouchZoomRotateHandler=Ra,O.VectorTileSource=Sr,O.VideoSource=ia,O.addSourceType=(_,t)=>g._(void 0,void 0,void 0,(function*(){if(co(_))throw new Error(`A source type called "${_}" already exists.`);((o,c)=>{qr[o]=c})(_,t)})),O.clearPrewarmedResources=function(){const _=Ve;_&&(_.isPreloaded()&&_.numActive()===1?(_.release(ae),Ve=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},O.getMaxParallelImageRequests=function(){return g.a.MAX_PARALLEL_IMAGE_REQUESTS},O.getRTLTextPluginStatus=function(){return Rs().getRTLTextPluginStatus()},O.getVersion=function(){return Fc},O.getWorkerCount=function(){return me.workerCount},O.getWorkerUrl=function(){return g.a.WORKER_URL},O.importScriptInWorkers=function(_){return Ys().broadcast("IS",_)},O.prewarm=function(){Vi().acquire(ae)},O.setMaxParallelImageRequests=function(_){g.a.MAX_PARALLEL_IMAGE_REQUESTS=_},O.setRTLTextPlugin=function(_,t){return Rs().setRTLTextPlugin(_,t)},O.setWorkerCount=function(_){me.workerCount=_},O.setWorkerUrl=function(_){g.a.WORKER_URL=_}}));var it=C;return it}))})(Cp)),Cp.exports}var Wg=Kg();const Jm=um(Wg),Jg=Rt.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize(x){Rt.setOptions(this,x),this._throttledUpdate=Rt.Util.throttle(this._update,this.options.updateInterval,this)},onAdd(x){this._container||this._initContainer();const A=this.getPaneName();x.getPane(A).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),x.options.zoomAnimation&&Rt.DomEvent.on(x._proxy,Rt.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove(x){this._map._proxy&&this._map.options.zoomAnimation&&Rt.DomEvent.off(this._map._proxy,Rt.DomUtil.TRANSITION_END,this._transitionEnd,this);const A=this.getPaneName();x.getPane(A).removeChild(this._container),this._container=null,this._glMap.remove(),this._glMap=null},getEvents(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaplibreMap(){return this._glMap},getCanvas(){return this._glMap.getCanvas()},getSize(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getOpacity(){return this.options.opacity},setOpacity(x){this.options.opacity=x,this._container.style.opacity=x},getBounds(){const x=this.getSize().multiplyBy(.5),A=this._map.latLngToContainerPoint(this._map.getCenter());return Rt.latLngBounds(this._map.containerPointToLatLng(A.subtract(x)),this._map.containerPointToLatLng(A.add(x)))},getContainer(){return this._container},getPaneName(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_resize(){return this._glMap._resize},_initContainer(){if(this._container)return;this._container=Rt.DomUtil.create("div","leaflet-gl-layer");const x=this.getSize(),A=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=`${x.x}px`,this._container.style.height=`${x.y}px`;const C=this._map.containerPointToLayerPoint([0,0]).subtract(A);Rt.DomUtil.setPosition(this._container,C)},_initGL(){if(this._glMap)return;const x=this._map.getCenter(),A=Rt.extend({},this.options,{container:this._container,center:[x.lng,x.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new Jm.Map(A),this._glMap.on("error",k=>{k.error&&k.error.status===401&&console.warn("Invalid or expired API key. Please check that API key is not expired and has the basemaps privilege assigned.")}),this._glMap.once("styledata",()=>{this.fire("styleLoaded")}),this._glMap.transform.latRange=null,this._glMap.transform.maxValidLatitude=1/0,this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;const C=this._glMap._actualCanvas;Rt.DomUtil.addClass(C,"leaflet-image-layer"),Rt.DomUtil.addClass(C,"leaflet-zoom-animated"),this.options.interactive&&Rt.DomUtil.addClass(C,"leaflet-interactive"),this.options.className&&Rt.DomUtil.addClass(C,this.options.className)},_update(){if(!this._map||(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming))return;const x=this.getSize(),A=this._container,C=this._glMap,k=this._map.getSize().multiplyBy(this.options.padding),V=this._map.containerPointToLayerPoint([0,0]).subtract(k);Rt.DomUtil.setPosition(A,V),this._transformGL(C),C.transform.width!==x.x||C.transform.height!==x.y?(A.style.width=`${x.x}px`,A.style.height=`${x.y}px`,C._resize!==null&&C._resize!==void 0?C._resize():C.resize()):C._update()},_transformGL(x){const A=this._map.getCenter(),C=x.transform;C.center=Jm.LngLat.convert([A.lng,A.lat]),C.zoom=this._map.getZoom()-1},_pinchZoom(){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom(x){const A=this._map.getZoomScale(x.zoom),C=this._map.getSize().multiplyBy(this.options.padding*A),k=this.getSize()._divideBy(2),V=this._map.project(x.center,x.zoom)._subtract(k)._add(this._map._getMapPanePos().add(C))._round(),it=this._map.project(this._map.getBounds().getNorthWest(),x.zoom)._subtract(V);Rt.DomUtil.setTransform(this._glMap._actualCanvas,it.subtract(this._offset),A)},_zoomStart(){this._zooming=!0},_zoomEnd(){const x=this._map.getZoomScale(this._map.getZoom());Rt.DomUtil.setTransform(this._glMap._actualCanvas,null,x),this._zooming=!1,this._update()},_transitionEnd(){Rt.Util.requestAnimFrame(function(){const x=this._map.getZoom(),A=this._map.getCenter(),C=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());Rt.DomUtil.setTransform(this._glMap._actualCanvas,C,1),this._glMap.once("moveend",Rt.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:A,zoom:x-1})},this)}});function Qg(x){return new Jg(x)}const Qm=Rt.Layer.extend({options:{portalUrl:"https://www.arcgis.com",preserveDrawingBuffer:!1},initialize(x,A){if(A&&Rt.setOptions(this,A),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.apikey?this.options.token=this.options.apikey:this.options.token&&(this.options.apikey=this.options.token),!x)throw new Error("An ITEM ID or SERVICE URL is required for vectorTileLayer.");x&&(this.options.key=x),this._createLayer()},_createLayer(){jg(this.options.key,this.options,(x,A,C,k)=>{if(x){this.fire("load-error",{value:x});return}$g(k.tileInfo.spatialReference.wkid)||console.warn('This layer is not guaranteed to display properly because its service does not use the Web Mercator projection. The "tileInfo.spatialReference" property is:',k.tileInfo.spatialReference,`
More information is available at https://github.com/maplibre/maplibre-gl-js/issues/168 and https://github.com/Esri/esri-leaflet-vector/issues/94.`),A=Gg(A,C,k,this.options.token),this._createMaplibreLayer(A)})},_setupAttribution(){if(!this.getAttribution()){const x=this._maplibreGL.getMaplibreMap().style.stylesheet.sources,A=Object.keys(x);this.options.attribution=x[A[A.length-1]].attribution,this._map&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution())}},_createMaplibreLayer(x){this._maplibreGL=Qg({style:x,pane:this.options.pane,opacity:this.options.opacity,preserveDrawingBuffer:this.options.preserveDrawingBuffer}),this._ready=!0,this.fire("ready",{},!0),this._maplibreGL.on("styleLoaded",()=>{this._setupAttribution(),this.options.style&&typeof this.options.style=="function"&&this._maplibreGL._glMap.setStyle(this.options.style(this._maplibreGL._glMap.getStyle()))})},onAdd(x){this._map=x,this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove(x){x.removeLayer(this._maplibreGL)},_asyncAdd(){const x=this._map;this._maplibreGL.addTo(x,this)}}),ty='Powered by <a href="https://www.esri.com">Esri</a>',ey=Qm.extend({initialize(x,A){if(A.version||(x.includes("/")?A.version=2:A.version=1),x||(x=A.version===1?"ArcGIS:Streets":"arcgis/streets"),!(A.apikey||A.apiKey||A.token))throw new Error("An API Key or token is required for vectorBasemapLayer.");if(A.version!==2){if(A.language)throw new Error("The language parameter is only supported by the basemap styles service v2. Provide a v2 style enumeration to use this option.");if(A.worldview)throw new Error("The worldview parameter is only supported by the basemap styles service v2. Provide a v2 style enumeration to use this option.");if(A.places)throw new Error("The places parameter is only supported by the basemap styles service v2. Provide a v2 style enumeration to use this option.")}A.pane||(x.includes(":Label")||x.includes("/label")?A.pane="esri-labels":x.includes(":Detail")||x.includes("/detail")?A.pane="esri-detail":A.pane="tilePane"),Qm.prototype.initialize.call(this,x,A)},_createLayer(){let x;this.options.version&&this.options.version===2?x=Zg(this.options.key,this.options.apikey,{language:this.options.language,worldview:this.options.worldview,places:this.options.places,baseUrl:this.options.baseUrl}):x=Ug(this.options.key,this.options.apikey),this.options.version&&this.options.version===1&&fetch(x).then(A=>A.json()).then(A=>{A.error&&console.warn("Error:",A.error.message)}).catch(A=>{console.warn("Error:",A.message)}),this._createMaplibreLayer(x)},_setupAttribution(){if(this.options.key.length===32){const x=this._maplibreGL.getMaplibreMap().style.stylesheet.sources,A=[];Object.keys(x).forEach(C=>{A.push(x[C].attribution),x[C].copyrightText&&x[C].copyrightText&&x[C].copyrightText!==""&&x[C].attribution!==x[C].copyrightText&&A.push(x[C].copyrightText)}),this._map.attributionControl.addAttribution(`<span class="esri-dynamic-attribution">${ty} | ${A.join(", ")}</span>`)}else if(Th.setEsriAttribution(this._map),this.options.attributionUrls||(this.options.attributionUrls=this._getAttributionUrls(this.options.key)),this._map&&this.options.attributionUrls){if(this._map.attributionControl){for(let x=0;x<this.options.attributionUrls.length;x++){const A=this.options.attributionUrls[x];Hg(A,this._map)}this._map.attributionControl.addAttribution('<span class="esri-dynamic-attribution"></span>')}Th._updateMapAttribution({target:this._map})}},_getAttributionUrls(x){return x.indexOf("OSM:")===0||x.indexOf("osm/")===0?["https://static.arcgis.com/attribution/Vector/OpenStreetMap_v2"]:x.indexOf("ArcGIS:Imagery")===0||x.indexOf("arcgis/imagery")===0?["https://static.arcgis.com/attribution/World_Imagery","https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]:["https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]},_initPane(){if(!this._map.getPane(this.options.pane)){const x=this._map.createPane(this.options.pane);x.style.pointerEvents="none";let A=500;this.options.pane==="esri-detail"?A=250:this.options.pane==="esri-labels"&&(A=300),x.style.zIndex=A}},onRemove(x){if(x.off("moveend",Th._updateMapAttribution),x.removeLayer(this._maplibreGL),x.attributionControl){Th.removeEsriAttribution&&Th.removeEsriAttribution(x);const A=document.getElementsByClassName("esri-dynamic-attribution");if(A&&A.length>0){const C=A[0].outerHTML;x.attributionControl.removeAttribution(C),x.attributionControl.removeAttribution('<span class="esri-dynamic-attribution"></span>')}}},_asyncAdd(){const x=this._map;this._initPane(),x.on("moveend",Th._updateMapAttribution),this._maplibreGL.addTo(x,this)}});function iy(x,A){return new ey(x,A)}const t_="AAPTxy8BH1VEsoebNVZXo8HurAtUqBEibvXQ49H44V9cLFsdZhqOdxezMGzrZ2QiYfHHlb9zkcacxXvSeuIsHOvLLbUB_MFqDvT-evdF8PKDKmuIayqymwswn09IzC3tH_aL0s9G-CZSWBAaOS2tOZdHdLNA0L34rW0z4wZBQVpKrYKWKYNr4AltUWCw28T5qZB2E7so0ek3jRLAEKbqPgXmr844piY3S6xgI-2oBoj9rBM19tqk-YakklhymszucwtRAT1_ZmlRyAzl",ny={GREY:{type:"esri-custom",id:"38786e137dea4eb5a240ef85cb1390a2"},DARK:{type:"esri-enum",id:"arcgis/dark-gray"}},ay={EXPLORE:"GREY",QUIZ_ZONES:"DARK",QUIZ_INTERSECTIONS:"GREY",QUIZ_BLOCKS:"GREY",QUIZ_ADDRESSES:"GREY"},sy=[{id:"1",name:"Hall 1",coords:[49.291329039026046,-122.79161362016414]},{id:"2",name:"Hall 2",coords:[49.26223510671969,-122.81725512755891]},{id:"3",name:"Hall 3",coords:[49.24804277980424,-122.86566519365569]},{id:"4",name:"Hall 4",coords:[49.2952132946437,-122.7425391041921]}],ry=_d.divIcon({className:"custom-icon",html:`<div style="
    background-color: white; 
    border: 2px solid #ef4444; 
    border-radius: 50%; 
    width: 30px; 
    height: 30px; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.3); 
    font-size: 18px;
    box-sizing: content-box; 
  "></div>`,iconSize:[34,34],iconAnchor:[17,17],popupAnchor:[0,-20]});function oy({style:x}){const A=lf(),C=He.useRef(null);return He.useEffect(()=>{const k=()=>{if(C.current){try{A.hasLayer(C.current)&&A.removeLayer(C.current)}catch(V){console.warn("Suppressed Esri layer cleanup error:",V)}C.current=null}};k();try{const V=ny[x],it=iy(V.id,{apikey:t_,token:t_});it&&(it.addTo(A),C.current=it)}catch(V){console.error("Esri Basemap Init Error:",V)}return k},[A,x]),null}function ly({visible:x}){const A=lf();return He.useEffect(()=>{if(!x)return;const C=w_({url:"https://geodata.coquitlam.ca/arcgis/rest/services/DynamicServices/Cadastral/MapServer",opacity:.9,layers:[0,1,16],f:"image"}).addTo(A);return()=>{A.removeLayer(C)}},[A,x]),null}function uy({visible:x,pane:A}){const C=lf();return He.useEffect(()=>{if(!x)return;const k=w_({url:"https://geodata.coquitlam.ca/arcgis/rest/services/DynamicServices/Planning/MapServer",layers:[6],opacity:.8,f:"image",pane:A||"overlayPane"}).addTo(C);return()=>{C.removeLayer(k)}},[C,x,A]),null}function cy(){return Ae.jsx(Ae.Fragment,{children:sy.map(x=>Ae.jsx(ag,{position:x.coords,icon:ry,children:Ae.jsx(o_,{direction:"top",offset:[0,-15],className:"font-bold text-xs",children:x.name})},x.id))})}function hy({onMapClick:x}){return eg({click:A=>x(A.latlng)}),null}function fy({target:x,mode:A,allBlocks:C,allZones:k}){const V=lf();return He.useEffect(()=>{if(!x)return;let it;if(A==="QUIZ_ZONES"){const O=x.geometry.coordinates[0].map(g=>[g[1],g[0]]);it=_d.latLngBounds(O),V.flyTo(it.getCenter(),13,{animate:!0})}else if(A==="QUIZ_BLOCKS"&&C.length>0){const O=C.filter(g=>g.street===x.street);if(O.length>0){const g=O.flatMap(bt=>bt.coordinates);it=_d.latLngBounds(g),V.fitBounds(it,{paddingTopLeft:[50,50],paddingBottomRight:[350,50],maxZoom:16,animate:!0})}}else if(A==="QUIZ_ADDRESSES"){const O=(Math.random()-.5)*.006,g=(Math.random()-.5)*.008,bt=[x.lat+O,x.lng+g];V.flyTo(bt,16,{animate:!0})}},[x,V,A,C,k]),null}function dy({guessBlock:x,targetBlock:A,mode:C}){const k=lf();return He.useEffect(()=>{if(C==="QUIZ_BLOCKS"&&x&&A){const V=[...x.coordinates,...A.coordinates],it=_d.latLngBounds(V);k.fitBounds(it,{paddingTopLeft:[100,100],paddingBottomRight:[350,100],maxZoom:17,animate:!0})}},[x,A,C,k]),null}const e_={E1:"#ef4444",E2:"#3b82f6",E3:"#22c55e",Q5:"#eab308",E4:"#a855f7",UNKNOWN:"#9ca3af"};function py({gameMode:x,score:A,mapStyle:C,setMapStyle:k,startMode:V,toggleBlocks:it,showBlocks:O}){return Ae.jsxs("div",{className:"bg-slate-950 text-white p-3 shadow-md z-20 flex justify-between items-center border-b border-slate-800 h-16",children:[Ae.jsxs("h1",{className:"text-lg font-bold tracking-wider",children:["FIRST DUE ",Ae.jsx("span",{className:"text-sky-500",children:"TRAINER"})]}),x!=="EXPLORE"&&Ae.jsxs("div",{className:"font-mono text-sm text-slate-400",children:["SCORE: ",Ae.jsx("span",{className:"text-white text-lg",children:A})]}),Ae.jsxs("div",{className:"flex gap-4 items-center",children:[Ae.jsx("div",{className:"flex bg-slate-800 rounded p-1 mr-4 border border-slate-700",children:["GREY","DARK"].map(g=>Ae.jsx("button",{onClick:()=>k(g),className:`px-2 py-1 text-[10px] font-bold rounded ${C===g?"bg-slate-600 text-white":"text-slate-400 hover:text-white"}`,children:g},g))}),Ae.jsx("button",{onClick:()=>it(!O),className:`mr-4 px-3 py-1 text-xs font-bold rounded border ${O?"bg-amber-500 text-black border-amber-600":"bg-slate-800 text-amber-500 border-amber-900 hover:border-amber-500"}`,children:O?"HIDE":"LABELS"}),Ae.jsx("button",{onClick:()=>V("EXPLORE"),className:"px-3 py-1 text-xs font-bold rounded bg-slate-700 text-white hover:bg-slate-600",children:"EXPLORE"}),Ae.jsx("button",{onClick:()=>V("QUIZ_ZONES"),className:"px-3 py-1 text-xs font-bold rounded bg-slate-800 text-sky-500 border border-sky-900 hover:bg-slate-700",children:"ZONES"}),Ae.jsx("button",{onClick:()=>V("QUIZ_INTERSECTIONS"),className:"px-3 py-1 text-xs font-bold rounded bg-slate-800 text-emerald-500 border border-emerald-900 hover:bg-slate-700",children:"INTXN"}),Ae.jsx("button",{onClick:()=>V("QUIZ_BLOCKS"),className:"px-3 py-1 text-xs font-bold rounded bg-slate-800 text-amber-500 border border-amber-900 hover:bg-slate-700",children:"BLOCKS"}),Ae.jsx("button",{onClick:()=>V("QUIZ_ADDRESSES"),className:"px-3 py-1 text-xs font-bold rounded bg-slate-800 text-purple-400 border border-purple-900 hover:bg-slate-700",children:"ADDRESS"})]})]})}function my({gameMode:x,currentQuestion:A,feedback:C,roundScore:k,distanceOff:V,clickedBlockData:it,onNext:O,onZoneGuess:g,map:bt}){return A?Ae.jsxs("div",{className:"absolute top-4 right-4 z-[1000] w-72 bg-slate-900/95 backdrop-blur border border-slate-700 shadow-2xl rounded-xl overflow-hidden flex flex-col pointer-events-auto",children:[Ae.jsxs("div",{className:"bg-slate-800 p-4 border-b border-slate-700 text-center",children:[x==="QUIZ_ZONES"&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("h2",{className:"text-slate-500 text-[10px] uppercase font-bold",children:"FIRST DUE"}),Ae.jsxs("div",{className:"text-3xl text-white font-bold",children:["Zone ",A.zone_id]})]}),x==="QUIZ_INTERSECTIONS"&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"text-slate-500 text-[10px] uppercase font-bold",children:"LOCATE"}),Ae.jsx("div",{className:"text-xl text-white font-bold",children:A.name})]}),x==="QUIZ_BLOCKS"&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"text-slate-500 text-[10px] uppercase font-bold",children:"FIND THE BLOCK"}),Ae.jsx("div",{className:"text-3xl text-amber-500 font-bold leading-tight",children:A.block}),Ae.jsx("div",{className:"text-lg text-white font-bold",children:A.street})]}),x==="QUIZ_ADDRESSES"&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("div",{className:"text-slate-500 text-[10px] uppercase font-bold tracking-widest mb-1",children:"FIND ADDRESS"}),Ae.jsx("div",{className:"text-xl text-white font-bold leading-tight",children:A.address})]})]}),Ae.jsxs("div",{className:"p-4",children:[x==="QUIZ_ZONES"&&Ae.jsx("div",{className:"flex flex-col gap-2",children:Object.keys(e_).filter(Et=>Et!=="UNKNOWN").map(Et=>Ae.jsxs("button",{onClick:()=>g(Et),disabled:C!==null,className:`w-full py-3 px-4 rounded-lg font-bold text-left flex justify-between items-center transition-all border-l-4 ${C==="WRONG"&&Et===A.unit_id?"bg-green-600 text-white border-green-300 shadow-inner":"bg-slate-800 text-slate-300 border-transparent hover:bg-slate-700 hover:text-white"}`,children:[Ae.jsx("span",{children:Et}),Ae.jsx("span",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:e_[Et]}})]},Et))}),C?Ae.jsxs("div",{className:"text-center animate-in fade-in",children:[Ae.jsx("div",{className:`text-4xl font-bold mb-2 ${C==="PERFECT"||C==="CORRECT"?"text-green-400":"text-slate-300"}`,children:C==="PERFECT"||C==="CORRECT"?"PERFECT!":Ae.jsxs("span",{className:"text-2xl",children:["OFF BY ",Ae.jsxs("span",{className:"text-white",children:[V,"m"]})]})}),x==="QUIZ_BLOCKS"&&C==="WRONG"&&it&&Ae.jsxs("div",{className:"text-red-400 font-bold text-lg mb-4",children:["Picked: ",it.block]}),Ae.jsx("button",{onClick:O,className:"bg-sky-600 hover:bg-sky-500 text-white font-bold py-3 px-6 rounded-lg w-full shadow-lg mt-4",children:"NEXT "})]}):Ae.jsxs("div",{className:"text-center text-slate-500 text-xs italic",children:[x==="QUIZ_INTERSECTIONS"&&"Tap the intersection...",x==="QUIZ_BLOCKS"&&"Click the road segment...",x==="QUIZ_ADDRESSES"&&"Zoom in & find the house..."]}),x==="QUIZ_ADDRESSES"&&!C&&Ae.jsx("button",{onClick:()=>bt.setView([A.lat,A.lng],20,{animate:!0}),className:"mt-4 bg-slate-700 hover:bg-slate-600 text-xs text-white py-2 px-4 rounded w-full border border-slate-500",children:" ZOOM TO PARCEL"})]})]}):null}function _y(){const[x,A]=He.useState(null),[C,k]=He.useState([]),[V,it]=He.useState([]),[O,g]=He.useState([]),[bt,Et]=He.useState([]),[Wt,It]=He.useState("EXPLORE"),[Mt,Ui]=He.useState("GREY"),[Bi,je]=He.useState(!1),[gi,on]=He.useState(null),[ea,We]=He.useState(0),[Qi,Ni]=He.useState(null),[Xi,Xe]=He.useState(null),[Un,wn]=He.useState(0),[ca,Fe]=He.useState(null),Ei=He.useRef(null);He.useEffect(()=>{const St="/coquitlam-fire-trainer/";fetch(`${St}data/zones.json?v=2`).then(Ht=>{if(!Ht.ok)throw new Error("HTTP 404");return Ht.json()}).then(k).catch(Ht=>console.error("Missing zones.json",Ht)),fetch(`${St}data/intersections.json?v=1`).then(Ht=>{if(!Ht.ok)throw new Error("HTTP 404");return Ht.json()}).then(it).catch(Ht=>console.error("Missing intersections.json",Ht)),fetch(`${St}data/blocks.json?v=2`).then(Ht=>{if(!Ht.ok)throw new Error("HTTP 404");return Ht.json()}).then(g).catch(Ht=>console.error("Missing blocks.json",Ht)),fetch(`${St}data/addresses.json?v=2`).then(Ht=>{if(!Ht.ok)throw new Error("HTTP 404");return Ht.json()}).then(Et).catch(Ht=>console.error("Missing addresses.json",Ht))},[]),He.useEffect(()=>{const St=Ht=>{Ht.key==="Enter"&&Qi&&Wt!=="EXPLORE"&&Pi()};return window.addEventListener("keydown",St),()=>window.removeEventListener("keydown",St)},[Qi,Wt,C,V,O,bt]);const Sn=St=>{clearTimeout(Ei.current),It(St),We(0),Ni(null),Xe(null),Ui(ay[St]),je(St==="QUIZ_ADDRESSES"),St==="QUIZ_ZONES"&&$i(C),St==="QUIZ_INTERSECTIONS"&&$i(V),St==="QUIZ_BLOCKS"&&Vt(),St==="QUIZ_ADDRESSES"&&$i(bt)},Pi=()=>{Wt==="QUIZ_ZONES"&&$i(C),Wt==="QUIZ_INTERSECTIONS"&&$i(V),Wt==="QUIZ_BLOCKS"&&Vt(),Wt==="QUIZ_ADDRESSES"&&$i(bt)},$i=St=>{clearTimeout(Ei.current),!(!St||St.length===0)&&(on(St[Math.floor(Math.random()*St.length)]),Ni(null),Xe(null))},Vt=()=>{if(clearTimeout(Ei.current),!O||O.length===0)return;const St=O.filter(Ht=>Ht.block>0);on(St[Math.floor(Math.random()*St.length)]),Ni(null),Fe(null)},ce=St=>{St===gi.unit_id?(Ni("CORRECT"),We(Ht=>Ht+1),Ei.current=setTimeout(()=>$i(C),1e3)):Ni("WRONG")},re=St=>{if(Wt!=="QUIZ_INTERSECTIONS"&&Wt!=="QUIZ_ADDRESSES"||Qi)return;Xe(St);const Ht=qm([St.lng,St.lat]),ae=qm([gi.lng,gi.lat]);let me=Math.round(fg(Ht,ae,{units:"kilometers"})*1e3);me<=(Wt==="QUIZ_ADDRESSES"?15:50)&&(me=0),wn(me);const Ve=Math.max(0,500-me);We(Vi=>Vi+Ve);const Mi=me===0?"PERFECT":Ve>0?"OKAY":"MISS";Ni(Mi),Mi==="PERFECT"&&(Ei.current=setTimeout(()=>{Wt==="QUIZ_INTERSECTIONS"&&$i(V),Wt==="QUIZ_ADDRESSES"&&$i(bt)},1500))},xi=St=>{if(Wt!=="QUIZ_BLOCKS"||Qi)return;Fe(St);const Ht=Math.abs(gi.block-St.block);Ht===0?(Ni("PERFECT"),We(ae=>ae+1),Ei.current=setTimeout(Vt,1500)):(Ni("WRONG"),wn(Ht))},ge=St=>{if(!Qi)return{color:Mt==="ORTHO"?"#38bdf8":"#64748b",weight:8,opacity:.9};const Ht=St.block===gi.block,ae=ca&&St.block===ca.block;return Ht?{color:"#22c55e",weight:14,opacity:1}:ae?{color:"#ef4444",weight:14,opacity:1}:{color:"#94a3b8",weight:4,opacity:.2}},dt=St=>Wt==="QUIZ_ZONES"?gi&&St.zone_id===gi.zone_id?{color:"#06b6d4",fillOpacity:.5,weight:0}:{color:"transparent",fillOpacity:0,weight:0}:{color:"#475569",fillOpacity:.05,weight:1};return Ae.jsxs("div",{className:"h-screen w-screen flex flex-col bg-slate-900 overflow-hidden",children:[Ae.jsx(py,{gameMode:Wt,score:ea,mapStyle:Mt,setMapStyle:Ui,startMode:Sn,toggleBlocks:je,showBlocks:Bi}),Ae.jsxs("div",{className:"flex-grow relative",children:[Ae.jsxs(ng,{center:[49.28,-122.8],zoom:12,style:{height:"100%",width:"100%"},className:"bg-slate-900",zoomControl:!1,maxZoom:22,ref:A,children:[Ae.jsx(oy,{style:Mt}),Ae.jsx(ly,{visible:Bi}),Ae.jsx(jm,{name:"underlayPane",style:{zIndex:390}}),Ae.jsx(jm,{name:"labelsPane",style:{zIndex:410}}),Ae.jsx(uy,{visible:Wt==="EXPLORE"||Wt==="QUIZ_ZONES",pane:"labelsPane"}),Wt==="QUIZ_ZONES"&&C.map(St=>Ae.jsx(lg,{positions:St.geometry.coordinates[0].map(Ht=>[Ht[1],Ht[0]]),pathOptions:dt(St),pane:"underlayPane"},St.zone_id)),Wt!=="QUIZ_ZONES"&&Ae.jsx(cy,{}),Ae.jsx(hy,{onMapClick:re}),!Qi&&gi&&Ae.jsx(fy,{target:gi,mode:Wt,allBlocks:O,allZones:C}),Qi==="WRONG"&&Wt==="QUIZ_BLOCKS"&&ca&&Ae.jsx(dy,{guessBlock:ca,targetBlock:O.find(St=>St.block===gi.block&&St.street===gi.street),mode:Wt}),Wt==="QUIZ_BLOCKS"&&gi&&O&&O.length>0&&O.filter(St=>St.street===gi.street).map((St,Ht)=>Ae.jsx(Vm,{positions:St.coordinates,eventHandlers:{click:ae=>{_d.DomEvent.stopPropagation(ae),xi(St)}},pathOptions:ge(St),children:Ae.jsx(o_,{sticky:!0,direction:"top",className:"font-bold text-xs bg-slate-900 text-white border-0",children:Qi?`Block ${St.block}`:"Block ???"})},`${St.street}-${St.block}-${Ht}`)),(Wt==="QUIZ_INTERSECTIONS"||Wt==="QUIZ_ADDRESSES")&&Xi&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(Um,{center:Xi,radius:6,pathOptions:{color:"white",fillColor:Qi==="PERFECT"?"#22c55e":"#ef4444",fillOpacity:1,weight:2}}),Qi!=="PERFECT"&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(Um,{center:[gi.lat,gi.lng],radius:6,pathOptions:{color:"white",fillColor:"#22c55e",fillOpacity:1,weight:2}}),Ae.jsx(Vm,{positions:[Xi,[gi.lat,gi.lng]],pathOptions:{color:"#ef4444",dashArray:"10, 10",weight:2,opacity:.8}})]})]})]}),Ae.jsx(my,{gameMode:Wt,currentQuestion:gi,feedback:Qi,distanceOff:Un,clickedBlockData:ca,map:x,onNext:Pi,onZoneGuess:ce})]})]})}function gy(){return Ae.jsx("div",{className:"App",children:Ae.jsx(_y,{})})}U_.createRoot(document.getElementById("root")).render(Ae.jsx(He.StrictMode,{children:Ae.jsx(gy,{})}));
